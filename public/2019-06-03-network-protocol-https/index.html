<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  <title>杂谈网络协议之 HTTP、HTTPS 和 TLS | 派大星星星星</title>
  
  <meta name="keywords" content="iOS">
  
  

  

  <meta name="HandheldFriendly" content="True">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <!-- meta -->
  

  <!-- link -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.css">
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.6.3/css/all.min.css">
  

  
  <link rel="shortcut icon" type="image/x-icon" href="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/fat_cat_header_small.png">
  

  
    <link rel="stylesheet" href="/style.css">
  

  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script>

  
  
    <!-- ba -->
    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?420331e790ec3f2c56b1660b4958f8c3";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
    </script>
  
</head>

<body>
  
  
  <div class="cover-wrapper">
    <cover class="cover post half">
      
        
  <img class="logo" src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/fat_cat_header_small.png">


  <div class="m_search">
    <form name="searchform" class="form u-search-form">
      <input type="text" class="input u-search-input" placeholder>
      <i class="icon fas fa-search fa-fw"></i>
    </form>
  </div>

<div class="menu navgation">
  <ul class="h-list">
    
      
        <li>
          <a class="nav home" href="/" id="home">
            <i class="fas fa-beer fa-fw"></i>&nbsp;博客
          </a>
        </li>
      
        <li>
          <a class="nav home" href="/categories/" id="categories">
            <i class="fas fa-folder-open fa-fw"></i>&nbsp;分类
          </a>
        </li>
      
        <li>
          <a class="nav home" href="/tags/" id="tags">
            <i class="fas fa-tags fa-fw"></i>&nbsp;标签
          </a>
        </li>
      
        <li>
          <a class="nav home" href="/archives/" id="archives">
            <i class="fas fa-archive fa-fw"></i>&nbsp;归档
          </a>
        </li>
      
    
  </ul>
</div>

      
    </cover>
    <header class="l_header pure">
  <div id="loading-bar-wrapper">
    <div id="loading-bar" class="pure"></div>
  </div>

	<div class="wrapper">
		<div class="nav-main container container--flex">
      <a class="logo flat-box" href="/">
        
          派大星星星星
        
      </a>
			<div class="menu navgation">
				<ul class="h-list">
          
  					
  						<li>
								<a class="nav flat-box" href="/" id="home">
									<i class="fas fa-beer fa-fw"></i>&nbsp;博客
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/categories/" id="categories">
									<i class="fas fa-folder-open fa-fw"></i>&nbsp;分类
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/tags/" id="tags">
									<i class="fas fa-tags fa-fw"></i>&nbsp;标签
								</a>
							</li>
      			
  						<li>
								<a class="nav flat-box" href="/archives/" id="archives">
									<i class="fas fa-archive fa-fw"></i>&nbsp;归档
								</a>
							</li>
      			
      		
				</ul>
			</div>

			
				<div class="m_search">
					<form name="searchform" class="form u-search-form">
						<input type="text" class="input u-search-input" placeholder="搜索">
						<i class="icon fas fa-search fa-fw"></i>
					</form>
				</div>
			
			<ul class="switcher h-list">
				
					<li class="s-search"><a class="fas fa-search fa-fw" href="javascript:void(0)"></a></li>
				
				<li class="s-menu"><a class="fas fa-bars fa-fw" href="javascript:void(0)"></a></li>
			</ul>
		</div>

		<div class="nav-sub container container--flex">
			<a class="logo flat-box"></a>
			<ul class="switcher h-list">
				<li class="s-comment"><a class="flat-btn fas fa-comments fa-fw" href="javascript:void(0)"></a></li>
        
          <li class="s-toc"><a class="flat-btn fas fa-list fa-fw" href="javascript:void(0)"></a></li>
        
			</ul>
		</div>
	</div>
</header>
	<aside class="menu-phone">
    <header>
		<nav class="menu navgation">
      <ul>
        
          
            <li>
							<a class="nav flat-box" href="/" id="home">
								<i class="fas fa-beer fa-fw"></i>&nbsp;博客
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/categories/" id="categories">
								<i class="fas fa-folder-open fa-fw"></i>&nbsp;分类
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/tags/" id="tags">
								<i class="fas fa-tags fa-fw"></i>&nbsp;标签
							</a>
            </li>
          
            <li>
							<a class="nav flat-box" href="/archives/" id="archives">
								<i class="fas fa-archive fa-fw"></i>&nbsp;归档
							</a>
            </li>
          
       
      </ul>
		</nav>
    </header>
	</aside>
<script>setLoadingBarProgress(40);</script>

  </div>


  <div class="l_body">
    <div class='body-wrapper'>
      <div class="l_main">
  

  
    <article id="post" class="post white-box article-type-post" itemscope itemprop="blogPost">
      


  <section class="meta">
    
    
    <div class="meta" id="header-meta">
      
        
  
    <h1 class="title">
      <a href="/2019-06-03-network-protocol-https/">
        杂谈网络协议之 HTTP、HTTPS 和 TLS
      </a>
    </h1>
  


      
      <div class="new-meta-box">
        
          
        
          
            
  <div class="new-meta-item author">
    <a href="https://paaatrick.com" rel="nofollow">
      
        <i class="fas fa-user" aria-hidden="true"></i>
      
      <p>大星</p>
    </a>
  </div>


          
        
          
            <div class="new-meta-item date">
  <a class="notlink">
    <i class="fas fa-calendar-alt" aria-hidden="true"></i>
    <p>2019-06-03</p>
  </a>
</div>

          
        
          
            
  
  <div class="new-meta-item category">
    <a href="/categories/Tech/" rel="nofollow">
      <i class="fas fa-folder-open" aria-hidden="true"></i>
      <p>Tech</p>
    </a>
  </div>


          
        
          
            
  
    <div class="new-meta-item browse busuanzi">
      <a class="notlink">
        <i class="fas fa-eye" aria-hidden="true"></i>
        <p>
          <span id="busuanzi_value_page_pv">
            <i class="fas fa-spinner fa-spin fa-fw" aria-hidden="true"></i>
          </span>
        </p>
      </a>
    </div>
  


          
        
          
            

          
        
      </div>
      
        <hr>
      
    </div>
  </section>


      <section class="article typo">
        <div class="article-entry" itemprop="articleBody">
          <p>最近学了些HTTP相关的内容，做了些笔记，深入了解TLS后感觉密码学挺有意思。</p>
<a id="more"></a>

<p><a href="https://paaatrick.com/2019-06-06-network-protocol-ip-tcp-udp/">关于TCP/IP的内容链接</a></p>
<h2 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h2><h4 id="HTTP-0-9"><a href="#HTTP-0-9" class="headerlink" title="HTTP/0.9"></a>HTTP/0.9</h4><ul>
<li>这是后来回来定义的版本，这个初始版本采用纯文本格式</li>
<li>只有GET动作，在响应请求后立即关闭连接，功能非常有限</li>
</ul>
<h4 id="HTTP-1-0"><a href="#HTTP-1-0" class="headerlink" title="HTTP/1.0"></a>HTTP/1.0</h4><ul>
<li>1996年发布，与1.1差不了多少了<ol>
<li>增加了<code>HEAD</code>、<code>POST</code>等方法</li>
<li>增加响应状态码，标记可能的错误原因</li>
<li>引入协议版本号概念</li>
<li>引入了<code>Header</code>头部的概念</li>
<li>传输的数据不再仅限于文本</li>
</ol>
</li>
<li>但是1.0并不是一个标准，只相当于一个备忘录（参考文档）</li>
</ul>
<h4 id="HTTP-1-1"><a href="#HTTP-1-1" class="headerlink" title="HTTP/1.1"></a>HTTP/1.1</h4><ul>
<li>1999年，发布RFC文档编号2616，是个正式的标准<ol>
<li>增加了<code>PUT</code>、<code>DELETE</code>等方法</li>
<li>增加了缓存管理和控制</li>
<li>明确了连接管理，允许持久连接</li>
<li>允许响应数据分块（<code>chunked</code>），利于传输大文件</li>
<li>强制要求<code>Host</code>头，让互联网主机托管成为可能</li>
</ol>
</li>
</ul>
<h6 id="HTTP请求报文格式"><a href="#HTTP请求报文格式" class="headerlink" title="HTTP请求报文格式"></a>HTTP请求报文格式</h6><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190606155246.jpg" alt></p>
<ul>
<li>请求方法 | URL | 协议版本</li>
<li><code>Header</code>头部（一行一个字段，key-value，中间冒号分隔）</li>
<li>空行</li>
<li>请求包体(GET没有,POST用)(GET也可以填body,服务端不一定处理)</li>
</ul>
<h6 id="HTTP响应报文格式"><a href="#HTTP响应报文格式" class="headerlink" title="HTTP响应报文格式"></a>HTTP响应报文格式</h6><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190606155333.jpg" alt></p>
<ul>
<li>协议版本 | 状态码 | 状态码描述</li>
<li><code>Header</code>头部（一行一个字段，key-value，中间冒号分隔）</li>
<li>空行</li>
<li>响应包体</li>
</ul>
<h6 id="常见的Header"><a href="#常见的Header" class="headerlink" title="常见的Header"></a>常见的Header</h6><ol>
<li>Accept-Charset： 数据编码格式</li>
<li>Content-Type： 数据的类型</li>
<li>Cache-control：max-age，客户端的话就是希望多新的缓存，服务端的话就是告诉客户端某个时间段内的数据都是最新的</li>
<li>If-Modified-Since：如果服务器的资源在某个时间之后更新了，那么客户端就应该下载最最新的资源；如果没有更新，服务端会返回304 Not Modified的响应，那客户端就不用下载了</li>
<li>Retry-After：告诉客户端应该在多长时间以后再次尝试一下</li>
<li>Connection：一般是keep-alive，用来保活TCP连接，close的话就是传输完后就关闭TCP连接</li>
<li>Referer：客户端告诉服务端我是从哪个链接来的，服务端收到后可以做处理，重定向，或者用于支付后的回调（微信支付）</li>
<li>User-Agent：老生常谈，操作系统和浏览器名称版本，很多骚操作</li>
</ol>
<h6 id="一些特点"><a href="#一些特点" class="headerlink" title="一些特点"></a>一些特点</h6><ol>
<li>一般POST时，先发送header，服务器响应 100 Continue 后，浏览器再发送Data，服务器响应 200 OK，可能分两个TCP包</li>
<li>header是key-value，中间冒号分隔</li>
<li>HTTP即超文本传输协议 HyperTextTransferProtocol, 是一个在计算机世界里专门在两点之间传输文字、图片、音频、视频等超文本数据的约定和规范</li>
<li>HTTP没有实体，不是互联网，不是语言，不是HTML，不是孤立的协议。</li>
<li>HTTP是基于TCP的，TCP的重传HTTP不知道</li>
<li>由于有Keep-Alive机制，每次HTTP连接无需TCP重新握手</li>
</ol>
<h4 id="HTTP-2-0"><a href="#HTTP-2-0" class="headerlink" title="HTTP/2.0"></a>HTTP/2.0</h4><ul>
<li>HTTP2.0通过头压缩、分帧、多路复用等技术提升性能</li>
</ul>
<p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190606155409.jpg" alt></p>
<ol>
<li>SPDY是谷歌推出的，HTTP2.0基于此制定</li>
<li>HTTP2.0对header压缩，用索引表替代key-value，将一个TCP连接中切分多个流。<ul>
<li>每个流有自己ID，流是双向的虚拟通道，流有优先级。2.0还将所有信息分割为帧。</li>
<li>有header帧和data帧，用二进制编码，多个data帧属于同一个流。</li>
<li>这样可以将多个请求分到不同的流中，将请求内容拆成帧，进行二进制传输。</li>
<li>帧可以打散乱序发送，然后根据每个帧首部的流标识符重新组装，并根据优先级决定先处理哪个流。</li>
<li>HTTP2.0其实是将n个请求变成n个流，将数据分成帧，乱序发送到一个TCP连接中。</li>
<li>这样2.0解决了1.1的队首阻塞问题。1.1通过pipeline用多条TCP实现并发，2.0只用1个TCP实现并发，提高性能。</li>
<li>但HTTP2.0还是基于TCP的，TCP处理包时有严格顺序，前面流2的帧没收到，后面流1的帧也会阻塞</li>
</ul>
</li>
</ol>
<p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190606155413.jpg" alt></p>
<h4 id="QUIC"><a href="#QUIC" class="headerlink" title="QUIC"></a>QUIC</h4><ul>
<li>QUIC是谷歌基于UDP改进的应用层，未来HTTP3.0可能基于此实现，解决HTTP2.0的问题，QUIC也是面向连接的。</li>
<li>QUIC自定义类似TCP的连接、重试、多路复用、流量控制技术，进一步提升性能</li>
</ul>
<p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190606155449.jpg" alt></p>
<ol>
<li><p>机制1：自定义连接</p>
<ul>
<li>一条TCP连接是四元组（源IP和端口,目标IP和端口）标识的，一旦一个元素变化就需要断开重连</li>
<li>移动互联经常不稳定、切换，都会导致重连，又三次握手，时延高</li>
<li>而基于UDP的QUIC自己用64位随机数作为标识替代四元组，而且UDP是无连接的</li>
<li>当前述的四个元素变化时，不用重新建立连接</li>
</ul>
</li>
<li><p>机制2：自定义重传机制</p>
<ul>
<li>TCP有通过采样往返时间RTT的自适应重传算法，但是这种采样不准确。</li>
<li>QUIC也有递增序列号，任何一个包重发序列号都+1，不像TCP重发包还是原来的序号。</li>
<li>这样超时采样就准了，但是如何知道重发的包内容与前一个一样呢</li>
<li>QUIC在数据流里定义了<code>offset</code>，可以通过<code>offset</code>查看数据发送到了哪里</li>
<li>只要某个<code>offset</code>没到就重发，按照<code>offset</code>拼接成一个流，相当于多设一个参数处理流的顺序。</li>
</ul>
</li>
<li><p>机制3：无阻塞的多路复用</p>
<ul>
<li>跟2.0一样，同一条QUIC上可以创建多个流来发送HTTP请求</li>
<li>但因为基于UDP，一个连接上的多个流之间没有依赖</li>
<li>假如流2丢了一个UDP包，后面跟着流3的一个UDP包，虽然流2的包需要重传，但流3的包无需等待，而TCP就会阻塞</li>
</ul>
</li>
<li><p>机制4：自定义流量控制</p>
<ul>
<li>TCP的流量控制是通过滑动窗口协议，QUIC也是通过window_update来告诉对方自己可接受的字节数</li>
<li>但QUIC的窗口是适应自己的多路复用机制的，不但在一个连接上控制窗口，每个流也有控制窗口</li>
<li>TCP里接收端的窗口起始点是下一个要接收并且ACK的包，即便后来的包都到了放在缓存里，窗口也不能右移</li>
<li>只要前面的包没到，后面的到了也不能ACK，就会导致后面的到了也可能超时重传，浪费带宽。</li>
<li>QUIC的ACK是基于offset的，每个offset的包到了进了缓存就可以应答，应答后就不用重发，再继续等中间的包即可</li>
<li>QUIC窗口的其实位置为当前收到的最大offset，从这个offset到当前流所能容纳的最大缓存才是真正的窗口</li>
<li>另外还有整个连接的窗口，需要对所有流的窗口做一个统计</li>
</ul>
</li>
</ol>
<p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190606155516.jpg" alt></p>
<h4 id="关于HTTP的队首阻塞"><a href="#关于HTTP的队首阻塞" class="headerlink" title="关于HTTP的队首阻塞"></a>关于HTTP的队首阻塞</h4><ol>
<li><p>HTTP/1.0对于同一个tcp连接，所有的请求放入队列中，只有前一个请求的响应收到了，然后才能发送下一个请求。可见，HTTP/1.0的队首组塞发生在客户端。</p>
</li>
<li><p>HTTP/1.1对于同一个tcp连接，HTTP/1.1允许一次发送多个请求，也就是说，不必等前一个响应收到，就可以发送下一个请求，这样就解决了HTTP/1.0的客户端的队首阻塞。但服务端响应的发送要根据请求的顺序排队发送，如果前一个请求的处理时间长就会影响后面的响应发送。可见，HTTP/1.1的队首阻塞发生在服务器端。</p>
</li>
<li><p>HTTP/2.0无论在客户端还是在服务器端都不需要排队，在同一个TCP连接上，有多个stream，由各个stream发送和接收请求，各个steam相互独立，互不阻塞。只要TCO没有人在用那么就可以发送已经生成的requst或者reponse的数据，在两端都不用等，从而彻底解决了HTTP协议层面的队首阻塞问题。</p>
</li>
</ol>
<h2 id="HTTPS"><a href="#HTTPS" class="headerlink" title="HTTPS"></a>HTTPS</h2><h4 id="建立连接过程"><a href="#建立连接过程" class="headerlink" title="建立连接过程"></a>建立连接过程</h4><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190606155548.jpg" alt></p>
<ol>
<li>开始连接时，客户端用服务端的公钥加密发送，服务端用客户端的公钥加密回应</li>
<li>CA证书里有公钥，CA是递归的最后有几个大的rootCA，先用非对称加密获取密钥，然后用对称加密传输数据，TLS/SSL</li>
<li>HTTPS握手过程：（c是客户端，s是服务端）<ul>
<li>c发送 <code>Client Hello</code> 给s，明文传输TLS版本、加密套件候选列表、压缩算法候选列表等以及一个随机数A</li>
<li>s返回 <code>Server Hello</code> 给c，声明选择使用的协议版本、加密套件、压缩算法等以及一个随机数B</li>
<li>s发送 <code>Server Certificate</code> 给c，然后再发送 Server Hello Done，说明发送信息就这么多了，结束</li>
<li>c校验前一步s给的证书，从自己信任的CA仓库中拿CA证书的公钥取解密s的证书，过程中可能需要往上追溯CA、CA的CA等</li>
<li>c发送 <code>Client Key Exchange</code>，内含生成的一个随机数C：<code>Pre-master</code>，用s证书的公钥加密，发送给s，s可以通过自己的私钥解密出来（<code>Pre-master</code>是RSA加密的说法，DH加密需要 <code>DH exponent</code>）</li>
<li>现在，c和s都有了三个随机数，分别是自己的、对方的、Pre-master，通过这三个随机数，c和s能生成相同的对称密钥</li>
<li>c发送 <code>Change Cipher Spec</code> 通知s采用协商的通信密钥和加密算法进行对称加密通信</li>
<li>c发送 <code>Encrypted Handshake Message</code> 将先前商定好的参数采用协商密钥加密，发送给s用于数据与握手验证</li>
<li>s发送 <code>Change Cipher Spec</code> 回应c采用协商的通信密钥和加密算法进行对称加密通信</li>
<li>s发送 <code>Encrypted Handshake Message</code> 将先前商定好的参数采用协商密钥加密，发送给c用于数据与握手验证</li>
<li>双方转而使用对称加密通信，握手完成，除了以上过程，其余过程与HTTP一样</li>
</ul>
</li>
<li>上面是HTTPS单向验证，只是c验证了s的证书，是大部分的场景，也可以在更加严格安全要求的情况下，启用双向验证，互验证书</li>
<li>重放与篡改攻击：自定义的：通过Timestamp和Nonce随机数联合起来做不可逆签名来保证。</li>
<li>为什么不直接用非对称加密通信？<ul>
<li>非对称加密的加密的内容不能超过公钥长度，所以只能用来作密钥交换或者内容签名</li>
<li>性能问题，对称加密是毫秒级，非对称是秒级，<code>HTTPS</code>握手过程的<code>90%</code>时间都在解密<code>RSA</code></li>
</ul>
</li>
<li>除了<code>Premaster</code>外还需要两个随机数的原因是<code>TLS</code>不信任每个客户端都能产生安全的随机数，所以引入多两个随机数</li>
</ol>
<h4 id="SSL-TLS"><a href="#SSL-TLS" class="headerlink" title="SSL/TLS"></a>SSL/TLS</h4><ol>
<li>TLS即SSL升级版，18年推出TLS1.3，目前(19年)用TLS1.2和1.3的都不少，SSL早就废弃了</li>
<li>对称加密算法有：<code>AES</code>、<code>DES</code>、<code>3DES</code>，非对称加密算法有：<code>RSA</code>、<code>ECDHE</code></li>
<li>TLS中上面将两个随机数和Premaster计算成对称加密主密钥的算法是PRF算法(SHA256)</li>
<li>TLS是在传输层（TCPUDP层）之上，应用层（HTTP）之下的层，HTTPS其实就是在TCP和HTTP之间加了TLS层</li>
</ol>
<p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190606155834.PNG" alt></p>
<ol start="5">
<li>握手的加密套件：例子：<code>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</code>，<code>ECDHE</code>密钥交换、<code>RSA</code>身份验证、<code>AES</code>算法、<code>128</code>加密强度、<code>GCM</code>加密模式、<code>SHA256</code>是MAC或者PRF</li>
<li>目前主流HTTPS的流量是使用<code>ECDHE</code>进行密钥交换、用<code>RSA</code>进行身份验证</li>
</ol>
<h4 id="TLS协议原理"><a href="#TLS协议原理" class="headerlink" title="TLS协议原理"></a>TLS协议原理</h4><ul>
<li><p>自顶向下、分层抽象，TLS大致在四层</p>
<ol>
<li>最底层是基础算法原语的实现如<code>AES</code>、<code>RSA</code>、<code>MD5</code>、<code>SHA256</code>、<code>ECDH</code>等</li>
<li>第二层是选定参数后，符合密码学里标准分类的算法，包括块加密算法，签名算法，非对称加密算法，MAC算法等，例如： <code>aes-128-cbc-pkcs7</code>，<code>rsaes-oaep</code> ，<code>rsassa-pkcs1-v1_5</code>, <code>hmac-sha256</code>，<code>ecdsa-p256</code>，<code>curve25519</code> 等</li>
<li>第三层是把多种标准算法组合而成的半成品组件，例如：对称传输组件例如 <code>aes-128-cbc + hmac-sha256，aes-128-gcm</code>，认证密钥协商算法: <code>rsassa-OAEP + ecdh-secp256r1</code>，数字信封：<code>rsaes-oaep + aes-cbc-128 + hmac-sha256</code> ，文件密码加密存储组件：<code>pbkdf2+aes-128-cbc-hmac-sha256</code>，密钥扩展算法 <code>PRF-sha256</code> 等</li>
<li>第四层是用各种组件拼装而成的各种成品密码学协议/软件，例如：TLS协议，SSH协议，SRP协议，gnupg文件格式，iMessage协议，bitcoin协议等等</li>
</ol>
</li>
<li><p>很多程序员自己造的轮子，往往说白了就是想重复实现第3层的某个组件而已。</p>
</li>
</ul>
<h5 id="TLS加密套件-CipherSuite"><a href="#TLS加密套件-CipherSuite" class="headerlink" title="TLS加密套件 (CipherSuite)"></a>TLS加密套件 (CipherSuite)</h5><ul>
<li><p>从上述分层的角度看，<code>TLS</code>大致是由三个组件拼成的：</p>
<ol>
<li>对称加密传输组件，例如<code>aes-128-gcm</code>;</li>
<li>认证密钥协商组件，例如<code>rsa-ecdhe</code>;</li>
<li>密钥扩展组件，例如<code>TLS-PRF-sha256</code></li>
</ol>
</li>
<li><p>这些组件可以再拆分为5类算法，在<code>TLS</code>中，这5类算法组合在一起，称为一个<code>CipherSuite</code>：</p>
<ol>
<li>authentication (认证算法)</li>
<li>encryption (加密算法 )</li>
<li>message authentication code (消息认证码算法  简称MAC)</li>
<li>key exchange (密钥交换算法)</li>
<li>key derivation function （密钥衍生算法)</li>
</ol>
</li>
<li><p>TLS协议设计之初就考虑到了这每一类算法的演变，所以没有定死算法，而是设计了一个算法协商过程，来允许加入新的算法( 简直是软件可扩展性设计的典范！)，协商出的一个算法组合即一个<code>CipherSuite</code></p>
</li>
<li><p>常见加密套件<br> <img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190606155835.JPG" alt></p>
</li>
</ul>
<h4 id="加密算法分类"><a href="#加密算法分类" class="headerlink" title="加密算法分类"></a>加密算法分类</h4><ul>
<li><p>上述第二层中的密码学算法常见有下面几类</p>
<ol>
<li>块加密算法：<code>AES</code>（AES_128_GCM等）、<code>Serpent</code>等</li>
<li>流加密算法：<code>RC4</code>、<code>ChaCha20</code>等</li>
<li>加密用哈希函数：<code>MD5</code>、<code>SHA1</code>、<code>SHA256</code>、<code>POLY1305</code>等</li>
<li>消息验证码函数：<code>AEAD</code>、<code>HMAC-SHA256</code>等</li>
<li>密钥交换算法：<code>RSA</code>、<code>DH</code>、<code>ECDH</code>、<code>ECDHE</code></li>
<li>公钥加密算法：<code>RSA</code></li>
<li>数字签名算法：<code>RSA</code>、<code>DSA</code>、<code>ECDSA</code></li>
</ol>
</li>
<li><p>设计一个加密通信协议的过程，就是自顶向下，逐步细化，挑选各类组件，拼装成完整协议的过程</p>
</li>
</ul>
<h4 id="AES加密算法"><a href="#AES加密算法" class="headerlink" title="AES加密算法"></a>AES加密算法</h4><ol>
<li>每个加密数据块大小固定为128位（16个字节），最后一块不满16字节的话需要用填充算法补齐</li>
<li>最终生成的加密密钥长度有128位、192位、256位三种</li>
<li>多种工作模式：<code>ECB</code>、<code>CBC</code>、<code>CFB</code>等，这块内容很多，后续补充</li>
</ol>
<h4 id="DES、3DES加密算法"><a href="#DES、3DES加密算法" class="headerlink" title="DES、3DES加密算法"></a>DES、3DES加密算法</h4><ol>
<li><p>DES:</p>
<ul>
<li>每个加密数据块大小固定为64位（8个字节）</li>
<li>生成的密钥长度为64位（其中8位用于校验（每个字节的第8位）），所以AES比DES安全</li>
</ul>
</li>
<li><p>3DES:</p>
<ul>
<li>还是64位的加密数据块大小</li>
<li>简单粗暴的 <code>Triple DES</code>，使用3个<code>DES</code>密钥（所以共192位，其中24位校验），对数据块（还是64位的小块）应用三次<code>DES</code>算法进行三次加密</li>
<li>使用的3个密钥不是合并成1个密钥，而还是分成3个用，<code>3DES</code>加密时依次使用密钥1、密钥2、密钥3对明文数据块进行加密，解密过程反之亦然。</li>
<li>每次加解密原理与<code>DES</code>一样</li>
</ul>
</li>
</ol>
<h4 id="RSA加密算法"><a href="#RSA加密算法" class="headerlink" title="RSA加密算法"></a>RSA加密算法</h4><p>1977年，三位数学家Rivest、Shamir 和 Adleman 设计了一种算法，可以实现非对称加密。这种算法用他们三个人的名字命名，叫做<code>RSA</code>算法。从那时直到现在，<code>RSA</code>算法一直是最广为使用的“非对称加密算法”。</p>
<ol>
<li><p>公钥与私钥的产生</p>
<ul>
<li>假设Alice想要通过一个不可靠的媒体接收Bob的一条私人讯息。</li>
<li>她可以用以下的方式来产生一个公钥和一个私钥：</li>
<li>随意选择两个大的质数p和q，p不等于q，计算N=pq。</li>
<li>根据欧拉函数，求得r =φ(N)=φ(p)φ(q)= (p-1)(q-1)</li>
<li>选择一个小于 r 的整数 e，求得 e 关于模 r 的模反元素，命名为d。（模反元素存在，当且仅当e与r互质）</li>
<li>将 p 和 q 的记录销毁。    </li>
<li>(N,e)是公钥，(N,d)是私钥。Alice将她的公钥(N,e)传给Bob，而将她的私钥(N,d)藏起来。 </li>
</ul>
</li>
<li><p>加密消息</p>
<ul>
<li>假设Bob想给Alice送一个消息m，他知道Alice产生的N和e。</li>
<li>他使用起先与Alice约好的格式将m转换为一个小于N，且与N互质的整数n</li>
<li>比如他可以将每一个字转换为这个字的Unicode码，然后将这些数字连在一起组成一个数字。</li>
<li>假如他的信息非常长的话，他可以将这个信息分为几段，然后将每一段转换为n。</li>
<li>用下面这个公式他可以将n加密为c：</li>
<li>n^e ≡ c (mod N)</li>
<li>计算c并不复杂。Bob算出c后就可以将它传递给Alice。</li>
</ul>
</li>
<li><p>解密消息</p>
<ul>
<li>Alice得到Bob的消息c后就可以利用她的密钥d来解码。她可以用以下这个公式来将c转换为n：</li>
<li>c^d ≡ n (mod N)</li>
<li>得到n后，她可以将原来的信息m重新复原。</li>
<li>解码的原理是 c^d ≡ n^(e·d)(mod N)</li>
<li>已知e·d ≡ 1 (mod r)，即e·d =1 +hφ(N)。由欧拉定理可得：</li>
<li>n ^(e·d) =n^ (1 +hφ(N))=n·((n^φ(N))^h)≡(n(1)^h)(modN) ≡ n (mod N)</li>
</ul>
</li>
<li><p>签名消息</p>
<ul>
<li>RSA也可以用来为一个消息署名。</li>
<li>假如Alice想给Bob传递一个署名的消息的话，那么她可以为她的消息计算一个散列值（Message digest）</li>
<li>然后用她的私钥加密这个散列值并将这个“署名”加在消息的后面。</li>
<li>这个消息只有用她的公钥才能被解密。</li>
<li>Bob获得这个消息后可以用Alice的公钥解密这个散列值</li>
<li>然后将这个数据与他自己为这个消息计算的散列值相比较。</li>
<li>假如两者相符的话，那么他就可以知道发信人持有甲的密钥，以及这个消息在传播路径上没有被篡改过。</li>
</ul>
</li>
<li><p>实战例子</p>
<ul>
<li>通过一次简单实践更好的了解RSA</li>
<li>假设p = 2，q = 5（p，q都是素数即可），则N = pq = 10；</li>
<li>得到：r = (p-1)(q-1) = (2-1)(5-1) = 4；</li>
<li>根据模反元素公式，可以得出，e·d ≡ 1 (mod 4),即e·d = 4n+1 (n为正整数)；</li>
<li>假设n=5，则e·d = 21，且e、d为正整数，并且e与r互质，则e = 7，d = 3；</li>
<li>获得公钥和密钥：公钥为(N, e) = (10, 7)，密钥为(N, d) = (10, 3)；</li>
<li>假设要传输的数字为2，通过公钥加密后为：(2^7)(mod 10) = 8；</li>
<li>通过密钥解密：(8^3)(mod 10) = 512(mod 10) = 2，即获得结果；</li>
</ul>
</li>
</ol>
<h4 id="ECDHE加密算法"><a href="#ECDHE加密算法" class="headerlink" title="ECDHE加密算法"></a>ECDHE加密算法</h4><ul>
<li>主要用于HTTPS中的密钥交换</li>
<li><code>ECDHE</code>源自<code>ECDH</code>，<code>ECDH</code>即使用椭圆曲线加密技术（ECC）的 DH密钥交换（Diffie-Hellman）算法.</li>
<li><code>DH</code>密钥交换算法，可以让交换双方在不共享任何秘密的情况下协商出一个密钥。<code>ECC</code>则是建立在基于椭圆曲线的离散对数问题上的密码体制，在相同的密钥长度下，其安全性比<code>RSA</code>更高。</li>
<li>而<code>ECDHE</code>则是<code>ECDH</code>的<code>Ephemeral version</code>，它会为每次握手过程分配一个不同的<code>DH key</code>，从而提供前向安全性。实际上，在<code>HTTP/2</code>中允许使用的<code>Cipher Suite</code>必须采用具有前向安全性的密钥交换算法。</li>
</ul>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><ol>
<li>HTTPS实际就是在TCP层与http层之间加入了TLS/SSL来解决安全问题的。</li>
<li>在进行应用数据传输之前，TLS需要通过握手过程来协商安全通信所需的相关参数。</li>
<li>整个通信过程中主要用到散列、对称加密、非对称加密和证书等相关技术，来解决客户端与服务器数据传输中各种安全风险问题，从而达到保证整个通信过程的安全。</li>
</ol>

        </div>
        
          


  <section class="meta" id="footer-meta">
    <hr>
    <div class="new-meta-box">
      
        
          <div class="new-meta-item date" itemprop="dateUpdated" datetime="2019-08-01T18:15:29+08:00">
  <a class="notlink">
    <i class="fas fa-clock" aria-hidden="true"></i>
    <p>最后更新于 2019年8月1日</p>
  </a>
</div>

        
      
        
          
  
  <div class="new-meta-item meta-tags"><a class="tag" href="/tags/NetworkProtocol/" rel="nofollow"><i class="fas fa-hashtag" aria-hidden="true"></i>&nbsp;<p>NetworkProtocol</p></a></div>


        
      
        
          
  <div class="new-meta-item share -mob-share-list">
  <div class="-mob-share-list share-body">
    
      
        <a class="-mob-share-qq" title="QQ好友" rel="external nofollow noopener noreferrer" href="http://connect.qq.com/widget/shareqq/index.html?url=https://paaatrick.com/2019-06-03-network-protocol-https/&title=杂谈网络协议之 HTTP、HTTPS 和 TLS | 派大星星星星&summary=最近学了些HTTP相关的内容，做了些笔记，深入了解TLS后感觉密码学挺有意思。">
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/assets@19.1.9/logo/128/qq.png">
          
        </a>
      
    
      
        <a class="-mob-share-qzone" title="QQ空间" rel="external nofollow noopener noreferrer" href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://paaatrick.com/2019-06-03-network-protocol-https/&title=杂谈网络协议之 HTTP、HTTPS 和 TLS | 派大星星星星&summary=最近学了些HTTP相关的内容，做了些笔记，深入了解TLS后感觉密码学挺有意思。">
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/assets@19.1.9/logo/128/qzone.png">
          
        </a>
      
    
      
        <a class="qrcode" rel="external nofollow noopener noreferrer" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACvUlEQVR42u3aQW7DMAwEwPz/0+m5aO3sUlKaAqNT4Do2RwFEltLjEY/nxbi6J3nC/ZOv7nycGHh4eHibQk+C+Pni5Ak/334V1dV3k5jx8PDwTvOSF9y/bPbd+9SSfH5hwcPDw/sYXhLuLP3khTgeHh7ef+HNWhUr3YO3JgY8PDy8mDdrNySBJs2INvQjvRY8PDy8mJcv1p/z+cj+Hh4eHt7yrnq+GXZ//fR212W0eHh4eAd4+YKbHAVY2dZqj2rlceLh4eHt5SUNgvaf/HwK8q2vvCXx7R48PDy8A7yVBsRs+79t784mbkN/BQ8PD++W124staVzklru78wn6MXJCDw8PLxl3qzZmoTSrs/1b9JmNjw8PLwDvNl216xoztPA7Dnfei14eHh4W3ltCzVPIbsObM3e8ki6Gnh4eHijSNrSuW22riSGvLCO8h4eHh7eVl7eop0dk2qfn6euF3/Fw8PDO8DLH70S6DMYbZopjh3g4eHhbeW1Z7JWDg20ZfGGpgkeHh7eYV6++D7j0S7l+XQkqQsPDw/vBG/WDmg39dsr7doepQo8PDy8Tby22F0pkWfle5KQLtMDHh4e3h/x8tzSTlNeTC8dusLDw8M7wGuvzBbulSnII/klMeDh4eG9hZe/ICma149hzd6Lh4eHd4LXNm3b0rYtjvPyOr+Oh4eHd4I3awHsWuhXklDxW+Hh4eEd4M0W6PWkkqeBNp3g4eHh/RVvfTt/1viYjWIbDA8PD2/Ee5ZjlgbabbB8Kl+U7Hh4eHgHeO2C2wadp4o26CUMHh4e3jKvbT3Mmgt5OT7bwbuMCg8PD+8Yr92yaovgYaek/BYeHh7eJ/OSzf72qMF66wEPDw/vk3nrSWLlgNfSoSs8PDy8TbxZ4yBJG+2xqtnnDb0WPDw8vJg3axPkKSGfxFkhvmHg4eHhpbwvu7MDJ7EnJtYAAAAASUVORK5CYII=">
        
          <img src="https://cdn.jsdelivr.net/gh/xaoxuu/assets@19.1.9/logo/128/wechat.png">
        
        </a>
      
    
      
        <a class="-mob-share-weibo" title="微博" rel="external nofollow noopener noreferrer" href="http://service.weibo.com/share/share.php?url=https://paaatrick.com/2019-06-03-network-protocol-https/&title=杂谈网络协议之 HTTP、HTTPS 和 TLS | 派大星星星星&summary=最近学了些HTTP相关的内容，做了些笔记，深入了解TLS后感觉密码学挺有意思。">
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/assets@19.1.9/logo/128/weibo.png">
          
        </a>
      
    
      
        <a class="qrcode" rel="external nofollow noopener noreferrer" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACvUlEQVR42u3aQW7DMAwEwPz/0+m5aO3sUlKaAqNT4Do2RwFEltLjEY/nxbi6J3nC/ZOv7nycGHh4eHibQk+C+Pni5Ak/334V1dV3k5jx8PDwTvOSF9y/bPbd+9SSfH5hwcPDw/sYXhLuLP3khTgeHh7ef+HNWhUr3YO3JgY8PDy8mDdrNySBJs2INvQjvRY8PDy8mJcv1p/z+cj+Hh4eHt7yrnq+GXZ//fR212W0eHh4eAd4+YKbHAVY2dZqj2rlceLh4eHt5SUNgvaf/HwK8q2vvCXx7R48PDy8A7yVBsRs+79t784mbkN/BQ8PD++W124staVzklru78wn6MXJCDw8PLxl3qzZmoTSrs/1b9JmNjw8PLwDvNl216xoztPA7Dnfei14eHh4W3ltCzVPIbsObM3e8ki6Gnh4eHijSNrSuW22riSGvLCO8h4eHh7eVl7eop0dk2qfn6euF3/Fw8PDO8DLH70S6DMYbZopjh3g4eHhbeW1Z7JWDg20ZfGGpgkeHh7eYV6++D7j0S7l+XQkqQsPDw/vBG/WDmg39dsr7doepQo8PDy8Tby22F0pkWfle5KQLtMDHh4e3h/x8tzSTlNeTC8dusLDw8M7wGuvzBbulSnII/klMeDh4eG9hZe/ICma149hzd6Lh4eHd4LXNm3b0rYtjvPyOr+Oh4eHd4I3awHsWuhXklDxW+Hh4eEd4M0W6PWkkqeBNp3g4eHh/RVvfTt/1viYjWIbDA8PD2/Ee5ZjlgbabbB8Kl+U7Hh4eHgHeO2C2wadp4o26CUMHh4e3jKvbT3Mmgt5OT7bwbuMCg8PD+8Yr92yaovgYaek/BYeHh7eJ/OSzf72qMF66wEPDw/vk3nrSWLlgNfSoSs8PDy8TbxZ4yBJG+2xqtnnDb0WPDw8vJg3axPkKSGfxFkhvmHg4eHhpbwvu7MDJ7EnJtYAAAAASUVORK5CYII=">
        
          <img src="https://cdn.jsdelivr.net/gh/xaoxuu/assets@19.1.9/logo/128/qrcode.png">
        
        </a>
      
    
  </div>
</div>



        
      
    </div>
  </section>


        
        
            <div class="prev-next">
                
                    <section class="prev">
                        <span class="art-item-left">
                            <h6><i class="fas fa-chevron-left" aria-hidden="true"></i>&nbsp;上一页</h6>
                            <h4>
                                <a href="/2019-06-06-network-protocol-ip-tcp-udp/" rel="prev" title="杂谈网络协议之 TCP/IP">
                                  
                                      杂谈网络协议之 TCP/IP
                                  
                                </a>
                            </h4>
                            
                                
                                <h6 class="tags">
                                    <a class="tag" href="/tags/NetworkProtocol/"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>NetworkProtocol</a>
                                </h6>
                            
                        </span>
                    </section>
                
                
                    <section class="next">
                        <span class="art-item-right" aria-hidden="true">
                            <h6>下一页&nbsp;<i class="fas fa-chevron-right" aria-hidden="true"></i></h6>
                            <h4>
                                <a href="/2019-06-01-ios-achieve-h5-image-bounding-rect/" rel="prev" title="WKWebView获取H5页面里图片地址以及图片相对视图窗口的坐标的方法">
                                    
                                        WKWebView获取H5页面里图片地址以及图片相对视图窗口的坐标的方法
                                    
                                </a>
                            </h4>
                            
                                
                                <h6 class="tags">
                                    <a class="tag" href="/tags/iOS/"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>iOS</a> <a class="tag" href="/tags/Objective-C/"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>Objective-C</a>
                                </h6>
                            
                        </span>
                    </section>
                
            </div>
        
      </section>
    </article>
  

  
    <!-- 显示推荐文章和评论 -->



  <article class="post white-box comments">
    <section class="article typo">
      <h4><i class="fas fa-comments fa-fw" aria-hidden="true"></i>&nbsp;评论</h4>
      
        <section id="comments">
          <div id="disqus_thread">
            <div><i class="fas fa-exclamation-triangle">&nbsp;无法加载Disqus评论系统，请确保您的网络能够正常访问。</i></div>
          </div>
        </section>
      
      
      
      
    </section>
  </article>


  




<!-- 根据页面mathjax变量决定是否加载MathJax数学公式js -->



  <script>
    window.subData = {
      title: '杂谈网络协议之 HTTP、HTTPS 和 TLS',
      tools: true
    }
  </script>


</div>
<aside class="l_side">
  
    
    
      
        
          
          
            <section class="widget author">
  <div class="content pure">
    
      <div class="avatar">
        <img class="avatar" src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190516125601.jpg">
      </div>
    
    
    
      <div class="social-wrapper">
        
          
            <a href="https://github.com/Fongim" class="social fab fa-github flat-btn" target="_blank" rel="external nofollow noopener noreferrer">
            </a>
          
        
          
            <a href="mailto:me@paaatrick.com" class="social fas fa-envelope flat-btn" target="_blank" rel="external nofollow noopener noreferrer">
            </a>
          
        
          
            <a href="https://me.csdn.net/fongim" class="social fab fa-contao flat-btn" target="_blank" rel="external nofollow noopener noreferrer">
            </a>
          
        
      </div>
    
  </div>
</section>

          
        
      
        
          
          
            
  <section class="widget toc-wrapper">
    
<header class="pure">
  <div><i class="fas fa-list fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;本文目录</div>
  
    <div class="wrapper"><a class="s-toc rightBtn" rel="external nofollow noopener noreferrer" href="javascript:void(0)"><i class="fas fa-thumbtack fa-fw"></i></a></div>
  
</header>

    <div class="content pure">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTP"><span class="toc-text">HTTP</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#HTTP-0-9"><span class="toc-text">HTTP/0.9</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTTP-1-0"><span class="toc-text">HTTP/1.0</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTTP-1-1"><span class="toc-text">HTTP/1.1</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#HTTP请求报文格式"><span class="toc-text">HTTP请求报文格式</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#HTTP响应报文格式"><span class="toc-text">HTTP响应报文格式</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#常见的Header"><span class="toc-text">常见的Header</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#一些特点"><span class="toc-text">一些特点</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HTTP-2-0"><span class="toc-text">HTTP/2.0</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#QUIC"><span class="toc-text">QUIC</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#关于HTTP的队首阻塞"><span class="toc-text">关于HTTP的队首阻塞</span></a></li></ol><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTPS"><span class="toc-text">HTTPS</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#建立连接过程"><span class="toc-text">建立连接过程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SSL-TLS"><span class="toc-text">SSL/TLS</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#TLS协议原理"><span class="toc-text">TLS协议原理</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#TLS加密套件-CipherSuite"><span class="toc-text">TLS加密套件 (CipherSuite)</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#加密算法分类"><span class="toc-text">加密算法分类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#AES加密算法"><span class="toc-text">AES加密算法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#DES、3DES加密算法"><span class="toc-text">DES、3DES加密算法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#RSA加密算法"><span class="toc-text">RSA加密算法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ECDHE加密算法"><span class="toc-text">ECDHE加密算法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#总结"><span class="toc-text">总结</span></a></li></ol></li>
    </div>
  </section>


          
        
      
        
          
          
            
  <section class="widget category">
    
<header class="pure">
  <div><i class="fas fa-folder-open fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;文章分类</div>
  
    <a class="rightBtn" rel="nofollow" href="/categories/" title="categories/">
    <i class="fas fa-expand-arrows-alt fa-fw"></i></a>
  
</header>

    <div class="content pure">
      <ul class="entry">
        
          <li><a class="flat-box" title="/categories/Algorithm/" href="/categories/Algorithm/"><div class="name">Algorithm</div><div class="badge">(10)</div></a></li>
        
          <li><a class="flat-box" title="/categories/Life/" href="/categories/Life/"><div class="name">Life</div><div class="badge">(4)</div></a></li>
        
          <li><a class="flat-box" title="/categories/Note/" href="/categories/Note/"><div class="name">Note</div><div class="badge">(12)</div></a></li>
        
          <li><a class="flat-box" title="/categories/Tech/" href="/categories/Tech/"><div class="name">Tech</div><div class="badge">(13)</div></a></li>
        
      </ul>
    </div>
  </section>


          
        
      
        
          
          
            
  <section class="widget tagcloud">
    
<header class="pure">
  <div><i class="fas fa-fire fa-fw" aria-hidden="true"></i>&nbsp;&nbsp;热门标签</div>
  
    <a class="rightBtn" rel="nofollow" href="/tags/" title="tags/">
    <i class="fas fa-expand-arrows-alt fa-fw"></i></a>
  
</header>

    <div class="content pure">
      <a href="/tags/Algorithm/" style="font-size: 20px; color: #707070">Algorithm</a> <a href="/tags/Audio-Video/" style="font-size: 14px; color: #999">Audio/Video</a> <a href="/tags/Food/" style="font-size: 16px; color: #8b8b8b">Food</a> <a href="/tags/Hotel/" style="font-size: 14px; color: #999">Hotel</a> <a href="/tags/LeetCode/" style="font-size: 20px; color: #707070">LeetCode</a> <a href="/tags/NetworkProtocol/" style="font-size: 18px; color: #7e7e7e">NetworkProtocol</a> <a href="/tags/Objective-C/" style="font-size: 22px; color: #636363">Objective-C</a> <a href="/tags/Python/" style="font-size: 20px; color: #707070">Python</a> <a href="/tags/Swift/" style="font-size: 14px; color: #999">Swift</a> <a href="/tags/SwiftUI/" style="font-size: 14px; color: #999">SwiftUI</a> <a href="/tags/WordPress/" style="font-size: 16px; color: #8b8b8b">WordPress</a> <a href="/tags/iOS/" style="font-size: 24px; color: #555">iOS</a>
    </div>
  </section>


          
        
      
    

  
</aside>

<footer id="footer" class="clearfix">
  
  
    <div class="social-wrapper">
      
        
          <a href="https://github.com/Fongim" class="social fab fa-github flat-btn" target="_blank" rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="mailto:me@paaatrick.com" class="social fas fa-envelope flat-btn" target="_blank" rel="external nofollow noopener noreferrer">
          </a>
        
      
        
          <a href="https://me.csdn.net/fongim" class="social fab fa-contao flat-btn" target="_blank" rel="external nofollow noopener noreferrer">
          </a>
        
      
    </div>
  
  <br>
  <div><p>©2019 派大星星星星</p>
</div>
  <div>
    本站使用
    <a href="https://xaoxuu.com/wiki/material-x/" target="_blank" class="codename">Material X</a>
    作为主题
    
      ，
      总访问量为
      <span id="busuanzi_value_site_pv"><i class="fas fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span>
      次
    
    。
  </div>
</footer>
<script>setLoadingBarProgress(80);</script>


      <script>setLoadingBarProgress(60);</script>
    </div>
    <a class="s-top fas fa-arrow-up fa-fw" href='javascript:void(0)'></a>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>

  <script>
    var GOOGLE_CUSTOM_SEARCH_API_KEY = "";
    var GOOGLE_CUSTOM_SEARCH_ENGINE_ID = "";
    var ALGOLIA_API_KEY = "";
    var ALGOLIA_APP_ID = "";
    var ALGOLIA_INDEX_NAME = "";
    var AZURE_SERVICE_NAME = "";
    var AZURE_INDEX_NAME = "";
    var AZURE_QUERY_KEY = "";
    var BAIDU_API_ID = "";
    var SEARCH_SERVICE = "hexo" || "hexo";
    var ROOT = "/"||"/";
    if(!ROOT.endsWith('/'))ROOT += '/';
  </script>

<script src="//instant.page/1.2.2" type="module" integrity="sha384-2xV8M5griQmzyiY3CDqh1dn4z3llDVqZDqzjzcY+jCBCk/a5fXJmuZ/40JJAPeoU"></script>


  <script async src="https://cdn.jsdelivr.net/npm/scrollreveal@4.0.5/dist/scrollreveal.min.js"></script>
  <script type="text/javascript">
    $(function() {
      const $reveal = $('.reveal');
      if ($reveal.length === 0) return;
      const sr = ScrollReveal({ distance: 0 });
      sr.reveal('.reveal');
    });
  </script>


  <script src="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.js"></script>
  <script type="text/javascript">
    $(function() {
      Waves.attach('.flat-btn', ['waves-button']);
      Waves.attach('.float-btn', ['waves-button', 'waves-float']);
      Waves.attach('.float-btn-light', ['waves-button', 'waves-float', 'waves-light']);
      Waves.attach('.flat-box', ['waves-block']);
      Waves.attach('.float-box', ['waves-block', 'waves-float']);
      Waves.attach('.waves-image');
      Waves.init();
    });
  </script>


  <script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-busuanzi@2.3/js/busuanzi.pure.mini.js"></script>




  
  
  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-backstretch/2.0.4/jquery.backstretch.min.js"></script>
    <script type="text/javascript">
      $(function(){
        const images = ["https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190516120523.jpeg", "https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190516120522.jpeg", "https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190516120521.jpeg", "https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190516120520.jpeg", "https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190516120519.jpeg", "https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190516120518.jpeg", "https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190516120517.jpeg", "https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190516120516.jpeg", "https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190516120515.jpeg"];
        for (let i = 1; i < images.length; i++) {
          const random = Math.floor(Math.random() * (i + 1));
          [images[i], images[random]] = [images[random], images[i]];
        }
        if ('') {
          $('').backstretch(images, 
          {
            duration: "40000",
            fade: "2500"
          });
        } else {
          $.backstretch(images, 
          {
            duration: "40000",
            fade: "2500"
          });
        }
      });
    </script>
  





  <script>
    var disqus_shortname = 'paaatrick-com';
    
      var disqus_url = 'https://paaatrick.com/2019-06-03-network-protocol-https/';
    
    (function(){
      var dsq = document.createElement('script');
      dsq.type = 'text/javascript';
      dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>







  <script src="/js/app.js"></script>


  <script src="/js/search.js"></script>




<!-- 复制 -->
<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  let COPY_SUCCESS = "复制成功";
  let COPY_FAILURE = "复制失败";
  /*页面载入完成后，创建复制按钮*/
  !function (e, t, a) {
    /* code */
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '  <i class="fa fa-copy"></i><span>复制</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });

      clipboard.on('success', function(e) {
        //您可以加入成功提示
        console.info('Action:', e.action);
        console.info('Text:', e.text);
        console.info('Trigger:', e.trigger);
        success_prompt(COPY_SUCCESS);
        e.clearSelection();
      });
      clipboard.on('error', function(e) {
        //您可以加入失败提示
        console.error('Action:', e.action);
        console.error('Trigger:', e.trigger);
        fail_prompt(COPY_FAILURE);
      });
    }
    initCopyCode();

  }(window, document);

  /**
   * 弹出式提示框，默认1.5秒自动消失
   * @param message 提示信息
   * @param style 提示样式，有alert-success、alert-danger、alert-warning、alert-info
   * @param time 消失时间
   */
  var prompt = function (message, style, time)
  {
      style = (style === undefined) ? 'alert-success' : style;
      time = (time === undefined) ? 1500 : time*1000;
      $('<div>')
          .appendTo('body')
          .addClass('alert ' + style)
          .html(message)
          .show()
          .delay(time)
          .fadeOut();
  };

  // 成功提示
  var success_prompt = function(message, time)
  {
      prompt(message, 'alert-success', time);
  };

  // 失败提示
  var fail_prompt = function(message, time)
  {
      prompt(message, 'alert-danger', time);
  };

  // 提醒
  var warning_prompt = function(message, time)
  {
      prompt(message, 'alert-warning', time);
  };

  // 信息提示
  var info_prompt = function(message, time)
  {
      prompt(message, 'alert-info', time);
  };

</script>


<!-- fancybox -->
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
<script>
  let LAZY_LOAD_IMAGE = "";
  $(".article-entry").find("fancybox").find("img").each(function () {
      var element = document.createElement("a");
      $(element).attr("data-fancybox", "gallery");
      $(element).attr("href", $(this).attr("src"));
      /* 图片采用懒加载处理时,
       * 一般图片标签内会有个属性名来存放图片的真实地址，比如 data-original,
       * 那么此处将原本的属性名src替换为对应属性名data-original,
       * 修改如下
       */
       if (LAZY_LOAD_IMAGE) {
         $(element).attr("href", $(this).attr("data-original"));
       }
      $(this).wrap(element);
  });
</script>





  <script>setLoadingBarProgress(100);</script>
</body>
</html>
