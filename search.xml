<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>å¦‚ä½•æ„å»ºä¸€ä¸ªæ”¯æŒ Windows XP çš„ LIB/DLL/EXE</title>
      <link href="/2021-11-07-build-for-windows-xp/"/>
      <url>/2021-11-07-build-for-windows-xp/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘æŠŠå…¬å¸çš„ä¸€äº›å¤§å‹è·¨å¹³å° C++ Base é¡¹ç›®ä» CMake æ„å»ºç³»ç»Ÿåˆ‡æ¢åˆ°äº† Google çš„ <a href="https://gn.googlesource.com/gn/" target="_blank" rel="noopener">GN Build</a>ã€‚è¿›å±•éƒ½æ¯”è¾ƒé¡ºåˆ©ï¼Œç›´åˆ°æœ‰å®¢æˆ·éœ€è¦ä¸€ä¸ªæ”¯æŒ Windows XP çš„åŠ¨æ€åº“ã€‚ã€‚ã€‚</p><p>è™½ç„¶é©¬ä¸Šå°±è¦ 2022 å¹´ï¼Œè·ç¦» XP çš„è¯ç”Ÿå·²ç»è¶…è¿‡ 20 å¹´ï¼Œè·ç¦» XP çš„åºŸå¼ƒä¹Ÿè¶…è¿‡ 7 å¹´äº†ï¼Œä½†ä»ç„¶æ¶ä¸ä½è¿˜æ˜¯å°†è¿‘æœ‰ 5% çš„è®¡ç®—æœºè¿è¡Œç€ XP ï¼ˆå¤§é™†åœ°åŒºç”šè‡³æœ‰ 15% ï¼ï¼‰ï¼Œæ—¢ç„¶å®¢æˆ·éœ€è¦ï¼Œé‚£è¿˜æ˜¯å¾—æ”¯æŒ ğŸ¤·â€â™‚ï¸</p><a id="more"></a><p>å®é™…ä¸Šè¿™ä¸ªé¡¹ç›®åœ¨å‡ å¹´å‰å·²ç»åšè¿‡ä¸€æ¬¡ XP çš„é€‚é…ï¼Œä¹Ÿé¡ºåˆ©äº¤ä»˜è¿‡å¾ˆå¤šæ¬¡äº†ï¼Œä½†æ˜æ˜¾ Google Chromium çš„å·¥å…·é“¾é»˜è®¤å¹¶ä¸æ”¯æŒ Windows XPã€‚</p><h2 id="æ„å»ºæ”¯æŒ"><a href="#æ„å»ºæ”¯æŒ" class="headerlink" title="æ„å»ºæ”¯æŒ"></a>æ„å»ºæ”¯æŒ</h2><p>ç»è¿‡ä¸€ç•ªç ”ç©¶ï¼Œå®é™…ä¸Šåœ¨æ„å»ºè¿™å—ï¼Œæƒ³è¦æ”¯æŒ XP è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œéš¾çš„æ˜¯ä»£ç ä¸­å¦‚ä½•è§£å†³é€‚é…é‚£äº› XP æ²¡æœ‰æä¾›çš„ Windows APIã€‚ä»¥ä¸‹æŒ‰ç…§ä¸åŒçš„ Windows å·¥ç¨‹æ¥è®¨è®ºã€‚</p><h3 id="åŸç”Ÿ-Visual-Studio-å·¥ç¨‹"><a href="#åŸç”Ÿ-Visual-Studio-å·¥ç¨‹" class="headerlink" title="åŸç”Ÿ Visual Studio å·¥ç¨‹"></a>åŸç”Ÿ Visual Studio å·¥ç¨‹</h3><ol><li><p>é¦–å…ˆç¡®ä¿ä½ çš„ Visual Studio å·²å®‰è£… XP å·¥å…·é›†ï¼ˆä¾‹å¦‚ VS 2019 çš„éœ€è¦å®‰è£…æ ‡æ³¨äº†å·²åºŸå¼ƒçš„ v141_xp å·¥å…·é›†ã€‚</p><p> <img src="https://raw.githubusercontent.com/patrick-fu/personal_blog_image/master/image/visual_studio_installer_xp.png" alt="Visual Studio Installer v141_xp"></p></li><li><p>æ‰“å¼€è§£å†³æ–¹æ¡ˆ/é¡¹ç›®ï¼Œåœ¨é¡¹ç›®å±æ€§ä¸­æ‰¾åˆ°å¸¸è§„ -&gt; å¹³å°å·¥å…·é›†ï¼Œé€‰æ‹© v141_xp æˆ–å…¶ä»–å¸¦æœ‰ xp åç¼€çš„å·¥å…·é›†ã€‚</p><p> <img src="https://raw.githubusercontent.com/patrick-fu/personal_blog_image/master/image/visual_studio_project_properties.png" alt="Visual Studio Project Properties Toolset"></p></li><li><p>æ”¹åŠ¨ä¿å­˜åï¼Œæ³¨æ„åˆ°æ­¤æ—¶ Windows SDK çš„ç‰ˆæœ¬ä¼šè‡ªåŠ¨åˆ‡æ¢åˆ° 7.0ã€‚ç„¶åå†æ¬¡ç”Ÿæˆé¡¹ç›®ï¼Œå°±èƒ½æ„å»ºå‡ºä¸€ä¸ªæ”¯æŒ Windows XP çš„åº“/å¯æ‰§è¡ŒäºŒè¿›åˆ¶äº†ã€‚</p></li></ol><h3 id="CMake-å·¥ç¨‹"><a href="#CMake-å·¥ç¨‹" class="headerlink" title="CMake å·¥ç¨‹"></a>CMake å·¥ç¨‹</h3><ol><li><p>éœ€è¦ä½¿ç”¨ Visual Studio Generatorï¼Œå‚è€ƒ <a href="https://cmake.org/cmake/help/v3.22/manual/cmake-generators.7.html#visual-studio-generators" target="_blank" rel="noopener">CMake Visual Studio Generator</a></p></li><li><p>é€šè¿‡ <code>-T</code> å‚æ•°æŒ‡å®š v141_xp æˆ– v140_xp çš„å·¥å…·é›†ï¼Œå‚è€ƒ <a href="https://cmake.org/cmake/help/v3.22/variable/CMAKE_GENERATOR_TOOLSET.html#variable:CMAKE_GENERATOR_TOOLSET" target="_blank" rel="noopener">CMAKE_GENERATOR_TOOLSET</a></p></li><li><p>ä¾‹å¦‚ <code>cmake -GVisual Studio 15 2017 -Tv141_xp</code></p></li></ol><h3 id="GN-Ninja-å·¥ç¨‹"><a href="#GN-Ninja-å·¥ç¨‹" class="headerlink" title="GN (Ninja) å·¥ç¨‹"></a>GN (Ninja) å·¥ç¨‹</h3><blockquote><p>æ­¤æ–¹å¼ä¸ä»…é€‚ç”¨äº GN å·¥ç¨‹ï¼Œä¹Ÿé€‚ç”¨äºä»»ä½•ç›´æ¥è°ƒç”¨ MSBuild å‘½ä»¤è¡Œå·¥å…·çš„æ„å»ºç³»ç»Ÿã€‚</p></blockquote><ol><li><p>ä¸ºæ‰€æœ‰ <code>source_set</code> æ·»åŠ  <code>_USING_V110_SDK71_</code> è¿™ä¸ª <code>defines</code> ï¼ˆå®å®šä¹‰ï¼‰ï¼Œå³ä¸º <code>cl.exe</code> æ·»åŠ å‚æ•° <code>/D_USING_V110_SDK71_</code> ï¼ˆç”¨äºä¼ é€’ç»™æºç ä¸­å¯èƒ½å‡ºç°çš„ XP åˆ†æ”¯å®ï¼Œè¿™æ˜¯å®˜æ–¹æ¨èçš„ XP ä¸“ç”¨å®ï¼‰</p></li><li><p>ä¸ºä½ çš„ <code>shared_library</code> æˆ– <code>executable</code> Target æ·»åŠ  <code>/SUBSYSTEM:WINDOWS,&quot;5.02&quot;</code> è¿™ä¸ª <code>ldflags</code> ï¼ˆé“¾æ¥å™¨å‚æ•°ï¼‰ ï¼Œå³ä¸º <code>link.exe</code> æŒ‡å®šæ„å»ºç›®æ ‡ä¸º 5.02 (Windows XP SP2)ï¼Œå‚è€ƒ <a href="https://docs.microsoft.com/en-us/cpp/build/reference/subsystem-specify-subsystem?view=msvc-160" target="_blank" rel="noopener">é“¾æ¥å™¨é€‰é¡¹ /SUBSYSTEMï¼ˆæŒ‡å®šå­ç³»ç»Ÿï¼‰</a></p></li><li><p>å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ Google Chromium çš„ <a href="https://github.com/chromium/chromium/tree/master/build" target="_blank" rel="noopener"><code>build</code></a> ä½œä¸ºä½ çš„ GN å·¥ç¨‹çš„å·¥å…·é“¾ï¼Œä½ å¯ä»¥ç›´æ¥ä¸ºä½ çš„ <code>shared_library</code> æˆ– <code>executable</code> Target æ·»åŠ å¦‚ä¸‹ config:</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">configs += [ &quot;//build/config/win:windowed&quot; ]</span><br></pre></td></tr></table></figure><p> <img src="https://raw.githubusercontent.com/patrick-fu/personal_blog_image/master/image/chromium_build_win_config_windowed.png" alt="Chromium build win config windowed"></p><p> å‚è€ƒï¼š<a href="https://github.com/patrick-fu/gn_build/blob/48ac640820/config/win/BUILD.gn#L570" target="_blank" rel="noopener">GN build toolchain, //build/config/win:windowed</a></p></li></ol><h3 id="ä»£ç æ”¯æŒ"><a href="#ä»£ç æ”¯æŒ" class="headerlink" title="ä»£ç æ”¯æŒ"></a>ä»£ç æ”¯æŒ</h3><p>å¦‚æœä½ çš„é¡¹ç›®é‡Œä¾èµ–äº†å¾ˆå¤š Windows APIï¼Œå¯ä»¥é¢„è§çš„æ˜¯é“¾æ¥æ—¶æ‰¾ä¸åˆ°ç¬¦å·ï¼Œå› ä¸ºå¾ˆå¤š API éƒ½æ˜¯åœ¨ Windows 7 ä»¥åæ‰æä¾›çš„ã€‚</p><p>å½“ç„¶ä½ å¯ä»¥è€—è´¹ä¸€äº›æ—¶é—´ï¼ŒæŠŠé‚£äº›ç”¨åˆ°çš„æ–° API æ›¿æ¢æ‰ï¼Œä¸ç®¡æ˜¯æ‰¾æ›¿ä»£å“è¿˜æ˜¯å¹²è„†å°±ä¸æ”¯æŒï¼Œéƒ½å¯ä»¥ã€‚</p><p>ä¸ªäººæ¨èä¸€ä¸ªä¾¿äºä½ é€‚é… XP çš„ <a href="https://github.com/Chuyu-Team/YY-Thunks" target="_blank" rel="noopener">å¼€æºé¡¹ç›® YY-Thunks</a>ï¼Œé›†æˆåˆ°ä½ çš„å·¥ç¨‹ä¸­ï¼Œåº”è¯¥å°±èƒ½é“¾æ¥æˆåŠŸäº†ã€‚ :-)</p>]]></content>
      
      
      <categories>
          
          <category> Tech </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Windows </tag>
            
            <tag> GN </tag>
            
            <tag> Ninja </tag>
            
            <tag> CMake </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flutter ç§»åŠ¨ç«¯å±å¹•é‡‡é›†æ–¹æ¡ˆåˆ†äº«</title>
      <link href="/2020-11-20-flutter-screen-capture/"/>
      <url>/2020-11-20-flutter-screen-capture/</url>
      
        <content type="html"><![CDATA[<p>ç°å¦‚ä»Šéšç€ Flutter çš„åº”ç”¨è¶Šæ¥è¶Šå¹¿æ³›ï¼Œçº¯ Flutter é¡¹ç›®ä¹Ÿè¶Šæ¥è¶Šå¤šï¼Œæœ¬ç¯‡å†…å®¹ä¸»è¦åˆ†äº«çš„æ˜¯ Flutter ç§»åŠ¨ç«¯ï¼ˆiOS + Androidï¼‰çš„å±å¹•é‡‡é›†çš„å®ç°ã€‚</p><a id="more"></a><h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>åœ¨è§†é¢‘ä¼šè®®ã€çº¿ä¸Šè¯¾å ‚ã€æ¸¸æˆç›´æ’­ç­‰åœºæ™¯ï¼Œå±å¹•å…±äº«æ˜¯ä¸€ä¸ªæœ€å¸¸è§çš„åŠŸèƒ½ã€‚å±å¹•å…±äº«å°±æ˜¯å¯¹å±å¹•ç”»é¢çš„å®æ—¶å…±äº«ï¼Œç«¯åˆ°ç«¯ä¸»è¦æœ‰å‡ ä¸ªæ­¥éª¤ï¼šå½•å±é‡‡é›†ã€è§†é¢‘ç¼–ç åŠå°è£…ã€å®æ—¶ä¼ è¾“ã€è§†é¢‘è§£å°è£…åŠè§£ç ã€è§†é¢‘æ¸²æŸ“ã€‚</p><p>ä¸€èˆ¬æ¥è¯´ï¼Œå®æ—¶å±å¹•å…±äº«æ—¶ï¼Œå…±äº«å‘èµ·ç«¯ä»¥å›ºå®šé‡‡æ ·é¢‘ç‡ï¼ˆä¸€èˆ¬ 8 - 15å¸§è¶³å¤Ÿï¼‰æŠ“å–åˆ°å±å¹•ä¸­æŒ‡å®šæºçš„ç”»é¢ï¼ˆåŒ…æ‹¬æŒ‡å®šå±å¹•ã€æŒ‡å®šåŒºåŸŸã€æŒ‡å®šç¨‹åºç­‰ï¼‰ï¼Œç»è¿‡è§†é¢‘ç¼–ç å‹ç¼©ï¼ˆåº”é€‰æ‹©ä¿æŒæ–‡æœ¬/å›¾å½¢è¾¹ç¼˜ä¿¡æ¯ä¸å¤±çœŸçš„æ–¹æ¡ˆï¼‰åï¼Œåœ¨å®æ—¶ç½‘ç»œä¸Šä»¥ç›¸åº”çš„å¸§ç‡åˆ†å‘ã€‚</p><p>å› æ­¤ï¼Œå±å¹•é‡‡é›†æ˜¯å®ç°å®æ—¶å±å¹•å…±äº«çš„åŸºç¡€ï¼Œå®ƒçš„åº”ç”¨åœºæ™¯ä¹Ÿæ˜¯éå¸¸å¹¿æ³›çš„ã€‚</p><h2 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h2><h3 id="å‡†å¤‡"><a href="#å‡†å¤‡" class="headerlink" title="å‡†å¤‡"></a>å‡†å¤‡</h3><p>é¦–å…ˆæˆ‘ä»¬çœ‹çœ‹åŸç”Ÿç³»ç»Ÿæä¾›äº†å“ªäº›èƒ½åŠ›æ¥è¿›è¡Œå±å¹•å½•åˆ¶ã€‚</p><ol><li><p>iOS 11.0 æä¾›äº† <code>ReplayKit 2</code> ç”¨äºé‡‡é›†è·¨ App çš„å…¨å±€å±å¹•å†…å®¹ï¼Œä½†ä»…èƒ½é€šè¿‡æ§åˆ¶ä¸­å¿ƒå¯åŠ¨ï¼›iOS 12.0 åˆ™åœ¨æ­¤åŸºç¡€ä¸Šæä¾›äº†ä» App å†…å¯åŠ¨ ReplayKit çš„èƒ½åŠ›ã€‚</p></li><li><p>Android 5.0 ç³»ç»Ÿæä¾›äº† <code>MediaProjection</code> åŠŸèƒ½ï¼Œåªéœ€å¼¹çª—è·å–ç”¨æˆ·çš„åŒæ„å³å¯é‡‡é›†åˆ°å…¨å±€å±å¹•å†…å®¹ã€‚</p></li></ol><p>æˆ‘ä»¬å†çœ‹ä¸€ä¸‹ Android / iOS çš„å±å¹•é‡‡é›†èƒ½åŠ›æœ‰å“ªäº›åŒºåˆ«ã€‚</p><ol><li><p>iOS çš„ <code>ReplayKit</code> æ˜¯é€šè¿‡å¯åŠ¨ä¸€ä¸ª <code>Broadcast Upload Extension</code> å­è¿›ç¨‹æ¥é‡‡é›†å±å¹•æ•°æ®ï¼Œéœ€è¦è§£å†³ä¸» App è¿›ç¨‹ä¸å±å¹•é‡‡é›†å­è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡äº¤äº’é—®é¢˜ï¼ŒåŒæ—¶ï¼Œå­è¿›ç¨‹è¿˜æœ‰è¯¸å¦‚è¿è¡Œæ—¶å†…å­˜æœ€å¤§ä¸èƒ½è¶…è¿‡ 50M çš„é™åˆ¶ã€‚</p></li><li><p>Android çš„ <code>MediaProjection</code> æ˜¯ç›´æ¥åœ¨ App ä¸»è¿›ç¨‹å†…è¿è¡Œçš„ï¼Œå¯ä»¥å¾ˆå®¹æ˜“è·å–åˆ°å±å¹•æ•°æ®çš„ <code>Surface</code>ã€‚</p></li></ol><h3 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><p>è™½ç„¶æ— æ³•é¿å…åŸç”Ÿä»£ç ï¼Œä½†æˆ‘ä»¬å¯ä»¥å°½é‡ä»¥æœ€å°‘çš„åŸç”Ÿä»£ç æ¥å®ç° Flutter å±å¹•é‡‡é›†ã€‚å°†ä¸¤ç«¯çš„å±å¹•é‡‡é›†èƒ½åŠ›æŠ½è±¡å°è£…ä¸ºé€šç”¨çš„ Dart å±‚æ¥å£ï¼Œåªéœ€ä¸€æ¬¡éƒ¨ç½²å®Œæˆåï¼Œå°±èƒ½å¼€å¿ƒåœ°åœ¨ Dart å±‚å¯åŠ¨ã€åœæ­¢å±å¹•é‡‡é›†äº†ã€‚</p><h4 id="iOS"><a href="#iOS" class="headerlink" title="iOS"></a><strong>iOS</strong></h4><p>æ‰“å¼€ <code>Runner</code> Xcode Projectï¼Œæ–°å»ºä¸€ä¸ª <code>Broadcast Upload Extension</code> Targetï¼Œåœ¨æ­¤å¤„ç† ReplayKit å­è¿›ç¨‹çš„ä¸šåŠ¡é€»è¾‘ã€‚</p><p>é¦–å…ˆéœ€è¦å¤„ç†ä¸» App è¿›ç¨‹ä¸ ReplayKit å­è¿›ç¨‹çš„è·¨è¿›ç¨‹é€šä¿¡é—®é¢˜ï¼Œç”±äºå±å¹•é‡‡é›†çš„ audio/video buffer å›è°ƒéå¸¸é¢‘ç¹ï¼Œå‡ºäºæ€§èƒ½ä¸ Flutter æ’ä»¶ç”Ÿæ€è€ƒè™‘ï¼Œåœ¨åŸç”Ÿä¾§å¤„ç†éŸ³è§†é¢‘ buffer æ˜¾ç„¶æ˜¯ç›®å‰æœ€é è°±çš„æ–¹æ¡ˆï¼Œé‚£å‰©ä¸‹è¦è§£å†³çš„å°±æ˜¯å¯åŠ¨ã€åœæ­¢ä¿¡ä»¤ä»¥åŠå¿…è¦çš„é…ç½®ä¿¡æ¯çš„ä¼ è¾“äº†ã€‚</p><p>å¯¹äºå¯åŠ¨ <code>ReplayKit</code> çš„æ“ä½œï¼Œå¯ä»¥é€šè¿‡ Flutter çš„ MethodChannel åœ¨åŸç”Ÿä¾§ new ä¸€ä¸ª <code>RPSystemBroadcastPickerView</code>ï¼Œè¿™æ˜¯ä¸€ä¸ªç³»ç»Ÿæä¾›çš„ Viewï¼ŒåŒ…å«ä¸€ä¸ªç‚¹å‡»åç›´æ¥å¼¹å‡ºå¯åŠ¨å±å¹•é‡‡é›†çª—å£çš„ Buttonã€‚é€šè¿‡éå† Sub View çš„æ–¹å¼æ‰¾åˆ° Button å¹¶è§¦å‘ç‚¹å‡»æ“ä½œï¼Œä¾¿è§£å†³äº†å¯åŠ¨ <code>ReplayKit</code> çš„é—®é¢˜ã€‚</p><p>ç„¶åæ˜¯é…ç½®ä¿¡æ¯çš„åŒæ­¥é—®é¢˜ã€‚</p><ul><li><p>ä¸€æ˜¯ä½¿ç”¨ iOS çš„ <code>App Group</code> èƒ½åŠ›ï¼Œé€šè¿‡ NSUserDefaults æŒä¹…åŒ–é…ç½®åœ¨è¿›ç¨‹é—´å…±äº«é…ç½®ä¿¡æ¯ï¼Œåˆ†åˆ«åœ¨ <code>Runner</code> Target å’Œ <code>Broadcast Upload Extension</code> Target å†…å¼€å¯ App Group èƒ½åŠ›å¹¶è®¾ç½®åŒä¸€ä¸ª App Group IDï¼Œç„¶åå°±èƒ½é€šè¿‡ <code>-[NSUserDefaults initWithSuiteName]</code> è¯»å†™æ­¤ App Group å†…çš„é…ç½®äº†ã€‚</p></li><li><p>äºŒæ˜¯ä½¿ç”¨è·¨è¿›ç¨‹é€šçŸ¥ <code>CFNotificationCenterGetDarwinNotifyCenter</code> æºå¸¦é…ç½®ä¿¡æ¯æ¥å®ç°è¿›ç¨‹é—´é€šä¿¡ã€‚</p></li></ul><p>æ¥ä¸‹æ¥æ˜¯åœæ­¢ ReplayKit çš„æ“ä½œã€‚ä¹Ÿæ˜¯ä½¿ç”¨ä¸Šè¿°çš„ CFNotification è·¨è¿›ç¨‹é€šçŸ¥ï¼Œåœ¨ Flutter ä¸» App å‘èµ·ç»“æŸå±å¹•é‡‡é›†çš„é€šçŸ¥ï¼ŒReplayKit å­è¿›ç¨‹æ¥æ”¶åˆ°é€šçŸ¥åè°ƒç”¨ <code>-[RPBroadcastSampleHandler finishBroadcastWithError:]</code> æ¥ç»“æŸå±å¹•é‡‡é›†ã€‚</p><center><img src="https://raw.githubusercontent.com/patrick-fu/personal_blog_image/master/image/20201120152638.png" width="80%"></center><h4 id="Android"><a href="#Android" class="headerlink" title="Android"></a><strong>Android</strong></h4><p>å¯åŠ¨å±å¹•é‡‡é›†æ—¶ï¼Œç›´æ¥é€šè¿‡ Flutter çš„ MethodChannel åœ¨åŸç”Ÿä¾§é€šè¿‡ <code>MediaProjectionManager</code> å¼¹å‡ºä¸€ä¸ªå‘ç”¨æˆ·è¯·æ±‚å±å¹•é‡‡é›†æƒé™çš„å¼¹çª—ï¼Œæ”¶åˆ°ç¡®è®¤åå³å¯è°ƒç”¨ <code>MediaProjectionManager.getMediaProjection()</code> å‡½æ•°æ‹¿åˆ° <code>MediaProjection</code> å¯¹è±¡ã€‚</p><p>ç„¶åæ ¹æ®ä¸šåŠ¡åœºæ™¯éœ€æ±‚ä»å±å¹•é‡‡é›† buffer çš„æ¶ˆè´¹è€…æ‹¿åˆ° <code>Surface</code>ï¼Œä¾‹å¦‚ï¼Œè¦ä¿å­˜å±å¹•å½•åˆ¶çš„è¯ï¼Œä» <code>MediaRecoder</code> æ‹¿åˆ° Surfaceï¼Œè¦å½•å±ç›´æ’­çš„è¯ï¼Œå¯è°ƒç”¨éŸ³è§†é¢‘ç›´æ’­ SDK çš„æ¥å£è·å– Surfaceã€‚</p><p>æœ‰äº† <code>MediaProjection</code> å’Œæ¶ˆè´¹è€…çš„ <code>Surface</code>ï¼Œæ¥ä¸‹æ¥å°±æ˜¯è°ƒç”¨ <code>MediaProjection.createVirtualDisplay()</code> å‡½æ•°ä¼ å…¥ Surface æ¥åˆ›å»º <code>VirtualDisplay</code> å®ä¾‹ï¼Œä»è€Œè·å–åˆ°å±å¹•é‡‡é›† bufferã€‚</p><p>æœ€åæ˜¯ç»“æŸå±å¹•é‡‡é›†ï¼Œç›¸æ¯” iOS å¤æ‚çš„æ“ä½œï¼ŒAndroid ä»…éœ€è¦å°† <code>VirtualDisplay</code> å’Œ <code>MediaProjection</code> å®ä¾‹å¯¹è±¡é‡Šæ”¾å³å¯ã€‚</p><h2 id="å®æˆ˜ç¤ºä¾‹"><a href="#å®æˆ˜ç¤ºä¾‹" class="headerlink" title="å®æˆ˜ç¤ºä¾‹"></a>å®æˆ˜ç¤ºä¾‹</h2><p>ä¸€ä¸ªå®ç°äº† iOS/Android å±å¹•é‡‡é›†å¹¶ä½¿ç”¨ <strong><a href="https://pub.dev/packages/zego_express_engine" target="_blank" rel="noopener">ZEGO Express Audio and Video Flutter SDK</a></strong> è¿›è¡Œæ¨æµç›´æ’­çš„ç¤ºä¾‹ Demoã€‚</p><p><strong><a href="https://github.com/zegoim/zego-express-example-screen-capture-flutter" target="_blank" rel="noopener">https://github.com/zegoim/zego-express-example-screen-capture-flutter</a></strong></p>]]></content>
      
      
      <categories>
          
          <category> Tech </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
            <tag> Flutter </tag>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è§£å†³ CocoaPods trunk CDN è¿æ¥ä¸ä¸Šçš„é—®é¢˜</title>
      <link href="/2020-04-10-cocoapods-trunk-cdn-issue/"/>
      <url>/2020-04-10-cocoapods-trunk-cdn-issue/</url>
      
        <content type="html"><![CDATA[<p>CocoaPods è‡ª 1.8 ç‰ˆæœ¬å¼€å§‹é»˜è®¤ä½¿ç”¨ trunk CDN (<a href="https://cdn.cocoapods.org/" target="_blank" rel="noopener">https://cdn.cocoapods.org/</a>) ä½œä¸º spec çš„æºï¼Œæœ¬æ„æ˜¯éå¸¸å¥½çš„ï¼Œé¿å…äº†éœ€è¦æœ¬åœ° clone ä¸€ä»½åºå¤§çš„ <a href="https://github.com/CocoaPods/Specs.git" target="_blank" rel="noopener">Specs</a> ä»“åº“å¯¼è‡´æ¯æ¬¡ update éƒ½è¦å…¨é‡æ›´æ–°çš„é—®é¢˜ã€‚ç„¶è€Œä¸çŸ¥ä¸ºä½•å›½å†…è¿ trunk CDN éƒ½è¢«é™åˆ¶è®¿é—®äº†ã€‚</p><p>å¸¸è§çš„é—®é¢˜æ˜¯ <code>pod install</code> æ—¶æŠ¥é”™ <code>CDN: trunk URL couldn&#39;t be downloaded</code> ä»¥åŠ <code>pod repo update</code> æ—¶ <code>CDN: trunk Repo update failed</code></p><p>ä»¥ä¸‹æ˜¯å‡ ç§è§£å†³æ–¹æ¡ˆã€‚</p><a id="more"></a><h2 id="å®‰è£…-CocoaPods"><a href="#å®‰è£…-CocoaPods" class="headerlink" title="å®‰è£… CocoaPods"></a>å®‰è£… CocoaPods</h2><p>åœ¨æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ä¹‹å‰ï¼Œè¯·ç¡®ä¿å·²å®‰è£… CocoaPodsã€‚</p><blockquote><p>å¯æ‰§è¡Œ <code>pod --version</code> æ£€æŸ¥æ˜¯å¦æœ‰å®‰è£… CocoaPods å¹¶æŸ¥çœ‹ç‰ˆæœ¬å·ã€‚</p></blockquote><p>å®‰è£… CocoaPodsï¼šæ‰“å¼€ç»ˆç«¯ Terminalï¼Œæ‰§è¡Œï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gem install cocoapods</span><br></pre></td></tr></table></figure><p>è¯·å‚é˜… <a href="https://guides.cocoapods.org/using/getting-started.html#getting-started" target="_blank" rel="noopener">CocoaPodså…¥é—¨</a></p><blockquote><p>æ³¨ï¼šè‹¥æ ¹æ®ä»¥ä¸Šå…¥é—¨æŒ‡å¼•ï¼Œå› ç½‘ç»œé—®é¢˜æ— æ³•ä¸‹è½½å®‰è£… CocoaPodsï¼Œå¯è€ƒè™‘ä½¿ç”¨ Ruby Gems é•œåƒæºï¼š</p><ul><li><p>æ¸…å Gems é•œåƒç«™: <a href="https://mirror.tuna.tsinghua.edu.cn/help/rubygems/" target="_blank" rel="noopener">https://mirror.tuna.tsinghua.edu.cn/help/rubygems/</a></p></li><li><p>Ruby China é•œåƒç«™: <a href="https://gems.ruby-china.com" target="_blank" rel="noopener">https://gems.ruby-china.com</a></p></li></ul></blockquote><h2 id="è§£å†³è¿æ¥ä¸ä¸Š-trunk-CDN-çš„é—®é¢˜"><a href="#è§£å†³è¿æ¥ä¸ä¸Š-trunk-CDN-çš„é—®é¢˜" class="headerlink" title="è§£å†³è¿æ¥ä¸ä¸Š trunk CDN çš„é—®é¢˜"></a>è§£å†³è¿æ¥ä¸ä¸Š trunk CDN çš„é—®é¢˜</h2><h3 id="æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨ä»£ç†"><a href="#æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨ä»£ç†" class="headerlink" title="æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨ä»£ç†"></a>æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨ä»£ç†</h3><p>ä¸ç®¡æ˜¯ä½¿ç”¨æ—§ç‰ˆ CocoaPods è¿˜æ˜¯ä½¿ç”¨é•œåƒæºï¼Œéƒ½ä¸æ˜¯æœ€ä¼˜è§£ï¼Œä¸ºäº†å……åˆ†ä½¿ç”¨ CocoaPods çš„ç‰¹æ€§ï¼Œæœ€æ¨èçš„è¿˜æ˜¯ä½¿ç”¨ä»£ç†æ¥è§£å†³æ— æ³•è¿æ¥ trunk CDN çš„é—®é¢˜ã€‚</p><h3 id="æ–¹æ¡ˆäºŒï¼šä½¿ç”¨æ—§ç‰ˆ-CocoaPods"><a href="#æ–¹æ¡ˆäºŒï¼šä½¿ç”¨æ—§ç‰ˆ-CocoaPods" class="headerlink" title="æ–¹æ¡ˆäºŒï¼šä½¿ç”¨æ—§ç‰ˆ CocoaPods"></a>æ–¹æ¡ˆäºŒï¼šä½¿ç”¨æ—§ç‰ˆ CocoaPods</h3><p>1.7.5 ç‰ˆæœ¬çš„ CocoaPods é»˜è®¤ä½¿ç”¨ <a href="https://github.com/CocoaPods/Specs.git" target="_blank" rel="noopener">Specs</a> ä½œä¸º repo æºï¼Œå¯ä»¥å¸è½½åé‡æ–°å®‰è£…æ—§ç‰ˆ CocoaPodsã€‚</p><ul><li>å¸è½½ï¼š</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gem uninstall cocoapods</span><br></pre></td></tr></table></figure><ul><li>å®‰è£… CocoaPods 1.7.5ï¼š</li></ul><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gem install cocoapods -v 1.7.5</span><br></pre></td></tr></table></figure><h3 id="æ–¹æ¡ˆä¸‰ï¼šæ‰‹åŠ¨åˆ‡æ¢ä½¿ç”¨å®˜æ–¹-Git-æº-é•œåƒæº"><a href="#æ–¹æ¡ˆä¸‰ï¼šæ‰‹åŠ¨åˆ‡æ¢ä½¿ç”¨å®˜æ–¹-Git-æº-é•œåƒæº" class="headerlink" title="æ–¹æ¡ˆä¸‰ï¼šæ‰‹åŠ¨åˆ‡æ¢ä½¿ç”¨å®˜æ–¹ Git æº / é•œåƒæº"></a>æ–¹æ¡ˆä¸‰ï¼šæ‰‹åŠ¨åˆ‡æ¢ä½¿ç”¨å®˜æ–¹ Git æº / é•œåƒæº</h3><blockquote><p>ä¸æ¨èæ­¤æ–¹æ¡ˆï¼Œæ¯”è¾ƒç¹çã€‚</p></blockquote><ol><li><p>æ£€æŸ¥å½“å‰ä½¿ç”¨çš„æº</p><p> å…ˆæ‰§è¡Œ <code>pod repo list</code> æŸ¥çœ‹æœ¬æœºçš„æºæœ‰å“ªäº›ï¼Œå¦‚æœå­˜åœ¨ä¸€ä¸ª master æº (<code>URL: https://github.com/CocoaPods/Specs.git</code>) ä»¥åŠä¸€ä¸ª trunk æº (<code>URL: https://cdn.cocoapods.org/</code>)ï¼Œåˆ™æ— éœ€æ“ä½œä¸‹é¢çš„ç¬¬äºŒæ­¥ï¼Œå¯ç›´æ¥æ‰§è¡Œ <code>pod repo remove trunk</code> åˆ é™¤ trunk CDN æºã€‚</p><p> è‹¥ä½¿ç”¨ 1.9.1 æˆ–ä»¥ä¸Šç‰ˆæœ¬ï¼Œåº”è¯¥åªå­˜åœ¨ä¸€ä¸ª trunk CDN æºï¼Œæ­¤æ—¶éœ€è¦æ‰‹åŠ¨æ·»åŠ  Git æº</p></li><li><p>æ·»åŠ æº</p><ul><li><p>æ·»åŠ  <a href="https://github.com/CocoaPods/Specs.git" target="_blank" rel="noopener">å®˜æ–¹ CocoaPods Git æº</a></p><p>  æ‰§è¡Œ <code>pod repo add cocoapods https://github.com/CocoaPods/Specs.git</code></p></li><li><p>æ·»åŠ  <a href="https://mirror.tuna.tsinghua.edu.cn/help/CocoaPods/" target="_blank" rel="noopener">æ¸…å CocoaPods é•œåƒæº</a></p><p>  æ‰§è¡Œ <code>pod repo add tuna https://mirrors.tuna.tsinghua.edu.cn/git/CocoaPods/Specs.git</code></p></li></ul></li><li><p>æ‰§è¡Œ <code>pod repo update --verbose</code></p></li><li><p>åœ¨ iOS é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ <code>Podfile</code> æ–‡ä»¶é‡ŒæŒ‡å®šæº</p><blockquote><p>è‹¥æ‰¾ä¸åˆ° <code>Podfile</code>ï¼Œè¯·å…ˆ <code>cd</code> è¿› iOS é¡¹ç›®çš„æ ¹ç›®å½•ï¼Œæ‰§è¡Œ <code>pod init</code></p></blockquote><p> å¾€ <code>Podfile</code> çš„ç¬¬ä¸€è¡Œæ·»åŠ ä¸€å¥ <code>source https://xxxxx.git</code> ï¼ˆå…¶ä¸­çš„ URL ä¸ºä¸Šä¸€æ­¥æ·»åŠ çš„æºçš„ URLï¼‰</p><p> ä¾‹ï¼šä½¿ç”¨æ¸…åæº</p> <figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">source <span class="string">'https://mirrors.tuna.tsinghua.edu.cn/git/CocoaPods/Specs.git'</span></span><br><span class="line"></span><br><span class="line">target <span class="string">'MyProject'</span> <span class="keyword">do</span></span><br><span class="line">  use_frameworks!</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p> å¦‚æœæ²¡æœ‰åœ¨ Podfile é‡ŒæŒ‡å®š source çš„è¯ï¼Œ1.8 ç‰ˆæœ¬ä»¥ä¸Šçš„ CocoaPods ä¼šè‡ªåŠ¨é‡æ–°æ·»åŠ å¹¶ä½¿ç”¨ trunk CDN æºï¼Œå› æ­¤æ¯ä¸ªé¡¹ç›®çš„ Podfile éƒ½éœ€è¦æ˜¾å¼æŒ‡å®š sourceï¼Œéå¸¸éº»çƒ¦ã€‚</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> Note </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
            <tag> CocoaPods </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>macOS ä½¿ç”¨ QuickLook é¢„è§ˆé«˜äº®æŸ¥çœ‹ä»»æ„ä»£ç æºæ–‡ä»¶</title>
      <link href="/2020-04-05-make-mac-quicklook-any-code-source-file/"/>
      <url>/2020-04-05-make-mac-quicklook-any-code-source-file/</url>
      
        <content type="html"><![CDATA[<p>å¾ˆå¤šæºç æ–‡ä»¶ macOS é»˜è®¤ä¸æ”¯æŒé€šè¿‡ç©ºæ ¼å¿«é€ŸæŸ¥çœ‹ï¼Œæ¯”å¦‚ Flutter çš„ <code>.dart</code> æ–‡ä»¶ã€YAML çš„ <code>.yaml</code>ã€<code>.yml</code>ã€CocoaPods çš„ <code>Podfile</code>ã€<code>Podfile.lock</code> ç­‰ç­‰ã€‚</p><a id="more"></a><p><img src="https://raw.githubusercontent.com/patrick-fu/personal_blog_image/master/image/20200405170111.png" alt="dart"></p><p>å°±ç®—é€šè¿‡å³é”®æ–‡ä»¶ï¼Œ<code>æ˜¾ç¤ºç®€ä»‹</code> -&gt; <code>æ‰“å¼€æ–¹å¼</code> å°†å…¶è®¾ç½®ä¸ºå…¨éƒ¨é€šè¿‡ VSCodeã€Android Studio ç­‰åº”ç”¨æ‰“å¼€ï¼Œè§£å†³äº†èƒ½åŒå‡»æ–‡ä»¶æ‰“å¼€çš„é—®é¢˜ï¼Œä¹Ÿè¿˜æ˜¯ä¸èƒ½ QuickLook å¿«é€Ÿé¢„è§ˆã€‚</p><p><img src="https://raw.githubusercontent.com/patrick-fu/personal_blog_image/master/image/20200405170604.png" alt="vscode_dart"></p><p>æ™®é€šçš„ <code>.h</code>ã€<code>.cpp</code> ç­‰æºç æ–‡ä»¶è™½ç„¶ç³»ç»Ÿæ˜¯è®¤è¯†äº†ï¼Œä½†æ²¡æœ‰ä»£ç é«˜äº®ï¼Œçœ‹ççœ¼ã€‚</p><p><img src="https://raw.githubusercontent.com/patrick-fu/personal_blog_image/master/image/20200405170330.png" alt="h_file"></p><h2 id="å®‰è£…æ’ä»¶"><a href="#å®‰è£…æ’ä»¶" class="headerlink" title="å®‰è£…æ’ä»¶"></a>å®‰è£…æ’ä»¶</h2><p>å¹¸å¥½æœ‰æˆå¨çš„å¼€æºæ’ä»¶åšäº†è¿™äº›äº‹ï¼Œä¸ç”¨é‡å¤é€ è½®å­ã€‚</p><p>GitHub é¡¹ç›®é“¾æ¥ï¼š<a href="https://github.com/sindresorhus/quick-look-plugins" target="_blank" rel="noopener">https://github.com/sindresorhus/quick-look-plugins</a></p><p>å…¶ä»–å…³äº QuickLook Plugin çš„ä»‹ç»ï¼š</p><ul><li><p><a href="https://sspai.com/post/31927" target="_blank" rel="noopener">https://sspai.com/post/31927</a></p></li><li><p><a href="https://zhuanlan.zhihu.com/p/57203915" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/57203915</a></p></li></ul><p>å…³äº QuickLook çš„ä»‹ç»å‚è€ƒä»¥ä¸Šä¸¤ä¸ªé“¾æ¥ï¼Œå°±ä¸å†å•°å—¦äº†ã€‚</p><p>å¯¹äºæœ¬æ–‡è®¨è®ºçš„é«˜äº®é¢„è§ˆæºç æ–‡ä»¶çš„éœ€æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥å®‰è£… <a href="https://github.com/anthonygelibert/QLColorCode" target="_blank" rel="noopener">QLColorCode</a> ç”¨äºä»£ç é«˜äº®ã€<a href="https://github.com/whomwah/qlstephen" target="_blank" rel="noopener">QLStephen</a> ç”¨äºé¢„è§ˆæ— åç¼€åçš„æ–‡ä»¶ã€‚</p><p>æ¨èé€šè¿‡ Homebrew æ¥å®‰è£…ï¼Œä»¥ä¾¿é›†ä¸­ç®¡ç†ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">brew cask install qlcolorcode</span><br><span class="line"></span><br><span class="line">brew cask install qlstephen</span><br></pre></td></tr></table></figure><blockquote><p>éœ€è¦æ³¨æ„çš„æ˜¯å¦‚æœ macOS ç³»ç»Ÿç‰ˆæœ¬æ˜¯ 10.15 Catalina åŠä»¥ä¸Šï¼Œå®‰è£…å®Œæ’ä»¶åéœ€è¦é¢å¤–æ‰§è¡Œä¸€ä¸‹</p><p><code>xattr -r ~/Library/QuickLook</code></p><p><code>xattr -d -r com.apple.quarantine ~/Library/QuickLook</code></p><p>ä»¥è§£å†³è¿è¡Œä¸äº† QuickLook æ’ä»¶çš„é—®é¢˜</p></blockquote><h2 id="æ·»åŠ æ‰©å±•æ–‡ä»¶"><a href="#æ·»åŠ æ‰©å±•æ–‡ä»¶" class="headerlink" title="æ·»åŠ æ‰©å±•æ–‡ä»¶"></a>æ·»åŠ æ‰©å±•æ–‡ä»¶</h2><p>ç„¶è€Œå³ä¾¿å®‰è£…äº†é‡Œé¢çš„ <a href="https://github.com/anthonygelibert/QLColorCode" target="_blank" rel="noopener">QLColorCode</a> ä¹Ÿè¿˜æ˜¯æ²¡æ³•æŸ¥çœ‹è¿™äº›ç³»ç»Ÿä¸è®¤è¯†çš„æ–‡ä»¶æ¯”å¦‚ <code>.dart</code>ï¼Œæ­¤æ—¶å¯ä¿®æ”¹ä¸€ä¸‹è¿™ä¸ªæ’ä»¶çš„é…ç½®æ–‡ä»¶ä½¿å…¶æ”¯æŒ</p><p>æ‰“å¼€ <code>~/Library/QuickLook/QLColorCode.qlgenerator/Contents/Info.plist</code> æ–‡ä»¶</p><p>æ‰¾åˆ° <code>Document types &gt; Item 0 &gt; Document Content Type UTIs (CFBundleDocumentTypes &gt; Item 0 &gt; LSItemContentTypes</code></p><p><img src="https://raw.githubusercontent.com/patrick-fu/personal_blog_image/master/image/20200405172403.png" alt="plist"></p><p>ç‚¹å‡»â•æ·»åŠ ä¸€è¡Œ <code>.dart</code> æ–‡ä»¶æ ¼å¼ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤º</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">com.apple.disk-image-dart</span><br></pre></td></tr></table></figure><p>ä¿å­˜åå³ç”Ÿæ•ˆï¼Œå…¶ä»–ç±»å‹æ–‡ä»¶ä¹Ÿå¯é€šè¿‡è¿™ä¸ªæ–¹æ³•æ¥å¿«é€Ÿé¢„è§ˆã€‚</p><p>ç„¶è€Œå¦‚ä½•æŸ¥çœ‹å…·ä½“æŸç§æ–‡ä»¶æ ¼å¼çš„ç±»å‹å‘¢ï¼Ÿ</p><p>é€šè¿‡è¿™æ¡å‘½ä»¤</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mdls -name kMDItemContentType ./main.dart</span><br></pre></td></tr></table></figure><p>å°±èƒ½å¾—åˆ°ä¼ å…¥çš„æ–‡ä»¶ç±»å‹äº†</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kMDItemContentType = <span class="string">"com.apple.disk-image-dart"</span></span><br></pre></td></tr></table></figure><p>æŠŠå¸¸è§çš„æºç æ–‡ä»¶éƒ½æ·»åŠ è¿› <code>~/Library/QuickLook/QLColorCode.qlgenerator/Contents/Info.plist</code>ï¼Œç”Ÿäº§æ•ˆç‡å¤§å¤§æé«˜ğŸ’ª</p><p><img src="https://raw.githubusercontent.com/patrick-fu/personal_blog_image/master/image/20200405173836.png" alt="dart"></p><p><img src="https://raw.githubusercontent.com/patrick-fu/personal_blog_image/master/image/20200405173841.png" alt="h"></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ol><li><p><a href="https://medium.com/@claudmarotta/how-to-preview-dart-files-with-macos-quick-look-54779340811f" target="_blank" rel="noopener">https://medium.com/@claudmarotta/how-to-preview-dart-files-with-macos-quick-look-54779340811f</a></p></li><li><p><a href="https://github.com/anthonygelibert/QLColorCode" target="_blank" rel="noopener">https://github.com/anthonygelibert/QLColorCode</a></p></li><li><p><a href="https://github.com/whomwah/qlstephen/issues/81#issuecomment-582365549" target="_blank" rel="noopener">https://github.com/whomwah/qlstephen/issues/81#issuecomment-582365549</a></p></li></ol>]]></content>
      
      
      <categories>
          
          <category> Note </category>
          
      </categories>
      
      
        <tags>
            
            <tag> macOS </tag>
            
            <tag> QuickLook </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€SwiftUIã€‘è§£å†³ NavigationLink ç«‹å³åŠ è½½ destination View çš„é—®é¢˜ï¼ˆå®ç°æ‡’åŠ è½½ï¼‰</title>
      <link href="/2020-03-23-swiftui-navigationlink-destination-not-lazy/"/>
      <url>/2020-03-23-swiftui-navigationlink-destination-not-lazy/</url>
      
        <content type="html"><![CDATA[<p>åœ¨ SwiftUI ä¸­ï¼Œä¸€èˆ¬é€šè¿‡ <code>NavigationView</code> é…åˆ <code>NavigationLinks</code> æ¥å®ç°é¡µé¢é—´çš„è·³è½¬ï¼Œå¯ç±»æ¯”ä¸º UIKit ä¸­çš„ <code>UINavigationController</code> ä¸ <code>segue</code>ï¼ˆæˆ–è€… push/present è¯­å¥ï¼‰ã€‚ç†Ÿæ‚‰ UIKit çš„å¼€å‘è€…åˆšæ¥è§¦ SwiftUI æ—¶å¯èƒ½ä¼šé‡åˆ°ä¸€ä¸ªå°å‘ï¼š<code>NavigationLinks</code> çš„ <code>destination</code> å¹¶ä¸æ˜¯æ‡’åŠ è½½çš„ã€‚</p><a id="more"></a><h2 id="é‡åˆ°çš„é—®é¢˜"><a href="#é‡åˆ°çš„é—®é¢˜" class="headerlink" title="é‡åˆ°çš„é—®é¢˜"></a>é‡åˆ°çš„é—®é¢˜</h2><p><code>NavigationLinks</code> ä¸ UIKit ä¸­ push/present ä¹‹é—´çš„è¡Œä¸ºå·®å¼‚å¯¼è‡´åˆšä¸Šæ‰‹ SwiftUI æ—¶ï¼Œç”±äºä¸çŸ¥é“ç›®æ ‡ View ä¼šè¢«æå‰åŠ è½½ï¼Œä½¿å¾—ç›®æ ‡ View é‡Œçš„ä¸šåŠ¡é€»è¾‘æ—¶åºä¸Šå‡ºç°é—®é¢˜ã€‚</p><p>æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œ<code>UINavigationController</code> çš„ç›®æ ‡ ViewController åªåœ¨è°ƒç”¨äº† push/present åæ‰ä¼šè§¦å‘å¸¸ç”¨çš„åŠ è½½æ–¹æ³• <code>viewDidLoad()</code>ã€‚</p><p>ç„¶è€Œåœ¨ SwiftUI ä¸­ï¼Œ<code>NavigationLinks</code> çš„ç›®æ ‡ View ä¼šç«‹å³åŠ è½½ï¼Œè¿™æ„å‘³ç€å‡è®¾æœ‰ä¸€ä¸ªåŒ…å« 100 ä¸ª cell çš„ <code>List</code>/<code>ForEach</code>ï¼Œå…¶ä¸­æ¯ä¸ª cell éƒ½æ˜¯ç”¨ <code>NavigationLinks</code> æ¥è·³è½¬æ–°é¡µé¢çš„è¯ï¼Œé‚£å½“åŠ è½½æ˜¾ç¤ºè¿™ä¸ª <code>List</code> æ—¶ï¼Œå†…å­˜ä¸­ä¼šé©¬ä¸Šåˆ›å»º 100 ä¸ªå¯¹åº”çš„ View ç»“æ„ä½“ã€‚</p><p>å¦‚æœè¿™äº› View çš„æ„é€ å‡½æ•°ä¸­è¿˜åšäº†äº›å¼€é”€å¤§çš„æ“ä½œæ¯”å¦‚ç½‘ç»œè¯·æ±‚ã€åŠ è½½èµ„æºç­‰ã€‚ã€‚ã€‚å¯ä»¥æƒ³è±¡å°†å¯¼è‡´ä»€ä¹ˆåæœğŸ¤£</p><blockquote><p>ä¾‹ï¼š</p></blockquote><p>å¦‚ä¸‹æ‰€ç¤ºï¼Œ<code>MyRootView</code> æ˜¯é¦–é¡µ Viewï¼Œé€šè¿‡ <code>NavigationView</code> æ¥å®ç°è·¯ç”±å¯¼èˆªåŠŸèƒ½ï¼Œå…¶ä¸­æ˜¯ä¸€ä¸ªåŒ…å«äº†ä¸‰ä¸ª cell çš„ <code>List</code>ï¼Œæ¯ä¸ª cell æ˜¯ä¸€ä¸ª <code>NavigationLinks</code>ï¼Œåˆ†åˆ«å¯¼èˆªè‡³ <code>FirstView</code>ã€<code>SecondView</code>ã€<code>ThirdView</code>ã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">MyRootView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> myViews = [</span><br><span class="line">        <span class="string">"FirstView"</span>,</span><br><span class="line">        <span class="string">"SecondView"</span>,</span><br><span class="line">        <span class="string">"ThirdView"</span></span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">containedView</span><span class="params">(viewName: String)</span></span> -&gt; <span class="type">AnyView</span> &#123;</span><br><span class="line">        <span class="keyword">switch</span> viewName &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">"FirstView"</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="type">AnyView</span>(<span class="type">FirstView</span>())</span><br><span class="line">        <span class="keyword">case</span> <span class="string">"SecondView"</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="type">AnyView</span>(<span class="type">SecondView</span>())</span><br><span class="line">        <span class="keyword">case</span> <span class="string">"ThirdView"</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="type">AnyView</span>(<span class="type">ThirdView</span>())</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="type">AnyView</span>(<span class="type">Text</span>(<span class="string">"None"</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">NavigationView</span> &#123;</span><br><span class="line">            <span class="type">List</span>(myViews, id: \.<span class="keyword">self</span>) &#123; viewName <span class="keyword">in</span></span><br><span class="line">                <span class="type">NavigationLink</span>(destination: <span class="keyword">self</span>.containedView(viewName: viewName)) &#123;</span><br><span class="line">                    <span class="type">Text</span>(viewName)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .navigationBarTitle(<span class="type">Text</span>(<span class="string">"ZegoExpressExample"</span>), displayMode: .automatic)</span><br><span class="line">            .onAppear &#123;</span><br><span class="line">                <span class="type">NSLog</span>(<span class="string">"ğŸš© MyRootView appear"</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åï¼Œåœ¨ <code>FirstView</code>ã€<code>SecondView</code>ã€<code>ThirdView</code> çš„å®ç°ä¸­ï¼ŒView ç»“æ„ä½“é‡ŒåŒ…å«ä¸€ä¸ª class å®ä¾‹å±æ€§ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">FirstView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">let</span> firstCoordinator = <span class="type">FirstCoordinator</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>() &#123;</span><br><span class="line">        <span class="type">NSLog</span>(<span class="string">"1ï¸âƒ£ FirstView init ğŸŸ¢"</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">"I'm FirstView created by Patrick Fu"</span>)</span><br><span class="line">            .onAppear &#123;</span><br><span class="line">                <span class="type">NSLog</span>(<span class="string">"---------1ï¸âƒ£ FirstView appear-------"</span>)</span><br><span class="line">            &#125;.onDisappear &#123;</span><br><span class="line">                <span class="type">NSLog</span>(<span class="string">"---------1ï¸âƒ£ FirstView disappear-------"</span>)</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">FirstCoordinator</span>: <span class="title">NSObject</span> </span>&#123;</span><br><span class="line">        <span class="keyword">override</span> <span class="keyword">init</span>() &#123;</span><br><span class="line">            <span class="type">NSLog</span>(<span class="string">"1ï¸âƒ£ FirstCoordinator init ğŸŸ¢"</span>)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">deinit</span> &#123;</span><br><span class="line">            <span class="type">NSLog</span>(<span class="string">"1ï¸âƒ£ FirstCoordinator deinit ğŸ”´"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SecondView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">let</span> secondCoordinator = <span class="type">SecondCoordinator</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>() &#123;</span><br><span class="line">        <span class="type">NSLog</span>(<span class="string">"2ï¸âƒ£ SecondView init ğŸŸ¢"</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">"I'm SecondView created by Patrick Fu"</span>)</span><br><span class="line">            .onAppear &#123;</span><br><span class="line">                <span class="type">NSLog</span>(<span class="string">"---------2ï¸âƒ£ SecondView appear-------"</span>)</span><br><span class="line">            &#125;.onDisappear &#123;</span><br><span class="line">                <span class="type">NSLog</span>(<span class="string">"---------2ï¸âƒ£ SecondView disappear-------"</span>)</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">SecondCoordinator</span>: <span class="title">NSObject</span> </span>&#123;</span><br><span class="line">        <span class="keyword">override</span> <span class="keyword">init</span>() &#123;</span><br><span class="line">            <span class="type">NSLog</span>(<span class="string">"2ï¸âƒ£ SecondCoordinator init ğŸŸ¢"</span>)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">deinit</span> &#123;</span><br><span class="line">            <span class="type">NSLog</span>(<span class="string">"2ï¸âƒ£ SecondCoordinator deinit ğŸ”´"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ThirdView çš„å®ç°å®Œå…¨ä¸€è‡´ï¼Œå°±ä¸è´´å‡ºæ¥äº†</p></blockquote><p>æµ‹è¯•ä¸€ä¸‹ï¼Œé€šè¿‡æ—¥å¿—å¯ä»¥å‘ç°ï¼Œå½“åŠ è½½æ˜¾ç¤º <code>MyRootView</code> çš„æ—¶å€™ï¼Œé€šè¿‡ <code>NavigationLinks</code> å¯¼èˆªçš„ç›®æ ‡ View å…¨éƒ¨è¢«æå‰ç«‹å³åˆå§‹åŒ–äº†ï¼Œå¹¶ä¸”å…¶å±æ€§ Coordinator ç±»ä¹Ÿè¢«å®ä¾‹åŒ–äº†ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">2020-03-23 01:10:46.546218+0800 ZegoExpressExample-iOS-Swift[76375:18919854] ğŸš© MyRootView appear</span><br><span class="line">2020-03-23 01:10:46.553204+0800 ZegoExpressExample-iOS-Swift[76375:18919854] 1ï¸âƒ£ FirstCoordinator init ğŸŸ¢</span><br><span class="line">2020-03-23 01:10:46.553234+0800 ZegoExpressExample-iOS-Swift[76375:18919854] 1ï¸âƒ£ FirstView init ğŸŸ¢</span><br><span class="line">2020-03-23 01:10:46.558073+0800 ZegoExpressExample-iOS-Swift[76375:18919854] 2ï¸âƒ£ SecondCoordinator init ğŸŸ¢</span><br><span class="line">2020-03-23 01:10:46.558104+0800 ZegoExpressExample-iOS-Swift[76375:18919854] 2ï¸âƒ£ SecondView init ğŸŸ¢</span><br><span class="line">2020-03-23 01:10:46.559791+0800 ZegoExpressExample-iOS-Swift[76375:18919854] 3ï¸âƒ£ ThirdCoordinator init ğŸŸ¢</span><br><span class="line">2020-03-23 01:10:46.559808+0800 ZegoExpressExample-iOS-Swift[76375:18919854] 3ï¸âƒ£ ThirdView init ğŸŸ¢</span><br><span class="line">2020-03-23 01:11:03.746197+0800 ZegoExpressExample-iOS-Swift[76375:18919854] ---------1ï¸âƒ£ FirstView appear-------</span><br><span class="line">2020-03-23 01:11:06.641696+0800 ZegoExpressExample-iOS-Swift[76375:18919854] ğŸš© MyRootView appear</span><br><span class="line">2020-03-23 01:11:06.892756+0800 ZegoExpressExample-iOS-Swift[76375:18919854] ---------1ï¸âƒ£ FirstView disappear-------</span><br><span class="line">2020-03-23 01:11:08.618983+0800 ZegoExpressExample-iOS-Swift[76375:18919854] ---------2ï¸âƒ£ SecondView appear-------</span><br><span class="line">2020-03-23 01:11:11.507952+0800 ZegoExpressExample-iOS-Swift[76375:18919854] ğŸš© MyRootView appear</span><br><span class="line">2020-03-23 01:11:11.680365+0800 ZegoExpressExample-iOS-Swift[76375:18919854] ---------2ï¸âƒ£ SecondView disappear-------</span><br><span class="line">2020-03-23 01:11:13.138151+0800 ZegoExpressExample-iOS-Swift[76375:18919854] ---------3ï¸âƒ£ ThirdView appear-------</span><br><span class="line">2020-03-23 01:11:15.317203+0800 ZegoExpressExample-iOS-Swift[76375:18919854] ğŸš© MyRootView appear</span><br><span class="line">2020-03-23 01:11:15.488869+0800 ZegoExpressExample-iOS-Swift[76375:18919854] ---------3ï¸âƒ£ ThirdView disappear-------</span><br></pre></td></tr></table></figure><p>å¹¶ä¸”åœ¨å³æ»‘è¿”å›ä¸»é¡µé¢æ—¶ï¼ŒView å’Œå…¶ Coordinator ç±»å®ä¾‹ä¹Ÿå¹¶æ²¡æœ‰è¢«é‡Šæ”¾ï¼ŒGG~</p><h2 id="è§£å†³æ–¹æ³•"><a href="#è§£å†³æ–¹æ³•" class="headerlink" title="è§£å†³æ–¹æ³•"></a>è§£å†³æ–¹æ³•</h2><p>é¦–å…ˆï¼Œ<code>NavigationLinks</code> ç«‹å³åŠ è½½ <code>destination</code> çš„ç°è±¡åº”è¯¥æ˜¯ SwiftUI çš„ Featureã€‚å› ä¸ºåœ¨ SwiftUI ä¸­ï¼ŒView æ˜¯éå¸¸è½»é‡åŒ–çš„ç»“æ„ä½“ï¼Œç±»ä¼¼äº Flutter ä¸­çš„ <code>Widget</code>ï¼Œåˆ›å»ºã€é”€æ¯çš„å¼€é”€éå¸¸ä½ã€‚</p><h3 id="æ–¹æ¡ˆä¸€"><a href="#æ–¹æ¡ˆä¸€" class="headerlink" title="æ–¹æ¡ˆä¸€"></a>æ–¹æ¡ˆä¸€</h3><p>å› æ­¤ï¼Œå…¶ä¸­ä¸€ç§è§£å†³æ–¹æ¡ˆå°±æ˜¯å……åˆ†åˆ©ç”¨ View çš„ <code>onAppear()</code> å’Œ <code>onDisappear()</code> ä½œä¸ºä¾èµ–æ³¨å…¥æ¥å®ç°è‡ªå·±çš„ä¸šåŠ¡é€»è¾‘å’Œä¸€äº›å¼€é”€å¤§çš„æ“ä½œï¼Œé¿å…åœ¨ View åˆå§‹åŒ–çš„æ—¶æœºåšä¸šåŠ¡é€»è¾‘ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒæŠŠ View çš„ <code>onAppear()</code> å½“åš UIKit ä¸­çš„ <code>viewDidLoad()</code> æ¥ä½¿ç”¨ï¼Œå¹¶ä¸”é¿å…åœ¨ View çš„å±æ€§ä¸­ç›´æ¥åˆå§‹åŒ–å¼€é”€å¤§çš„å¯¹è±¡ã€‚</p><h3 id="æ–¹æ¡ˆäºŒ"><a href="#æ–¹æ¡ˆäºŒ" class="headerlink" title="æ–¹æ¡ˆäºŒ"></a>æ–¹æ¡ˆäºŒ</h3><p>å½“ç„¶äº†ï¼Œä½œä¸ºè€ UIKit/AppKit å¼€å‘è€…ï¼Œå¤§é‡çš„å¯¹è±¡ç¬é—´å…¨éƒ¨åŠ è½½å®åœ¨éš¾é¡¶ï¼Œè¿˜æ˜¯å¾—æ‡’åŠ è½½æ‰è¡Œã€‚</p><p>é‚£å¦ä¸€ç§è§£å†³æ–¹æ¡ˆå°±æ˜¯é€šè¿‡ç»™ <code>destination</code> çš„ View åŒ…è£¹ä¸€å±‚è‡ªå®šä¹‰çš„ View æ¥å®ç°æ‡’åŠ è½½åŠŸèƒ½ã€‚</p><ul><li>LazyView.swift</li></ul><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">struct</span> <span class="title">LazyView</span>&lt;<span class="title">Content</span>: <span class="title">View</span>&gt;: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">let</span> build: () -&gt; <span class="type">Content</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">init</span>(<span class="number">_</span> build: <span class="meta">@autoclosure</span> @escaping () -&gt; <span class="type">Content</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.build = build</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">var</span> body: <span class="type">Content</span> &#123;</span><br><span class="line">        build()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸€ä¸ª View çš„ body å±æ€§åªåœ¨è¿™ä¸ª View è¢«æ˜¾ç¤ºå‡ºæ¥çš„æ—¶å€™æ‰ä¼šè¢«æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ body ä¸­çš„ <code>NavigationLinks</code> çš„ <code>destination</code> æ˜¯å¦ä¸€ä¸ª ViewB æ—¶ï¼Œè¿™ä¸ª <code>destination</code> çš„ ViewB ä¼šè¢«é©¬ä¸Šåˆå§‹åŒ–ï¼Œä½†æ˜¯ ViewB çš„ body å±æ€§ä¸ä¼šè¢«æ‰§è¡Œã€‚</p><p>æ¢å¥è¯è¯´ï¼ŒSwiftUI ä¼šç«‹åˆ»åŠ è½½<strong>å½“å‰å±‚çº§</strong>ä»¥åŠ<strong>ä¸‹ä¸€å±‚çº§</strong>çš„ Viewï¼Œä½†<strong>ä¸ä¼š</strong>åŠ è½½ç¬¬ä¸‰å±‚çº§çš„ Viewã€‚</p><p>å› æ­¤ï¼Œç”¨ä¸€ä¸ªè‡ªå®šä¹‰ View æ¥åŒ…è£¹ä½çœŸæ­£æƒ³è¦è·³è½¬çš„ç›®æ ‡ Viewï¼Œå°±å¯ä»¥å˜ç›¸çš„å®ç°æ‡’åŠ è½½ã€‚</p><p>å®é™…ä¸Šï¼Œæ­¤æ–¹æ¡ˆåªæ˜¯â€œæ‡’åŠ è½½â€äº†ç›®æ ‡ Viewï¼Œåœ¨ä¸€ä¸ªæ‹¥æœ‰å¤§é‡ cell çš„ <code>List</code>/<code>ForEach</code> ä¸­ï¼Œè¿˜æ˜¯ä¼šæœ‰ç­‰åŒæ•°é‡çš„ <code>LazyView</code> è¢«åˆ›å»ºã€‚</p><p>è¿™ç§æ–¹å¼å¹¶ä¸ Swiftyï¼Œç›®å‰çœ‹æ¥ï¼Œæœ€å¥½è¿˜æ˜¯æŒ‰ç…§ SwiftUI çš„è®¾è®¡ç†å¿µæ¥åšä¸šåŠ¡é€»è¾‘ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢çš„æ–¹æ¡ˆä¸€ã€‚</p><ul><li>ç”¨æ³•ç¤ºä¾‹</li></ul><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ContentView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">NavigationView</span> &#123;</span><br><span class="line">            <span class="type">NavigationLink</span>(destination: <span class="type">LazyView</span>(<span class="type">Text</span>(<span class="string">"My details page"</span>))) &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">"Go to details"</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹åçš„ <code>MyRootView</code> çš„ body å¦‚ä¸‹æ‰€ç¤º</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">    <span class="type">NavigationView</span> &#123;</span><br><span class="line">        <span class="type">List</span>(myViews, id: \.<span class="keyword">self</span>) &#123; viewName <span class="keyword">in</span></span><br><span class="line">            <span class="type">NavigationLink</span>(destination: <span class="type">LazyView</span>(<span class="keyword">self</span>.containedView(viewName: viewName))) &#123;</span><br><span class="line">                <span class="type">Text</span>(viewName)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        .navigationBarTitle(<span class="type">Text</span>(<span class="string">"ZegoExpressExample"</span>), displayMode: .automatic)</span><br><span class="line">        .onAppear &#123;</span><br><span class="line">            <span class="type">NSLog</span>(<span class="string">"ğŸš© MyRootView appear"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•ä¸€ä¸‹ï¼Œå½“åŠ è½½æ˜¾ç¤º <code>MyRootView</code> æ—¶ï¼Œé€šè¿‡ <code>NavigationLinks</code> å¯¼èˆªçš„ç›®æ ‡ View éƒ½å®ç°äº†æ‡’åŠ è½½ï¼Œå¹¶ä¸”åœ¨è¿”å› <code>MyRootView</code> å¹¶è¿›å…¥å…¶ä»–æ–°çš„ View æ—¶ï¼Œä¸Šä¸€ä¸ªè€ View ä¹Ÿèƒ½è¢«é‡Šæ”¾ï¼Œè¿™å°±éå¸¸èˆ’æœäº†ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">2020-03-23 01:32:12.577138+0800 ZegoExpressExample-iOS-Swift[76407:18927258] ğŸš© MyRootView appear</span><br><span class="line">2020-03-23 01:32:26.788288+0800 ZegoExpressExample-iOS-Swift[76407:18927258] 1ï¸âƒ£ FirstCoordinator init ğŸŸ¢</span><br><span class="line">2020-03-23 01:32:26.788380+0800 ZegoExpressExample-iOS-Swift[76407:18927258] 1ï¸âƒ£ FirstView init ğŸŸ¢</span><br><span class="line">2020-03-23 01:32:26.811396+0800 ZegoExpressExample-iOS-Swift[76407:18927258] ---------1ï¸âƒ£ FirstView appear-------</span><br><span class="line">2020-03-23 01:32:57.753106+0800 ZegoExpressExample-iOS-Swift[76407:18927258] ğŸš© MyRootView appear</span><br><span class="line">2020-03-23 01:32:57.969867+0800 ZegoExpressExample-iOS-Swift[76407:18927258] ---------1ï¸âƒ£ FirstView disappear-------</span><br><span class="line">2020-03-23 01:33:00.826847+0800 ZegoExpressExample-iOS-Swift[76407:18927258] 2ï¸âƒ£ SecondCoordinator init ğŸŸ¢</span><br><span class="line">2020-03-23 01:33:00.826983+0800 ZegoExpressExample-iOS-Swift[76407:18927258] 2ï¸âƒ£ SecondView init ğŸŸ¢</span><br><span class="line">2020-03-23 01:33:00.831038+0800 ZegoExpressExample-iOS-Swift[76407:18927258] 1ï¸âƒ£ FirstCoordinator deinit ğŸ”´</span><br><span class="line">2020-03-23 01:33:00.850590+0800 ZegoExpressExample-iOS-Swift[76407:18927258] ---------2ï¸âƒ£ SecondView appear-------</span><br><span class="line">2020-03-23 01:33:04.745348+0800 ZegoExpressExample-iOS-Swift[76407:18927258] ğŸš© MyRootView appear</span><br><span class="line">2020-03-23 01:33:05.011015+0800 ZegoExpressExample-iOS-Swift[76407:18927258] ---------2ï¸âƒ£ SecondView disappear-------</span><br><span class="line">2020-03-23 01:33:06.126583+0800 ZegoExpressExample-iOS-Swift[76407:18927258] 3ï¸âƒ£ ThirdCoordinator init ğŸŸ¢</span><br><span class="line">2020-03-23 01:33:06.126716+0800 ZegoExpressExample-iOS-Swift[76407:18927258] 3ï¸âƒ£ ThirdView init ğŸŸ¢</span><br><span class="line">2020-03-23 01:33:06.130353+0800 ZegoExpressExample-iOS-Swift[76407:18927258] 2ï¸âƒ£ SecondCoordinator deinit ğŸ”´</span><br><span class="line">2020-03-23 01:33:06.149465+0800 ZegoExpressExample-iOS-Swift[76407:18927258] ---------3ï¸âƒ£ ThirdView appear-------</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul><li><p><a href="https://twitter.com/chriseidhof/status/1144242544680849410" target="_blank" rel="noopener">https://twitter.com/chriseidhof/status/1144242544680849410</a></p></li><li><p><a href="https://stackoverflow.com/questions/57594159/swiftui-navigationlink-loads-destination-view-immediately-without-clicking" target="_blank" rel="noopener">https://stackoverflow.com/questions/57594159/swiftui-navigationlink-loads-destination-view-immediately-without-clicking</a></p></li></ul>]]></content>
      
      
      <categories>
          
          <category> Tech </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
            <tag> Swift </tag>
            
            <tag> SwiftUI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è¯¦è§£ YUV æ ¼å¼ï¼ˆI420/YUV420/NV12/NV12/YUV422ï¼‰</title>
      <link href="/2020-01-26-yuv-pixel-formats/"/>
      <url>/2020-01-26-yuv-pixel-formats/</url>
      
        <content type="html"><![CDATA[<p><code>YUV</code> ï¼ˆ<code>Y&#39;CbCr</code>ï¼‰æ˜¯ä¸€ç§åƒç´ æ ¼å¼ï¼Œå¸¸è§äºè§†é¢‘ç¼–ç ä¸é™æ€å›¾åƒã€‚ä¸ <code>RGB</code> æ ¼å¼ï¼ˆçº¢-ç»¿-è“ï¼‰ç›¸åï¼ŒYUV åˆ†åˆ«ç”±ä¸€ä¸ªç§°ä¸º <code>Y</code>ï¼ˆç›¸å½“äºç°åº¦ï¼‰çš„â€œäº®åº¦â€åˆ†é‡ï¼ˆLuminance or Lumaï¼‰å’Œä¸¤ä¸ªç§°ä¸º <code>U</code>ï¼ˆè“è‰²æŠ•å½± <code>Cb</code>ï¼‰å’Œ <code>V</code>ï¼ˆçº¢è‰²æŠ•å½± <code>Cr</code>ï¼‰çš„â€œè‰²åº¦â€åˆ†é‡ï¼ˆChrominance or Chromaï¼‰è¡¨ç¤ºï¼Œç”±æ­¤å¾—åã€‚</p><p>ä»…æœ‰ Y åˆ†é‡è€Œæ²¡æœ‰ UV åˆ†é‡ä¿¡æ¯ï¼Œä¸€æ ·å¯ä»¥æ˜¾ç¤ºå®Œæ•´çš„é»‘ç™½ï¼ˆç°åº¦ï¼‰å›¾åƒï¼Œè§£å†³äº†æ¨¡æ‹Ÿä¿¡å·ç”µè§†é»‘ç™½ä¸å½©è‰²çš„å…¼å®¹é—®é¢˜ã€‚</p><a id="more"></a><h2 id="é‡‡æ ·"><a href="#é‡‡æ ·" class="headerlink" title="é‡‡æ ·"></a>é‡‡æ ·</h2><p>è‰²åº¦é€šé“ï¼ˆUVï¼‰çš„é‡‡æ ·ç‡å¯ä»¥ä½äºäº®åº¦é€šé“ï¼ˆYï¼‰ï¼Œè€Œä¸ä¼šæ˜¾ç€é™ä½æ„ŸçŸ¥è´¨é‡ã€‚ä¸€ç§ç§°ä¸º â€œA:B:Câ€ çš„è¡¨ç¤ºæ³•ç”¨äºæè¿°ç›¸å¯¹äº Y é‡‡æ ·ï¼Œ U å’Œ V çš„é¢‘ç‡ï¼š</p><ul><li>4:4:4 è¡¨ç¤ºä¸é™ä½è‰²åº¦ï¼ˆUVï¼‰é€šé“çš„é‡‡æ ·ç‡ã€‚æ¯ä¸ª Y åˆ†é‡å¯¹åº”ä¸€ç»„ UV åˆ†é‡ã€‚</li><li>4:2:2 è¡¨ç¤º 2:1 æ°´å¹³ä¸‹é‡‡æ ·ï¼Œæ²¡æœ‰å‚ç›´ä¸‹é‡‡æ ·ã€‚æ¯ä¸¤ä¸ª Y åˆ†é‡å…±äº«ä¸€ç»„ UV åˆ†é‡ã€‚</li><li>4:2:0 è¡¨ç¤º 2:1 æ°´å¹³ä¸‹é‡‡æ ·ï¼ŒåŒæ—¶ 2:1 å‚ç›´ä¸‹é‡‡æ ·ã€‚æ¯å››ä¸ª Y åˆ†é‡å…±äº«ä¸€ç»„ UV åˆ†é‡ã€‚</li><li>4:1:1 è¡¨ç¤º 4:1 æ°´å¹³ä¸‹é‡‡æ ·ï¼Œæ²¡æœ‰å‚ç›´ä¸‹é‡‡æ ·ã€‚æ¯å››ä¸ª Y åˆ†é‡å…±äº«ä¸€ç»„ UV åˆ†é‡ã€‚4:1:1 é‡‡æ ·æ¯”å…¶ä»–æ ¼å¼å°‘è§ï¼Œæœ¬æ–‡ä¸å†è¯¦ç»†è®¨è®ºã€‚</li></ul><p>ä¸‹å›¾æ˜¾ç¤ºäº†å¦‚ä½•é’ˆå¯¹æ¯ä¸ªä¸‹é‡‡æ ·ç‡é‡‡æ ·è‰²åº¦ã€‚äº®åº¦æ ·æœ¬ç”¨åå­—è¡¨ç¤ºï¼Œè‰²åº¦æ ·æœ¬ç”¨åœ†åœˆè¡¨ç¤ºã€‚</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20200212164150.png" alt="YUV Sampling"></p><h2 id="å­˜å‚¨æ ¼å¼"><a href="#å­˜å‚¨æ ¼å¼" class="headerlink" title="å­˜å‚¨æ ¼å¼"></a>å­˜å‚¨æ ¼å¼</h2><p>YUV åœ¨å­˜å‚¨ä¸Šé€šå¸¸åˆ†ä¸ºå¹³é¢æ ¼å¼ï¼ˆ<code>Planar</code>ï¼‰ï¼ŒåŠå¹³é¢æ ¼å¼ï¼ˆ<code>Semi-Planar</code>ï¼‰ä»¥åŠæ‰“åŒ…æ ¼å¼ï¼ˆ<code>Packed</code>ï¼‰ã€‚</p><h3 id="Planar-å¹³é¢æ ¼å¼"><a href="#Planar-å¹³é¢æ ¼å¼" class="headerlink" title="Planar å¹³é¢æ ¼å¼"></a>Planar å¹³é¢æ ¼å¼</h3><p>å¹³é¢æ ¼å¼æœ‰æ—¶ä¹Ÿç§°ä¸ºä¸‰é¢æ ¼å¼ï¼ˆ<code>Triplanar</code>ï¼‰ï¼Œå³ Y, U, V ä¸‰ä¸ªåˆ†é‡å„è‡ªä½¿ç”¨å•ç‹¬çš„æ•°ç»„ä¿å­˜ï¼Œè¿™ç§ä¸‰å¹³é¢åˆ†ç¦»çš„æ ¼å¼æ¯”è¾ƒæ–¹ä¾¿è§†é¢‘ç¼–ç ã€‚</p><h4 id="YU12-I420"><a href="#YU12-I420" class="headerlink" title="YU12 (I420)"></a>YU12 (I420)</h4><ul><li>4:2:0 Formats, 12 Bits per Pixel, 3 Planars</li></ul><blockquote><p><a href="http://www.fourcc.org/pixel-format/yuv-i420/" target="_blank" rel="noopener">FOURCC I420</a></p></blockquote><p><code>YU12</code> å³ <code>I420</code>ï¼Œä¹Ÿå« <code>IYUV</code>ï¼Œå±äº <code>YUV420P</code> æ ¼å¼ã€‚ä¸‰ä¸ªå¹³é¢ï¼Œåˆ†åˆ«å­˜å‚¨ Y U V åˆ†é‡ã€‚æ¯å››ä¸ª Y åˆ†é‡å…±äº«ä¸€ç»„ UV åˆ†é‡ã€‚Uã€V å¹³é¢çš„ strides, width å’Œ height éƒ½æ˜¯ Y å¹³é¢çš„ä¸€åŠï¼Œå› æ­¤ä¸€ä¸ªåƒç´  12 bitsï¼Œå†…å­˜æ’åˆ—å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20200212182646.png" alt="YU12 Format"></p><p>ä»å›¾ä¸­å¯çœ‹å‡ºï¼ŒUã€V å¹³é¢çš„æ¯è¡Œå­—èŠ‚æ•°ï¼ˆstridesï¼‰ã€é«˜ï¼ˆheightï¼‰éƒ½æ˜¯ Y å¹³é¢çš„ä¸€åŠã€‚</p><p><code>I420</code> æ˜¯éŸ³è§†é¢‘å¼€å‘ä¸­å¸¸ç”¨çš„ä¸€ç§æ ¼å¼ã€‚</p><h4 id="YV12"><a href="#YV12" class="headerlink" title="YV12"></a>YV12</h4><ul><li>4:2:0 Formats, 12 Bits per Pixel, 3 Planars</li></ul><blockquote><p><a href="http://www.fourcc.org/pixel-format/yuv-yv12/" target="_blank" rel="noopener">FOURCC YV12</a></p></blockquote><p><code>YV12</code> ä¸ <code>I420</code> å‡ ä¹ä¸€æ ·ï¼Œä»…æ”¹å˜äº† U, V å¹³é¢çš„é¡ºåºã€‚å†…å­˜æ’åˆ—å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20200212181507.png" alt="YU12 Format"></p><h4 id="J420"><a href="#J420" class="headerlink" title="J420"></a>J420</h4><ul><li>4:2:0 Formats, 12 Bits per Pixel, 3 Planars</li></ul><p><code>J420</code> ä¸ <code>I420</code> å®Œå…¨ç›¸åŒï¼Œä½†å…·æœ‰å®Œæ•´èŒƒå›´ï¼ˆ0-255ï¼Œfull rangeï¼‰çš„äº®åº¦ï¼ˆYï¼‰åˆ†é‡ï¼Œè€Œä¸æ˜¯æœ‰é™èŒƒå›´ï¼ˆ16-240ï¼Œlimited rangeï¼Œåœ¨ iOS ä¸Šä¹Ÿå«åš video rangeï¼‰ã€‚è‰²åº¦ï¼ˆUVï¼‰åˆ†é‡ä¸ I420 ä¸­çš„å®Œå…¨ç›¸åŒã€‚</p><h4 id="IMC1"><a href="#IMC1" class="headerlink" title="IMC1"></a>IMC1</h4><ul><li>4:2:0 Formats, 16 Bits per Pixel, 3 Planars</li></ul><blockquote><p><a href="http://www.fourcc.org/pixel-format/yuv-imc1/" target="_blank" rel="noopener">FOURCC IMC1</a></p></blockquote><p><code>IMC1</code> ä¸ <code>I420</code> ç±»ä¼¼ï¼ŒU, V å¹³é¢çš„å®½ï¼ˆwidthï¼‰ã€é«˜ï¼ˆheightï¼‰æ˜¯ Y å¹³é¢çš„ä¸€åŠï¼Œä½†æ˜¯æ¯è¡Œå­—èŠ‚æ•°ï¼ˆstridesï¼‰ä¸ Y å¹³é¢ä¸€è‡´ï¼Œå› æ­¤ U, V å¹³é¢åœ¨å†…å­˜ä¸Šä¼šæœ‰ç•™ç©ºï¼ˆpaddingï¼‰ï¼Œå› æ­¤ä¸€ä¸ªåƒç´  16 bitsï¼Œå¦‚å›¾æ‰€ç¤ºï¼š</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20200212193133.png" alt="IMC1 Format"></p><h4 id="IMC3"><a href="#IMC3" class="headerlink" title="IMC3"></a>IMC3</h4><ul><li>4:2:0 Formats, 16 Bits per Pixel, 3 Planars</li></ul><p><code>IMC3</code> ä¸ <code>IMC1</code> å‡ ä¹ä¸€æ ·ï¼Œä»…æ”¹å˜äº† U, V å¹³é¢çš„é¡ºåºã€‚å†…å­˜æ’åˆ—å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20200212202002.png" alt="IMC3 Format"></p><h4 id="I422"><a href="#I422" class="headerlink" title="I422"></a>I422</h4><ul><li>4:2:2 Formats, 16 Bits per Pixel, 3 Planars</li></ul><p><code>I422</code> å±äº <code>YUV422P</code> æ ¼å¼ã€‚ä¸‰ä¸ªå¹³é¢ï¼Œåˆ†åˆ«å­˜å‚¨ Y U V åˆ†é‡ã€‚æ¯ä¸¤ä¸ª Y åˆ†é‡å…±äº«ä¸€ç»„ UV åˆ†é‡ã€‚Uã€V å¹³é¢çš„ strides, width æ˜¯ Y å¹³é¢çš„ä¸€åŠï¼Œä½† height ä¸ Y å¹³é¢ä¸€è‡´ï¼Œå› æ­¤ä¸€ä¸ªåƒç´  16 bitsï¼Œå†…å­˜æ’åˆ—å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20200212232724.png" alt="YUV422P"></p><p>ä»å›¾ä¸­å¯çœ‹å‡ºï¼ŒUã€V å¹³é¢çš„æ¯è¡Œå­—èŠ‚æ•°ï¼ˆstridesï¼‰æ˜¯ Y å¹³é¢çš„ä¸€åŠï¼Œé«˜ï¼ˆheightï¼‰ä¸ Y å¹³é¢ä¸€è‡´ã€‚</p><h4 id="J422"><a href="#J422" class="headerlink" title="J422"></a>J422</h4><ul><li>4:2:2 Formats, 16 Bits per Pixel, 3 Planars</li></ul><p><code>J422</code> ä¸ <code>I422</code> å®Œå…¨ç›¸åŒï¼Œä½†å…·æœ‰å®Œæ•´èŒƒå›´ï¼ˆ0-255ï¼Œfull rangeï¼‰çš„äº®åº¦ï¼ˆYï¼‰åˆ†é‡ï¼Œè€Œä¸æ˜¯æœ‰é™èŒƒå›´ï¼ˆ16-240ï¼Œlimited rangeï¼Œåœ¨ iOS ä¸Šä¹Ÿå«åš video rangeï¼‰ã€‚è‰²åº¦ï¼ˆUVï¼‰åˆ†é‡ä¸ I420 ä¸­çš„å®Œå…¨ç›¸åŒã€‚</p><h3 id="Semi-Planar-åŠå¹³é¢æ ¼å¼"><a href="#Semi-Planar-åŠå¹³é¢æ ¼å¼" class="headerlink" title="Semi-Planar åŠå¹³é¢æ ¼å¼"></a>Semi-Planar åŠå¹³é¢æ ¼å¼</h3><p>åŠå¹³é¢æ ¼å¼å…·æœ‰ä¸¤ä¸ªå¹³é¢è€Œä¸æ˜¯ä¸‰ä¸ªå¹³é¢ï¼Œä¸€ä¸ªå¹³é¢å­˜å‚¨äº®åº¦ï¼ˆYï¼‰åˆ†é‡ï¼Œå¦ä¸€ä¸ªå¹³é¢å­˜å‚¨ä¸¤ä¸ªè‰²åº¦ï¼ˆUVï¼‰åˆ†é‡ã€‚æœ‰æ—¶ä¹Ÿå°†å®ƒä»¬ç§°ä¸ºåŒå¹³é¢æ ¼å¼ï¼ˆ<code>BiPlanar</code>ï¼‰ã€‚</p><h4 id="NV12"><a href="#NV12" class="headerlink" title="NV12"></a>NV12</h4><ul><li>4:2:0 Formats, 12 Bits per Pixel, 2 Planars</li></ul><blockquote><p><a href="http://www.fourcc.org/pixel-format/yuv-nv12/" target="_blank" rel="noopener">FOURCC NV12</a></p></blockquote><p><code>NV12</code> å±äº <code>YUV420SP</code> æ ¼å¼ã€‚ä¸¤ä¸ªå¹³é¢ï¼Œåˆ†åˆ«å­˜å‚¨ Y åˆ†é‡ å’Œ UV åˆ†é‡ã€‚å…¶ä¸­ UV åˆ†é‡å…±ç”¨ä¸€ä¸ªå¹³é¢å¹¶ä¸”ä»¥ U, V, U, V çš„é¡ºåºäº¤é”™æ’åˆ—ã€‚æ¯å››ä¸ª Y åˆ†é‡å…±äº«ä¸€ç»„ UV åˆ†é‡ã€‚</p><p>UV å¹³é¢çš„ strides, width ä¸ Y å¹³é¢ä¸€æ ·é•¿ï¼Œä½† height ä»…ä¸º Y å¹³é¢çš„ä¸€åŠã€‚å› æ­¤ä¸€ä¸ªåƒç´  12 bitsï¼Œå†…å­˜æ’åˆ—å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20200212234845.png" alt="NV12 Format"></p><p>ä»å›¾ä¸­å¯çœ‹å‡ºï¼ŒUV å¹³é¢çš„æ¯è¡Œå­—èŠ‚æ•°ï¼ˆstridesï¼‰ä¸ Y å¹³é¢ä¸€è‡´ï¼Œé«˜ï¼ˆheightï¼‰æ˜¯ Y å¹³é¢çš„ä¸€åŠã€‚</p><p><code>NV12</code> æ˜¯ iOS ç›¸æœºï¼ˆ<code>AVCaptureOutput</code>ï¼‰å¯ç›´æ¥è¾“å‡ºçš„ä¸¤ç§è§†é¢‘å¸§æ ¼å¼ä¹‹ä¸€ï¼Œå¦å¤–ä¸€ç§æ˜¯ <code>BGRA32</code>(<code>kCVPixelFormatType_32BGRA</code>)ã€‚</p><p>åœ¨ iOS ä¸Šï¼Œ<code>NV12</code> è¿˜åˆ†ä¸º Full Range (0-255, <code>kCVPixelFormatType_420YpCbCr8BiPlanarFullRange</code>) å’Œ Video Range (16-240, <code>kCVPixelFormatType_420YpCbCr8BiPlanarVideoRange</code>)ï¼ŒåŒºåˆ«ä»…ä¸ºäº®åº¦ï¼ˆYï¼‰åˆ†é‡çš„å–å€¼èŒƒå›´ï¼Œä¸€èˆ¬è€Œè¨€ï¼ŒFull Range é€‚ç”¨äºé™æ€å›¾åƒï¼ˆæ‹ç…§ï¼‰ï¼ŒVideo Range é€‚ç”¨äºè§†é¢‘é‡‡é›†ï¼ˆæ‘„åƒï¼‰ã€‚</p><h4 id="NV21"><a href="#NV21" class="headerlink" title="NV21"></a>NV21</h4><ul><li>4:2:0 Formats, 12 Bits per Pixel, 2 Planars</li></ul><blockquote><p><a href="http://www.fourcc.org/pixel-format/yuv-nv21/" target="_blank" rel="noopener">FOURCC NV21</a></p></blockquote><p><code>NV21</code> å±äº <code>YUV420SP</code>ï¼Œä¸ <code>NV12</code> å‡ ä¹ä¸€è‡´ï¼ŒåŒºåˆ«æ˜¯ UV å¹³é¢ä¸­ U ä¸ V çš„æ’åˆ—é¡ºåºé¢ å€’ï¼Œä»¥ V, U, V, U çš„é¡ºåºäº¤é”™æ’åˆ—ï¼Œå†…å­˜æ’åˆ—å¦‚å›¾æ‰€ç¤ºï¼š</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20200212235436.png" alt="NV21 Format"></p><p><code>NV21</code> æ˜¯ Android ç›¸æœºï¼ˆ<code>Camera</code>ï¼‰é»˜è®¤çš„è¾“å‡ºæ ¼å¼ã€‚</p><h3 id="Packed-æ‰“åŒ…æ ¼å¼"><a href="#Packed-æ‰“åŒ…æ ¼å¼" class="headerlink" title="Packed æ‰“åŒ…æ ¼å¼"></a>Packed æ‰“åŒ…æ ¼å¼</h3><p>æ‰“åŒ…æ ¼å¼é€šå¸¸åªæœ‰ä¸€ä¸ªå¹³é¢ï¼Œæ‰€æœ‰äº®åº¦ï¼ˆYï¼‰å’Œè‰²åº¦ï¼ˆUVï¼‰æ•°æ®éƒ½äº¤ç»‡åœ¨ä¸€èµ·ã€‚æœ‰ç‚¹ç±»ä¼¼äº RGB æ ¼å¼ï¼Œåªæ˜¯ä½¿ç”¨äº†ä¸åŒçš„è‰²å½©ç©ºé—´ã€‚</p><p>æ‰“åŒ…æ ¼å¼åœ¨ç½‘ç»œæ‘„åƒå¤´ä¸­è¾ƒä¸ºå¸¸è§ã€‚ç¡¬ä»¶è®¾å¤‡ä½¿ç”¨å¤šå¹³é¢æ ¼å¼æ•ˆç‡è¾ƒä½ï¼Œå› ä¸ºæ¯ä¸ªåƒç´ éœ€è¦å¤šæ¬¡å†…å­˜è®¿é—®ã€‚è€Œæ‰“åŒ…æ ¼å¼ç”±äºä»…ä¸€ä¸ªå¹³é¢ï¼Œè®¿é—®å†…å­˜çš„å¼€é”€è¾ƒå°ã€‚</p><h4 id="AYUV"><a href="#AYUV" class="headerlink" title="AYUV"></a>AYUV</h4><ul><li>4:4:4 Formats, 32 Bits per Pixel</li></ul><blockquote><p><a href="http://www.fourcc.org/pixel-format/yuv-ayuv/" target="_blank" rel="noopener">FOURCC AYUV</a></p></blockquote><p>AYUV æ˜¯ Packed æ‰“åŒ…æ ¼å¼ï¼Œå…¶ä¸­æ¯ä¸ªåƒç´ ç¼–ç ä¸ºå››ä¸ªè¿ç»­å­—èŠ‚ï¼Œæ¯ä¸ªåƒç´ åœ¨å†…å­˜ä¸­æŒ‰ç…§ V, U, Y, A çš„é¡ºåºæ’åˆ—ï¼ˆA æŒ‡ alpha é€šé“ï¼‰ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20200212165800.png" alt="AYUV Format"></p><h4 id="YUYV-V422-YUY2-YUNV"><a href="#YUYV-V422-YUY2-YUNV" class="headerlink" title="YUYV (V422 / YUY2 / YUNV)"></a>YUYV (V422 / YUY2 / YUNV)</h4><ul><li>4:2:2 Formats, 16 Bits per Pixel</li></ul><blockquote><p><a href="http://www.fourcc.org/pixel-format/yuv-yuy2/" target="_blank" rel="noopener">FOURCC YUY2</a></p></blockquote><p><code>YUYV</code> é€šå¸¸ä¹Ÿç§°ä½œ <code>V422</code>ã€<code>YUY2</code>ã€<code>YUNV</code></p><p>YUY2 æ˜¯ Packed æ‰“åŒ…æ ¼å¼ï¼Œå…¶ä¸­ä¸¤ä¸ªåƒç´ å…±ç”¨ä¸€ç»„ UV åˆ†é‡ï¼Œå†…å­˜ä¸­æŒ‰ç…§ Y U Y V çš„é¡ºåºæ’åˆ—ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20200212171116.png" alt="YUYV Format"></p><h4 id="UYVY-Y422-UYNV"><a href="#UYVY-Y422-UYNV" class="headerlink" title="UYVY (Y422 / UYNV)"></a>UYVY (Y422 / UYNV)</h4><ul><li>4:2:2 Formats, 16 Bits per Pixel</li></ul><blockquote><p><a href="https://www.fourcc.org/pixel-format/yuv-uyvy/" target="_blank" rel="noopener">FOURCC UYVY</a></p></blockquote><p><code>UYVY</code> é€šå¸¸ä¹Ÿç§°ä½œ <code>Y422</code>ã€<code>UYNV</code></p><p><code>UYVY</code> ä¸ <code>YUYV</code> ç±»ä¼¼ï¼Œåªæ˜¯äº®åº¦ï¼ˆYï¼‰åˆ†é‡ä¸è‰²åº¦ï¼ˆUVï¼‰åˆ†é‡æ’åˆ—é¡ºåºé¢ å€’ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20200212172050.png" alt="UYVY Format"></p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ol><li><p><a href="https://docs.microsoft.com/en-us/windows/win32/medfound/recommended-8-bit-yuv-formats-for-video-rendering" target="_blank" rel="noopener">Microsoft: Recommended 8-Bit YUV Formats for Video Rendering</a></p></li><li><p><a href="https://wiki.videolan.org/YUV#Semi-planar" target="_blank" rel="noopener">VideoLANâ€™s Wiki: YUV</a></p></li><li><p><a href="https://www.fourcc.org/yuv.php" target="_blank" rel="noopener">FOURCC: YUV pixel formats</a></p></li><li><p><a href="https://developer.apple.com/videos/play/wwdc2011/419/?time=1527" target="_blank" rel="noopener">WWDC2011: Capturing from the Camera using AV Foundation on iOS 5</a></p></li></ol>]]></content>
      
      
      <categories>
          
          <category> Tech </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Audio/Video </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ‚è°ˆç½‘ç»œåè®®ä¹‹ç§å­ä¸P2P</title>
      <link href="/2019-07-07-network-protocol-p2p/"/>
      <url>/2019-07-07-network-protocol-p2p/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘å­¦äº†äº›P2Påè®®ç›¸å…³çš„å†…å®¹ï¼Œåšäº†äº›ç¬”è®°ã€‚</p><a id="more"></a><h2 id="P2P"><a href="#P2P" class="headerlink" title="P2P"></a>P2P</h2><p>P2P å³ peer-to-peerï¼Œä¸ºäº†è§£å†³ HTTP æˆ– FTP ä¸‹è½½æ–‡ä»¶æ—¶éš¾ä»¥è§£å†³å•ä¸€æœåŠ¡å™¨å¸¦å®½å‹åŠ›çš„ç¼ºç‚¹ã€‚P2P çš„ç‰¹ç‚¹æ˜¯èµ„æºå¼€å§‹å¹¶ä¸é›†ä¸­åœ°å­˜å‚¨åœ¨æŸäº›è®¾å¤‡ä¸Šï¼Œè€Œæ˜¯åˆ†æ•£åœ°å­˜å‚¨åœ¨å¤šå°è®¾å¤‡ä¸Šï¼Œè€Œæ˜¯åˆ†æ•£åœ°å­˜å‚¨åœ¨å¤šå°è®¾å¤‡ä¸Šã€‚è¿™äº›è®¾å¤‡æˆ‘ä»¬å§‘ä¸”ç§°ä¸º peerã€‚</p><p>æƒ³è¦ä¸‹è½½ä¸€ä¸ªæ–‡ä»¶çš„æ—¶å€™ï¼Œåªéœ€å¾—åˆ°é‚£äº›å·²ç»å­˜åœ¨äº†æ–‡ä»¶çš„ peerï¼Œå¹¶å’Œè¿™äº› peer ä¹‹é—´ï¼Œå»ºç«‹ç‚¹å¯¹ç‚¹çš„è¿æ¥ï¼Œè€Œä¸éœ€è¦åˆ°ä¸­å¿ƒæœåŠ¡å™¨ä¸Šï¼Œå°±å¯ä»¥å°±è¿‘ä¸‹è½½æ–‡ä»¶ã€‚ä¸€æ—¦ä¸‹è½½äº†æ–‡ä»¶ï¼Œä½ ä¹Ÿå°±æˆä¸º peer ä¸­çš„ä¸€å‘˜ï¼Œä½ æ—è¾¹çš„é‚£äº›æœºå™¨ï¼Œä¹Ÿå¯èƒ½ä¼šé€‰æ‹©ä»ä½ è¿™é‡Œä¸‹è½½æ–‡ä»¶ï¼Œæ‰€ä»¥å½“ä½ ä½¿ç”¨ P2P è½¯ä»¶çš„æ—¶å€™ï¼Œä¾‹å¦‚ BitTorrentï¼Œå¾€å¾€èƒ½å¤Ÿçœ‹åˆ°ï¼Œæ—¢æœ‰ä¸‹è½½æµé‡ï¼Œä¹Ÿæœ‰ä¸Šä¼ çš„æµé‡ï¼Œä¹Ÿå³ä½ è‡ªå·±ä¹ŸåŠ å…¥äº†è¿™ä¸ª P2P çš„ç½‘ç»œï¼Œè‡ªå·±ä»åˆ«äººé‚£é‡Œä¸‹è½½ï¼ŒåŒæ—¶ä¹Ÿæä¾›ç»™å…¶ä»–äººä¸‹è½½ã€‚</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190708180237.png" alt></p><p>ç¾å›½å·¥ç¨‹å¸ˆ Bram Cohen åœ¨ 2001 å¹´å‘å¸ƒäº† BitTorrent åè®®ï¼Œèµ„æºä¸å†ç”±ä¸€ä¸ªäººæˆ–ä¸€ä¸ªä¸­å¿ƒæœåŠ¡å™¨æä¾›ï¼Œè€Œæ˜¯æ‰€æœ‰äººæä¾›ç»™æ‰€æœ‰äººï¼Œä¸‹è½½çš„äººè¶Šå¤šï¼Œé€Ÿåº¦è¶Šå¿«ã€‚</p><p>BitTorrent çš„æ ¸å¿ƒæ€æƒ³æ˜¯æŠŠæ–‡ä»¶åˆ†æˆå¾ˆå¤šä¸ªå°å—ï¼Œè®©ä¸‹è½½è€…äº’ç›¸è¿æ¥ã€‚åè®®éœ€è¦èµ„æºå…±äº«è€…ç”Ÿæˆä¸€ä¸ªåŒ…å«ä¸‹è½½ä¿¡æ¯çš„ç§å­æ–‡ä»¶ï¼Œåç¼€æ˜¯ .torrentï¼Œå³ BT ç§å­ã€‚</p><h2 id="torrent"><a href="#torrent" class="headerlink" title="torrent"></a>torrent</h2><p>.torrent ç§å­æ–‡ä»¶ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œåˆ†åˆ«æ˜¯ï¼šannounceï¼ˆtracker URLï¼‰å’Œæ–‡ä»¶ä¿¡æ¯</p><p>æ–‡ä»¶ä¿¡æ¯åŒ…å«æ–‡ä»¶çš„åå­—ã€å¤§å°ï¼Œåˆ†å—åæ¯å—æ–‡ä»¶çš„å¤§å°ã€å“ˆå¸Œå€¼ç­‰ï¼Œå…·ä½“å¦‚ä¸‹ï¼š</p><ul><li>info åŒºï¼šæŒ‡å®šçš„æ˜¯ç§å­æ–‡ä»¶æ•°é‡ã€æ–‡ä»¶å¤§å°ã€ç›®å½•ç»“æ„ã€ç›®å½•å’Œæ–‡ä»¶çš„åå­—</li><li>Name å­—æ®µï¼šæŒ‡å®šé¡¶å±‚ç›®å½•åå­—ã€‚</li><li>æ¯ä¸ªæ®µçš„å¤§å°ï¼šBitTorrent åè®®æŠŠæ–‡ä»¶åˆ†æˆå¾ˆå¤šä¸ªå°æ®µ</li><li>æ®µå“ˆå¸Œå€¼ï¼šæ•´ä¸ªç§å­ä¸­ï¼Œæ¯ä¸ªæ®µçš„ SHA-1 å“ˆå¸Œå€¼æ‹¼åœ¨ä¸€èµ·</li></ul><p>ä¸‹è½½æ—¶ï¼ŒBT å®¢æˆ·ç«¯é¦–å…ˆè§£æ.torrent æ–‡ä»¶ï¼Œå¾—åˆ° Tracker åœ°å€ï¼Œç„¶åè¿æ¥ Tracker æœåŠ¡å™¨ã€‚</p><p>Tracker å¾ˆé‡è¦ï¼Œé€šè¿‡ Tracker æˆ‘ä»¬æ‰èƒ½æ‰¾åˆ°å…¶ä»–ä¸‹è½½è€…çš„è”ç³»æ–¹å¼ã€‚å½“ä½ ç”¨ä¸‹è½½è½¯ä»¶æ‰“å¼€ç§å­ï¼Œå°±ä¼šå¼€å§‹è”ç³»ç§å­æ–‡ä»¶é‡Œå†…ç½®çš„ Tracker æœåŠ¡å™¨ï¼Œå‘Šè¯‰ Tracker æˆ‘è¦ä¸‹è½½è¿™ä¸ªæ–‡ä»¶ï¼ŒæœåŠ¡å™¨ä¼šè®°å½•ä¸‹ä½ çš„ IPï¼Œå¹¶æŠŠå…¶ä»–æ­£åœ¨ä¸‹è½½æˆ–ä¸‹è½½å®Œæˆçš„äººçš„ IP è¿”å›ç»™ä½ ï¼Œè¿™æ ·ä½ ä»¬å°±å¯ä»¥æ„‰å¿«çš„ç»„é˜Ÿä¸‹è½½äº†ã€‚</p><p>Tracker æœåŠ¡å™¨å›åº”ä¸‹è½½è€…è¯·æ±‚ï¼Œå°†å…¶ä»–ä¸‹è½½è€…åŒ…æ‹¬å‘å¸ƒè€…çš„ IP æä¾›ç»™ä¸‹è½½è€…ã€‚ä¸‹è½½è€…å†è¿æ¥å…¶ä»–ä¸‹è½½è€…ï¼Œæ ¹æ®ç§å­æ–‡ä»¶ï¼ŒåŒæ–¹äº’ç›¸å‘ŠçŸ¥è‡ªå·±å·²ç»æœ‰çš„å—ï¼Œç„¶åäº¤æ¢å¯¹æ–¹æ²¡æœ‰çš„æ•°æ®ã€‚æ­¤æ—¶ä¸éœ€è¦å…¶ä»–æœåŠ¡å™¨å‚ä¸ï¼Œå¹¶åˆ†æ•£äº†å•ä¸ªçº¿è·¯ä¸Šçš„æ•°æ®æµé‡ï¼Œå‡è½»æœåŠ¡å™¨è´Ÿæ‹…ã€‚</p><p>ä¸‹è½½è€…æ¯å¾—åˆ°ä¸€ä¸ªå—ï¼Œéœ€è¦ç®—å‡ºä¸‹è½½å—çš„ Hash éªŒè¯ç ï¼Œå¹¶ä¸.torrent æ–‡ä»¶ä¸­çš„å¯¹æ¯”ã€‚å¦‚æœä¸€æ ·ï¼Œåˆ™è¯´æ˜å—æ­£ç¡®ï¼Œä¸ä¸€æ ·åˆ™éœ€è¦é‡æ–°ä¸‹è½½è¿™ä¸ªå—ã€‚è¿™ç§è§„å®šæ˜¯ä¸ºäº†è§£å†³ä¸‹è½½å†…å®¹çš„å‡†ç¡®æ€§é—®é¢˜ã€‚</p><p>å½“ç„¶ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°æ­£åœ¨ä¸‹è½½çš„äººï¼Œèµ„æºå‘å¸ƒè€…ä¹Ÿä¸åœ¨çº¿ï¼Œä½ å°±åªèƒ½ä»¥ 0kb/s çš„é€Ÿåº¦ç­‰ç€äº†ã€‚</p><p>ä¸éš¾å‘ç°ï¼ŒTracker æœåŠ¡å™¨æ˜¯ P2P ç½‘ç»œçš„å¼±ç‚¹ï¼Œå¦‚æœ Tracker è¢«å…³é—­æˆ–å°ç¦ï¼Œä½ å°±æ— æ³•æ‰¾åˆ°åŒä¼´ï¼Œä¹Ÿéš¾ä»¥å®Œæˆä¸‹è½½ï¼ŒBT ä¾ç„¶æ˜¯ä¸­å¿ƒåŒ–çš„åè®®ã€‚</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190708180236.png" alt></p><h2 id="DHT-å»ä¸­å¿ƒåŒ–ç½‘ç»œ"><a href="#DHT-å»ä¸­å¿ƒåŒ–ç½‘ç»œ" class="headerlink" title="DHT å»ä¸­å¿ƒåŒ–ç½‘ç»œ"></a>DHT å»ä¸­å¿ƒåŒ–ç½‘ç»œ</h2><p>ä¸ºäº†æ‘†è„±å¯¹ Tracker æœåŠ¡å™¨çš„ä¾èµ–ï¼Œå½»åº•å»ä¸­å¿ƒåŒ–ï¼Œäºæ˜¯äº§ç”Ÿäº†ä¸€ç§å«åš DHTï¼ˆDistributed Hash Tableï¼‰çš„å»ä¸­å¿ƒåŒ–ç½‘ç»œï¼Œæ¯ä¸ªåŠ å…¥ DHT ç½‘ç»œçš„äººï¼Œéƒ½è¦è´Ÿè´£å­˜å‚¨è¿™ä¸ªç½‘ç»œé‡Œçš„èµ„æºä¿¡æ¯å’Œå…¶ä»–æˆå‘˜çš„è”ç³»ä¿¡æ¯ï¼Œç›¸å½“äºæ‰€æœ‰äººä¸€èµ·æ„æˆäº†ä¸€ä¸ªåºå¤§çš„åˆ†å¸ƒå¼å­˜å‚¨æ•°æ®åº“ã€‚</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190708180234.png" alt></p><p>DHT çš„æœ¬è´¨æ˜¯æŠŠæ‰€æœ‰äººéƒ½å˜æˆä¸€ä¸ªå°å‹ Trackerï¼Œæ¯ä¸ªäººéƒ½æ‹¿ç€ä¸€ä»½åŠ¨æ€æ›´æ–°çš„åœ°å€å’Œæ–‡ä»¶ä¿¡æ¯ã€‚æˆ‘æ‰¾ä¸æˆ‘è¿æ¥çš„ 10 ä¸ªäººï¼Œä»–ä»¬å†å„è‡ªæ‰¾ 10 ä¸ªäººï¼Œä¸€ä¼ ååä¼ ç™¾ã€åƒã€ä¸‡ï¼Œæœ€åæˆ‘é€šè¿‡Nä¸ªäººçš„ä¸­è½¬ï¼Œæ‰¾åˆ°åº”è¯¥è¿ä¸Šçš„äººã€‚</p><p>æœ‰ä¸€ç§è‘—åçš„ DHT åè®®ï¼šKademliaã€‚ä»»ä½•ä¸€ä¸ª BitTorrent å¯åŠ¨ä¹‹åï¼Œå®ƒéƒ½æœ‰ä¸¤ä¸ªè§’è‰²ã€‚ä¸€ä¸ªæ˜¯ peerï¼Œç›‘å¬ä¸€ä¸ª TCP ç«¯å£ï¼Œç”¨æ¥ä¸Šä¼ å’Œä¸‹è½½æ–‡ä»¶ï¼Œè¿™ä¸ªè§’è‰²è¡¨æ˜ï¼Œæˆ‘è¿™é‡Œæœ‰æŸä¸ªæ–‡ä»¶ã€‚å¦ä¸€ä¸ªè§’è‰² DHT nodeï¼Œç›‘å¬ä¸€ä¸ª UDP çš„ç«¯å£ï¼Œé€šè¿‡è¿™ä¸ªè§’è‰²ï¼Œè¿™ä¸ªèŠ‚ç‚¹åŠ å…¥äº†ä¸€ä¸ª DHT çš„ç½‘ç»œã€‚</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190708181046.jpg" alt></p><p>åœ¨ DHT ç½‘ç»œä¸­ï¼Œæ¯ä¸ª DHT node éƒ½æœ‰ä¸€ä¸ªå¾ˆé•¿çš„ ID å­—ç¬¦ä¸²ã€‚æ¯ä¸ª DHT node éƒ½æœ‰è´£ä»»æŒæ¡ä¸€äº›çŸ¥è¯†ï¼Œå³æ–‡ä»¶ç´¢å¼•ï¼Œå³å®ƒåº”è¯¥çŸ¥é“æŸäº›æ–‡ä»¶æ˜¯ä¿å­˜åœ¨å“ªäº›èŠ‚ç‚¹ä¸Šã€‚å®ƒåªéœ€è¦æœ‰è¿™äº›çŸ¥è¯†å°±è¡Œï¼Œè‡ªå·±æœ¬èº«ä¸ä¸€å®šå°±æ˜¯ä¿å­˜è¿™ä¸ªæ–‡ä»¶çš„èŠ‚ç‚¹ã€‚node åº”è¯¥çŸ¥é“å“ªäº›çŸ¥è¯†æ˜¯é€šè¿‡å“ˆå¸Œç®—æ³•è®¡ç®—å‡ºæ¥ã€‚</p><p>æ¯ä¸ªæ–‡ä»¶éƒ½æœ‰ä¸€ä¸²é€šè¿‡ SHA1 å“ˆå¸Œç®—æ³•è®¡ç®—å‡ºå”¯ä¸€çš„æ–‡ä»¶ IDï¼Œå¯ä»¥äº§ç”Ÿ 2 çš„ (4*40) å³ 2 çš„ 160 æ¬¡æ–¹ç§ç»„åˆï¼Œç”¨åªæœ‰ 0 å’Œ 1 çš„äºŒè¿›åˆ¶è¡¨ç¤ºå°±æ˜¯ 160 ä¸ª 0 å’Œ 1ã€‚</p><p>è€Œæ¯ä¸ªèŠ‚ç‚¹ä¹Ÿæœ‰ä¸€ä¸² 160 ä½çš„ 0 å’Œ 1ï¼Œä½œä¸ºèŠ‚ç‚¹ IDã€‚æ ¹æ®è¿™ 160 ä½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—èŠ‚ç‚¹å’ŒèŠ‚ç‚¹ä¹‹é—´ï¼ŒèŠ‚ç‚¹å’Œèµ„æºä¹‹é—´çš„è·ç¦»ã€‚</p><p>åœ¨ Kademlia ç½‘ç»œä¸­ï¼Œè·ç¦»æ˜¯é€šè¿‡å¼‚æˆ–ï¼ˆXORï¼‰è®¡ç®—çš„ã€‚ä»¥5ä½ä¸¾ä¾‹ï¼Œ01010 ä¸ 01000 çš„è·ç¦»ï¼Œå°±æ˜¯ä¸¤ä¸ª ID ä¹‹é—´çš„å¼‚æˆ–å€¼ï¼Œä¸º 00010ï¼Œä¹Ÿå³ä¸º 2ã€‚ 01010 ä¸ 00010 çš„è·ç¦»ä¸º 01000ï¼Œä¹Ÿå³ä¸º 8ã€‚01010 ä¸ 00011 çš„è·ç¦»ä¸º 01001ï¼Œä¹Ÿå³ 8+1=9ã€‚ä»¥æ­¤ç±»æ¨ï¼Œé«˜ä½ä¸åŒçš„ï¼Œè¡¨ç¤ºè·ç¦»æ›´è¿œä¸€äº›ï¼›ä½ä½ä¸åŒçš„ï¼Œè¡¨ç¤ºè·ç¦»æ›´è¿‘ä¸€äº›ï¼Œæ€»çš„è·ç¦»ä¸ºæ‰€æœ‰çš„ä¸åŒçš„ä½çš„è·ç¦»ä¹‹å’Œã€‚</p><p>æœ‰ä¸ªç†è®ºæ˜¯ï¼Œç¤¾äº¤ç½‘ç»œä¸­ï¼Œä»»ä½•ä¸¤ä¸ªäººç›´æ¥çš„è·ç¦»ä¸è¶…è¿‡å…­åº¦ï¼Œä¹Ÿå³ä½ æƒ³è”ç³»æ¯”å°”ç›–èŒ¨ï¼Œä¹Ÿå°±å…­ä¸ªäººå°±èƒ½å¤Ÿè”ç³»åˆ°äº†ã€‚</p><p>å‡è®¾å°æ˜å‘å¸ƒäº†ä¸€ä¸ªæ–‡ä»¶ï¼Œå°±èƒ½è®¡ç®—ä»–æ‰€çŸ¥é“çš„èŠ‚ç‚¹ ID ä¸è¿™ä¸ªæ–‡ä»¶ ID çš„è·ç¦»ï¼Œè®©ç®—å‡ºæ¥æœ€è·ç¦»æœ€çŸ­çš„èŠ‚ç‚¹å†è®¡ç®—å®ƒçŸ¥é“çš„èŠ‚ç‚¹å’Œæ–‡ä»¶ ID çš„è·ç¦»ï¼Œé‡å¤è¿™ä¸ªè¿‡ç¨‹ï¼Œå°±èƒ½æ‰¾åˆ°ä¸æ–‡ä»¶ ID çš„è·ç¦»æœ€çŸ­çš„ä¸€æ‰¹èŠ‚ç‚¹ IDï¼ŒæŠŠå°æ˜æä¾›çš„ä¸‹è½½ä¿¡æ¯å­˜åœ¨è¿™é‡Œã€‚</p><p>è¿™æ ·ï¼Œä¸‹è½½è€…ä¹Ÿåªè¦æ‰¾åˆ°å’Œæ–‡ä»¶ ID è·ç¦»æ¥è¿‘çš„èŠ‚ç‚¹ IDï¼Œå°±èƒ½å»ºç«‹è¿æ¥ï¼Œå¼€å§‹ä¸‹è½½ã€‚</p><h4 id="DHT-ç½‘ç»œå¦‚ä½•ç»´æŠ¤"><a href="#DHT-ç½‘ç»œå¦‚ä½•ç»´æŠ¤" class="headerlink" title="DHT ç½‘ç»œå¦‚ä½•ç»´æŠ¤"></a>DHT ç½‘ç»œå¦‚ä½•ç»´æŠ¤</h4><p>å°±åƒäººä¸€æ ·ï¼Œè™½ç„¶æˆ‘ä»¬å¸¸è”ç³»äººçš„åªæœ‰å°‘æ•°ï¼Œä½†æ˜¯æœ‹å‹åœˆé‡Œè‚¯å®šæ˜¯è¿œè¿‘éƒ½æœ‰ã€‚DHT ç½‘ç»œçš„æœ‹å‹åœˆä¹Ÿæ˜¯ä¸€æ ·ï¼Œè¿œè¿‘éƒ½æœ‰ï¼Œå¹¶ä¸”æŒ‰è·ç¦»åˆ†å±‚ã€‚</p><p>å‡è®¾æŸä¸ªèŠ‚ç‚¹çš„ ID ä¸º 01010ï¼Œå¦‚æœä¸€ä¸ªèŠ‚ç‚¹çš„ IDï¼Œå‰é¢æ‰€æœ‰ä½æ•°éƒ½ä¸å®ƒç›¸åŒï¼Œåªæœ‰æœ€å 1 ä½ä¸åŒã€‚è¿™æ ·çš„èŠ‚ç‚¹åªæœ‰ 1 ä¸ªï¼Œä¸º 01011ã€‚ä¸åŸºç¡€èŠ‚ç‚¹çš„å¼‚æˆ–å€¼ä¸º 00001ï¼Œå³è·ç¦»ä¸º 1ï¼›å¯¹äº 01010 è€Œè¨€ï¼Œè¿™æ ·çš„èŠ‚ç‚¹å½’ä¸ºâ€œk-bucket 1â€ã€‚</p><p>å¦‚æœä¸€ä¸ªèŠ‚ç‚¹çš„ IDï¼Œå‰é¢æ‰€æœ‰ä½æ•°éƒ½ç›¸åŒï¼Œä»å€’æ•°ç¬¬ 2 ä½å¼€å§‹ä¸åŒï¼Œè¿™æ ·çš„èŠ‚ç‚¹åªæœ‰ 2 ä¸ªï¼Œå³ 01000 å’Œ 01001ï¼Œä¸åŸºç¡€èŠ‚ç‚¹çš„å¼‚æˆ–å€¼ä¸º 00010 å’Œ 00011ï¼Œå³è·ç¦»èŒƒå›´ä¸º 2 å’Œ 3ï¼›å¯¹äº 01010 è€Œè¨€ï¼Œè¿™æ ·çš„èŠ‚ç‚¹å½’ä¸ºâ€œk-bucket 2â€ã€‚</p><p>å¦‚æœä¸€ä¸ªèŠ‚ç‚¹çš„ IDï¼Œå‰é¢æ‰€æœ‰ä½æ•°ç›¸åŒï¼Œä»å€’æ•°ç¬¬ i ä½å¼€å§‹ä¸åŒï¼Œè¿™æ ·çš„èŠ‚ç‚¹åªæœ‰ 2^(i-1) ä¸ªï¼Œä¸åŸºç¡€èŠ‚ç‚¹çš„è·ç¦»èŒƒå›´ä¸º [2^(i-1), 2^i)ï¼›å¯¹äº 01010 è€Œè¨€ï¼Œè¿™æ ·çš„èŠ‚ç‚¹å½’ä¸ºâ€œk-bucket iâ€ã€‚</p><p>æœ€ç»ˆåˆ°ä»å€’æ•° 160 ä½å°±å¼€å§‹éƒ½ä¸åŒã€‚å·®è·è¶Šå¤§ï¼Œé™Œç”Ÿäººè¶Šå¤šï¼Œä½†æ˜¯æœ‹å‹åœˆä¸èƒ½éƒ½æ”¾ä¸‹ï¼Œæ‰€ä»¥æ¯ä¸€å±‚éƒ½åªæ”¾ K ä¸ªï¼Œè¿™æ˜¯å‚æ•°å¯ä»¥é…ç½®ã€‚</p><h4 id="DHT-ç½‘ç»œèŠ‚ç‚¹çš„æŸ¥æ‰¾"><a href="#DHT-ç½‘ç»œèŠ‚ç‚¹çš„æŸ¥æ‰¾" class="headerlink" title="DHT ç½‘ç»œèŠ‚ç‚¹çš„æŸ¥æ‰¾"></a>DHT ç½‘ç»œèŠ‚ç‚¹çš„æŸ¥æ‰¾</h4><p>å‡è®¾ï¼Œnode A çš„ ID ä¸º 00110ï¼Œè¦æ‰¾ node B ID ä¸º 10000ï¼Œå¼‚æˆ–è·ç¦»ä¸º 10110ï¼Œè·ç¦»èŒƒå›´åœ¨ [2^4, 2^5)ï¼Œæ‰€ä»¥è¿™ä¸ªç›®æ ‡èŠ‚ç‚¹å¯èƒ½åœ¨â€œk-bucket 5â€ä¸­ï¼Œè¿™å°±è¯´æ˜ B çš„ ID ä¸ A çš„ ID ä»ç¬¬ 5 ä½å¼€å§‹ä¸åŒï¼Œæ‰€ä»¥ B å¯èƒ½åœ¨â€œk-bucket 5â€ä¸­ã€‚</p><p>ç„¶åï¼ŒA çœ‹çœ‹è‡ªå·±çš„ k-bucket 5 æœ‰æ²¡æœ‰ Bã€‚å¦‚æœæœ‰å°±æ‰¾åˆ°äº†ï¼›å¦‚æœæ²¡æœ‰ï¼Œåœ¨ k-bucket 5 é‡Œéšä¾¿æ‰¾ä¸€ä¸ª Cã€‚å› ä¸ºæ˜¯äºŒè¿›åˆ¶ï¼ŒCã€B éƒ½å’Œ A çš„ç¬¬ 5 ä½ä¸åŒï¼Œé‚£ä¹ˆ C çš„ ID ç¬¬ 5 ä½è‚¯å®šä¸ B ç›¸åŒï¼Œå³å®ƒä¸ B çš„è·ç¦»ä¼šå°äº 2^4ï¼Œç›¸å½“äºæ¯”Aã€B ä¹‹é—´çš„è·ç¦»ç¼©çŸ­äº†ä¸€åŠä»¥ä¸Šã€‚</p><p>å†è¯·æ±‚ Cï¼Œåœ¨å®ƒè‡ªå·±çš„é€šè®¯å½•é‡Œï¼ŒæŒ‰åŒæ ·çš„æŸ¥æ‰¾æ–¹å¼æ‰¾ä¸€ä¸‹ Bã€‚å¦‚æœ C çŸ¥é“ Bï¼Œå°±å‘Šè¯‰ Aï¼›å¦‚æœ C ä¹Ÿä¸çŸ¥é“ Bï¼Œé‚£ C æŒ‰åŒæ ·çš„æœç´¢æ–¹æ³•ï¼Œå¯ä»¥åœ¨è‡ªå·±çš„é€šè®¯å½•é‡Œæ‰¾åˆ°ä¸€ä¸ªç¦» B æ›´è¿‘çš„ D æœ‹å‹ï¼ˆDã€B ä¹‹é—´è·ç¦»å°äº 2^3ï¼‰ï¼ŒæŠŠ D æ¨èç»™ Aï¼ŒA è¯·æ±‚ D è¿›è¡Œä¸‹ä¸€æ­¥æŸ¥æ‰¾ã€‚</p><p>Kademlia çš„è¿™ç§æŸ¥è¯¢æœºåˆ¶ï¼Œæ˜¯é€šè¿‡æŠ˜åŠæŸ¥æ‰¾çš„æ–¹å¼æ¥æ”¶ç¼©èŒƒå›´ï¼Œå¯¹äºæ€»çš„èŠ‚ç‚¹æ•°ç›®ä¸º Nï¼Œæœ€å¤šåªéœ€è¦æŸ¥è¯¢ log2(N) æ¬¡ï¼Œå°±èƒ½å¤Ÿæ‰¾åˆ°ã€‚</p><h4 id="DHT-ç½‘ç»œèŠ‚ç‚¹ä¹‹é—´çš„æ²Ÿé€š"><a href="#DHT-ç½‘ç»œèŠ‚ç‚¹ä¹‹é—´çš„æ²Ÿé€š" class="headerlink" title="DHT ç½‘ç»œèŠ‚ç‚¹ä¹‹é—´çš„æ²Ÿé€š"></a>DHT ç½‘ç»œèŠ‚ç‚¹ä¹‹é—´çš„æ²Ÿé€š</h4><p>Kademlia ç®—æ³•ä¸­ï¼Œæ¯ä¸ªèŠ‚ç‚¹åªæœ‰ 4 ä¸ªæŒ‡ä»¤ã€‚</p><ul><li>PINGï¼šæµ‹è¯•ä¸€ä¸ªèŠ‚ç‚¹æ˜¯å¦åœ¨çº¿ã€‚</li><li>STOREï¼šè¦æ±‚ä¸€ä¸ªèŠ‚ç‚¹å­˜å‚¨ä¸€ä»½æ•°æ®ã€‚</li><li>FIND_NODEï¼šæ ¹æ®èŠ‚ç‚¹ ID æŸ¥æ‰¾ä¸€ä¸ªèŠ‚ç‚¹</li><li>FIND_VALUEï¼šæ ¹æ® KEY æŸ¥æ‰¾ä¸€ä¸ªæ•°æ®ï¼Œä¸ FIND_NODE ç±»ä¼¼</li></ul><h4 id="DHT-ç½‘ç»œçš„æ›´æ–°"><a href="#DHT-ç½‘ç»œçš„æ›´æ–°" class="headerlink" title="DHT ç½‘ç»œçš„æ›´æ–°"></a>DHT ç½‘ç»œçš„æ›´æ–°</h4><p>æ¯ä¸ª bucket é‡Œçš„èŠ‚ç‚¹ï¼Œéƒ½æŒ‰æœ€åä¸€æ¬¡æ¥è§¦çš„æ—¶é—´å€’åºæ’åˆ—ï¼Œè¿™å°±ç›¸å½“äºï¼Œæœ‹å‹åœˆé‡Œé¢æœ€è¿‘è”ç³»è¿‡çš„äººå¾€å¾€æ˜¯æœ€ç†Ÿçš„ã€‚</p><p>æ¯æ¬¡æ‰§è¡Œå››ä¸ªæŒ‡ä»¤ä¸­çš„ä»»æ„ä¸€ä¸ªéƒ½ä¼šè§¦å‘æ›´æ–°ã€‚</p><p>å½“ä¸€ä¸ªèŠ‚ç‚¹ä¸è‡ªå·±æ¥è§¦æ—¶ï¼Œæ£€æŸ¥å®ƒæ˜¯å¦å·²ç»åœ¨ k-bucket ä¸­ï¼Œä¹Ÿå°±æ˜¯è¯´æ˜¯å¦å·²ç»åœ¨æœ‹å‹åœˆã€‚å¦‚æœåœ¨ï¼Œé‚£ä¹ˆå°†å®ƒæŒªåˆ° k-bucket åˆ—è¡¨çš„æœ€åº•ï¼Œä¹Ÿå°±æ˜¯æœ€æ–°çš„ä½ç½®ï¼Œåˆšè”ç³»è¿‡ï¼Œå°±ç½®é¡¶ä¸€ä¸‹ï¼Œæ–¹ä¾¿ä»¥åå¤šè”ç³»ï¼›å¦‚æœä¸åœ¨ï¼Œæ–°çš„è”ç³»äººè¦ä¸è¦åŠ åˆ°é€šè®¯å½•é‡Œé¢å‘¢ï¼Ÿå‡è®¾é€šè®¯å½•å·²æ»¡çš„æƒ…å†µï¼ŒPING ä¸€ä¸‹åˆ—è¡¨æœ€ä¸Šé¢ï¼Œä¹Ÿå³æœ€æ—§çš„ä¸€ä¸ªèŠ‚ç‚¹ã€‚å¦‚æœ PING é€šäº†ï¼Œå°†æ—§èŠ‚ç‚¹æŒªåˆ°åˆ—è¡¨æœ€åº•ï¼Œå¹¶ä¸¢å¼ƒæ–°èŠ‚ç‚¹ï¼Œè€æœ‹å‹è¿˜æ˜¯ç•™ä¸€ä¸‹ï¼›å¦‚æœ PING ä¸é€šï¼Œåˆ é™¤æ—§èŠ‚ç‚¹ï¼Œå¹¶å°†æ–°èŠ‚ç‚¹åŠ å…¥åˆ—è¡¨ï¼Œè¿™äººè”ç³»ä¸ä¸Šäº†ï¼Œåˆ äº†å§ã€‚</p><p>è¿™ä¸ªæœºåˆ¶ä¿è¯äº†ä»»æ„èŠ‚ç‚¹åŠ å…¥å’Œç¦»å¼€éƒ½ä¸å½±å“æ•´ä½“ç½‘ç»œã€‚</p><h2 id="ç£åŠ›é“¾æ¥"><a href="#ç£åŠ›é“¾æ¥" class="headerlink" title="ç£åŠ›é“¾æ¥"></a>ç£åŠ›é“¾æ¥</h2><p>ä»Šå¤©æœ€æµè¡Œçš„ä¸‹è½½æ–¹å¼æ˜¯ç£åŠ›é“¾æ¥ï¼ˆMagnet URI schemeï¼‰å°±æ˜¯åŸºäº DHT ç½‘ç»œçš„ï¼Œé€šå¸¸æ˜¯ä¸€ä¸²è¿™æ ·çš„ç¥ç§˜ä»£ç ï¼š</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190708180235.png" alt></p><p>å‰é¢éƒ½æ˜¯æ ‡å‡†æ ¼å¼ï¼Œæœ€é‡è¦çš„æ˜¯è¿™ 40 ä¸ª 16 è¿›åˆ¶çš„æ•°å­—å³ 160 ä½ 2 è¿›åˆ¶æ•°å­—ã€‚ä»»ä½•æ–‡ä»¶ä¸¢è¿› SHA1 å“ˆå¸Œç®—æ³•éƒ½èƒ½å¾—åˆ°ä¸€ä¸²è¿™æ ·å­—ç¬¦ï¼Œ40 ä½ã€16 è¿›åˆ¶ã€åªå±äºè¿™ä¸ªæ–‡ä»¶ï¼Œå®ƒèƒ½å¸®æˆ‘ä»¬æ‰¾åˆ°æˆ‘ä»¬è¦ä¸‹è½½çš„ä¸œè¥¿ã€‚</p><p>æ ¹æ®ä¸Šé¢è®²çš„ DHTï¼Œåªéœ€è¦ä¸€ä¸²æ–‡ä»¶ ID å’Œå­˜å‚¨åœ¨æœ¬åœ°çš„ K æ¡¶æ•°æ®ï¼Œä½ å°±å¯ä»¥é«˜æ•ˆçš„æ‰¾åˆ°è¦ä¸‹è½½çš„æ–‡ä»¶ã€‚è€Œèµ„æºçš„å‘å¸ƒè€…å’Œä¼ æ’­è€…ä¹Ÿåªéœ€è¦åˆ†äº« 40 ä¸ªæ•°å­—å°±å¥½ï¼Œè¶³å¤Ÿç®€å•ï¼Œæ–¹ä¾¿å’Œéšç§ã€‚</p><p>åœ¨çœŸå®çš„ DHT ç½‘ç»œï¼Œæ¯ä¸ª K æ¡¶è‡³å°‘è®°å½•äº† 8 ä¸ªèŠ‚ç‚¹ï¼Œä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹ä¸‹çº¿ï¼Œéƒ½ä¸ä¼šå½±å“æ•´ä¸ªç½‘ç»œçš„è¿è¡Œã€‚</p><p>ä½œä¸ºæ–‡ä»¶å’ŒèŠ‚ç‚¹ ID ï¼Œ2 çš„ 160 æ¬¡æ–¹ä¹Ÿè¶³å¤Ÿå¤§ï¼Œå¤§åˆ°å…¨åœ°çƒ 70 äº¿äººæ¯ç§’ä¸‹è½½ 10000 ä¸ªç§å­ï¼Œä¹Ÿè¶³å¤Ÿä¸‹è½½ç™¾ä¸‡äº¿å¹´ç›´åˆ°å®‡å®™ç»ˆç»“ã€‚</p><p>è¿™äº›å¤©æ‰ä»¬çš„è®¾è®¡ï¼Œè®©æˆ‘ä»¬æ‹¥æœ‰äº†ä¸€ä¸ªæ— æ³•è¢«å®¡æŸ¥å’Œè¿½è¸ªçš„å»ä¸­å¿ƒåŒ–ç½‘ç»œã€‚è¿™å‚¬ç”Ÿäº†åºå¤§çš„ç›—ç‰ˆäº§ä¸šï¼Œä½†ä¹Ÿè®©å¾ˆå¤šå†…å®¹æœ‰æœºä¼šé¿å¼€å®¡æŸ¥ã€‚</p><p>å› ä¸ºç½‘ç«™å¯ä»¥è¢«éš”ç¦»ã€è¢«æ‹”çº¿ã€è¢«ç¦æ­¢è®¿é—®ï¼Œä½†ç§å­ä¸ä¼šã€‚åªè¦ç§å­ä¸æ­»ï¼Œé‚£äº›ä¸å­˜åœ¨çš„éŸ³ä¹å›¾ä¹¦å’Œè§†é¢‘å°±è¿˜æ´»åœ¨äº’è”ç½‘ä¸Šï¼Œæ²¡æœ‰ä»»ä½•äººå¯ä»¥æ¯æ‰ã€‚</p><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><ul><li><p>ä¸‹è½½ä¸€ä¸ªæ–‡ä»¶å¯ä»¥ä½¿ç”¨ HTTP æˆ– FTPï¼Œè¿™ä¸¤ç§éƒ½æ˜¯é›†ä¸­ä¸‹çš„æ–¹å¼ï¼Œè€Œ P2P åˆ™æ¢äº†ä¸€ç§æ€è·¯ï¼Œé‡‡å–éä¸­å¿ƒåŒ–ä¸‹è½½çš„æ–¹å¼ï¼›</p></li><li><p>P2P ä¹Ÿæ˜¯æœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯ä¾èµ–äº tracker çš„ï¼Œä¹Ÿå³å…ƒæ•°æ®é›†ä¸­ï¼Œæ–‡ä»¶æ•°æ®åˆ†æ•£ï¼›å¦ä¸€ç§æ˜¯åŸºäºåˆ†å¸ƒå¼çš„å“ˆå¸Œç®—æ³•ï¼Œå…ƒæ•°æ®å’Œæ–‡ä»¶æ•°æ®å…¨éƒ¨åˆ†æ•£ã€‚</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> Tech </category>
          
      </categories>
      
      
        <tags>
            
            <tag> NetworkProtocol </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ‚è°ˆç½‘ç»œåè®®ä¹‹ TCP/IP</title>
      <link href="/2019-06-06-network-protocol-ip-tcp-udp/"/>
      <url>/2019-06-06-network-protocol-ip-tcp-udp/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘å­¦äº†äº›TCP/IPç›¸å…³çš„å†…å®¹ï¼Œåšäº†äº›ç¬”è®°ã€‚</p><a id="more"></a><p><a href="https://paaatrick.com/2019-06-03-network-protocol-https/">å…³äºHTTP(S)ã€TLSçš„å†…å®¹é“¾æ¥</a></p><h2 id="ç½‘ç»œåˆ†å±‚"><a href="#ç½‘ç»œåˆ†å±‚" class="headerlink" title="ç½‘ç»œåˆ†å±‚"></a>ç½‘ç»œåˆ†å±‚</h2><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190606103501.jpg" alt></p><h4 id="ç½‘ç»œåˆ†å±‚çš„åŸå› "><a href="#ç½‘ç»œåˆ†å±‚çš„åŸå› " class="headerlink" title="ç½‘ç»œåˆ†å±‚çš„åŸå› "></a>ç½‘ç»œåˆ†å±‚çš„åŸå› </h4><ul><li><p>å¤æ‚çš„ç¨‹åºéƒ½éœ€è¦åˆ†å±‚ï¼Œå„å±‚æ¬¡ä¹‹é—´æ˜¯ç‹¬ç«‹çš„</p></li><li><p>æŸä¸€å±‚å¹¶ä¸éœ€è¦çŸ¥é“å®ƒçš„ä¸‹ä¸€å±‚æ˜¯å¦‚ä½•å®ç°çš„ï¼Œè€Œä»…ä»…éœ€è¦çŸ¥é“è¯¥å±‚é€šè¿‡å±‚é—´çš„æ¥å£æ‰€æä¾›çš„æœåŠ¡ï¼Œè¿™æ ·èƒ½é™ä½é—®é¢˜çš„å¤æ‚åº¦ï¼Œä¸Šå±‚å·¥ä½œä¸å½±å“ä¸‹å±‚çš„å·¥ä½œ</p></li><li><p>æ˜“ä¸å¤šäººåä½œï¼Œæ˜“ä¸å®ç°å’Œç»´æŠ¤ï¼Œä¿ƒè¿›æ ‡å‡†åŒ–å·¥ä½œ</p></li><li><p>åªè¦æ˜¯åœ¨ç½‘ç»œä¸Šè·‘çš„åŒ…ï¼Œéƒ½æ˜¯å®Œæ•´çš„ï¼Œå¯ä»¥æœ‰ä¸‹å±‚æ²¡ä¸Šå±‚ï¼Œç»ä¸å¯èƒ½æœ‰ä¸Šå±‚æ²¡ä¸‹å±‚</p></li><li><p>å¯¹äºTCPæ¥è¯´ï¼Œåªè¦æƒ³å‘å‡ºå»åŒ…ï¼Œå°±å¿…é¡»è¦æœ‰IPå±‚å’ŒMACå±‚</p></li></ul><h4 id="ç½‘ç»œå¦‚ä½•åˆ†å±‚"><a href="#ç½‘ç»œå¦‚ä½•åˆ†å±‚" class="headerlink" title="ç½‘ç»œå¦‚ä½•åˆ†å±‚"></a>ç½‘ç»œå¦‚ä½•åˆ†å±‚</h4><ul><li>ä¸€èˆ¬æœ‰äº”å±‚æ¨¡å‹å’Œä¸ƒå±‚æ¨¡å‹ï¼ŒæŒ‰ä¸ªäººç†è§£ï¼Œä¸ƒå±‚æ¨¡å‹åªæ˜¯æŠŠäº”å±‚æ¨¡å‹æœ€ä¸Šå±‚çš„åº”ç”¨å±‚ç»™ç»†åŒ–äº†<ol><li>ç‰©ç†å±‚(ä¸­ç»§å™¨ã€é›†çº¿å™¨ã€HUBã€ç½‘çº¿)</li><li>æ•°æ®é“¾è·¯å±‚(MAC)</li><li>ç½‘ç»œå±‚(IP) </li><li>ä¼ è¾“å±‚(TCP/UDP) </li><li>åº”ç”¨å±‚(HTTP(S))</li></ol></li></ul><h4 id="ç½‘ç»œåˆ†å±‚è¿è¡Œçš„è¿‡ç¨‹"><a href="#ç½‘ç»œåˆ†å±‚è¿è¡Œçš„è¿‡ç¨‹" class="headerlink" title="ç½‘ç»œåˆ†å±‚è¿è¡Œçš„è¿‡ç¨‹"></a>ç½‘ç»œåˆ†å±‚è¿è¡Œçš„è¿‡ç¨‹</h4><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190606104044.jpg" alt></p><ol><li>æ¥æ”¶è¿‡ç¨‹</li></ol><p>å½“ä¸€ä¸ªåŒ…ç»è¿‡ç½‘å£æ—¶ï¼Œé¦–å…ˆçœ‹çœ‹è¦ä¸è¦è¯·è¿›æ¥å¤„ç†ä¸€ä¸‹ï¼ˆé…ç½®äº†æ··æ‚æ¨¡å¼çš„ç½‘å£ï¼Œå‡¡æ˜¯ç»è¿‡çš„éƒ½æ‹¿è¿›æ¥ï¼‰ï¼Œæ‹¿è¿›æ¥ä»¥åäº¤ç»™ä¸€æ®µç¨‹åºå¤„ç†ï¼Œäºæ˜¯è°ƒç”¨<code>process_layer2(buffer)</code>ï¼Œå½“ç„¶è¿™æ˜¯å‡å‡½æ•°ï¼Œä½†ä½ çŸ¥é“è‚¯å®šæœ‰ç±»ä¼¼åŠŸèƒ½çš„å‡½æ•°çš„ï¼Œè¿™ä¸ªå‡½æ•°åŠŸèƒ½æ˜¯ä»bufferä¸­æ‘˜æ‰äºŒå±‚ï¼ˆMACï¼‰çš„å¤´æŸ¥çœ‹ã€‚</p><p>å‡å¦‚å‘ç°è¿™ä¸ªåŒ…çš„MACåœ°å€ä¸è‡ªå·±ç›¸ç¬¦ï¼Œè¯´æ˜æ˜¯å‘ç»™ä½ çš„ï¼Œäºæ˜¯è°ƒç”¨<code>process_layer3(buffer)</code>ï¼Œæ‘˜æ‰ä¸‰å±‚ï¼ˆIPï¼‰çš„å¤´æŸ¥çœ‹ï¼Œå¦‚æœIPåœ°å€ä¸æ˜¯è‡ªå·±çš„ï¼Œå°±åº”è¯¥è½¬å‘å‡ºå»ï¼Œå¦‚æœIPåœ°å€æ˜¯è‡ªå·±çš„ï¼Œå°±æ ¹æ®IPå¤´çš„æŒ‡ç¤ºï¼Œæ‹¿æ‰ä¸‰å±‚çš„å¤´ï¼Œè¿›ç¨‹ä¸‹ä¸€å±‚çš„å¤„ç†ï¼Œå¦‚æœåœ°å€æ˜¯TCPçš„ï¼Œè°ƒç”¨<code>process_tcp(buffer)</code>ï¼Œå¦‚æœæ˜¯UDPçš„è°ƒç”¨<code>process_udp(buffer)</code>ã€‚</p><p>å‡è®¾æ˜¯TCPçš„ï¼Œè°ƒç”¨<code>process_tcp(buffer)</code>ï¼ŒæŸ¥çœ‹å››å±‚çš„å¤´ï¼Œçœ‹æ˜¯ä¸€ä¸ªå‘èµ·ï¼Œè¿˜æ˜¯åº”ç­”ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªæ­£å¸¸çš„æ•°æ®åŒ…ï¼Œåˆ†åˆ«äº¤ç»™ä¸åŒçš„é€»è¾‘å¤„ç†ã€‚å¦‚æœæ˜¯å‘èµ·æˆ–è€…åº”ç­”ï¼Œæ¥ä¸‹æ¥å¯èƒ½è¦å‘é€ä¸€ä¸ªå›å¤åŒ…ï¼›å¦‚æœæ˜¯ä¸€ä¸ªæ­£å¸¸çš„æ•°æ®åŒ…ï¼Œå°±éœ€è¦äº¤ç»™ä¸Šå±‚äº†ã€‚äº¤ç»™è°å‘¢ï¼Ÿæ˜¯ä¸æ˜¯æœ‰ <code>process_http(buffer)</code> å‡½æ•°å‘¢ï¼Ÿ</p><p>æ²¡æœ‰çš„ï¼Œå¦‚æœä½ æ˜¯ä¸€ä¸ªç½‘ç»œåŒ…å¤„ç†ç¨‹åºï¼Œä½ ä¸éœ€è¦æœ‰process_http(buffer)ï¼Œè€Œæ˜¯åº”è¯¥äº¤ç»™åº”ç”¨å»å¤„ç†ã€‚äº¤ç»™å“ªä¸ªåº”ç”¨å‘¢ï¼Ÿåœ¨å››å±‚çš„å¤´é‡Œé¢æœ‰ç«¯å£å·ï¼Œä¸åŒçš„åº”ç”¨ç›‘å¬ä¸åŒçš„ç«¯å£å·ã€‚å¦‚æœå‘ç°æµè§ˆå™¨åº”ç”¨åœ¨ç›‘å¬è¿™ä¸ªç«¯å£ï¼Œé‚£ä½ å‘ç»™æµè§ˆå™¨å°±è¡Œäº†ã€‚è‡³äºæµè§ˆå™¨æ€ä¹ˆå¤„ç†ï¼Œå’Œä½ æ²¡æœ‰å…³ç³»ã€‚</p><p>æµè§ˆå™¨è‡ªç„¶æ˜¯è§£æ HTMLï¼Œæ˜¾ç¤ºå‡ºé¡µé¢æ¥ã€‚ç”µè„‘çš„ä¸»äººçœ‹åˆ°é¡µé¢å¾ˆå¼€å¿ƒï¼Œå°±ç‚¹äº†é¼ æ ‡ã€‚ç‚¹å‡»é¼ æ ‡çš„åŠ¨ä½œè¢«æµè§ˆå™¨æ•è·ã€‚æµè§ˆå™¨çŸ¥é“ï¼Œåˆè¦å‘èµ·å¦ä¸€ä¸ª HTTP è¯·æ±‚äº†ï¼Œäºæ˜¯ä½¿ç”¨ç«¯å£å·ï¼Œå°†è¯·æ±‚å‘ç»™äº†ä½ ã€‚</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190606103753.jpg" alt></p><ol start="2"><li>å‘é€è¿‡ç¨‹</li></ol><p>æ”¶åˆ°äº†ä¸€ä¸ªå°è£…å¥½çš„HTTPåŒ…åï¼Œé¦–å…ˆè°ƒç”¨<code>send_tcp(buffer)</code>ï¼Œ<code>buffer</code>é‡Œå°±æ˜¯HTTPè¯·æ±‚çš„å†…å®¹ï¼Œè¿™ä¸ªå‡½æ•°é‡Œé¢åŠ ä¸€ä¸ªTCPçš„å¤´ï¼Œè®°å½•ä¸‹æµè§ˆå™¨ç»™çš„æºç«¯å£å·ï¼Œä¸€èˆ¬æ˜¯80ï¼ˆHTTPSå°±443ï¼‰ã€‚</p><p>ç„¶åè°ƒç”¨<code>send_layer3(buffer)</code>ï¼Œ<code>buffer</code>é‡Œé¢å·²ç»æœ‰äº†HTTPçš„å¤´å’Œå†…å®¹ï¼Œä»¥åŠTCPçš„å¤´ï¼Œè¿™ä¸ªå‡½æ•°é‡Œé¢åŠ ä¸€ä¸ªIPçš„å¤´ï¼Œè®°å½•ä¸‹æºIPåœ°å€å’Œç›®æ ‡IPåœ°å€ã€‚</p><p>ç„¶åè°ƒç”¨<code>send_layer2(buffer)</code>ï¼Œ<code>buffer</code>é‡Œé¢å·²ç»æœ‰äº†HTTPçš„å¤´å’Œå†…å®¹ã€TCPçš„å¤´ï¼Œä»¥åŠIPçš„å¤´ï¼Œè¿™ä¸ªå‡½æ•°é‡Œé¢åŠ ä¸€ä¸ªMACçš„å¤´ï¼Œè®°å½•æºMACåœ°å€ï¼Œå¾—åˆ°çš„å°±æ˜¯æœ¬æœºå™¨çš„ MAC åœ°å€å’Œç›®æ ‡çš„ MAC åœ°å€ã€‚ä¸è¿‡ï¼Œè¿™ä¸ªè¿˜è¦çœ‹å½“å‰çŸ¥é“ä¸çŸ¥é“ï¼ŒçŸ¥é“å°±ç›´æ¥åŠ ä¸Šï¼›ä¸çŸ¥é“çš„è¯ï¼Œå°±è¦é€šè¿‡ä¸€å®šçš„åè®®å¤„ç†è¿‡ç¨‹ï¼Œæ‰¾åˆ° MAC åœ°å€ã€‚åæ­£è¦å¡«ä¸€ä¸ªï¼Œä¸èƒ½ç©ºç€ã€‚</p><p>åªè¦<code>buffer</code>é‡Œé¢çš„å†…å®¹å®Œæ•´ï¼Œå°±å¯ä»¥ä»ç½‘å£å‘å‡ºå»äº†ã€‚</p><h4 id="æ•°æ®é“¾è·¯å±‚-MAC"><a href="#æ•°æ®é“¾è·¯å±‚-MAC" class="headerlink" title="æ•°æ®é“¾è·¯å±‚ MAC"></a>æ•°æ®é“¾è·¯å±‚ MAC</h4><ul><li><p>MACçš„å…¨ç§°æ˜¯Medium Access Controlï¼Œå³åª’ä½“è®¿é—®æ§åˆ¶ã€‚</p></li><li><p>ä»¥å¤ªç½‘è§„å®šï¼Œè¿å…¥ç½‘ç»œçš„æ‰€æœ‰è®¾å¤‡ï¼Œéƒ½å¿…é¡»å…·æœ‰â€ç½‘å¡â€æ¥å£ã€‚æ•°æ®åŒ…å¿…é¡»æ˜¯ä»ä¸€å—ç½‘å¡ï¼Œä¼ é€åˆ°å¦ä¸€å—ç½‘å¡ã€‚ç½‘å¡çš„åœ°å€ï¼Œå°±æ˜¯æ•°æ®åŒ…çš„å‘é€åœ°å€å’Œæ¥æ”¶åœ°å€ï¼Œè¿™å«åšMACåœ°å€ã€‚</p></li><li><p>æ¯å—ç½‘å¡å‡ºå‚çš„æ—¶å€™ï¼Œéƒ½æœ‰ä¸€ä¸ªå…¨ä¸–ç•Œç‹¬ä¸€æ— äºŒçš„MACåœ°å€ï¼Œé•¿åº¦æ˜¯48ä¸ªäºŒè¿›åˆ¶ä½ï¼Œé€šå¸¸ç”¨12ä¸ªåå…­è¿›åˆ¶æ•°è¡¨ç¤ºã€‚</p><p> <img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190606103751.jpg" alt></p></li><li><p>å‰6ä¸ªåå…­è¿›åˆ¶æ•°æ˜¯å‚å•†ç¼–å·ï¼Œå6ä¸ªæ˜¯è¯¥å‚å•†çš„ç½‘å¡æµæ°´å·ã€‚æœ‰äº†MACåœ°å€ï¼Œå°±å¯ä»¥å®šä½ç½‘å¡å’Œæ•°æ®åŒ…çš„è·¯å¾„äº†ã€‚</p></li><li><p>ä¸€å—ç½‘å¡è·å–å¦ä¸€å—ç½‘å¡MACåœ°å€çš„æ–¹å¼ï¼šARPåè®®ï¼Œå½“å·²çŸ¥IPæ—¶è¯·æ±‚MACåœ°å€</p></li><li><p>ARPçš„å·¥ä½œæ–¹å¼ï¼šå¹¿æ’­ï¼Œå‘åŒä¸ªå­ç½‘ç»œå†…æ‰€æœ‰è®¡ç®—æœºå‘é€æ•°æ®åŒ…ï¼Œè®©æ¯å°è®¡ç®—æœºè‡ªå·±åˆ¤æ–­è‡ªå·±æ˜¯å¦ä¸ºæ¥æ”¶æ–¹</p><p> <img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190606103754.jpg" alt></p></li></ul><h4 id="ç½‘ç»œå±‚-IP"><a href="#ç½‘ç»œå±‚-IP" class="headerlink" title="ç½‘ç»œå±‚ IP"></a>ç½‘ç»œå±‚ IP</h4><ul><li>ARPå¯»æ‰¾MACçš„å¹¿æ’­æ–¹å¼åªèƒ½åœ¨å­ç½‘ç»œå†…ä½¿ç”¨ï¼Œæ¯ä¸ªå­ç½‘ç»œä¹‹é—´é€šä¿¡éœ€è¦IPåè®®</li><li>Linux ä¸ŠæŸ¥çœ‹IPåœ°å€çš„å‘½ä»¤ï¼š<code>ifconfig</code> å’Œ <code>ip addr</code>ã€æ²¡æœ‰çš„è¯è‡ªè¡Œå®‰è£…<code>net-tools</code>å’Œ<code>iproute2</code></li></ul><ol><li><p>IPåœ°å€</p><ul><li>IPv4çš„ç½‘ç»œåœ°å€ç”±32ä¸ªäºŒè¿›åˆ¶ä½ç»„æˆ</li></ul><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190606103750.jpg" alt></p><ul><li>IP åœ°å€æ˜¯ä¸€ä¸ªç½‘å¡åœ¨ç½‘ç»œä¸–ç•Œçš„é€šè®¯åœ°å€ï¼Œç›¸å½“äºæˆ‘ä»¬ç°å®ä¸–ç•Œçš„é—¨ç‰Œå·ç </li></ul></li><li><p>CIDR</p><ul><li>32ä½çš„IPåœ°å€åˆ†æˆäº†5ç±»ï¼Œä½†å› ä¸ºå¤ªæµªè´¹äº†ï¼Œæ‰€ä»¥ä½¿ç”¨<code>CIDR</code></li><li>CIDRä»£æ›¿ABCç±»åˆ†é…IPåœ°å€æ®µï¼Œæ³¨æ„ç§æœ‰IPæ®µï¼ŒCIDRä¼´éšå¹¿æ’­åœ°å€å’Œå­ç½‘æ©ç </li></ul></li><li><p>IPçš„ä½œç”¨</p><ul><li>IPåè®®çš„ä½œç”¨ä¸»è¦æœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯ä¸ºæ¯ä¸€å°è®¡ç®—æœºåˆ†é…IPåœ°å€ï¼Œå¦ä¸€ä¸ªæ˜¯ç¡®å®šå“ªäº›åœ°å€åœ¨åŒä¸€ä¸ªå­ç½‘ç»œã€‚</li></ul></li><li><p>ä»IPå¾—åˆ°MACçš„æ–¹å¼</p><ul><li>å› ä¸ºIPæ•°æ®åŒ…æ˜¯æ”¾åœ¨ä»¥å¤ªç½‘æ•°æ®åŒ…é‡Œå‘é€çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»åŒæ—¶çŸ¥é“ä¸¤ä¸ªåœ°å€ï¼Œä¸€ä¸ªæ˜¯å¯¹æ–¹çš„MACåœ°å€ï¼Œå¦ä¸€ä¸ªæ˜¯å¯¹æ–¹çš„IPåœ°å€ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œå¯¹æ–¹çš„IPåœ°å€æ˜¯å·²çŸ¥çš„ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸çŸ¥é“å®ƒçš„MACåœ°å€ã€‚åˆ†ä¸¤ç§æƒ…å†µ</li></ul><ol><li>å¦‚æœä¸¤å°ä¸»æœºä¸åœ¨åŒä¸€ä¸ªå­ç½‘ç»œï¼Œé‚£ä¹ˆäº‹å®ä¸Šæ²¡æœ‰åŠæ³•å¾—åˆ°å¯¹æ–¹çš„MACåœ°å€ï¼Œåªèƒ½æŠŠæ•°æ®åŒ…ä¼ é€åˆ°ä¸¤ä¸ªå­ç½‘ç»œè¿æ¥å¤„çš„â€ç½‘å…³â€ï¼ˆgatewayï¼‰ï¼Œè®©ç½‘å…³å»å¤„ç†ã€‚</li><li>å¦‚æœä¸¤å°ä¸»æœºåœ¨åŒä¸€ä¸ªå­ç½‘ç»œï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç”¨ARPåè®®ï¼Œå¾—åˆ°å¯¹æ–¹çš„MACåœ°å€ã€‚</li></ol></li></ol><ul><li>DHCPè¯·æ±‚IPåœ°å€ï¼ŒDHCPé™„é€PXEåè®®å®‰è£…OS</li></ul><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190606130549.jpg" alt></p><h2 id="ICMP-å’Œ-ping"><a href="#ICMP-å’Œ-ping" class="headerlink" title="ICMP å’Œ ping"></a>ICMP å’Œ ping</h2><ul><li><p>ping æ˜¯åŸºäº ICMP å·¥ä½œçš„ï¼ŒICMPå…¨ç§°Internet Control Message Protocolï¼Œå°±æ˜¯äº’è”ç½‘æ§åˆ¶æŠ¥æ–‡åè®®ã€‚</p></li><li><p>ICMP æŠ¥æ–‡æ˜¯å°è£…åœ¨ IP åŒ…é‡Œé¢çš„ã€‚å› ä¸ºä¼ è¾“æŒ‡ä»¤çš„æ—¶å€™ï¼Œè‚¯å®šéœ€è¦æºåœ°å€å’Œç›®æ ‡åœ°å€ã€‚å®ƒæœ¬èº«éå¸¸ç®€å•ã€‚</p></li></ul><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190606124731.jpg" alt></p><ol><li><p>æŸ¥è¯¢æŠ¥æ–‡</p><ul><li>ping å°±æ˜¯ICMPçš„æŸ¥è¯¢æŠ¥æ–‡ï¼Œæ˜¯ä¸€ç§ä¸»åŠ¨è¯·æ±‚ï¼Œå¹¶è·å¾—ä¸»åŠ¨åº”ç­”çš„ICMPåè®®ï¼Œä¸è¿‡pingåœ¨ICMPåé¢å¢åŠ äº†è‡ªå·±çš„æ ¼å¼</li><li>ping ä¸»åŠ¨è¯·æ±‚çš„å‘é€ï¼š<code>ICMP ECHO REQUEST</code></li><li>ping ä¸»åŠ¨è¯·æ±‚çš„å›å¤ï¼š<code>ICMP ECHO REPLY</code></li><li>æ¯”åŸç”ŸICMPå¤šäº†ä¸¤ä¸ªå­—æ®µï¼šæ ‡è¯†ç¬¦ã€åºå·ï¼Œä»¥åŠå¯é€‰å­˜æ”¾è¯·æ±‚çš„æ—¶é—´å€¼ï¼Œå¯è®¡ç®—å¾€è¿”æ—¶é—´</li></ul></li><li><p>å·®é”™æŠ¥æ–‡</p><ul><li>ç»ˆç‚¹ä¸å¯è¾¾ï¼š3ï¼Œåˆ†ä¸ºç½‘ç»œä¸å¯è¾¾ã€ä¸»æœºä¸å¯è¾¾ã€åè®®ä¸å¯è¾¾ã€ç«¯å£ä¸å¯è¾¾ã€éœ€è¦è¿›è¡Œåˆ†ç‰‡ä½†è®¾ç½®äº†ä¸åˆ†ç‰‡ç­‰</li><li>æºæŠ‘åˆ¶ï¼š4ï¼Œè®©æºç«™æ”¾æ…¢å‘é€é€Ÿåº¦</li><li>è¶…æ—¶ï¼š11ï¼Œè¶…è¿‡ç½‘ç»œåŒ…çš„ç”Ÿå­˜æ—¶é—´è¿˜æ²¡åˆ°è¾¾ç›®æ ‡</li><li>é‡å®šå‘ï¼š5ï¼Œè®©ä¸‹æ¬¡å‘ç»™å¦ä¸€ä¸ªè·¯ç”±å™¨</li></ul></li></ol><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190606124744.jpg" alt></p><ol start="3"><li><p>ping çš„å‘é€å’Œæ¥æ”¶è¿‡ç¨‹</p><ul><li>å¯ä»¥çœ‹å‡ºpingæ˜¯ä½¿ç”¨äº†ICMPé‡Œçš„<code>ECHO REQUEST</code>å’Œ<code>ECHO REPLY</code></li></ul></li><li><p>TTL (TimeToLive)</p><ul><li>åœ¨IPv4ä¸­, TTLæ˜¯IPåè®®çš„ä¸€ä¸ª8ä¸ªäºŒè¿›åˆ¶ä½çš„å€¼(0-255)ï¼Œè¿™ä¸ªå€¼å¯ä»¥è¢«è®¤ä¸ºæ˜¯æ•°æ®åŒ…åœ¨internetç³»ç»Ÿä¸­å¯ä»¥è·³è·ƒçš„æ¬¡æ•°ä¸Šé™ã€‚</li><li>TTLæ˜¯ç”±æ•°æ®åŒ…çš„å‘é€è€…è®¾ç½®çš„, åœ¨å‰å¾€ç›®çš„åœ°çš„è¿‡ç¨‹ä¸­, æ¯ç»è¿‡ä¸€å°ä¸»æœºæˆ–è®¾å¤‡, è¿™ä¸ªå€¼å°±è¦å‡å°‘ä¸€ç‚¹ã€‚</li><li>å¦‚æœåœ¨æ•°æ®åŒ…åˆ°è¾¾ç›®çš„åœ°å‰, TTLå€¼è¢«å‡åˆ°äº†0ï¼Œé‚£ä¹ˆè¿™ä¸ªåŒ…å°†ä½œä¸ºä¸€ä¸ªICMPé”™è¯¯çš„æ•°æ®åŒ…è¢«ä¸¢å¼ƒã€‚</li></ul></li><li><p>å·®é”™æŠ¥æ–‡çš„åº”ç”¨<code>Traceroute</code> </p><ul><li>Traceroute æ•…æ„è®¾ç½®ç‰¹æ®Šçš„TTLï¼Œæ¥è¿½è¸ªå»å¾€ç›®çš„åœ°æ—¶æ²¿é€”ç»è¿‡çš„è·¯ç”±å™¨</li><li>å¯¹ç›®çš„IPåœ°å€å‘é€UDPåŒ…ï¼Œè®¾ç½®TTLä¸º1ï¼Œå³åˆ°è¾¾ç¬¬ä¸€ä¸ªè·¯ç”±å°±æŒ‚æ‰äº†ï¼Œç„¶åè¿”å›ä¸€ä¸ªICMPå·®é”™æŠ¥æ–‡åŒ…ï¼Œç±»å‹æ˜¯è¶…æ—¶</li><li>ç„¶åè®¾ç½®TTLä¸º2ï¼Œç»§ç»­åˆ°ç¬¬äºŒä¸ªè·¯ç”±å°±æŒ‚äº†ï¼Œè¿”å›è¶…æ—¶ï¼Œé€æ­¥è¿­ä»£è¿™ä¸ªè¿‡ç¨‹å–å¾—æ•´ä¸ªè·¯å¾„ä¸Šçš„è·¯ç”±IPå’Œå»¶è¿Ÿ</li><li>æœ‰äº›è·¯ç”±ä¸ä¼šå›å¤è¿™ä¸ªICMPï¼Œè¿™å°±æ˜¯Tracerouteè¿”å›å†…å®¹éƒ¨åˆ†ç©ºç™½çš„åŸå› </li><li>å¦å¤–ä¸€ä¸ªä½œç”¨æ˜¯æ•…æ„è®¾ç½®ä¸åˆ†ç‰‡ï¼Œä»è€Œç¡®å®šè·¯å¾„çš„MTU</li></ul></li></ol><h2 id="TCP-å’Œ-UDP-çš„åŒºåˆ«"><a href="#TCP-å’Œ-UDP-çš„åŒºåˆ«" class="headerlink" title="TCP å’Œ UDP çš„åŒºåˆ«"></a>TCP å’Œ UDP çš„åŒºåˆ«</h2><ol><li><p>TCP é¢å‘è¿æ¥ï¼ŒUDP é¢å‘æ— è¿æ¥</p></li><li><p>TCP æä¾›å¯é äº¤ä»˜ï¼ŒUDP ä¸å¯é </p><ul><li>TCP è¿æ¥ä¼ è¾“çš„æ•°æ®ï¼Œæ— å·®é”™ï¼Œä¸ä¸¢å¤±ï¼Œä¸é‡å¤ï¼ŒæŒ‰åºåˆ°è¾¾</li><li>UDP ç»§æ‰¿ IP åŒ…çš„ç‰¹æ€§ï¼Œä¸ä¿è¯ä¸ä¸¢å¤±ï¼Œä¸ä¿è¯æŒ‰é¡ºåºåˆ°è¾¾</li></ul></li><li><p>TCP åŸºäºå­—èŠ‚æµï¼ŒUDP åŸºäºæ•°æ®æŠ¥</p><ul><li>TCP å‘é€çš„æ—¶å€™æ˜¯ä¸€ä¸ªæµï¼Œæ²¡å¤´æ²¡å°¾</li><li>è™½ç„¶ IP åŒ…æ˜¯ä¸€ä¸ªä¸ªçš„ IP åŒ…ï¼ŒTCP è‡ªå·±ç»´æŠ¤æˆäº†æµ</li><li>UDP ç»§æ‰¿äº† IP çš„ç‰¹æ€§ï¼ŒåŸºäºæ•°æ®æŠ¥ï¼Œä¸€ä¸ªä¸ªåœ°å‘ï¼Œä¸€ä¸ªä¸ªåœ°æ”¶</li></ul></li><li><p>TCP æœ‰æ‹¥å¡æ§åˆ¶ï¼Œ UDP æ²¡æœ‰</p><ul><li>TCP æ„è¯†åˆ°åŒ…ä¸¢å¤±æˆ–è€…ç½‘ç»œç¯å¢ƒå·®åï¼Œæ ¹æ®æƒ…å†µè°ƒæ•´è¡Œä¸ºï¼Œè°ƒèŠ‚å‘é€é€Ÿåº¦</li><li>UDP æ²¡æœ‰æ„è¯†ï¼Œåº”ç”¨å«å‘åŒ…å°±å‘</li></ul></li><li><p>TCP æ˜¯æœ‰çŠ¶æ€æœåŠ¡ï¼ŒUDP æ˜¯æ— çŠ¶æ€æœåŠ¡</p><ul><li>TCP ç²¾ç¡®è®°å½•äº†å‘é€ã€æ¥æ”¶çŠ¶æ€</li><li>UDP ä¸è®°å½•çŠ¶æ€</li></ul></li></ol><h2 id="UDP"><a href="#UDP" class="headerlink" title="UDP"></a>UDP</h2><h4 id="UDP-åŒ…å¤´æ ¼å¼"><a href="#UDP-åŒ…å¤´æ ¼å¼" class="headerlink" title="UDP åŒ…å¤´æ ¼å¼"></a>UDP åŒ…å¤´æ ¼å¼</h4><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190606130750.jpg" alt></p><ul><li>æºç«¯å£å· | ç›®çš„ç«¯å£å·</li><li>16ä½UDPé•¿åº¦ | 16ä½UDPæ ¡éªŒå’Œ</li><li>æ•°æ®</li></ul><h4 id="UDP-ç‰¹ç‚¹"><a href="#UDP-ç‰¹ç‚¹" class="headerlink" title="UDP ç‰¹ç‚¹"></a>UDP ç‰¹ç‚¹</h4><ol><li><p>æ²Ÿé€šç®€å•ï¼Œè®¤ä¸ºç½‘ç»œé€šè·¯é»˜è®¤å°±æ˜¯å¾ˆå®¹æ˜“é€è¾¾çš„ï¼Œä¸å®¹æ˜“è¢«ä¸¢å¼ƒçš„</p></li><li><p>è½»ä¿¡ä»–äººï¼Œ ä¸ä¼šå»ºç«‹è¿æ¥ï¼Œè™½ç„¶æœ‰ç«¯å£å·ï¼Œä½†æ˜¯ç›‘å¬åä»»ä½•äººéƒ½èƒ½å‘æ•°æ®ç»™ä»–ï¼Œä»–ä¹Ÿå¯ä»¥å‘æ•°æ®ç»™ä»»ä½•ã€ä»»æ„å¤šäºº</p></li><li><p>æ„£å¤´é’ï¼Œä¸ä¼šæ ¹æ®ç½‘ç»œæƒ…å†µè¿›è¡Œå‘åŒ…çš„æ‹¥å¡æ§åˆ¶ï¼Œæ— è®ºä¸¢åŒ…æˆä»€ä¹ˆæ ·è¿˜æ˜¯è¯¥æ€ä¹ˆå‘å°±æ€ä¹ˆå‘</p></li></ol><h4 id="UDP-ä½¿ç”¨åœºæ™¯"><a href="#UDP-ä½¿ç”¨åœºæ™¯" class="headerlink" title="UDP ä½¿ç”¨åœºæ™¯"></a>UDP ä½¿ç”¨åœºæ™¯</h4><ol><li><p>éœ€è¦èµ„æºå°‘ï¼Œç½‘ç»œç¯å¢ƒå¥½çš„å†…ç½‘ï¼Œæˆ–å¯¹ä¸¢åŒ…ä¸æ•æ„Ÿçš„åº”ç”¨ã€‚å¦‚ DCHP å’Œ TFTP å°±æ˜¯åŸºäº UDP åè®®çš„ï¼Œå› ä¸ºBIOSèµ„æºå°‘ä¸é€‚åˆç»´æŠ¤TCPé‚£ç§å¤æ‚çš„çŠ¶æ€æœº</p></li><li><p>ä¸éœ€è¦ä¸€å¯¹ä¸€æ²Ÿé€šå»ºç«‹è¿æ¥ï¼Œè€Œæ˜¯å¯ä»¥å¹¿æ’­çš„åº”ç”¨ã€‚UDP é¢å‘æ— è¿æ¥çš„åŠŸèƒ½å¯ä»¥æ‰¿è½½å¹¿æ’­æˆ–è€…å¤šæ’­çš„åè®®ï¼ŒåŸºäº UDP çš„ DHCP å°±æ˜¯å¹¿æ’­çš„å½¢å¼</p></li><li><p>éœ€è¦å¤„ç†é€Ÿåº¦å¿«ï¼Œæ—¶å»¶ä½ï¼Œå¯å®¹å¿å°‘æ•°ä¸¢åŒ…ï¼Œä½†å³ä¾¿ç½‘ç»œæ‹¥å¡ä¹Ÿè¦ä¸åœæ­‡å‘åŒ…çš„åº”ç”¨ã€‚æ¯”å¦‚ç½‘ç»œç›´æ’­ï¼Œç”¨æˆ·ä¸å…³å¿ƒè¿‡æ—¶æ•°æ®ï¼Œè€æ•°æ®ä¸¢äº†ä¹Ÿå°±ä¸¢äº†ï¼Œä½†ä¸èƒ½å› ä¸ºæ‹¥å¡è€Œåœæ­‡äº†</p></li></ol><h4 id="UDP-ä½¿ç”¨ä¾‹å­"><a href="#UDP-ä½¿ç”¨ä¾‹å­" class="headerlink" title="UDP ä½¿ç”¨ä¾‹å­"></a>UDP ä½¿ç”¨ä¾‹å­</h4><ol><li><p>ç½‘é¡µæˆ–è€…Appçš„è®¿é—®</p><ul><li>QUICåè®®</li><li>ç§»åŠ¨äº’è”ï¼Œç½‘ç»œç»å¸¸å˜æ¢ï¼ŒTCPä¼šç»å¸¸é‡è¿å¾ˆè€—æ—¶ï¼ŒåŸºäºUDPçš„QUICå°±æ¯”è¾ƒåˆé€‚</li></ul></li><li><p>æµåª’ä½“åè®®</p><ul><li>TCP çš„ä¸¥æ ¼é¡ºåºä¼ è¾“ä¸é€‚åˆç›´æ’­ï¼Œç”¨æˆ·ä¸åœ¨æ„è€æ•°æ®è€Œæ˜¯è¦å®æ—¶æ€§ï¼Œå®å¯ä¸¢åŒ…ä¹Ÿä¸è¦å¡é¡¿</li><li>å¾ˆå¤šç›´æ’­åº”ç”¨åŸºäº UDP å®ç°è‡ªå·±çš„è§†é¢‘ä¼ è¾“åè®®</li></ul></li><li><p>å®æ—¶æ¸¸æˆ</p><ul><li>æ¸¸æˆçš„å®æ—¶æ€§è¦æ±‚å¾ˆé«˜ï¼Œè€Œä¸”æœåŠ¡å™¨éœ€è¦æ²Ÿé€šå¾ˆå¤šå®¢æˆ·ç«¯ï¼ˆç©å®¶ï¼‰ï¼Œåœ¨å¼‚æ­¥IOæœºåˆ¶å¼•å…¥ä¹‹å‰ï¼ŒUDPæ˜¯åº”å¯¹æµ·é‡å®¢æˆ·ç«¯è¿æ¥çš„ç­–ç•¥</li><li>TCPçš„å¼ºé¡ºåºé—®é¢˜ï¼Œå¯¹æˆ˜æ¸¸æˆå¯¹ç½‘ç»œè¦æ±‚ç®€å•ï¼Œå¦‚FPSåªéœ€ä¼ è¾“ç©å®¶ä½ç½®å’Œè¡Œä¸ºç­‰ï¼Œå®¢æˆ·ç«¯è§£æå“åº”å¹¶æ¸²æŸ“åœºæ™¯ï¼Œç©å®¶å¹¶ä¸å…³å¿ƒè¿‡æœŸæ•°æ®ï¼Œå¦‚æœä¸€ä¸ªæ•°æ®åŒ…ä¸¢å¤±å¯¼è‡´å¡é¡¿ï¼Œä¸‹ä¸€ç§’å°±è¢«çˆ†å¤´äº†ã€‚ç”¨UDPè‡ªå®šä¹‰å¯é åè®®ï¼Œè‡ªå®šä¹‰é‡ä¼ ç­–ç•¥ï¼Œèƒ½å°½é‡é™ä½å»¶è¿Ÿï¼Œå‡å°‘ç½‘ç»œé—®é¢˜å¯¹æ¸¸æˆæ€§èƒ½çš„å½±å“</li></ul></li><li><p>IoT ç‰©è”ç½‘</p><ul><li>ç‰©è”ç½‘è®¾å¤‡ç»ˆç«¯èµ„æºå°‘ï¼Œç»´æŠ¤TCPå¼€é”€å¤ªå¤§</li><li>ç‰©è”ç½‘å¯¹å®æ—¶æ€§è¦æ±‚é«˜ï¼ŒTCPå®¹æ˜“å¯¼è‡´é«˜å»¶è¿Ÿ</li><li>Googleå­å…¬å¸æ¨å‡ºçš„ç‰©è”ç½‘é€šä¿¡åè®® Thread å°±æ˜¯åŸºäº UDP çš„</li></ul></li><li><p>ç§»åŠ¨é€šä¿¡é¢†åŸŸ</p><ul><li>4G ç½‘ç»œçš„æ•°æ®åè®® GTP-U æ˜¯åŸºäº UDP çš„</li></ul></li></ol><h4 id="UDP-å°ç»“"><a href="#UDP-å°ç»“" class="headerlink" title="UDP å°ç»“"></a>UDP å°ç»“</h4><ol><li><p>å¦‚æœå°† TCP æ¯”ä½œæˆç†Ÿçš„ç¤¾ä¼šäººï¼ŒUDP åˆ™æ˜¯å¤´è„‘ç®€å•çš„å°æœ‹å‹ã€‚TCP å¤æ‚ï¼ŒUDP ç®€å•ï¼›TCP ç»´æŠ¤è¿æ¥ï¼ŒUDP è°éƒ½ç›¸ä¿¡ï¼›TCP ä¼šåšæŒçŸ¥è¿›é€€ï¼›UDP æ„£å¤´é’ä¸€ä¸ªï¼Œå‹‡å¾€ç›´å‰ï¼›</p></li><li><p>UDP è™½ç„¶ç®€å•ï¼Œä½†å®ƒæœ‰ç®€å•çš„ç”¨æ³•ã€‚å®ƒå¯ä»¥ç”¨åœ¨ç¯å¢ƒç®€å•ã€éœ€è¦å¤šæ’­ã€åº”ç”¨å±‚è‡ªå·±æ§åˆ¶ä¼ è¾“çš„åœ°æ–¹ã€‚ä¾‹å¦‚ DHCPã€VXLANã€QUIC ç­‰ã€‚</p></li></ol><h2 id="TCP"><a href="#TCP" class="headerlink" title="TCP"></a>TCP</h2><ul><li>TCPçš„seqæ˜¯32ä½çš„è®¡æ•°å™¨ï¼Œæ¯4å¾®ç§’åŠ 1ï¼Œè®¡ç®—å¯çŸ¥284åˆ†é’Ÿå³4.73å°æ—¶é‡ç½®ä¸€æ¬¡</li></ul><h4 id="TCP-åŒ…å¤´æ ¼å¼"><a href="#TCP-åŒ…å¤´æ ¼å¼" class="headerlink" title="TCP åŒ…å¤´æ ¼å¼"></a>TCP åŒ…å¤´æ ¼å¼</h4><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190606130901.jpg" alt></p><ul><li>æºç«¯å£å· | ç›®æ ‡ç«¯å£å·</li><li>åŒ…åºå·:<code>seq</code></li><li>ç¡®è®¤åºå·:<code>ack</code></li><li>é¦–éƒ¨é•¿åº¦ | ä¿ç•™ | URG | ACK | PSH | RST | SYN | FIN | 16ä½çª—å£å¤§å°</li><li>æ ¡éªŒå’Œ | ç´§æ€¥æŒ‡é’ˆ</li><li>é€‰é¡¹</li><li>æ•°æ®æœ¬ä½“</li></ul><ol><li>é¦–å…ˆä¸UDPä¸€æ ·æ˜¯æºç«¯å£å’Œç›®æ ‡ç«¯å£å·ï¼Œç”¨äºç¡®å®šå‘ç»™å“ªä¸ªåº”ç”¨</li><li><code>seq</code>åºå·è§£å†³ä¹±åºé—®é¢˜ï¼Œç¡®å®šæ¯ä¸ªåŒ…çš„å…ˆæ¥ååˆ°ï¼Œæ˜¯ä¸ª32ä½çš„è®¡æ•°å™¨ï¼Œæ¯4å¾®ç§’åŠ 1ï¼Œè®¡ç®—å¯çŸ¥284åˆ†é’Ÿå³4.73å°æ—¶é‡ç½®ä¸€æ¬¡</li><li><code>ack</code>çš„å€¼æ˜¯å¯¹æ–¹å‘æ¥çš„TCPåŒ…å†…<code>seq</code>çš„å€¼+1ï¼Œè§£å†³ä¸ä¸¢åŒ…é—®é¢˜</li><li>çŠ¶æ€ä½ï¼Œ<code>SYN</code>æ˜¯å‘èµ·è¿æ¥ï¼Œ<code>ACK</code>æ˜¯å›å¤ï¼Œ<code>RST</code>æ˜¯é‡æ–°è¿æ¥ï¼Œ<code>FIN</code>æ˜¯ç»“æŸè¿æ¥ï¼Œè¿™æ˜¯TCPé¢å‘è¿æ¥çš„ä½“ç°ï¼Œç»´æŠ¤è¿æ¥çŠ¶æ€ï¼Œè¿™äº›å¸¦çŠ¶æ€ä½çš„åŒ…çš„å‘é€ä¼šå¼•èµ·åŒæ–¹çš„çŠ¶æ€å˜æ›´</li><li>çª—å£å¤§å°ï¼Œåšæµé‡æ§åˆ¶ï¼ŒåŒæ–¹å„è‡ªå£°æ˜ä¸€ä¸ªçª—å£ï¼Œæ ‡è¯†è‡ªå·±å½“å‰çš„å¤„ç†èƒ½åŠ›ï¼Œä¸è¦å‘é€å¾—å¤ªå¿«ä¹Ÿåˆ«å¤ªæ…¢</li></ol><h4 id="TCP-çš„ç‰¹å¾"><a href="#TCP-çš„ç‰¹å¾" class="headerlink" title="TCP çš„ç‰¹å¾"></a>TCP çš„ç‰¹å¾</h4><ul><li>é¡ºåºé—®é¢˜ï¼Œç¨³é‡ä¸ä¹±ï¼›</li><li>ä¸¢åŒ…é—®é¢˜ï¼Œæ‰¿è¯ºé è°±ï¼›</li><li>è¿æ¥ç»´æŠ¤ï¼Œæœ‰å§‹æœ‰ç»ˆï¼›</li><li>æµé‡æ§åˆ¶ï¼ŒæŠŠæ¡åˆ†å¯¸ï¼›</li><li>æ‹¥å¡æ§åˆ¶ï¼ŒçŸ¥è¿›çŸ¥é€€ã€‚</li></ul><h4 id="ä¸‰æ¬¡æ¡æ‰‹å››æ¬¡æŒ¥æ‰‹"><a href="#ä¸‰æ¬¡æ¡æ‰‹å››æ¬¡æŒ¥æ‰‹" class="headerlink" title="ä¸‰æ¬¡æ¡æ‰‹å››æ¬¡æŒ¥æ‰‹"></a>ä¸‰æ¬¡æ¡æ‰‹å››æ¬¡æŒ¥æ‰‹</h4><ol><li><p>ä¸‰æ¬¡æ¡æ‰‹</p><ul><li>â‘  Aï¼šæ‚¨å¥½ï¼Œæˆ‘æ˜¯ A â‘¡ Bï¼šæ‚¨å¥½ Aï¼Œæˆ‘æ˜¯ B â‘¢ Aï¼šæ‚¨å¥½ B</li><li>TCPè¿æ¥çš„å»ºç«‹ç§°ä¸ºä¸‰æ¬¡æ¡æ‰‹ï¼Œâ€œè¯·æ±‚ -&gt; åº”ç­” -&gt; åº”ç­”ä¹‹åº”ç­”â€ï¼Œè®©åŒæ–¹çš„æ¶ˆæ¯éƒ½â€œæœ‰å»æœ‰å›â€</li><li>ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼ŒAåº”ç­”Bçš„åº”ç­”åŒ…ï¼Œèƒ½è§£å†³ä¸€ä¸ªé—®é¢˜ï¼šBæ”¶åˆ°äº†æ¥è‡ªå¾ˆä¹…ä¹‹å‰Açš„å¤šæ¬¡ç”³è¯·è¿æ¥çš„SYNåŒ…ï¼Œå¦‚æœä¸¤æ¬¡æ¡æ‰‹ï¼ŒBè¿™æ—¶å»ºç«‹äº†è¿æ¥å°±ç­‰äºå•ç›¸æ€ï¼Œæ‰€ä»¥éœ€è¦â€œåº”ç­”ä¹‹åº”ç­”â€</li><li>ä¸ºä»€ä¹ˆä¸å››æ¬¡æ¡æ‰‹ï¼Ÿå› ä¸ºå°±ç®—40æ¬¡æ¡æ‰‹ä¹Ÿä¸èƒ½çœŸæ­£ä¿è¯è¿æ¥å°±å»ºç«‹äº†ï¼Œåªè¦åŒæ–¹éƒ½æœ‰å»æœ‰å›å°±åŸºæœ¬è®¤ä¸ºå»ºç«‹äº†ï¼Œå¹¶ä¸”ä¸€èˆ¬Aå’ŒBè¿æ¥å»ºç«‹åå°±å¼€å§‹å‘æ•°æ®ï¼Œä¸€ä½†Aæ–¹å¼€å§‹å‘é€æ•°æ®ï¼Œé—®é¢˜å°±è§£å†³äº†</li><li>å¦‚æœè¿æ¥å»ºç«‹åAä¸€ç›´ä¸å‘æ•°æ®ï¼Œè¿™ä¸ªåœ¨HTTPæœ‰keepaliveæœºåˆ¶ï¼Œå³ä½¿æ²¡æœ‰çœŸå®æ•°æ®åŒ…ä¹Ÿæœ‰æ¢æ´»åŒ…</li><li>Bä¹Ÿå¯ä»¥è®¾è®¡å¯¹äºé•¿æ—¶é—´ä¸å‘åŒ…çš„Aä¸»åŠ¨å…³é—­è¿æ¥</li><li>å¤§å†™<code>ACK</code>ä¸å°å†™<code>ack</code>çš„åŒºåˆ«ï¼šå¤§å†™çš„æ˜¯çŠ¶æ€ä½ï¼Œå½“ä¸º1æ—¶è¡¨ç¤ºåŒ…æ˜¯å›å¤åŒ…ï¼Œå°å†™æ˜¯ç¡®è®¤åºå·ï¼Œå€¼æ˜¯å¯¹æ–¹çš„åºå·<code>seq</code>+1</li></ul><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190606132859.jpg" alt></p></li></ol><p>ä¸€å¼€å§‹ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½å¤„äº <code>CLOSED</code> çŠ¶æ€ã€‚å…ˆæ˜¯æœåŠ¡ç«¯ä¸»åŠ¨ç›‘å¬æŸä¸ªç«¯å£ï¼Œå¤„äº <code>LISTEN</code> çŠ¶æ€ã€‚ç„¶åå®¢æˆ·ç«¯ä¸»åŠ¨å‘èµ·è¿æ¥ <code>SYN</code>ï¼Œä¹‹åå¤„äº <code>SYN-SENT</code> çŠ¶æ€ã€‚æœåŠ¡ç«¯æ”¶åˆ°å‘èµ·çš„è¿æ¥ï¼Œè¿”å› <code>SYN</code>ï¼Œå¹¶ä¸” <code>ACK</code> å®¢æˆ·ç«¯çš„ <code>SYN</code>ï¼Œä¹‹åå¤„äº <code>SYN-RCVD</code> çŠ¶æ€ã€‚å®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡ç«¯å‘é€çš„ <code>SYN</code> å’Œ <code>ACK</code> ä¹‹åï¼Œå‘é€ <code>ACK</code> çš„ <code>ACK</code>ï¼Œä¹‹åå¤„äº <code>ESTABLISHED</code> çŠ¶æ€ï¼Œå› ä¸ºå®ƒä¸€å‘ä¸€æ”¶æˆåŠŸäº†ã€‚æœåŠ¡ç«¯æ”¶åˆ° <code>ACK</code> çš„ <code>ACK</code> ä¹‹åï¼Œå¤„äº <code>ESTABLISHED</code> çŠ¶æ€ï¼Œå› ä¸ºå®ƒä¹Ÿä¸€å‘ä¸€æ”¶äº†ã€‚</p><ol start="2"><li><p>å››æ¬¡æŒ¥æ‰‹</p><ul><li>ç”±äºTCPè¿æ¥æ˜¯å…¨åŒå·¥çš„ï¼Œå› æ­¤æ¯ä¸ªæ–¹å‘éƒ½å¿…é¡»å•ç‹¬è¿›è¡Œå…³é—­ã€‚è¿™ä¸ªåŸåˆ™æ˜¯å½“ä¸€æ–¹å®Œæˆå®ƒçš„æ•°æ®å‘é€ä»»åŠ¡åå°±èƒ½å‘é€ä¸€ä¸ªFINæ¥ç»ˆæ­¢è¿™ä¸ªæ–¹å‘çš„è¿æ¥ã€‚æ”¶åˆ°ä¸€ä¸ª FINåªæ„å‘³ç€è¿™ä¸€æ–¹å‘ä¸Šæ²¡æœ‰æ•°æ®æµåŠ¨ï¼Œä¸€ä¸ªTCPè¿æ¥åœ¨æ”¶åˆ°ä¸€ä¸ªFINåä»èƒ½å‘é€æ•°æ®ã€‚é¦–å…ˆè¿›è¡Œå…³é—­çš„ä¸€æ–¹å°†æ‰§è¡Œä¸»åŠ¨å…³é—­ï¼Œè€Œå¦ä¸€æ–¹æ‰§è¡Œè¢«åŠ¨å…³é—­ã€‚</li></ul><ol><li>å®¢æˆ·ç«¯Aå‘é€ä¸€ä¸ªFINï¼Œç”¨æ¥å…³é—­å®¢æˆ·Aåˆ°æœåŠ¡å™¨Bçš„æ•°æ®ä¼ é€</li><li>æœåŠ¡å™¨Bæ”¶åˆ°è¿™ä¸ªFINï¼Œå®ƒå‘å›ä¸€ä¸ªACKï¼Œç¡®è®¤åºå·ä¸ºæ”¶åˆ°çš„åºå·åŠ 1ã€‚å’ŒSYNä¸€æ ·ï¼Œä¸€ä¸ªFINå°†å ç”¨ä¸€ä¸ªåºå·</li><li>æœåŠ¡å™¨Bå…³é—­ä¸å®¢æˆ·ç«¯Açš„è¿æ¥ï¼Œå‘é€ä¸€ä¸ªFINç»™å®¢æˆ·ç«¯A</li><li>å®¢æˆ·ç«¯Aå‘å›ACKæŠ¥æ–‡ç¡®è®¤ï¼Œå¹¶å°†ç¡®è®¤åºå·è®¾ç½®ä¸ºæ”¶åˆ°åºå·åŠ 1</li></ol><ul><li>ä¸Šé¢2ä¸3çš„è¿‡ç¨‹ä¸­ï¼ŒBå¯èƒ½è¿˜æœ‰è¦å‘ç»™Açš„æ•°æ®æ²¡å‘é€å®Œï¼Œå°±é¦–å…ˆACKäº†Açš„FINåï¼Œç­‰å¤„ç†å®Œæ•°æ®åå†å‘é€FINç»™Aï¼Œæ‰€ä»¥ä¸€å…±éœ€è¦4æ¬¡æŒ¥æ‰‹ã€‚</li></ul><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190606132901.jpg" alt></p></li><li><p>ç™½è¯è§£é‡Šå››æ¬¡æŒ¥æ‰‹</p><ul><li><p>â‘  Aï¼šB å•Šï¼Œæˆ‘ä¸æƒ³ç©äº† â‘¡ Bï¼šå“¦ï¼Œä½ ä¸æƒ³ç©äº†å•Šï¼Œæˆ‘çŸ¥é“äº† â‘¢ Bï¼šA å•Šï¼Œå¥½å§ï¼Œæˆ‘ä¹Ÿä¸ç©äº†ï¼Œæ‹œæ‹œ â‘£ Aï¼šå¥½çš„ï¼Œæ‹œæ‹œã€‚</p></li><li><p>A å¼€å§‹è¯´â€œä¸ç©äº†â€ï¼ŒB è¯´â€œçŸ¥é“äº†â€ï¼Œè¿™ä¸ªå›åˆæ˜¯æ²¡ä»€ä¹ˆé—®é¢˜çš„ï¼Œå› ä¸ºåœ¨æ­¤ä¹‹å‰ï¼ŒåŒæ–¹è¿˜å¤„äºåˆä½œçš„çŠ¶æ€ï¼Œå¦‚æœ A è¯´â€œä¸ç©äº†â€ï¼Œæ²¡æœ‰æ”¶åˆ°å›å¤ï¼Œåˆ™ A ä¼šé‡æ–°å‘é€â€œä¸ç©äº†â€ã€‚ä½†æ˜¯è¿™ä¸ªå›åˆç»“æŸä¹‹åï¼Œå°±æœ‰å¯èƒ½å‡ºç°å¼‚å¸¸æƒ…å†µäº†ï¼Œå› ä¸ºå·²ç»æœ‰ä¸€æ–¹ç‡å…ˆæ’•ç ´è„¸ã€‚</p></li><li><p>ä¸€ç§æƒ…å†µæ˜¯ï¼ŒA è¯´å®Œâ€œä¸ç©äº†â€ä¹‹åï¼Œç›´æ¥è·‘è·¯ï¼Œæ˜¯ä¼šæœ‰é—®é¢˜çš„ï¼Œå› ä¸º B è¿˜æ²¡æœ‰å‘èµ·ç»“æŸï¼Œè€Œå¦‚æœ A è·‘è·¯ï¼ŒB å°±ç®—å‘èµ·ç»“æŸï¼Œä¹Ÿå¾—ä¸åˆ°å›ç­”ï¼ŒB å°±ä¸çŸ¥é“è¯¥æ€ä¹ˆåŠäº†ã€‚å¦ä¸€ç§æƒ…å†µæ˜¯ï¼ŒA è¯´å®Œâ€œä¸ç©äº†â€ï¼ŒB ç›´æ¥è·‘è·¯ï¼Œä¹Ÿæ˜¯æœ‰é—®é¢˜çš„ï¼Œå› ä¸º A ä¸çŸ¥é“ B æ˜¯è¿˜æœ‰äº‹æƒ…è¦å¤„ç†ï¼Œè¿˜æ˜¯è¿‡ä¸€ä¼šå„¿ä¼šå‘é€ç»“æŸã€‚</p></li><li><p>æ–­å¼€çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå½“ A è¯´â€œä¸ç©äº†â€ï¼Œå°±è¿›å…¥ FIN_WAIT_1 çš„çŠ¶æ€ï¼ŒB æ”¶åˆ°â€œA ä¸ç©â€çš„æ¶ˆæ¯åï¼Œå‘é€çŸ¥é“äº†ï¼Œå°±è¿›å…¥ CLOSE_WAIT çš„çŠ¶æ€ã€‚</p></li><li><p>A æ”¶åˆ°â€œB è¯´çŸ¥é“äº†â€ï¼Œå°±è¿›å…¥ FIN_WAIT_2 çš„çŠ¶æ€ï¼Œå¦‚æœè¿™ä¸ªæ—¶å€™ B ç›´æ¥è·‘è·¯ï¼Œåˆ™ A å°†æ°¸è¿œåœ¨è¿™ä¸ªçŠ¶æ€ã€‚TCP åè®®é‡Œé¢å¹¶æ²¡æœ‰å¯¹è¿™ä¸ªçŠ¶æ€çš„å¤„ç†ï¼Œä½†æ˜¯ Linux æœ‰ï¼Œå¯ä»¥è°ƒæ•´ tcp_fin_timeout è¿™ä¸ªå‚æ•°ï¼Œè®¾ç½®ä¸€ä¸ªè¶…æ—¶æ—¶é—´ã€‚</p></li><li><p>å¦‚æœ B æ²¡æœ‰è·‘è·¯ï¼Œå‘é€äº†â€œB ä¹Ÿä¸ç©äº†â€çš„è¯·æ±‚åˆ°è¾¾ A æ—¶ï¼ŒA å‘é€â€œçŸ¥é“ B ä¹Ÿä¸ç©äº†â€çš„ ACK åï¼Œä» FIN_WAIT_2 çŠ¶æ€ç»“æŸï¼ŒæŒ‰è¯´ A å¯ä»¥è·‘è·¯äº†ï¼Œä½†æ˜¯æœ€åçš„è¿™ä¸ª ACK ä¸‡ä¸€ B æ”¶ä¸åˆ°å‘¢ï¼Ÿåˆ™ B ä¼šé‡æ–°å‘ä¸€ä¸ªâ€œB ä¸ç©äº†â€ï¼Œè¿™ä¸ªæ—¶å€™ A å·²ç»è·‘è·¯äº†çš„è¯ï¼ŒB å°±å†ä¹Ÿæ”¶ä¸åˆ° ACK äº†ï¼Œå› è€ŒTCP åè®®è¦æ±‚ A æœ€åç­‰å¾…ä¸€æ®µæ—¶é—´ TIME_WAITï¼Œè¿™ä¸ªæ—¶é—´è¦è¶³å¤Ÿé•¿ï¼Œé•¿åˆ°å¦‚æœ B æ²¡æ”¶åˆ° ACK çš„è¯ï¼Œâ€œB è¯´ä¸ç©äº†â€ä¼šé‡å‘çš„ï¼ŒA ä¼šé‡æ–°å‘ä¸€ä¸ª ACK å¹¶ä¸”è¶³å¤Ÿæ—¶é—´åˆ°è¾¾ Bã€‚</p></li><li><p>A ç›´æ¥è·‘è·¯è¿˜æœ‰ä¸€ä¸ªé—®é¢˜æ˜¯ï¼ŒA çš„ç«¯å£å°±ç›´æ¥ç©ºå‡ºæ¥äº†ï¼Œä½†æ˜¯ B ä¸çŸ¥é“ï¼ŒB åŸæ¥å‘è¿‡çš„å¾ˆå¤šåŒ…å¾ˆå¯èƒ½è¿˜åœ¨è·¯ä¸Šï¼Œå¦‚æœ A çš„ç«¯å£è¢«ä¸€ä¸ªæ–°çš„åº”ç”¨å ç”¨äº†ï¼Œè¿™ä¸ªæ–°çš„åº”ç”¨ä¼šæ”¶åˆ°ä¸Šä¸ªè¿æ¥ä¸­ B å‘è¿‡æ¥çš„åŒ…ï¼Œè™½ç„¶åºåˆ—å·æ˜¯é‡æ–°ç”Ÿæˆçš„ï¼Œä½†æ˜¯è¿™é‡Œè¦ä¸Šä¸€ä¸ªåŒä¿é™©ï¼Œé˜²æ­¢äº§ç”Ÿæ··ä¹±ï¼Œå› è€Œä¹Ÿéœ€è¦ç­‰è¶³å¤Ÿé•¿çš„æ—¶é—´ï¼Œç­‰åˆ°åŸæ¥ B å‘é€çš„æ‰€æœ‰çš„åŒ…éƒ½æ­»ç¿˜ç¿˜ï¼Œå†ç©ºå‡ºç«¯å£æ¥ã€‚</p></li><li><p>ç­‰å¾…çš„æ—¶é—´è®¾ä¸º 2MSLï¼ŒMSLæ˜¯Maximum Segment Lifetimeï¼ŒæŠ¥æ–‡æœ€å¤§ç”Ÿå­˜æ—¶é—´ï¼Œå®ƒæ˜¯ä»»ä½•æŠ¥æ–‡åœ¨ç½‘ç»œä¸Šå­˜åœ¨çš„æœ€é•¿æ—¶é—´ï¼Œè¶…è¿‡è¿™ä¸ªæ—¶é—´æŠ¥æ–‡å°†è¢«ä¸¢å¼ƒã€‚å› ä¸º TCP æŠ¥æ–‡åŸºäºæ˜¯ IP åè®®çš„ï¼Œè€Œ IP å¤´ä¸­æœ‰ä¸€ä¸ªTTL åŸŸï¼Œæ˜¯ IP æ•°æ®æŠ¥å¯ä»¥ç»è¿‡çš„æœ€å¤§è·¯ç”±æ•°ï¼Œæ¯ç»è¿‡ä¸€ä¸€ä¸ªå¤„ç†ä»–çš„è·¯ç”±å™¨æ­¤å€¼å°±å‡ 1ï¼Œå½“æ­¤å€¼ä¸º 0 åˆ™æ•°æ®æŠ¥å°†è¢«ä¸¢å¼ƒï¼ŒåŒæ—¶å‘é€ ICMP æŠ¥æ–‡é€šçŸ¥æºä¸»æœºã€‚åè®®è§„å®š MSL ä¸º2 åˆ†é’Ÿï¼Œå®é™…åº”ç”¨ä¸­å¸¸ç”¨çš„æ˜¯ 30 ç§’ï¼Œ1 åˆ†é’Ÿå’Œ 2 åˆ†é’Ÿç­‰ã€‚</p></li><li><p>è¿˜æœ‰ä¸€ä¸ªå¼‚å¸¸æƒ…å†µå°±æ˜¯ï¼ŒB è¶…è¿‡äº† 2MSL çš„æ—¶é—´ï¼Œä¾ç„¶æ²¡æœ‰æ”¶åˆ°å®ƒå‘çš„ FIN çš„ ACKï¼Œæ€ä¹ˆåŠå‘¢ï¼ŸæŒ‰ç…§ TCP çš„åŸç†ï¼ŒB å½“ç„¶è¿˜ä¼šé‡å‘ FINï¼Œè¿™ä¸ªæ—¶å€™ A å†æ”¶åˆ°è¿™ä¸ªåŒ…ä¹‹åï¼ŒA å°±è¡¨ç¤ºï¼Œæˆ‘å·²ç»åœ¨è¿™é‡Œç­‰äº†è¿™ä¹ˆé•¿æ—¶é—´äº†ï¼Œå·²ç»ä»è‡³ä¹‰å°½äº†ï¼Œä¹‹åçš„æˆ‘å°±éƒ½ä¸è®¤äº†ï¼Œäºæ˜¯å°±ç›´æ¥å‘é€ RSTï¼ŒB å°±çŸ¥é“ A æ—©å°±è·‘äº†ã€‚</p></li></ul></li><li><p>TCP çŠ¶æ€æœº</p></li></ol><ul><li>æŠŠä¸Šé¢ä¸¤ä¸ªæ—¶åºå›¾åˆå¹¶èµ·æ¥å°±æ˜¯è¿™ä¸ªTCPçŠ¶æ€æœºå›¾</li></ul><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190606132904.jpg" alt></p><ul><li>åŠ é»‘åŠ ç²—çš„éƒ¨åˆ†æ˜¯ä¸»è¦æµç¨‹ï¼Œé˜¿æ‹‰ä¼¯æ•°å­—çš„åºå·æ˜¯è¿æ¥å»ºç«‹çš„é¡ºåºï¼Œå¤§å†™ä¸­æ–‡æ•°å­—çš„åºå·æ˜¯è¿æ¥æ–­å¼€çš„é¡ºåºã€‚åŠ ç²—å®çº¿æ˜¯å®¢æˆ·ç«¯Açš„çŠ¶æ€å˜åŒ–è¿‡ç¨‹ï¼ŒåŠ ç²—è™šçº¿æ˜¯æœåŠ¡ç«¯Bçš„çŠ¶æ€å˜åŒ–è¿‡ç¨‹ã€‚ç»†è™šçº¿æ˜¯å…¶ä»–éä¸»æµè¿‡ç¨‹ã€‚</li></ul><h4 id="TCP-çš„é¡ºåºæœºåˆ¶"><a href="#TCP-çš„é¡ºåºæœºåˆ¶" class="headerlink" title="TCP çš„é¡ºåºæœºåˆ¶"></a>TCP çš„é¡ºåºæœºåˆ¶</h4><ul><li><p>æ¯ä¸ªåŒ…éƒ½æœ‰ä¸€ä¸ªIDï¼ŒæŒ‰ç…§IDä¸€ä¸ªä¸ªå‘é€</p></li><li><p>ç´¯è®¡ç¡®è®¤ï¼ˆç´¯è®¡åº”ç­”ï¼‰</p><ul><li>å‘é€ç«¯å’Œæ¥æ”¶ç«¯åˆ†åˆ«æœ‰ç¼“å­˜ä¿å­˜è®°å½•æ‰€æœ‰å‘é€å’Œæ¥æ”¶çš„åŒ…</li></ul></li></ul><ol><li><p>å‘é€ç«¯çª—å£</p><ul><li><p>å‘é€ç«¯çš„ç¼“å­˜é‡Œæ˜¯æŒ‰ç…§åŒ…IDæ’åˆ—çš„ï¼Œæœ‰å››ç§ç±»å‹</p><ol><li>å‘é€äº†ä¸”å·²ç¡®è®¤</li><li>å‘é€äº†ä¸”å°šæœªç¡®è®¤</li><li>è¿˜æ²¡å‘é€ä½†ç­‰å¾…å‘é€</li><li>è¿˜æ²¡å‘é€ä¸”æš‚æ—¶ä¸ä¼šå‘é€</li></ol><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190606145507.jpg" alt></p></li><li><p>ä¸Šé¢3å’Œ4çš„åŒºåˆ†æ˜¯æµé‡æ§åˆ¶</p><ol><li>æµé‡æ§åˆ¶ä½¿ç”¨çª—å£ï¼ˆ<code>Advertised Window</code>ï¼‰ï¼Œçª—å£å¤§å°ç­‰äºä¸Šé¢2+3éƒ¨åˆ†ï¼Œå³å‘é€æœªç¡®è®¤å’Œæœªå‘é€ä½†å¯å‘é€çš„</li><li><code>LastByteAcked</code>ï¼šç¬¬ä¸€éƒ¨åˆ†å’Œç¬¬äºŒéƒ¨åˆ†çš„åˆ†ç•Œçº¿</li><li><code>LastByteSent</code>ï¼šç¬¬äºŒéƒ¨åˆ†å’Œç¬¬ä¸‰éƒ¨åˆ†çš„åˆ†ç•Œçº¿</li><li><code>LastByteAcked + AdvertisedWindow</code>ï¼šç¬¬ä¸‰éƒ¨åˆ†å’Œç¬¬å››éƒ¨åˆ†çš„åˆ†ç•Œçº¿</li></ol></li></ul></li><li><p>æ¥æ”¶ç«¯çª—å£</p><ul><li>æ¥æ”¶ç«¯çš„ç¼“å­˜é‡Œæ˜¯æŒ‰ç…§åŒ…IDæ’åˆ—çš„ï¼Œæœ‰ä¸‰ç§ç±»å‹<ol><li>æ¥æ”¶ä¸”ç¡®è®¤è¿‡</li><li>å°šæœªæ¥æ”¶ä½†å¯æ¥æ”¶</li><li>å°šæœªæ¥æ”¶ä¸”ä¸èƒ½æ¥æ”¶</li></ol></li></ul><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190606145846.jpg" alt></p><ul><li><p>æµé‡æ§åˆ¶ä½¿ç”¨çª—å£ï¼ˆ<code>AdvertisedWindow</code>ï¼‰ï¼Œçª—å£å¤§å°æ˜¯ä¸Šé¢ç¬¬2éƒ¨åˆ†ï¼Œéœ€è¦è®¡ç®—</p><ol><li><code>MaxRcvBuffer</code>ï¼šæœ€å¤§ç¼“å­˜çš„é‡ï¼›</li><li><code>LastByteRead</code> ä¹‹åæ˜¯å·²ç»æ¥æ”¶äº†ï¼Œä½†æ˜¯è¿˜æ²¡è¢«åº”ç”¨å±‚è¯»å–çš„ï¼›</li><li><code>NextByteExpected</code> æ˜¯ç¬¬ä¸€éƒ¨åˆ†å’Œç¬¬äºŒéƒ¨åˆ†çš„åˆ†ç•Œçº¿ã€‚</li></ol><ul><li><code>NextByteExpected</code> å’Œ <code>LastByteRead</code> çš„å·®å…¶å®æ˜¯è¿˜æ²¡è¢«åº”ç”¨å±‚è¯»å–çš„éƒ¨åˆ†å ç”¨æ‰çš„ <code>MaxRcvBuffer</code> çš„é‡ï¼Œæˆ‘ä»¬å®šä¹‰ä¸º <code>A</code>ã€‚</li><li><code>AdvertisedWindow</code> å…¶å®æ˜¯ <code>MaxRcvBuffer</code> å‡å» <code>A</code>ï¼Œå³ç¬¬2éƒ¨åˆ†çš„å¤§å°</li><li>ä¹Ÿå°±æ˜¯ï¼š<code>AdvertisedWindow = MaxRcvBuffer - ((NextByteExpected-1) - LastByteRead)</code>ã€‚</li><li>ç¬¬2éƒ¨åˆ†å’Œç¬¬3éƒ¨åˆ†çš„åˆ†ç•Œçº¿å°±æ˜¯ <code>NextByteExpected</code> + <code>AdvertisedWindow</code>ï¼Œå³ <code>LastByteRead</code> + <code>MaxRcvBuffer</code></li></ul></li></ul></li></ol><h4 id="TCP-çš„ä¸¢åŒ…é‡å‘æœºåˆ¶"><a href="#TCP-çš„ä¸¢åŒ…é‡å‘æœºåˆ¶" class="headerlink" title="TCP çš„ä¸¢åŒ…é‡å‘æœºåˆ¶"></a>TCP çš„ä¸¢åŒ…é‡å‘æœºåˆ¶</h4><ol><li><p>ç¡®è®¤ä¸é‡å‘æœºåˆ¶</p><ul><li>è¶…æ—¶é‡è¯•ï¼Œæ²¡æœ‰<code>ACK</code>çš„åŒ…éƒ½æœ‰è®¾ä¸€ä¸ªå®šæ—¶å™¨ï¼Œè¶…è¿‡ä¸€å®šæ—¶é—´å°±é‡æ–°å°è¯•</li><li>è¶…æ—¶æ—¶é—´éœ€è¦å¤§äºå¾€è¿”æ—¶é—´ RTTï¼Œä¹Ÿä¸å®œè¿‡é•¿</li></ul></li><li><p>è‡ªé€‚åº”é‡ä¼ ç®—æ³•</p><ul><li>TCP é€šè¿‡é‡‡æ · RTT æ—¶é—´å’Œ RTT çš„æ³¢åŠ¨èŒƒå›´ï¼Œè¿›è¡ŒåŠ æƒå¹³å‡ï¼Œç®—å‡ºä¸€ä¸ªå€¼ï¼Œè¿˜éœ€è¦æ ¹æ®æ–°çŠ¶å†µä¸æ–­å˜åŒ–</li><li>è¶…æ—¶è§¦å‘é‡ä¼ çš„é—®é¢˜æ˜¯è¶…æ—¶å‘¨æœŸå¯èƒ½å¾ˆé•¿</li></ul></li><li><p>å¿«é€Ÿé‡ä¼ æœºåˆ¶</p><ul><li>å½“æ¥æ”¶æ–¹æ”¶åˆ°ä¸€ä¸ªåºå·å¤§äºä¸‹ä¸€ä¸ªæ‰€æœŸæœ›çš„æŠ¥æ–‡æ®µæ—¶ï¼Œå°±æ£€æµ‹åˆ°äº†æ•°æ®æµä¸­çš„ä¸€ä¸ªé—´æ ¼ï¼Œäºæ˜¯å‘é€ä¸‰ä¸ªå†—ä½™çš„ ACKï¼Œå®¢æˆ·ç«¯æ”¶åˆ°åï¼Œå°±åœ¨å®šæ—¶å™¨è¿‡æœŸä¹‹å‰ï¼Œé‡ä¼ ä¸¢å¤±çš„æŠ¥æ–‡æ®µã€‚</li><li>è¿˜æœ‰ä¸€ç§æ–¹å¼ <code>SACK</code> (Selective Acknowledgment)ï¼Œåœ¨TCPå¤´é‡ŒåŠ ä¸€ä¸ªSACKï¼Œå¯ä»¥æŠŠå¯ä»¥å°†ç¼“å­˜çš„åœ°å›¾å‘é€ç»™å‘é€æ–¹ã€‚</li></ul></li></ol><h4 id="TCP-çš„æµé‡æ§åˆ¶æœºåˆ¶"><a href="#TCP-çš„æµé‡æ§åˆ¶æœºåˆ¶" class="headerlink" title="TCP çš„æµé‡æ§åˆ¶æœºåˆ¶"></a>TCP çš„æµé‡æ§åˆ¶æœºåˆ¶</h4><ul><li><p>å¦‚æœå‘é€æ–¹å‘é€å¤ªçŒ›ï¼Œæ¥æ”¶æ–¹å¤„ç†ä¸è¿‡æ¥å¯¼è‡´ç¼“å­˜ä¸­æ²¡æœ‰ç©ºé—´ï¼Œå¯ä»¥é€šè¿‡ç¡®è®¤ä¿¡æ¯ä¿®æ”¹çª—å£å¤§å°ï¼Œç”šè‡³è®¾ä¸º0ï¼Œä½¿å‘é€æ–¹æš‚æ—¶åœæ­¢å‘é€</p></li><li><p>å½“å‘é€æ–¹å‘ç°è‡ªå·±çª—å£è¢«è°ƒæ•´åˆ°0åï¼Œä¼šå®šæ—¶å‘é€çª—å£æ¢æµ‹æ•°æ®åŒ…ï¼Œçœ‹æ˜¯å¦æœ‰æœºä¼šè°ƒæ•´çª—å£å¤§å°</p></li><li><p>å½“æ¥æ”¶æ–¹æ¯”è¾ƒæ…¢æ—¶ï¼Œè¦é˜²æ­¢ä½èƒ½çª—å£ç»¼åˆå¾ï¼Œé¿å…ç©ºå‡ºä¸€ä¸ªå­—èŠ‚å°±é€šçŸ¥å‘é€æ–¹ç„¶ååˆå¡«æ»¡çª—å£ã€‚å½“çª—å£å¤ªå°æ—¶ï¼Œå¯ä»¥æš‚åœæ›´æ–°çª—å£ï¼Œç›´åˆ°çª—å£è¾¾åˆ°ä¸€å®šå¤§å°æˆ–è€…ç¼“å†²åŒºä¸€åŠä¸ºç©ºï¼Œæ‰æ›´æ–°çª—å£</p></li></ul><h4 id="TCP-çš„æ‹¥å¡æ§åˆ¶æœºåˆ¶"><a href="#TCP-çš„æ‹¥å¡æ§åˆ¶æœºåˆ¶" class="headerlink" title="TCP çš„æ‹¥å¡æ§åˆ¶æœºåˆ¶"></a>TCP çš„æ‹¥å¡æ§åˆ¶æœºåˆ¶</h4><ol><li><p>ä¹Ÿæ˜¯é€šè¿‡çª—å£å¤§å°æ§åˆ¶ï¼Œæ»‘åŠ¨çª—å£ <code>rwnd</code> æ˜¯æ€•å‘é€æ–¹æŠŠæ¥æ”¶æ–¹ç¼“å­˜å æ»¡ï¼Œæ‹¥å¡çª—å£ <code>cwnd</code> æ˜¯æ€•æŠŠç½‘ç»œå¡æ»¡</p><ul><li><p><code>LastByteSent - LastByteAcked &lt;= min {cwnd, rwnd}</code>ï¼Œæ˜¯æ‹¥å¡çª—å£å’Œæ»‘åŠ¨çª—å£å…±åŒæ§åˆ¶å‘é€çš„é€Ÿåº¦</p></li><li><p>å‘é€æ–¹éš¾ä»¥åˆ¤æ–­ç½‘ç»œæ˜¯å¦æ»¡çš„æ–¹æ³•ï¼Œåœ¨TCPçœ‹æ¥ç½‘ç»œè·¯å¾„æ˜¯ä¸€ä¸ªé»‘ç›’</p></li><li><p>TCP å‘é€åŒ…å¸¸è¢«æ¯”å–»ä¸ºå¾€ä¸€ä¸ªæ°´ç®¡é‡Œé¢çŒæ°´ï¼Œè€Œ TCP çš„æ‹¥å¡æ§åˆ¶å°±æ˜¯åœ¨ä¸å µå¡ï¼Œä¸ä¸¢åŒ…çš„æƒ…å†µä¸‹ï¼Œå°½é‡å‘æŒ¥å¸¦å®½ã€‚</p></li></ul></li></ol><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190606152532.jpg" alt></p><ol start="2"><li><p>TCP çš„æ‹¥å¡æ§åˆ¶ä¸»è¦ç”¨æ¥é¿å…ä¸¤ç§ç°è±¡ï¼šåŒ…ä¸¢å¤±å’Œè¶…æ—¶é‡ä¼ </p><ul><li><p>ä¸€æ—¦å‡ºç°äº†è¿™äº›ç°è±¡å°±è¯´æ˜ï¼Œå‘é€é€Ÿåº¦å¤ªå¿«äº†ï¼Œè¦æ…¢ä¸€ç‚¹ã€‚ä½†æ˜¯ä¸€å¼€å§‹æˆ‘æ€ä¹ˆçŸ¥é“é€Ÿåº¦å¤šå¿«å‘¢ï¼Œæˆ‘æ€ä¹ˆçŸ¥é“åº”è¯¥æŠŠçª—å£è°ƒæ•´åˆ°å¤šå¤§å‘¢ï¼Ÿ</p></li><li><p>æ…¢å¯åŠ¨ï¼šä¸€å¼€å§‹ <code>cwnd</code> å¤§å°ä¸ºä¸€ä¸ªæŠ¥æ–‡æ®µï¼Œå½“æ”¶åˆ°ç¡®è®¤æ—¶æŒ‡æ•°å‹å¢å¤§<code>cwnd</code>å¤§å°</p></li><li><p>æŒ‡æ•°å‹æ¶¨åˆ°ä¸€ä¸ªå€¼ä¸º65535å­—èŠ‚çš„ <code>ssthresh</code> æ—¶é™ä¸ºçº¿æ€§å¢é•¿ï¼Œæ¯8ä¸ªç¡®è®¤<code>cwnd</code>å¢åŠ 1ï¼Œä½†æ€»æœ‰æº¢å‡ºçš„æ—¶å€™ã€‚</p></li><li><p>å½“å‡ºç°æ‹¥å¡å³ä¸¢åŒ…æ—¶ï¼Œéœ€è¦è¶…æ—¶é‡ä¼ ï¼Œ<code>ssthresh</code>è®¾ä¸º<code>cwnd/2</code>ï¼Œ<code>cwnd</code>è®¾ä¸º1ï¼Œé‡æ–°å¼€å§‹æ…¢å¯åŠ¨ï¼Œä¸€å¤œå›åˆ°è§£æ”¾å‰ã€‚</p></li></ul></li><li><p>å¿«é€Ÿé‡ä¼ </p><ul><li><p>å½“æ¥æ”¶ç«¯å‘ç°ä¸¢äº†ä¸€ä¸ªä¸­é—´åŒ…æ—¶ï¼Œå‘é€ä¸‰æ¬¡å‰ä¸€ä¸ªåŒ…çš„ACKï¼Œäºæ˜¯å‘é€ç«¯å°±ä¼šå¿«é€Ÿé‡ä¼ ï¼Œä¸å¿…ç­‰å¾…è¶…æ—¶é‡ä¼ ã€‚</p></li><li><p>æ­¤æ—¶<code>cwnd</code> = <code>cwnd</code> / 2ï¼Œ <code>sshthresh</code> = <code>cwnd</code>ï¼Œå½“ä¸‰ä¸ªåŒ…è¿”å›æ—¶ï¼Œ<code>cwnd = sshthresh + 3</code></p></li><li><p>ä¹Ÿå°±æ˜¯ä¸ç”¨å›åˆ°è§£æ”¾å‰ï¼Œåªæ˜¯å‡åŠè€Œå·²</p></li></ul><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190606153531.jpg" alt></p><ul><li><p>è¿™ç§æœºåˆ¶å¯¼è‡´å»¶è¿Ÿé«˜çš„æƒ…å†µä¸‹ï¼Œåè€Œé™ä½é€Ÿåº¦ï¼Œå¯¼è‡´æœ¬æ–‡å‰é¢UDPéƒ¨åˆ†é‡Œè¯´çš„TCPçš„é—®é¢˜</p><ol><li><p>ä¸¢åŒ…ä¸ä»£è¡¨é€šé“æ»¡äº†ï¼Œå¯èƒ½æœ¬èº«å…¬ç½‘å°±æ˜¯ä¼šä¸¢åŒ…çš„ï¼Œè¿™æ—¶å…¶å®å¹¶æ²¡æœ‰æ‹¥å¡</p></li><li><p>TCP çš„æ‹¥å¡æ§åˆ¶è¦ç­‰åˆ°å°†ä¸­é—´è®¾å¤‡éƒ½å¡«å……æ»¡äº†æ‰å‘ç”Ÿä¸¢åŒ…ï¼Œä»è€Œé™ä½å‘é€é€Ÿåº¦ï¼Œæ­¤æ—¶å·²ç»æ™šäº†ï¼Œå…¶å®TCPåªè¦é€šé“æ»¡äº†å°±åº”è¯¥å¼€å§‹æ§åˆ¶äº†ï¼Œè€Œä¸åº”è¯¥ç­‰åˆ°è¿ç¼“å­˜éƒ½æ»¡äº†æ‰æ§åˆ¶</p></li></ol></li><li><p>è§£å†³æ–¹æ³•ï¼š<code>BBR</code> æ‹¥å¡ç®—æ³•ï¼Œæ‰¾åˆ°ä¸€ä¸ªå¹³è¡¡ç‚¹ï¼Œå¡«æ»¡ç®¡é“ä½†æ˜¯ä¸å¡«æ»¡ä¸­é—´è®¾å¤‡çš„ç¼“å­˜ï¼Œè¾¾åˆ°é«˜å¸¦å®½å’Œä½æ—¶å»¶çš„å¹³è¡¡</p></li></ul><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190606153950.jpg" alt></p></li></ol><h4 id="TCP-å°ç»“"><a href="#TCP-å°ç»“" class="headerlink" title="TCP å°ç»“"></a>TCP å°ç»“</h4><ul><li>TCP åŒ…å¤´å¾ˆå¤æ‚ï¼Œä½†æ˜¯ä¸»è¦å…³æ³¨äº”ä¸ªé—®é¢˜ï¼Œé¡ºåºé—®é¢˜ï¼Œä¸¢åŒ…é—®é¢˜ï¼Œè¿æ¥ç»´æŠ¤ï¼Œæµé‡æ§åˆ¶ï¼Œæ‹¥å¡æ§åˆ¶</li><li>è¿æ¥çš„å»ºç«‹æ˜¯ç»è¿‡ä¸‰æ¬¡æ¡æ‰‹ï¼Œæ–­å¼€çš„æ—¶å€™å››æ¬¡æŒ¥æ‰‹</li><li>é¡ºåºé—®é¢˜ã€ä¸¢åŒ…é—®é¢˜ã€æµé‡æ§åˆ¶éƒ½æ˜¯é€šè¿‡æ»‘åŠ¨çª—å£æ¥è§£å†³çš„</li><li>æ‹¥å¡æ§åˆ¶æ˜¯é€šè¿‡æ‹¥å¡çª—å£æ¥è§£å†³çš„</li></ul>]]></content>
      
      
      <categories>
          
          <category> Tech </category>
          
      </categories>
      
      
        <tags>
            
            <tag> NetworkProtocol </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ‚è°ˆç½‘ç»œåè®®ä¹‹ HTTPã€HTTPS å’Œ TLS</title>
      <link href="/2019-06-03-network-protocol-https/"/>
      <url>/2019-06-03-network-protocol-https/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘å­¦äº†äº›HTTPç›¸å…³çš„å†…å®¹ï¼Œåšäº†äº›ç¬”è®°ï¼Œæ·±å…¥äº†è§£TLSåæ„Ÿè§‰å¯†ç å­¦æŒºæœ‰æ„æ€ã€‚</p><a id="more"></a><p><a href="https://paaatrick.com/2019-06-06-network-protocol-ip-tcp-udp/">å…³äºTCP/IPçš„å†…å®¹é“¾æ¥</a></p><h2 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h2><h4 id="HTTP-0-9"><a href="#HTTP-0-9" class="headerlink" title="HTTP/0.9"></a>HTTP/0.9</h4><ul><li>è¿™æ˜¯åæ¥å›æ¥å®šä¹‰çš„ç‰ˆæœ¬ï¼Œè¿™ä¸ªåˆå§‹ç‰ˆæœ¬é‡‡ç”¨çº¯æ–‡æœ¬æ ¼å¼</li><li>åªæœ‰GETåŠ¨ä½œï¼Œåœ¨å“åº”è¯·æ±‚åç«‹å³å…³é—­è¿æ¥ï¼ŒåŠŸèƒ½éå¸¸æœ‰é™</li></ul><h4 id="HTTP-1-0"><a href="#HTTP-1-0" class="headerlink" title="HTTP/1.0"></a>HTTP/1.0</h4><ul><li>1996å¹´å‘å¸ƒï¼Œä¸1.1å·®ä¸äº†å¤šå°‘äº†<ol><li>å¢åŠ äº†<code>HEAD</code>ã€<code>POST</code>ç­‰æ–¹æ³•</li><li>å¢åŠ å“åº”çŠ¶æ€ç ï¼Œæ ‡è®°å¯èƒ½çš„é”™è¯¯åŸå› </li><li>å¼•å…¥åè®®ç‰ˆæœ¬å·æ¦‚å¿µ</li><li>å¼•å…¥äº†<code>Header</code>å¤´éƒ¨çš„æ¦‚å¿µ</li><li>ä¼ è¾“çš„æ•°æ®ä¸å†ä»…é™äºæ–‡æœ¬</li></ol></li><li>ä½†æ˜¯1.0å¹¶ä¸æ˜¯ä¸€ä¸ªæ ‡å‡†ï¼Œåªç›¸å½“äºä¸€ä¸ªå¤‡å¿˜å½•ï¼ˆå‚è€ƒæ–‡æ¡£ï¼‰</li></ul><h4 id="HTTP-1-1"><a href="#HTTP-1-1" class="headerlink" title="HTTP/1.1"></a>HTTP/1.1</h4><ul><li>1999å¹´ï¼Œå‘å¸ƒRFCæ–‡æ¡£ç¼–å·2616ï¼Œæ˜¯ä¸ªæ­£å¼çš„æ ‡å‡†<ol><li>å¢åŠ äº†<code>PUT</code>ã€<code>DELETE</code>ç­‰æ–¹æ³•</li><li>å¢åŠ äº†ç¼“å­˜ç®¡ç†å’Œæ§åˆ¶</li><li>æ˜ç¡®äº†è¿æ¥ç®¡ç†ï¼Œå…è®¸æŒä¹…è¿æ¥</li><li>å…è®¸å“åº”æ•°æ®åˆ†å—ï¼ˆ<code>chunked</code>ï¼‰ï¼Œåˆ©äºä¼ è¾“å¤§æ–‡ä»¶</li><li>å¼ºåˆ¶è¦æ±‚<code>Host</code>å¤´ï¼Œè®©äº’è”ç½‘ä¸»æœºæ‰˜ç®¡æˆä¸ºå¯èƒ½</li></ol></li></ul><h6 id="HTTPè¯·æ±‚æŠ¥æ–‡æ ¼å¼"><a href="#HTTPè¯·æ±‚æŠ¥æ–‡æ ¼å¼" class="headerlink" title="HTTPè¯·æ±‚æŠ¥æ–‡æ ¼å¼"></a>HTTPè¯·æ±‚æŠ¥æ–‡æ ¼å¼</h6><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190606155246.jpg" alt></p><ul><li>è¯·æ±‚æ–¹æ³• | URL | åè®®ç‰ˆæœ¬</li><li><code>Header</code>å¤´éƒ¨ï¼ˆä¸€è¡Œä¸€ä¸ªå­—æ®µï¼Œkey-valueï¼Œä¸­é—´å†’å·åˆ†éš”ï¼‰</li><li>ç©ºè¡Œ</li><li>è¯·æ±‚åŒ…ä½“(GETæ²¡æœ‰,POSTç”¨)(GETä¹Ÿå¯ä»¥å¡«body,æœåŠ¡ç«¯ä¸ä¸€å®šå¤„ç†)</li></ul><h6 id="HTTPå“åº”æŠ¥æ–‡æ ¼å¼"><a href="#HTTPå“åº”æŠ¥æ–‡æ ¼å¼" class="headerlink" title="HTTPå“åº”æŠ¥æ–‡æ ¼å¼"></a>HTTPå“åº”æŠ¥æ–‡æ ¼å¼</h6><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190606155333.jpg" alt></p><ul><li>åè®®ç‰ˆæœ¬ | çŠ¶æ€ç  | çŠ¶æ€ç æè¿°</li><li><code>Header</code>å¤´éƒ¨ï¼ˆä¸€è¡Œä¸€ä¸ªå­—æ®µï¼Œkey-valueï¼Œä¸­é—´å†’å·åˆ†éš”ï¼‰</li><li>ç©ºè¡Œ</li><li>å“åº”åŒ…ä½“</li></ul><h6 id="å¸¸è§çš„Header"><a href="#å¸¸è§çš„Header" class="headerlink" title="å¸¸è§çš„Header"></a>å¸¸è§çš„Header</h6><ol><li>Accept-Charsetï¼š æ•°æ®ç¼–ç æ ¼å¼</li><li>Content-Typeï¼š æ•°æ®çš„ç±»å‹</li><li>Cache-controlï¼šmax-ageï¼Œå®¢æˆ·ç«¯çš„è¯å°±æ˜¯å¸Œæœ›å¤šæ–°çš„ç¼“å­˜ï¼ŒæœåŠ¡ç«¯çš„è¯å°±æ˜¯å‘Šè¯‰å®¢æˆ·ç«¯æŸä¸ªæ—¶é—´æ®µå†…çš„æ•°æ®éƒ½æ˜¯æœ€æ–°çš„</li><li>If-Modified-Sinceï¼šå¦‚æœæœåŠ¡å™¨çš„èµ„æºåœ¨æŸä¸ªæ—¶é—´ä¹‹åæ›´æ–°äº†ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯å°±åº”è¯¥ä¸‹è½½æœ€æœ€æ–°çš„èµ„æºï¼›å¦‚æœæ²¡æœ‰æ›´æ–°ï¼ŒæœåŠ¡ç«¯ä¼šè¿”å›304 Not Modifiedçš„å“åº”ï¼Œé‚£å®¢æˆ·ç«¯å°±ä¸ç”¨ä¸‹è½½äº†</li><li>Retry-Afterï¼šå‘Šè¯‰å®¢æˆ·ç«¯åº”è¯¥åœ¨å¤šé•¿æ—¶é—´ä»¥åå†æ¬¡å°è¯•ä¸€ä¸‹</li><li>Connectionï¼šä¸€èˆ¬æ˜¯keep-aliveï¼Œç”¨æ¥ä¿æ´»TCPè¿æ¥ï¼Œcloseçš„è¯å°±æ˜¯ä¼ è¾“å®Œåå°±å…³é—­TCPè¿æ¥</li><li>Refererï¼šå®¢æˆ·ç«¯å‘Šè¯‰æœåŠ¡ç«¯æˆ‘æ˜¯ä»å“ªä¸ªé“¾æ¥æ¥çš„ï¼ŒæœåŠ¡ç«¯æ”¶åˆ°åå¯ä»¥åšå¤„ç†ï¼Œé‡å®šå‘ï¼Œæˆ–è€…ç”¨äºæ”¯ä»˜åçš„å›è°ƒï¼ˆå¾®ä¿¡æ”¯ä»˜ï¼‰</li><li>User-Agentï¼šè€ç”Ÿå¸¸è°ˆï¼Œæ“ä½œç³»ç»Ÿå’Œæµè§ˆå™¨åç§°ç‰ˆæœ¬ï¼Œå¾ˆå¤šéªšæ“ä½œ</li></ol><h6 id="ä¸€äº›ç‰¹ç‚¹"><a href="#ä¸€äº›ç‰¹ç‚¹" class="headerlink" title="ä¸€äº›ç‰¹ç‚¹"></a>ä¸€äº›ç‰¹ç‚¹</h6><ol><li>ä¸€èˆ¬POSTæ—¶ï¼Œå…ˆå‘é€headerï¼ŒæœåŠ¡å™¨å“åº” 100 Continue åï¼Œæµè§ˆå™¨å†å‘é€Dataï¼ŒæœåŠ¡å™¨å“åº” 200 OKï¼Œå¯èƒ½åˆ†ä¸¤ä¸ªTCPåŒ…</li><li>headeræ˜¯key-valueï¼Œä¸­é—´å†’å·åˆ†éš”</li><li>HTTPå³è¶…æ–‡æœ¬ä¼ è¾“åè®® HyperTextTransferProtocol, æ˜¯ä¸€ä¸ªåœ¨è®¡ç®—æœºä¸–ç•Œé‡Œä¸“é—¨åœ¨ä¸¤ç‚¹ä¹‹é—´ä¼ è¾“æ–‡å­—ã€å›¾ç‰‡ã€éŸ³é¢‘ã€è§†é¢‘ç­‰è¶…æ–‡æœ¬æ•°æ®çš„çº¦å®šå’Œè§„èŒƒ</li><li>HTTPæ²¡æœ‰å®ä½“ï¼Œä¸æ˜¯äº’è”ç½‘ï¼Œä¸æ˜¯è¯­è¨€ï¼Œä¸æ˜¯HTMLï¼Œä¸æ˜¯å­¤ç«‹çš„åè®®ã€‚</li><li>HTTPæ˜¯åŸºäºTCPçš„ï¼ŒTCPçš„é‡ä¼ HTTPä¸çŸ¥é“</li><li>ç”±äºæœ‰Keep-Aliveæœºåˆ¶ï¼Œæ¯æ¬¡HTTPè¿æ¥æ— éœ€TCPé‡æ–°æ¡æ‰‹</li></ol><h4 id="HTTP-2-0"><a href="#HTTP-2-0" class="headerlink" title="HTTP/2.0"></a>HTTP/2.0</h4><ul><li>HTTP2.0é€šè¿‡å¤´å‹ç¼©ã€åˆ†å¸§ã€å¤šè·¯å¤ç”¨ç­‰æŠ€æœ¯æå‡æ€§èƒ½</li></ul><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190606155409.jpg" alt></p><ol><li>SPDYæ˜¯è°·æ­Œæ¨å‡ºçš„ï¼ŒHTTP2.0åŸºäºæ­¤åˆ¶å®š</li><li>HTTP2.0å¯¹headerå‹ç¼©ï¼Œç”¨ç´¢å¼•è¡¨æ›¿ä»£key-valueï¼Œå°†ä¸€ä¸ªTCPè¿æ¥ä¸­åˆ‡åˆ†å¤šä¸ªæµã€‚<ul><li>æ¯ä¸ªæµæœ‰è‡ªå·±IDï¼Œæµæ˜¯åŒå‘çš„è™šæ‹Ÿé€šé“ï¼Œæµæœ‰ä¼˜å…ˆçº§ã€‚2.0è¿˜å°†æ‰€æœ‰ä¿¡æ¯åˆ†å‰²ä¸ºå¸§ã€‚</li><li>æœ‰headerå¸§å’Œdataå¸§ï¼Œç”¨äºŒè¿›åˆ¶ç¼–ç ï¼Œå¤šä¸ªdataå¸§å±äºåŒä¸€ä¸ªæµã€‚</li><li>è¿™æ ·å¯ä»¥å°†å¤šä¸ªè¯·æ±‚åˆ†åˆ°ä¸åŒçš„æµä¸­ï¼Œå°†è¯·æ±‚å†…å®¹æ‹†æˆå¸§ï¼Œè¿›è¡ŒäºŒè¿›åˆ¶ä¼ è¾“ã€‚</li><li>å¸§å¯ä»¥æ‰“æ•£ä¹±åºå‘é€ï¼Œç„¶åæ ¹æ®æ¯ä¸ªå¸§é¦–éƒ¨çš„æµæ ‡è¯†ç¬¦é‡æ–°ç»„è£…ï¼Œå¹¶æ ¹æ®ä¼˜å…ˆçº§å†³å®šå…ˆå¤„ç†å“ªä¸ªæµã€‚</li><li>HTTP2.0å…¶å®æ˜¯å°†nä¸ªè¯·æ±‚å˜æˆnä¸ªæµï¼Œå°†æ•°æ®åˆ†æˆå¸§ï¼Œä¹±åºå‘é€åˆ°ä¸€ä¸ªTCPè¿æ¥ä¸­ã€‚</li><li>è¿™æ ·2.0è§£å†³äº†1.1çš„é˜Ÿé¦–é˜»å¡é—®é¢˜ã€‚1.1é€šè¿‡pipelineç”¨å¤šæ¡TCPå®ç°å¹¶å‘ï¼Œ2.0åªç”¨1ä¸ªTCPå®ç°å¹¶å‘ï¼Œæé«˜æ€§èƒ½ã€‚</li><li>ä½†HTTP2.0è¿˜æ˜¯åŸºäºTCPçš„ï¼ŒTCPå¤„ç†åŒ…æ—¶æœ‰ä¸¥æ ¼é¡ºåºï¼Œå‰é¢æµ2çš„å¸§æ²¡æ”¶åˆ°ï¼Œåé¢æµ1çš„å¸§ä¹Ÿä¼šé˜»å¡</li></ul></li></ol><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190606155413.jpg" alt></p><h4 id="QUIC"><a href="#QUIC" class="headerlink" title="QUIC"></a>QUIC</h4><ul><li>QUICæ˜¯è°·æ­ŒåŸºäºUDPæ”¹è¿›çš„åº”ç”¨å±‚ï¼Œæœªæ¥HTTP3.0å¯èƒ½åŸºäºæ­¤å®ç°ï¼Œè§£å†³HTTP2.0çš„é—®é¢˜ï¼ŒQUICä¹Ÿæ˜¯é¢å‘è¿æ¥çš„ã€‚</li><li>QUICè‡ªå®šä¹‰ç±»ä¼¼TCPçš„è¿æ¥ã€é‡è¯•ã€å¤šè·¯å¤ç”¨ã€æµé‡æ§åˆ¶æŠ€æœ¯ï¼Œè¿›ä¸€æ­¥æå‡æ€§èƒ½</li></ul><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190606155449.jpg" alt></p><ol><li><p>æœºåˆ¶1ï¼šè‡ªå®šä¹‰è¿æ¥</p><ul><li>ä¸€æ¡TCPè¿æ¥æ˜¯å››å…ƒç»„ï¼ˆæºIPå’Œç«¯å£,ç›®æ ‡IPå’Œç«¯å£ï¼‰æ ‡è¯†çš„ï¼Œä¸€æ—¦ä¸€ä¸ªå…ƒç´ å˜åŒ–å°±éœ€è¦æ–­å¼€é‡è¿</li><li>ç§»åŠ¨äº’è”ç»å¸¸ä¸ç¨³å®šã€åˆ‡æ¢ï¼Œéƒ½ä¼šå¯¼è‡´é‡è¿ï¼Œåˆä¸‰æ¬¡æ¡æ‰‹ï¼Œæ—¶å»¶é«˜</li><li>è€ŒåŸºäºUDPçš„QUICè‡ªå·±ç”¨64ä½éšæœºæ•°ä½œä¸ºæ ‡è¯†æ›¿ä»£å››å…ƒç»„ï¼Œè€Œä¸”UDPæ˜¯æ— è¿æ¥çš„</li><li>å½“å‰è¿°çš„å››ä¸ªå…ƒç´ å˜åŒ–æ—¶ï¼Œä¸ç”¨é‡æ–°å»ºç«‹è¿æ¥</li></ul></li><li><p>æœºåˆ¶2ï¼šè‡ªå®šä¹‰é‡ä¼ æœºåˆ¶</p><ul><li>TCPæœ‰é€šè¿‡é‡‡æ ·å¾€è¿”æ—¶é—´RTTçš„è‡ªé€‚åº”é‡ä¼ ç®—æ³•ï¼Œä½†æ˜¯è¿™ç§é‡‡æ ·ä¸å‡†ç¡®ã€‚</li><li>QUICä¹Ÿæœ‰é€’å¢åºåˆ—å·ï¼Œä»»ä½•ä¸€ä¸ªåŒ…é‡å‘åºåˆ—å·éƒ½+1ï¼Œä¸åƒTCPé‡å‘åŒ…è¿˜æ˜¯åŸæ¥çš„åºå·ã€‚</li><li>è¿™æ ·è¶…æ—¶é‡‡æ ·å°±å‡†äº†ï¼Œä½†æ˜¯å¦‚ä½•çŸ¥é“é‡å‘çš„åŒ…å†…å®¹ä¸å‰ä¸€ä¸ªä¸€æ ·å‘¢</li><li>QUICåœ¨æ•°æ®æµé‡Œå®šä¹‰äº†<code>offset</code>ï¼Œå¯ä»¥é€šè¿‡<code>offset</code>æŸ¥çœ‹æ•°æ®å‘é€åˆ°äº†å“ªé‡Œ</li><li>åªè¦æŸä¸ª<code>offset</code>æ²¡åˆ°å°±é‡å‘ï¼ŒæŒ‰ç…§<code>offset</code>æ‹¼æ¥æˆä¸€ä¸ªæµï¼Œç›¸å½“äºå¤šè®¾ä¸€ä¸ªå‚æ•°å¤„ç†æµçš„é¡ºåºã€‚</li></ul></li><li><p>æœºåˆ¶3ï¼šæ— é˜»å¡çš„å¤šè·¯å¤ç”¨</p><ul><li>è·Ÿ2.0ä¸€æ ·ï¼ŒåŒä¸€æ¡QUICä¸Šå¯ä»¥åˆ›å»ºå¤šä¸ªæµæ¥å‘é€HTTPè¯·æ±‚</li><li>ä½†å› ä¸ºåŸºäºUDPï¼Œä¸€ä¸ªè¿æ¥ä¸Šçš„å¤šä¸ªæµä¹‹é—´æ²¡æœ‰ä¾èµ–</li><li>å‡å¦‚æµ2ä¸¢äº†ä¸€ä¸ªUDPåŒ…ï¼Œåé¢è·Ÿç€æµ3çš„ä¸€ä¸ªUDPåŒ…ï¼Œè™½ç„¶æµ2çš„åŒ…éœ€è¦é‡ä¼ ï¼Œä½†æµ3çš„åŒ…æ— éœ€ç­‰å¾…ï¼Œè€ŒTCPå°±ä¼šé˜»å¡</li></ul></li><li><p>æœºåˆ¶4ï¼šè‡ªå®šä¹‰æµé‡æ§åˆ¶</p><ul><li>TCPçš„æµé‡æ§åˆ¶æ˜¯é€šè¿‡æ»‘åŠ¨çª—å£åè®®ï¼ŒQUICä¹Ÿæ˜¯é€šè¿‡window_updateæ¥å‘Šè¯‰å¯¹æ–¹è‡ªå·±å¯æ¥å—çš„å­—èŠ‚æ•°</li><li>ä½†QUICçš„çª—å£æ˜¯é€‚åº”è‡ªå·±çš„å¤šè·¯å¤ç”¨æœºåˆ¶çš„ï¼Œä¸ä½†åœ¨ä¸€ä¸ªè¿æ¥ä¸Šæ§åˆ¶çª—å£ï¼Œæ¯ä¸ªæµä¹Ÿæœ‰æ§åˆ¶çª—å£</li><li>TCPé‡Œæ¥æ”¶ç«¯çš„çª—å£èµ·å§‹ç‚¹æ˜¯ä¸‹ä¸€ä¸ªè¦æ¥æ”¶å¹¶ä¸”ACKçš„åŒ…ï¼Œå³ä¾¿åæ¥çš„åŒ…éƒ½åˆ°äº†æ”¾åœ¨ç¼“å­˜é‡Œï¼Œçª—å£ä¹Ÿä¸èƒ½å³ç§»</li><li>åªè¦å‰é¢çš„åŒ…æ²¡åˆ°ï¼Œåé¢çš„åˆ°äº†ä¹Ÿä¸èƒ½ACKï¼Œå°±ä¼šå¯¼è‡´åé¢çš„åˆ°äº†ä¹Ÿå¯èƒ½è¶…æ—¶é‡ä¼ ï¼Œæµªè´¹å¸¦å®½ã€‚</li><li>QUICçš„ACKæ˜¯åŸºäºoffsetçš„ï¼Œæ¯ä¸ªoffsetçš„åŒ…åˆ°äº†è¿›äº†ç¼“å­˜å°±å¯ä»¥åº”ç­”ï¼Œåº”ç­”åå°±ä¸ç”¨é‡å‘ï¼Œå†ç»§ç»­ç­‰ä¸­é—´çš„åŒ…å³å¯</li><li>QUICçª—å£çš„å…¶å®ä½ç½®ä¸ºå½“å‰æ”¶åˆ°çš„æœ€å¤§offsetï¼Œä»è¿™ä¸ªoffsetåˆ°å½“å‰æµæ‰€èƒ½å®¹çº³çš„æœ€å¤§ç¼“å­˜æ‰æ˜¯çœŸæ­£çš„çª—å£</li><li>å¦å¤–è¿˜æœ‰æ•´ä¸ªè¿æ¥çš„çª—å£ï¼Œéœ€è¦å¯¹æ‰€æœ‰æµçš„çª—å£åšä¸€ä¸ªç»Ÿè®¡</li></ul></li></ol><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190606155516.jpg" alt></p><h4 id="å…³äºHTTPçš„é˜Ÿé¦–é˜»å¡"><a href="#å…³äºHTTPçš„é˜Ÿé¦–é˜»å¡" class="headerlink" title="å…³äºHTTPçš„é˜Ÿé¦–é˜»å¡"></a>å…³äºHTTPçš„é˜Ÿé¦–é˜»å¡</h4><ol><li><p>HTTP/1.0å¯¹äºåŒä¸€ä¸ªtcpè¿æ¥ï¼Œæ‰€æœ‰çš„è¯·æ±‚æ”¾å…¥é˜Ÿåˆ—ä¸­ï¼Œåªæœ‰å‰ä¸€ä¸ªè¯·æ±‚çš„å“åº”æ”¶åˆ°äº†ï¼Œç„¶åæ‰èƒ½å‘é€ä¸‹ä¸€ä¸ªè¯·æ±‚ã€‚å¯è§ï¼ŒHTTP/1.0çš„é˜Ÿé¦–ç»„å¡å‘ç”Ÿåœ¨å®¢æˆ·ç«¯ã€‚</p></li><li><p>HTTP/1.1å¯¹äºåŒä¸€ä¸ªtcpè¿æ¥ï¼ŒHTTP/1.1å…è®¸ä¸€æ¬¡å‘é€å¤šä¸ªè¯·æ±‚ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸å¿…ç­‰å‰ä¸€ä¸ªå“åº”æ”¶åˆ°ï¼Œå°±å¯ä»¥å‘é€ä¸‹ä¸€ä¸ªè¯·æ±‚ï¼Œè¿™æ ·å°±è§£å†³äº†HTTP/1.0çš„å®¢æˆ·ç«¯çš„é˜Ÿé¦–é˜»å¡ã€‚ä½†æœåŠ¡ç«¯å“åº”çš„å‘é€è¦æ ¹æ®è¯·æ±‚çš„é¡ºåºæ’é˜Ÿå‘é€ï¼Œå¦‚æœå‰ä¸€ä¸ªè¯·æ±‚çš„å¤„ç†æ—¶é—´é•¿å°±ä¼šå½±å“åé¢çš„å“åº”å‘é€ã€‚å¯è§ï¼ŒHTTP/1.1çš„é˜Ÿé¦–é˜»å¡å‘ç”Ÿåœ¨æœåŠ¡å™¨ç«¯ã€‚</p></li><li><p>HTTP/2.0æ— è®ºåœ¨å®¢æˆ·ç«¯è¿˜æ˜¯åœ¨æœåŠ¡å™¨ç«¯éƒ½ä¸éœ€è¦æ’é˜Ÿï¼Œåœ¨åŒä¸€ä¸ªTCPè¿æ¥ä¸Šï¼Œæœ‰å¤šä¸ªstreamï¼Œç”±å„ä¸ªstreamå‘é€å’Œæ¥æ”¶è¯·æ±‚ï¼Œå„ä¸ªsteamç›¸äº’ç‹¬ç«‹ï¼Œäº’ä¸é˜»å¡ã€‚åªè¦TCOæ²¡æœ‰äººåœ¨ç”¨é‚£ä¹ˆå°±å¯ä»¥å‘é€å·²ç»ç”Ÿæˆçš„requstæˆ–è€…reponseçš„æ•°æ®ï¼Œåœ¨ä¸¤ç«¯éƒ½ä¸ç”¨ç­‰ï¼Œä»è€Œå½»åº•è§£å†³äº†HTTPåè®®å±‚é¢çš„é˜Ÿé¦–é˜»å¡é—®é¢˜ã€‚</p></li></ol><h2 id="HTTPS"><a href="#HTTPS" class="headerlink" title="HTTPS"></a>HTTPS</h2><h4 id="å»ºç«‹è¿æ¥è¿‡ç¨‹"><a href="#å»ºç«‹è¿æ¥è¿‡ç¨‹" class="headerlink" title="å»ºç«‹è¿æ¥è¿‡ç¨‹"></a>å»ºç«‹è¿æ¥è¿‡ç¨‹</h4><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190606155548.jpg" alt></p><ol><li>å¼€å§‹è¿æ¥æ—¶ï¼Œå®¢æˆ·ç«¯ç”¨æœåŠ¡ç«¯çš„å…¬é’¥åŠ å¯†å‘é€ï¼ŒæœåŠ¡ç«¯ç”¨å®¢æˆ·ç«¯çš„å…¬é’¥åŠ å¯†å›åº”</li><li>CAè¯ä¹¦é‡Œæœ‰å…¬é’¥ï¼ŒCAæ˜¯é€’å½’çš„æœ€åæœ‰å‡ ä¸ªå¤§çš„rootCAï¼Œå…ˆç”¨éå¯¹ç§°åŠ å¯†è·å–å¯†é’¥ï¼Œç„¶åç”¨å¯¹ç§°åŠ å¯†ä¼ è¾“æ•°æ®ï¼ŒTLS/SSL</li><li>HTTPSæ¡æ‰‹è¿‡ç¨‹ï¼šï¼ˆcæ˜¯å®¢æˆ·ç«¯ï¼Œsæ˜¯æœåŠ¡ç«¯ï¼‰<ul><li>cå‘é€ <code>Client Hello</code> ç»™sï¼Œæ˜æ–‡ä¼ è¾“TLSç‰ˆæœ¬ã€åŠ å¯†å¥—ä»¶å€™é€‰åˆ—è¡¨ã€å‹ç¼©ç®—æ³•å€™é€‰åˆ—è¡¨ç­‰ä»¥åŠä¸€ä¸ªéšæœºæ•°A</li><li>sè¿”å› <code>Server Hello</code> ç»™cï¼Œå£°æ˜é€‰æ‹©ä½¿ç”¨çš„åè®®ç‰ˆæœ¬ã€åŠ å¯†å¥—ä»¶ã€å‹ç¼©ç®—æ³•ç­‰ä»¥åŠä¸€ä¸ªéšæœºæ•°B</li><li>så‘é€ <code>Server Certificate</code> ç»™cï¼Œç„¶åå†å‘é€ Server Hello Doneï¼Œè¯´æ˜å‘é€ä¿¡æ¯å°±è¿™ä¹ˆå¤šäº†ï¼Œç»“æŸ</li><li>cæ ¡éªŒå‰ä¸€æ­¥sç»™çš„è¯ä¹¦ï¼Œä»è‡ªå·±ä¿¡ä»»çš„CAä»“åº“ä¸­æ‹¿CAè¯ä¹¦çš„å…¬é’¥å–è§£å¯†sçš„è¯ä¹¦ï¼Œè¿‡ç¨‹ä¸­å¯èƒ½éœ€è¦å¾€ä¸Šè¿½æº¯CAã€CAçš„CAç­‰</li><li>cå‘é€ <code>Client Key Exchange</code>ï¼Œå†…å«ç”Ÿæˆçš„ä¸€ä¸ªéšæœºæ•°Cï¼š<code>Pre-master</code>ï¼Œç”¨sè¯ä¹¦çš„å…¬é’¥åŠ å¯†ï¼Œå‘é€ç»™sï¼Œså¯ä»¥é€šè¿‡è‡ªå·±çš„ç§é’¥è§£å¯†å‡ºæ¥ï¼ˆ<code>Pre-master</code>æ˜¯RSAåŠ å¯†çš„è¯´æ³•ï¼ŒDHåŠ å¯†éœ€è¦ <code>DH exponent</code>ï¼‰</li><li>ç°åœ¨ï¼Œcå’Œséƒ½æœ‰äº†ä¸‰ä¸ªéšæœºæ•°ï¼Œåˆ†åˆ«æ˜¯è‡ªå·±çš„ã€å¯¹æ–¹çš„ã€Pre-masterï¼Œé€šè¿‡è¿™ä¸‰ä¸ªéšæœºæ•°ï¼Œcå’Œsèƒ½ç”Ÿæˆç›¸åŒçš„å¯¹ç§°å¯†é’¥</li><li>cå‘é€ <code>Change Cipher Spec</code> é€šçŸ¥sé‡‡ç”¨åå•†çš„é€šä¿¡å¯†é’¥å’ŒåŠ å¯†ç®—æ³•è¿›è¡Œå¯¹ç§°åŠ å¯†é€šä¿¡</li><li>cå‘é€ <code>Encrypted Handshake Message</code> å°†å…ˆå‰å•†å®šå¥½çš„å‚æ•°é‡‡ç”¨åå•†å¯†é’¥åŠ å¯†ï¼Œå‘é€ç»™sç”¨äºæ•°æ®ä¸æ¡æ‰‹éªŒè¯</li><li>så‘é€ <code>Change Cipher Spec</code> å›åº”cé‡‡ç”¨åå•†çš„é€šä¿¡å¯†é’¥å’ŒåŠ å¯†ç®—æ³•è¿›è¡Œå¯¹ç§°åŠ å¯†é€šä¿¡</li><li>så‘é€ <code>Encrypted Handshake Message</code> å°†å…ˆå‰å•†å®šå¥½çš„å‚æ•°é‡‡ç”¨åå•†å¯†é’¥åŠ å¯†ï¼Œå‘é€ç»™cç”¨äºæ•°æ®ä¸æ¡æ‰‹éªŒè¯</li><li>åŒæ–¹è½¬è€Œä½¿ç”¨å¯¹ç§°åŠ å¯†é€šä¿¡ï¼Œæ¡æ‰‹å®Œæˆï¼Œé™¤äº†ä»¥ä¸Šè¿‡ç¨‹ï¼Œå…¶ä½™è¿‡ç¨‹ä¸HTTPä¸€æ ·</li></ul></li><li>ä¸Šé¢æ˜¯HTTPSå•å‘éªŒè¯ï¼Œåªæ˜¯céªŒè¯äº†sçš„è¯ä¹¦ï¼Œæ˜¯å¤§éƒ¨åˆ†çš„åœºæ™¯ï¼Œä¹Ÿå¯ä»¥åœ¨æ›´åŠ ä¸¥æ ¼å®‰å…¨è¦æ±‚çš„æƒ…å†µä¸‹ï¼Œå¯ç”¨åŒå‘éªŒè¯ï¼Œäº’éªŒè¯ä¹¦</li><li>é‡æ”¾ä¸ç¯¡æ”¹æ”»å‡»ï¼šè‡ªå®šä¹‰çš„ï¼šé€šè¿‡Timestampå’ŒNonceéšæœºæ•°è”åˆèµ·æ¥åšä¸å¯é€†ç­¾åæ¥ä¿è¯ã€‚</li><li>ä¸ºä»€ä¹ˆä¸ç›´æ¥ç”¨éå¯¹ç§°åŠ å¯†é€šä¿¡ï¼Ÿ<ul><li>éå¯¹ç§°åŠ å¯†çš„åŠ å¯†çš„å†…å®¹ä¸èƒ½è¶…è¿‡å…¬é’¥é•¿åº¦ï¼Œæ‰€ä»¥åªèƒ½ç”¨æ¥ä½œå¯†é’¥äº¤æ¢æˆ–è€…å†…å®¹ç­¾å</li><li>æ€§èƒ½é—®é¢˜ï¼Œå¯¹ç§°åŠ å¯†æ˜¯æ¯«ç§’çº§ï¼Œéå¯¹ç§°æ˜¯ç§’çº§ï¼Œ<code>HTTPS</code>æ¡æ‰‹è¿‡ç¨‹çš„<code>90%</code>æ—¶é—´éƒ½åœ¨è§£å¯†<code>RSA</code></li></ul></li><li>é™¤äº†<code>Premaster</code>å¤–è¿˜éœ€è¦ä¸¤ä¸ªéšæœºæ•°çš„åŸå› æ˜¯<code>TLS</code>ä¸ä¿¡ä»»æ¯ä¸ªå®¢æˆ·ç«¯éƒ½èƒ½äº§ç”Ÿå®‰å…¨çš„éšæœºæ•°ï¼Œæ‰€ä»¥å¼•å…¥å¤šä¸¤ä¸ªéšæœºæ•°</li></ol><h4 id="SSL-TLS"><a href="#SSL-TLS" class="headerlink" title="SSL/TLS"></a>SSL/TLS</h4><ol><li>TLSå³SSLå‡çº§ç‰ˆï¼Œ18å¹´æ¨å‡ºTLS1.3ï¼Œç›®å‰(19å¹´)ç”¨TLS1.2å’Œ1.3çš„éƒ½ä¸å°‘ï¼ŒSSLæ—©å°±åºŸå¼ƒäº†</li><li>å¯¹ç§°åŠ å¯†ç®—æ³•æœ‰ï¼š<code>AES</code>ã€<code>DES</code>ã€<code>3DES</code>ï¼Œéå¯¹ç§°åŠ å¯†ç®—æ³•æœ‰ï¼š<code>RSA</code>ã€<code>ECDHE</code></li><li>TLSä¸­ä¸Šé¢å°†ä¸¤ä¸ªéšæœºæ•°å’ŒPremasterè®¡ç®—æˆå¯¹ç§°åŠ å¯†ä¸»å¯†é’¥çš„ç®—æ³•æ˜¯PRFç®—æ³•(SHA256)</li><li>TLSæ˜¯åœ¨ä¼ è¾“å±‚ï¼ˆTCPUDPå±‚ï¼‰ä¹‹ä¸Šï¼Œåº”ç”¨å±‚ï¼ˆHTTPï¼‰ä¹‹ä¸‹çš„å±‚ï¼ŒHTTPSå…¶å®å°±æ˜¯åœ¨TCPå’ŒHTTPä¹‹é—´åŠ äº†TLSå±‚</li></ol><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190606155834.PNG" alt></p><ol start="5"><li>æ¡æ‰‹çš„åŠ å¯†å¥—ä»¶ï¼šä¾‹å­ï¼š<code>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</code>ï¼Œ<code>ECDHE</code>å¯†é’¥äº¤æ¢ã€<code>RSA</code>èº«ä»½éªŒè¯ã€<code>AES</code>ç®—æ³•ã€<code>128</code>åŠ å¯†å¼ºåº¦ã€<code>GCM</code>åŠ å¯†æ¨¡å¼ã€<code>SHA256</code>æ˜¯MACæˆ–è€…PRF</li><li>ç›®å‰ä¸»æµHTTPSçš„æµé‡æ˜¯ä½¿ç”¨<code>ECDHE</code>è¿›è¡Œå¯†é’¥äº¤æ¢ã€ç”¨<code>RSA</code>è¿›è¡Œèº«ä»½éªŒè¯</li></ol><h4 id="TLSåè®®åŸç†"><a href="#TLSåè®®åŸç†" class="headerlink" title="TLSåè®®åŸç†"></a>TLSåè®®åŸç†</h4><ul><li><p>è‡ªé¡¶å‘ä¸‹ã€åˆ†å±‚æŠ½è±¡ï¼ŒTLSå¤§è‡´åœ¨å››å±‚</p><ol><li>æœ€åº•å±‚æ˜¯åŸºç¡€ç®—æ³•åŸè¯­çš„å®ç°å¦‚<code>AES</code>ã€<code>RSA</code>ã€<code>MD5</code>ã€<code>SHA256</code>ã€<code>ECDH</code>ç­‰</li><li>ç¬¬äºŒå±‚æ˜¯é€‰å®šå‚æ•°åï¼Œç¬¦åˆå¯†ç å­¦é‡Œæ ‡å‡†åˆ†ç±»çš„ç®—æ³•ï¼ŒåŒ…æ‹¬å—åŠ å¯†ç®—æ³•ï¼Œç­¾åç®—æ³•ï¼Œéå¯¹ç§°åŠ å¯†ç®—æ³•ï¼ŒMACç®—æ³•ç­‰ï¼Œä¾‹å¦‚ï¼š <code>aes-128-cbc-pkcs7</code>ï¼Œ<code>rsaes-oaep</code> ï¼Œ<code>rsassa-pkcs1-v1_5</code>, <code>hmac-sha256</code>ï¼Œ<code>ecdsa-p256</code>ï¼Œ<code>curve25519</code> ç­‰</li><li>ç¬¬ä¸‰å±‚æ˜¯æŠŠå¤šç§æ ‡å‡†ç®—æ³•ç»„åˆè€Œæˆçš„åŠæˆå“ç»„ä»¶ï¼Œä¾‹å¦‚ï¼šå¯¹ç§°ä¼ è¾“ç»„ä»¶ä¾‹å¦‚ <code>aes-128-cbc + hmac-sha256ï¼Œaes-128-gcm</code>ï¼Œè®¤è¯å¯†é’¥åå•†ç®—æ³•: <code>rsassa-OAEP + ecdh-secp256r1</code>ï¼Œæ•°å­—ä¿¡å°ï¼š<code>rsaes-oaep + aes-cbc-128 + hmac-sha256</code> ï¼Œæ–‡ä»¶å¯†ç åŠ å¯†å­˜å‚¨ç»„ä»¶ï¼š<code>pbkdf2+aes-128-cbc-hmac-sha256</code>ï¼Œå¯†é’¥æ‰©å±•ç®—æ³• <code>PRF-sha256</code> ç­‰</li><li>ç¬¬å››å±‚æ˜¯ç”¨å„ç§ç»„ä»¶æ‹¼è£…è€Œæˆçš„å„ç§æˆå“å¯†ç å­¦åè®®/è½¯ä»¶ï¼Œä¾‹å¦‚ï¼šTLSåè®®ï¼ŒSSHåè®®ï¼ŒSRPåè®®ï¼Œgnupgæ–‡ä»¶æ ¼å¼ï¼ŒiMessageåè®®ï¼Œbitcoinåè®®ç­‰ç­‰</li></ol></li><li><p>å¾ˆå¤šç¨‹åºå‘˜è‡ªå·±é€ çš„è½®å­ï¼Œå¾€å¾€è¯´ç™½äº†å°±æ˜¯æƒ³é‡å¤å®ç°ç¬¬3å±‚çš„æŸä¸ªç»„ä»¶è€Œå·²ã€‚</p></li></ul><h5 id="TLSåŠ å¯†å¥—ä»¶-CipherSuite"><a href="#TLSåŠ å¯†å¥—ä»¶-CipherSuite" class="headerlink" title="TLSåŠ å¯†å¥—ä»¶ (CipherSuite)"></a>TLSåŠ å¯†å¥—ä»¶ (CipherSuite)</h5><ul><li><p>ä»ä¸Šè¿°åˆ†å±‚çš„è§’åº¦çœ‹ï¼Œ<code>TLS</code>å¤§è‡´æ˜¯ç”±ä¸‰ä¸ªç»„ä»¶æ‹¼æˆçš„ï¼š</p><ol><li>å¯¹ç§°åŠ å¯†ä¼ è¾“ç»„ä»¶ï¼Œä¾‹å¦‚<code>aes-128-gcm</code>;</li><li>è®¤è¯å¯†é’¥åå•†ç»„ä»¶ï¼Œä¾‹å¦‚<code>rsa-ecdhe</code>;</li><li>å¯†é’¥æ‰©å±•ç»„ä»¶ï¼Œä¾‹å¦‚<code>TLS-PRF-sha256</code></li></ol></li><li><p>è¿™äº›ç»„ä»¶å¯ä»¥å†æ‹†åˆ†ä¸º5ç±»ç®—æ³•ï¼Œåœ¨<code>TLS</code>ä¸­ï¼Œè¿™5ç±»ç®—æ³•ç»„åˆåœ¨ä¸€èµ·ï¼Œç§°ä¸ºä¸€ä¸ª<code>CipherSuite</code>ï¼š</p><ol><li>authentication (è®¤è¯ç®—æ³•)</li><li>encryption (åŠ å¯†ç®—æ³• )</li><li>message authentication code (æ¶ˆæ¯è®¤è¯ç ç®—æ³•  ç®€ç§°MAC)</li><li>key exchange (å¯†é’¥äº¤æ¢ç®—æ³•)</li><li>key derivation function ï¼ˆå¯†é’¥è¡ç”Ÿç®—æ³•)</li></ol></li><li><p>TLSåè®®è®¾è®¡ä¹‹åˆå°±è€ƒè™‘åˆ°äº†è¿™æ¯ä¸€ç±»ç®—æ³•çš„æ¼”å˜ï¼Œæ‰€ä»¥æ²¡æœ‰å®šæ­»ç®—æ³•ï¼Œè€Œæ˜¯è®¾è®¡äº†ä¸€ä¸ªç®—æ³•åå•†è¿‡ç¨‹ï¼Œæ¥å…è®¸åŠ å…¥æ–°çš„ç®—æ³•( ç®€ç›´æ˜¯è½¯ä»¶å¯æ‰©å±•æ€§è®¾è®¡çš„å…¸èŒƒï¼)ï¼Œåå•†å‡ºçš„ä¸€ä¸ªç®—æ³•ç»„åˆå³ä¸€ä¸ª<code>CipherSuite</code></p></li><li><p>å¸¸è§åŠ å¯†å¥—ä»¶<br> <img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190606155835.JPG" alt></p></li></ul><h4 id="åŠ å¯†ç®—æ³•åˆ†ç±»"><a href="#åŠ å¯†ç®—æ³•åˆ†ç±»" class="headerlink" title="åŠ å¯†ç®—æ³•åˆ†ç±»"></a>åŠ å¯†ç®—æ³•åˆ†ç±»</h4><ul><li><p>ä¸Šè¿°ç¬¬äºŒå±‚ä¸­çš„å¯†ç å­¦ç®—æ³•å¸¸è§æœ‰ä¸‹é¢å‡ ç±»</p><ol><li>å—åŠ å¯†ç®—æ³•ï¼š<code>AES</code>ï¼ˆAES_128_GCMç­‰ï¼‰ã€<code>Serpent</code>ç­‰</li><li>æµåŠ å¯†ç®—æ³•ï¼š<code>RC4</code>ã€<code>ChaCha20</code>ç­‰</li><li>åŠ å¯†ç”¨å“ˆå¸Œå‡½æ•°ï¼š<code>MD5</code>ã€<code>SHA1</code>ã€<code>SHA256</code>ã€<code>POLY1305</code>ç­‰</li><li>æ¶ˆæ¯éªŒè¯ç å‡½æ•°ï¼š<code>AEAD</code>ã€<code>HMAC-SHA256</code>ç­‰</li><li>å¯†é’¥äº¤æ¢ç®—æ³•ï¼š<code>RSA</code>ã€<code>DH</code>ã€<code>ECDH</code>ã€<code>ECDHE</code></li><li>å…¬é’¥åŠ å¯†ç®—æ³•ï¼š<code>RSA</code></li><li>æ•°å­—ç­¾åç®—æ³•ï¼š<code>RSA</code>ã€<code>DSA</code>ã€<code>ECDSA</code></li></ol></li><li><p>è®¾è®¡ä¸€ä¸ªåŠ å¯†é€šä¿¡åè®®çš„è¿‡ç¨‹ï¼Œå°±æ˜¯è‡ªé¡¶å‘ä¸‹ï¼Œé€æ­¥ç»†åŒ–ï¼ŒæŒ‘é€‰å„ç±»ç»„ä»¶ï¼Œæ‹¼è£…æˆå®Œæ•´åè®®çš„è¿‡ç¨‹</p></li></ul><h4 id="AESåŠ å¯†ç®—æ³•"><a href="#AESåŠ å¯†ç®—æ³•" class="headerlink" title="AESåŠ å¯†ç®—æ³•"></a>AESåŠ å¯†ç®—æ³•</h4><ol><li>æ¯ä¸ªåŠ å¯†æ•°æ®å—å¤§å°å›ºå®šä¸º128ä½ï¼ˆ16ä¸ªå­—èŠ‚ï¼‰ï¼Œæœ€åä¸€å—ä¸æ»¡16å­—èŠ‚çš„è¯éœ€è¦ç”¨å¡«å……ç®—æ³•è¡¥é½</li><li>æœ€ç»ˆç”Ÿæˆçš„åŠ å¯†å¯†é’¥é•¿åº¦æœ‰128ä½ã€192ä½ã€256ä½ä¸‰ç§</li><li>å¤šç§å·¥ä½œæ¨¡å¼ï¼š<code>ECB</code>ã€<code>CBC</code>ã€<code>CFB</code>ç­‰ï¼Œè¿™å—å†…å®¹å¾ˆå¤šï¼Œåç»­è¡¥å……</li></ol><h4 id="DESã€3DESåŠ å¯†ç®—æ³•"><a href="#DESã€3DESåŠ å¯†ç®—æ³•" class="headerlink" title="DESã€3DESåŠ å¯†ç®—æ³•"></a>DESã€3DESåŠ å¯†ç®—æ³•</h4><ol><li><p>DES:</p><ul><li>æ¯ä¸ªåŠ å¯†æ•°æ®å—å¤§å°å›ºå®šä¸º64ä½ï¼ˆ8ä¸ªå­—èŠ‚ï¼‰</li><li>ç”Ÿæˆçš„å¯†é’¥é•¿åº¦ä¸º64ä½ï¼ˆå…¶ä¸­8ä½ç”¨äºæ ¡éªŒï¼ˆæ¯ä¸ªå­—èŠ‚çš„ç¬¬8ä½ï¼‰ï¼‰ï¼Œæ‰€ä»¥AESæ¯”DESå®‰å…¨</li></ul></li><li><p>3DES:</p><ul><li>è¿˜æ˜¯64ä½çš„åŠ å¯†æ•°æ®å—å¤§å°</li><li>ç®€å•ç²—æš´çš„ <code>Triple DES</code>ï¼Œä½¿ç”¨3ä¸ª<code>DES</code>å¯†é’¥ï¼ˆæ‰€ä»¥å…±192ä½ï¼Œå…¶ä¸­24ä½æ ¡éªŒï¼‰ï¼Œå¯¹æ•°æ®å—ï¼ˆè¿˜æ˜¯64ä½çš„å°å—ï¼‰åº”ç”¨ä¸‰æ¬¡<code>DES</code>ç®—æ³•è¿›è¡Œä¸‰æ¬¡åŠ å¯†</li><li>ä½¿ç”¨çš„3ä¸ªå¯†é’¥ä¸æ˜¯åˆå¹¶æˆ1ä¸ªå¯†é’¥ï¼Œè€Œè¿˜æ˜¯åˆ†æˆ3ä¸ªç”¨ï¼Œ<code>3DES</code>åŠ å¯†æ—¶ä¾æ¬¡ä½¿ç”¨å¯†é’¥1ã€å¯†é’¥2ã€å¯†é’¥3å¯¹æ˜æ–‡æ•°æ®å—è¿›è¡ŒåŠ å¯†ï¼Œè§£å¯†è¿‡ç¨‹åä¹‹äº¦ç„¶ã€‚</li><li>æ¯æ¬¡åŠ è§£å¯†åŸç†ä¸<code>DES</code>ä¸€æ ·</li></ul></li></ol><h4 id="RSAåŠ å¯†ç®—æ³•"><a href="#RSAåŠ å¯†ç®—æ³•" class="headerlink" title="RSAåŠ å¯†ç®—æ³•"></a>RSAåŠ å¯†ç®—æ³•</h4><p>1977å¹´ï¼Œä¸‰ä½æ•°å­¦å®¶Rivestã€Shamir å’Œ Adleman è®¾è®¡äº†ä¸€ç§ç®—æ³•ï¼Œå¯ä»¥å®ç°éå¯¹ç§°åŠ å¯†ã€‚è¿™ç§ç®—æ³•ç”¨ä»–ä»¬ä¸‰ä¸ªäººçš„åå­—å‘½åï¼Œå«åš<code>RSA</code>ç®—æ³•ã€‚ä»é‚£æ—¶ç›´åˆ°ç°åœ¨ï¼Œ<code>RSA</code>ç®—æ³•ä¸€ç›´æ˜¯æœ€å¹¿ä¸ºä½¿ç”¨çš„â€œéå¯¹ç§°åŠ å¯†ç®—æ³•â€ã€‚</p><ol><li><p>å…¬é’¥ä¸ç§é’¥çš„äº§ç”Ÿ</p><ul><li>å‡è®¾Aliceæƒ³è¦é€šè¿‡ä¸€ä¸ªä¸å¯é çš„åª’ä½“æ¥æ”¶Bobçš„ä¸€æ¡ç§äººè®¯æ¯ã€‚</li><li>å¥¹å¯ä»¥ç”¨ä»¥ä¸‹çš„æ–¹å¼æ¥äº§ç”Ÿä¸€ä¸ªå…¬é’¥å’Œä¸€ä¸ªç§é’¥ï¼š</li><li>éšæ„é€‰æ‹©ä¸¤ä¸ªå¤§çš„è´¨æ•°på’Œqï¼Œpä¸ç­‰äºqï¼Œè®¡ç®—N=pqã€‚</li><li>æ ¹æ®æ¬§æ‹‰å‡½æ•°ï¼Œæ±‚å¾—r =Ï†(N)=Ï†(p)Ï†(q)= (p-1)(q-1)</li><li>é€‰æ‹©ä¸€ä¸ªå°äº r çš„æ•´æ•° eï¼Œæ±‚å¾— e å…³äºæ¨¡ r çš„æ¨¡åå…ƒç´ ï¼Œå‘½åä¸ºdã€‚ï¼ˆæ¨¡åå…ƒç´ å­˜åœ¨ï¼Œå½“ä¸”ä»…å½“eä¸räº’è´¨ï¼‰</li><li>å°† p å’Œ q çš„è®°å½•é”€æ¯ã€‚    </li><li>(N,e)æ˜¯å…¬é’¥ï¼Œ(N,d)æ˜¯ç§é’¥ã€‚Aliceå°†å¥¹çš„å…¬é’¥(N,e)ä¼ ç»™Bobï¼Œè€Œå°†å¥¹çš„ç§é’¥(N,d)è—èµ·æ¥ã€‚ </li></ul></li><li><p>åŠ å¯†æ¶ˆæ¯</p><ul><li>å‡è®¾Bobæƒ³ç»™Aliceé€ä¸€ä¸ªæ¶ˆæ¯mï¼Œä»–çŸ¥é“Aliceäº§ç”Ÿçš„Nå’Œeã€‚</li><li>ä»–ä½¿ç”¨èµ·å…ˆä¸Aliceçº¦å¥½çš„æ ¼å¼å°†mè½¬æ¢ä¸ºä¸€ä¸ªå°äºNï¼Œä¸”ä¸Näº’è´¨çš„æ•´æ•°n</li><li>æ¯”å¦‚ä»–å¯ä»¥å°†æ¯ä¸€ä¸ªå­—è½¬æ¢ä¸ºè¿™ä¸ªå­—çš„Unicodeç ï¼Œç„¶åå°†è¿™äº›æ•°å­—è¿åœ¨ä¸€èµ·ç»„æˆä¸€ä¸ªæ•°å­—ã€‚</li><li>å‡å¦‚ä»–çš„ä¿¡æ¯éå¸¸é•¿çš„è¯ï¼Œä»–å¯ä»¥å°†è¿™ä¸ªä¿¡æ¯åˆ†ä¸ºå‡ æ®µï¼Œç„¶åå°†æ¯ä¸€æ®µè½¬æ¢ä¸ºnã€‚</li><li>ç”¨ä¸‹é¢è¿™ä¸ªå…¬å¼ä»–å¯ä»¥å°†nåŠ å¯†ä¸ºcï¼š</li><li>n^e â‰¡ c (mod N)</li><li>è®¡ç®—cå¹¶ä¸å¤æ‚ã€‚Bobç®—å‡ºcåå°±å¯ä»¥å°†å®ƒä¼ é€’ç»™Aliceã€‚</li></ul></li><li><p>è§£å¯†æ¶ˆæ¯</p><ul><li>Aliceå¾—åˆ°Bobçš„æ¶ˆæ¯cåå°±å¯ä»¥åˆ©ç”¨å¥¹çš„å¯†é’¥dæ¥è§£ç ã€‚å¥¹å¯ä»¥ç”¨ä»¥ä¸‹è¿™ä¸ªå…¬å¼æ¥å°†cè½¬æ¢ä¸ºnï¼š</li><li>c^d â‰¡ n (mod N)</li><li>å¾—åˆ°nåï¼Œå¥¹å¯ä»¥å°†åŸæ¥çš„ä¿¡æ¯mé‡æ–°å¤åŸã€‚</li><li>è§£ç çš„åŸç†æ˜¯ c^d â‰¡ n^(eÂ·d)(mod N)</li><li>å·²çŸ¥eÂ·d â‰¡ 1 (mod r)ï¼Œå³eÂ·d =1 +hÏ†(N)ã€‚ç”±æ¬§æ‹‰å®šç†å¯å¾—ï¼š</li><li>n ^(eÂ·d) =n^ (1 +hÏ†(N))=nÂ·((n^Ï†(N))^h)â‰¡(n(1)^h)(modN) â‰¡ n (mod N)</li></ul></li><li><p>ç­¾åæ¶ˆæ¯</p><ul><li>RSAä¹Ÿå¯ä»¥ç”¨æ¥ä¸ºä¸€ä¸ªæ¶ˆæ¯ç½²åã€‚</li><li>å‡å¦‚Aliceæƒ³ç»™Bobä¼ é€’ä¸€ä¸ªç½²åçš„æ¶ˆæ¯çš„è¯ï¼Œé‚£ä¹ˆå¥¹å¯ä»¥ä¸ºå¥¹çš„æ¶ˆæ¯è®¡ç®—ä¸€ä¸ªæ•£åˆ—å€¼ï¼ˆMessage digestï¼‰</li><li>ç„¶åç”¨å¥¹çš„ç§é’¥åŠ å¯†è¿™ä¸ªæ•£åˆ—å€¼å¹¶å°†è¿™ä¸ªâ€œç½²åâ€åŠ åœ¨æ¶ˆæ¯çš„åé¢ã€‚</li><li>è¿™ä¸ªæ¶ˆæ¯åªæœ‰ç”¨å¥¹çš„å…¬é’¥æ‰èƒ½è¢«è§£å¯†ã€‚</li><li>Bobè·å¾—è¿™ä¸ªæ¶ˆæ¯åå¯ä»¥ç”¨Aliceçš„å…¬é’¥è§£å¯†è¿™ä¸ªæ•£åˆ—å€¼</li><li>ç„¶åå°†è¿™ä¸ªæ•°æ®ä¸ä»–è‡ªå·±ä¸ºè¿™ä¸ªæ¶ˆæ¯è®¡ç®—çš„æ•£åˆ—å€¼ç›¸æ¯”è¾ƒã€‚</li><li>å‡å¦‚ä¸¤è€…ç›¸ç¬¦çš„è¯ï¼Œé‚£ä¹ˆä»–å°±å¯ä»¥çŸ¥é“å‘ä¿¡äººæŒæœ‰ç”²çš„å¯†é’¥ï¼Œä»¥åŠè¿™ä¸ªæ¶ˆæ¯åœ¨ä¼ æ’­è·¯å¾„ä¸Šæ²¡æœ‰è¢«ç¯¡æ”¹è¿‡ã€‚</li></ul></li><li><p>å®æˆ˜ä¾‹å­</p><ul><li>é€šè¿‡ä¸€æ¬¡ç®€å•å®è·µæ›´å¥½çš„äº†è§£RSA</li><li>å‡è®¾p = 2ï¼Œq = 5ï¼ˆpï¼Œqéƒ½æ˜¯ç´ æ•°å³å¯ï¼‰ï¼Œåˆ™N = pq = 10ï¼›</li><li>å¾—åˆ°ï¼šr = (p-1)(q-1) = (2-1)(5-1) = 4ï¼›</li><li>æ ¹æ®æ¨¡åå…ƒç´ å…¬å¼ï¼Œå¯ä»¥å¾—å‡ºï¼ŒeÂ·d â‰¡ 1 (mod 4),å³eÂ·d = 4n+1 (nä¸ºæ­£æ•´æ•°)ï¼›</li><li>å‡è®¾n=5ï¼Œåˆ™eÂ·d = 21ï¼Œä¸”eã€dä¸ºæ­£æ•´æ•°ï¼Œå¹¶ä¸”eä¸räº’è´¨ï¼Œåˆ™e = 7ï¼Œd = 3ï¼›</li><li>è·å¾—å…¬é’¥å’Œå¯†é’¥ï¼šå…¬é’¥ä¸º(N, e) = (10, 7)ï¼Œå¯†é’¥ä¸º(N, d) = (10, 3)ï¼›</li><li>å‡è®¾è¦ä¼ è¾“çš„æ•°å­—ä¸º2ï¼Œé€šè¿‡å…¬é’¥åŠ å¯†åä¸ºï¼š(2^7)(mod 10) = 8ï¼›</li><li>é€šè¿‡å¯†é’¥è§£å¯†ï¼š(8^3)(mod 10) = 512(mod 10) = 2ï¼Œå³è·å¾—ç»“æœï¼›</li></ul></li></ol><h4 id="ECDHEåŠ å¯†ç®—æ³•"><a href="#ECDHEåŠ å¯†ç®—æ³•" class="headerlink" title="ECDHEåŠ å¯†ç®—æ³•"></a>ECDHEåŠ å¯†ç®—æ³•</h4><ul><li>ä¸»è¦ç”¨äºHTTPSä¸­çš„å¯†é’¥äº¤æ¢</li><li><code>ECDHE</code>æºè‡ª<code>ECDH</code>ï¼Œ<code>ECDH</code>å³ä½¿ç”¨æ¤­åœ†æ›²çº¿åŠ å¯†æŠ€æœ¯ï¼ˆECCï¼‰çš„ DHå¯†é’¥äº¤æ¢ï¼ˆDiffie-Hellmanï¼‰ç®—æ³•.</li><li><code>DH</code>å¯†é’¥äº¤æ¢ç®—æ³•ï¼Œå¯ä»¥è®©äº¤æ¢åŒæ–¹åœ¨ä¸å…±äº«ä»»ä½•ç§˜å¯†çš„æƒ…å†µä¸‹åå•†å‡ºä¸€ä¸ªå¯†é’¥ã€‚<code>ECC</code>åˆ™æ˜¯å»ºç«‹åœ¨åŸºäºæ¤­åœ†æ›²çº¿çš„ç¦»æ•£å¯¹æ•°é—®é¢˜ä¸Šçš„å¯†ç ä½“åˆ¶ï¼Œåœ¨ç›¸åŒçš„å¯†é’¥é•¿åº¦ä¸‹ï¼Œå…¶å®‰å…¨æ€§æ¯”<code>RSA</code>æ›´é«˜ã€‚</li><li>è€Œ<code>ECDHE</code>åˆ™æ˜¯<code>ECDH</code>çš„<code>Ephemeral version</code>ï¼Œå®ƒä¼šä¸ºæ¯æ¬¡æ¡æ‰‹è¿‡ç¨‹åˆ†é…ä¸€ä¸ªä¸åŒçš„<code>DH key</code>ï¼Œä»è€Œæä¾›å‰å‘å®‰å…¨æ€§ã€‚å®é™…ä¸Šï¼Œåœ¨<code>HTTP/2</code>ä¸­å…è®¸ä½¿ç”¨çš„<code>Cipher Suite</code>å¿…é¡»é‡‡ç”¨å…·æœ‰å‰å‘å®‰å…¨æ€§çš„å¯†é’¥äº¤æ¢ç®—æ³•ã€‚</li></ul><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><ol><li>HTTPSå®é™…å°±æ˜¯åœ¨TCPå±‚ä¸httpå±‚ä¹‹é—´åŠ å…¥äº†TLS/SSLæ¥è§£å†³å®‰å…¨é—®é¢˜çš„ã€‚</li><li>åœ¨è¿›è¡Œåº”ç”¨æ•°æ®ä¼ è¾“ä¹‹å‰ï¼ŒTLSéœ€è¦é€šè¿‡æ¡æ‰‹è¿‡ç¨‹æ¥åå•†å®‰å…¨é€šä¿¡æ‰€éœ€çš„ç›¸å…³å‚æ•°ã€‚</li><li>æ•´ä¸ªé€šä¿¡è¿‡ç¨‹ä¸­ä¸»è¦ç”¨åˆ°æ•£åˆ—ã€å¯¹ç§°åŠ å¯†ã€éå¯¹ç§°åŠ å¯†å’Œè¯ä¹¦ç­‰ç›¸å…³æŠ€æœ¯ï¼Œæ¥è§£å†³å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨æ•°æ®ä¼ è¾“ä¸­å„ç§å®‰å…¨é£é™©é—®é¢˜ï¼Œä»è€Œè¾¾åˆ°ä¿è¯æ•´ä¸ªé€šä¿¡è¿‡ç¨‹çš„å®‰å…¨ã€‚</li></ol>]]></content>
      
      
      <categories>
          
          <category> Tech </category>
          
      </categories>
      
      
        <tags>
            
            <tag> NetworkProtocol </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WKWebViewè·å–H5é¡µé¢é‡Œå›¾ç‰‡åœ°å€ä»¥åŠå›¾ç‰‡ç›¸å¯¹è§†å›¾çª—å£çš„åæ ‡çš„æ–¹æ³•</title>
      <link href="/2019-06-01-ios-achieve-h5-image-bounding-rect/"/>
      <url>/2019-06-01-ios-achieve-h5-image-bounding-rect/</url>
      
        <content type="html"><![CDATA[<p>WKWebViewè·å–H5é¡µé¢é‡Œå›¾ç‰‡åœ°å€ä»¥åŠå›¾ç‰‡ç›¸å¯¹è§†å›¾çª—å£çš„åæ ‡çš„æ–¹æ³•</p><p>æœ€è¿‘æœ‰ä¸ªéœ€æ±‚æ˜¯ç‚¹å‡»æ”¾å¤§æŸ¥çœ‹H5å†…å®¹é¡µé¢çš„å›¾ç‰‡ï¼Œå¯»æ‰¾åˆ°ä¸€ä¸ªæ¯”è¾ƒè½»é‡çš„åº“<a href="https://github.com/hackxhj/YHPhotoBrowser" target="_blank" rel="noopener"><code>YHPhotoBrowser</code></a>ï¼Œå…¶ä¸­æ ¹æ®å›¾ç‰‡ä½ç½®æ¥ç¼©æ”¾çš„åŠ¨ç”»éœ€è¦ä¼ é€’ä¸€ä¸ªå›¾ç‰‡æ‰€åœ¨å±å¹•é‡Œçš„ä½ç½®<code>CGRect</code>ï¼Œæƒ³è·å–H5çš„å›¾ç‰‡åæ ‡é‚£å°±éœ€è¦JSæ³¨å…¥äº†</p><a id="more"></a><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)handleSingleTap:(<span class="built_in">UITapGestureRecognizer</span> *)recognizer &#123;</span><br><span class="line">    <span class="built_in">CGPoint</span> touchPoint = [recognizer locationInView:<span class="keyword">self</span>.webView];</span><br><span class="line">    <span class="built_in">NSString</span> *jsString = [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"function getURLandRect()&#123;\</span></span><br><span class="line"><span class="string">                            var ele=document.elementFromPoint(%f, %f);\</span></span><br><span class="line"><span class="string">                            var url=ele.src;\</span></span><br><span class="line"><span class="string">                            var left=ele.getBoundingClientRect().left;\</span></span><br><span class="line"><span class="string">                            var top=ele.getBoundingClientRect().top;\</span></span><br><span class="line"><span class="string">                            var width=ele.getBoundingClientRect().width;\</span></span><br><span class="line"><span class="string">                            var height=ele.getBoundingClientRect().height;\</span></span><br><span class="line"><span class="string">                            var jsonString= `&#123;\"url\":\"$&#123;url&#125;\",\"left\":\"$&#123;left&#125;\",\"top\":\"$&#123;top&#125;\",\"width\":\"$&#123;width&#125;\",\"height\":\"$&#123;height&#125;\"&#125;`;\</span></span><br><span class="line"><span class="string">                            return(jsonString)&#125; getURLandRect()"</span>, touchPoint.x, touchPoint.y];</span><br><span class="line">    </span><br><span class="line">    [<span class="keyword">self</span>.webView evaluateJavaScript:jsString completionHandler:^(<span class="keyword">id</span> _Nullable result, <span class="built_in">NSError</span> * _Nullable error) &#123;</span><br><span class="line">        <span class="built_in">NSDictionary</span> *resultDic = [SmallTools convertToDictionary:(<span class="built_in">NSString</span> *)result];</span><br><span class="line">        <span class="built_in">NSString</span> *imageURL = [SmallTools isNullToString:resultDic[<span class="string">@"url"</span>]];</span><br><span class="line">        <span class="keyword">if</span> (imageURL.length == <span class="number">0</span> || [imageURL isEqualToString:<span class="string">@"undefined"</span>]) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">CGFloat</span> imgX = [resultDic[<span class="string">@"left"</span>] floatValue];</span><br><span class="line">        <span class="built_in">CGFloat</span> imgY = [resultDic[<span class="string">@"top"</span>] floatValue] + NAV_HEIGHT + <span class="number">5</span>;</span><br><span class="line">        <span class="built_in">CGFloat</span> imgW = [resultDic[<span class="string">@"width"</span>] floatValue];</span><br><span class="line">        <span class="built_in">CGFloat</span> imgH = [resultDic[<span class="string">@"height"</span>] floatValue];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">self</span>.photoView = [[YHPhotoBrowser alloc]init];</span><br><span class="line">        <span class="keyword">self</span>.photoView.sourceView = <span class="keyword">self</span>.view; <span class="comment">//å›¾ç‰‡æ‰€åœ¨çš„çˆ¶å®¹å™¨</span></span><br><span class="line">        <span class="keyword">self</span>.photoView.urlImgArr = @[imageURL]; <span class="comment">//ç½‘ç»œé“¾æ¥å›¾ç‰‡çš„æ•°ç»„</span></span><br><span class="line">        <span class="keyword">if</span> (imgX &amp;&amp; imgY &amp;&amp; imgW &amp;&amp; imgH) &#123; <span class="comment">//åŸå›¾ç‰‡æ‰€åœ¨å±å¹•ä½ç½®</span></span><br><span class="line">            <span class="keyword">self</span>.photoView.sourceRect = <span class="built_in">CGRectMake</span>(imgX, imgY, imgW, imgH);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">self</span>.photoView.indexTag = <span class="number">0</span>; <span class="comment">//åˆå§‹åŒ–è¿›å»æ˜¾ç¤ºçš„å›¾ç‰‡ä¸‹æ ‡</span></span><br><span class="line">        [<span class="keyword">self</span>.view addSubview:<span class="keyword">self</span>.photoView]; <span class="comment">//å åŠ åœ¨å½“å‰VCä¸Š</span></span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªJSæ–¹æ³•<code>document.elementFromPoint(%f, %f)</code>æ ¹æ®ä¼ å…¥çš„ç‚¹è¿”å›è¯¥ç‚¹æœ€ä¸Šå±‚çš„å¯¹è±¡ï¼Œé€šè¿‡<code>src</code>æ‰¾åˆ°å›¾ç‰‡çš„é“¾æ¥ï¼Œç„¶å<code>getBoundingClientRect()</code>æ–¹æ³•èƒ½è¿”å›å¯¹è±¡çš„å…«ä¸ªå±æ€§<code>left, top, right, bottom, x, y, width, height</code>ï¼Œæ ¹æ®éœ€è¦è·å–ç›¸åº”å±æ€§æ„é€ åŸå›¾çš„<code>CGRect</code>å³å¯</p><p>è¿™é‡Œé™„å¸¦ä¸€ä¸‹åˆ¤æ–­<code>NSString</code>åˆæ³•æ€§ä»¥åŠ<code>JSON</code>å­—ç¬¦ä¸²è½¬<code>NSDictionary</code>çš„å·¥å…·æ–¹æ³•</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">+ (<span class="built_in">NSString</span> *)isNullToString:(<span class="keyword">id</span>)string &#123;</span><br><span class="line">    <span class="keyword">if</span> ([string isEqual:<span class="string">@"NULL"</span>] || [string isKindOfClass:[<span class="built_in">NSNull</span> <span class="keyword">class</span>]] || [string isEqual:[<span class="built_in">NSNull</span> null]] || [string isEqual:<span class="literal">NULL</span>] || [[string <span class="keyword">class</span>] isSubclassOfClass:[<span class="built_in">NSNull</span> <span class="keyword">class</span>]] || string == <span class="literal">nil</span> || string == <span class="literal">NULL</span> || [string isKindOfClass:[<span class="built_in">NSNull</span> <span class="keyword">class</span>]] || [[string stringByTrimmingCharactersInSet:[<span class="built_in">NSCharacterSet</span> whitespaceAndNewlineCharacterSet]] length]==<span class="number">0</span> || [string isEqualToString:<span class="string">@"&lt;null&gt;"</span>] || [string isEqualToString:<span class="string">@"(null)"</span>]) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">@""</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">NSString</span> *)string;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+ (<span class="built_in">NSDictionary</span> *)convertToDictionary:(<span class="built_in">NSString</span> *)jsonStr &#123;</span><br><span class="line">    <span class="built_in">NSData</span> *data = [jsonStr dataUsingEncoding:<span class="built_in">NSUTF8StringEncoding</span>];</span><br><span class="line">    <span class="built_in">NSDictionary</span> *tempDic = [<span class="built_in">NSJSONSerialization</span> JSONObjectWithData:data options:<span class="number">0</span> error:<span class="literal">nil</span>];</span><br><span class="line">    <span class="keyword">return</span> tempDic;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Tech </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
            <tag> Objective-C </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LeetCodeåšé¢˜ç¬”è®°â€”å¹¶æŸ¥é›†ç›¸å…³é¢˜ç›®</title>
      <link href="/2019-05-24-leetcode-union-find/"/>
      <url>/2019-05-24-leetcode-union-find/</url>
      
        <content type="html"><![CDATA[<p>æœ‰å…³å¹¶æŸ¥é›† Union Find Set çš„åšé¢˜ç¬”è®°ï¼ŒPythonå®ç°</p><a id="more"></a><h2 id="200-å²›å±¿çš„ä¸ªæ•°-Number-of-Islands"><a href="#200-å²›å±¿çš„ä¸ªæ•°-Number-of-Islands" class="headerlink" title="200. å²›å±¿çš„ä¸ªæ•° Number of Islands"></a>200. å²›å±¿çš„ä¸ªæ•° Number of Islands</h2><p><a href="https://leetcode-cn.com/problems/number-of-islands/" target="_blank" rel="noopener">LeetCodeCN ç¬¬200é¢˜é“¾æ¥</a></p><p>ç¬¬ä¸€ç§æ–¹æ³•ï¼šæ„é€ ä¸€ä¸ªç®€å•çš„å¹¶æŸ¥é›†ï¼Œå°†è¾“å…¥çš„äºŒç»´æ•°ç»„åæ ‡ä¸€ç»´åŒ–ã€‚</p><p>å®ä¾‹åŒ–å¹¶æŸ¥é›†å¯¹è±¡åï¼Œéå†äºŒç»´æ•°ç»„ï¼Œå‘ç°ä¸º<code>1</code>æ—¶å¯¹è¯¥èŠ‚ç‚¹ä¸Šä¸‹å·¦å³éƒ½æ‰§è¡Œä¸€æ¬¡<code>union()</code>ï¼Œå°†è¿™ä¸Šä¸‹å·¦å³çš„<code>1</code> ï¼ˆå¦‚æœæ˜¯çš„è¯ï¼‰çš„<code>parent</code>æŒ‡å‘å½“å‰èŠ‚ç‚¹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UnionFind</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, grid)</span>:</span></span><br><span class="line">        n, m = len(grid), len(grid[<span class="number">0</span>])</span><br><span class="line">        self.count = <span class="number">0</span></span><br><span class="line">        self.parent = [<span class="number">-1</span>] * (n*m)</span><br><span class="line">        <span class="comment"># self.rank = [0] * (n*m)</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(m):</span><br><span class="line">                <span class="keyword">if</span> grid[i][j] == <span class="string">'1'</span>:</span><br><span class="line">                    self.parent[i*m + j] = i*m + j</span><br><span class="line">                    self.count += <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># åœ¨æŸ¥æ‰¾çš„åŒæ—¶ï¼Œä¹ŸæŠŠèŠ‚ç‚¹æ¢ç»‘åˆ°æ ¹èŠ‚ç‚¹ä¸Šäº†</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">find</span><span class="params">(self, i)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> self.parent[i] != i:</span><br><span class="line">            self.parent[i] = self.find(self.parent[i])</span><br><span class="line">        <span class="keyword">return</span> self.parent[i]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">union</span><span class="params">(self, x, y)</span>:</span></span><br><span class="line">        rootx = self.find(x)</span><br><span class="line">        rooty = self.find(y)</span><br><span class="line">        <span class="keyword">if</span> rootx != rooty:</span><br><span class="line">            self.parent[rooty] = rootx</span><br><span class="line">            self.count -= <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">numIslands</span><span class="params">(self, grid)</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> grid:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        uf = UnionFind(grid)</span><br><span class="line">        directions = [(<span class="number">0</span>,<span class="number">1</span>), (<span class="number">0</span>,<span class="number">-1</span>), (<span class="number">-1</span>,<span class="number">0</span>), (<span class="number">1</span>,<span class="number">0</span>)]</span><br><span class="line">        n, m = len(grid), len(grid[<span class="number">0</span>])</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(m):</span><br><span class="line">                <span class="keyword">if</span> grid[i][j] == <span class="string">'1'</span>:</span><br><span class="line">                    <span class="keyword">for</span> x, y <span class="keyword">in</span> directions:</span><br><span class="line">                        <span class="keyword">if</span> <span class="number">0</span> &lt;= i+x &lt; n <span class="keyword">and</span> <span class="number">0</span> &lt;= j+y &lt; m <span class="keyword">and</span> grid[i+x][j+y] == <span class="string">'1'</span>:</span><br><span class="line">                            uf.union(i*m+j, (i+x)*m+(j+y))</span><br><span class="line">        <span class="keyword">return</span> uf.count</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ–¹æ³•ï¼šæŸ“è‰²è§£æ³•ï¼ŒDFSæ·±åº¦ä¼˜å…ˆæœç´¢æ¸…é™¤ç›¸é‚»å²›å±¿ï¼Œéå†äºŒç»´æ•°ç»„ï¼Œå‘ç°ä¸º<code>1</code>æ—¶å²›å±¿æ•°é‡åŠ 1ï¼ŒåŒæ—¶DFSå°†è‡ªèº«åŠå‘¨è¾¹ç›¸é‚»ï¼ˆä¸Šä¸‹å·¦å³ï¼‰ä½ç½®é€’å½’ç½®<code>0</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">numIslands</span><span class="params">(self, grid: List[List[str]])</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> grid:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        self.grid, count = grid, <span class="number">0</span></span><br><span class="line">        self.n, self.m = len(grid), len(grid[<span class="number">0</span>])</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(self.n):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(self.m):</span><br><span class="line">                <span class="keyword">if</span> grid[i][j] == <span class="string">'1'</span>:</span><br><span class="line">                    count += <span class="number">1</span></span><br><span class="line">                    self.dfs(i, j)</span><br><span class="line">        <span class="keyword">return</span> count</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">dfs</span><span class="params">(self, i, j)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="number">0</span> &lt;= i &lt; self.n <span class="keyword">and</span> <span class="number">0</span> &lt;= j &lt; self.m <span class="keyword">and</span> self.grid[i][j] == <span class="string">'1'</span>:</span><br><span class="line">            self.grid[i][j] = <span class="string">'0'</span></span><br><span class="line">            self.dfs(i<span class="number">-1</span>, j)</span><br><span class="line">            self.dfs(i+<span class="number">1</span>, j)</span><br><span class="line">            self.dfs(i, j<span class="number">-1</span>)</span><br><span class="line">            self.dfs(i, j+<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰ç§æ–¹æ³•ï¼šæŸ“è‰²è§£æ³•ï¼ŒBFSå¹¿åº¦ä¼˜å…ˆæœç´¢æ¸…é™¤ç›¸é‚»å²›å±¿ï¼Œéå†äºŒç»´æ•°ç»„ï¼Œå‘ç°ä¸º<code>1</code>æ—¶å²›å±¿æ•°é‡åŠ 1ï¼ŒåŒæ—¶BFSå°†è‡ªèº«åŠå‘¨è¾¹ç›¸é‚»ï¼ˆä¸Šä¸‹å·¦å³ï¼‰ä½ç½®ç”¨é˜Ÿåˆ—é€ä¸ªç½®<code>0</code>ï¼ŒæŠŠä¸Šé¢çš„DFSçš„é€’å½’æ”¹æˆBFSçš„é˜Ÿåˆ—å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">numIslands</span><span class="params">(self, grid: List[List[str]])</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> grid:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        self.grid, count = grid, <span class="number">0</span></span><br><span class="line">        self.n, self.m = len(grid), len(grid[<span class="number">0</span>])</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(self.n):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(self.m):</span><br><span class="line">                <span class="keyword">if</span> grid[i][j] == <span class="string">'1'</span>:</span><br><span class="line">                    count += <span class="number">1</span></span><br><span class="line">                    self.bfs(i, j)</span><br><span class="line">        <span class="keyword">return</span> count</span><br><span class="line">                    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">bfs</span><span class="params">(self, i, j)</span>:</span></span><br><span class="line">        queue = deque()</span><br><span class="line">        queue.append((i, j))</span><br><span class="line">        <span class="keyword">while</span> queue:</span><br><span class="line">            i, j = queue.popleft()</span><br><span class="line">            <span class="keyword">if</span> <span class="number">0</span> &lt;= i &lt; self.n <span class="keyword">and</span> <span class="number">0</span> &lt;= j &lt; self.m <span class="keyword">and</span> self.grid[i][j] == <span class="string">'1'</span>:</span><br><span class="line">                self.grid[i][j] = <span class="string">'0'</span></span><br><span class="line">                queue.append((i<span class="number">-1</span>, j))</span><br><span class="line">                queue.append((i+<span class="number">1</span>, j))</span><br><span class="line">                queue.append((i, j<span class="number">-1</span>))</span><br><span class="line">                queue.append((i, j+<span class="number">1</span>))</span><br></pre></td></tr></table></figure><h2 id="547-æœ‹å‹åœˆ-Friend-Circles"><a href="#547-æœ‹å‹åœˆ-Friend-Circles" class="headerlink" title="547. æœ‹å‹åœˆ Friend Circles"></a>547. æœ‹å‹åœˆ Friend Circles</h2><p><a href="https://leetcode-cn.com/problems/friend-circles/" target="_blank" rel="noopener">LeetCodeCN ç¬¬547é¢˜</a></p><p>ç¬¬ä¸€ç§æ–¹æ³•ï¼šæ„é€ ä¸€ä¸ªç®€å•çš„å¹¶æŸ¥é›†ï¼Œå°†è¾“å…¥çš„äºŒç»´æ•°ç»„åæ ‡ä¸€ç»´åŒ–ã€‚</p><p>å®ä¾‹åŒ–å¹¶æŸ¥é›†å¯¹è±¡åï¼Œéå†äºŒç»´æ•°ç»„ï¼Œå‘ç°ä¸º<code>1</code>æ—¶å¯¹è¯¥èŠ‚ç‚¹ä¸Šä¸‹å·¦å³éƒ½æ‰§è¡Œä¸€æ¬¡<code>union()</code>ï¼Œå°†è¿™ä¸Šä¸‹å·¦å³çš„<code>1</code> ï¼ˆå¦‚æœæ˜¯çš„è¯ï¼‰çš„<code>parent</code>æŒ‡å‘å½“å‰èŠ‚ç‚¹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UnionFind</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, M)</span>:</span></span><br><span class="line">        self.n = len(M)</span><br><span class="line">        self.parent = list(range(self.n))</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># åœ¨æŸ¥æ‰¾çš„åŒæ—¶ï¼Œä¹ŸæŠŠèŠ‚ç‚¹æ¢ç»‘åˆ°æ ¹èŠ‚ç‚¹ä¸Šäº†</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">find</span><span class="params">(self, i)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> self.parent[i] != i:</span><br><span class="line">            self.parent[i] = self.find(self.parent[i])</span><br><span class="line">        <span class="keyword">return</span> self.parent[i]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">union</span><span class="params">(self, x, y)</span>:</span></span><br><span class="line">        rootx = self.find(x)</span><br><span class="line">        rooty = self.find(y)</span><br><span class="line">        <span class="keyword">if</span> rootx != rooty:</span><br><span class="line">            self.parent[rooty] = rootx</span><br><span class="line">            </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">diff_groups</span><span class="params">(self)</span>:</span></span><br><span class="line">        diff_groups = set()</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(self.n):</span><br><span class="line">            diff_groups.add(self.find(i))</span><br><span class="line">        <span class="keyword">return</span> len(diff_groups)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">findCircleNum</span><span class="params">(self, M)</span> -&gt; int:</span></span><br><span class="line">        uf = UnionFind(M)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(M)):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(len(M)):</span><br><span class="line">                <span class="keyword">if</span> M[i][j]:</span><br><span class="line">                    uf.union(i, j)</span><br><span class="line">        <span class="keyword">return</span> uf.diff_groups()</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ–¹æ³•ï¼šDFSï¼Œ é¦–å…ˆæˆ‘ä»¬è¿›è¡Œæƒ…æ™¯è½¬æ¢ï¼Œå¦‚æœæŠŠæ¯ä¸ªåŒå­¦çœ‹ä½œä¸€ä¸ªåŸå¸‚ï¼ŒåŒå­¦ä¸åŒå­¦ä¹‹é—´çš„æœ‹å‹å…³ç³»è¡¨ç¤ºä¸¤ä¸ªåŸå¸‚ä¹‹é—´å­˜åœ¨å…¬è·¯ï¼ˆå¯äº’ç›¸åˆ°è¾¾ï¼‰ã€‚é‚£ä¹ˆæœ‹å‹åœˆçš„ä¸ªæ•°å°±è½¬æ¢ä¸ºåŸå¸‚åœˆçš„ä¸ªæ•°ã€‚æˆ‘ä»¬æ¯æ¬¡ä»æ•´ä¸ªåŸå¸‚é›†åˆä¸­æŒ‘é€‰å‡ºä¸€ä¸ªæœªè®¿é—®çš„åŸå¸‚ï¼Œæ¥ç€æˆ‘ä»¬è®¿é—®å®ƒæ‰€èƒ½åˆ°è¾¾çš„æ‰€æœ‰åŸå¸‚ï¼ˆé€’å½’ï¼Œæ·±åº¦ä¼˜å…ˆæœç´¢ï¼‰ã€‚é‚£ä¹ˆæˆ‘ä»¬æŒ‘é€‰äº†å‡ æ¬¡å°±æ˜¯è®¿é—®åˆ°äº†å¤šå°‘ä¸ªåŸå¸‚åœˆã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">findCircleNum</span><span class="params">(self, M: List[List[int]])</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> M:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        self.M, self.n, self.visited, count = M, len(M), set(), <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(self.n):</span><br><span class="line">                <span class="keyword">if</span> i <span class="keyword">not</span> <span class="keyword">in</span> self.visited:</span><br><span class="line">                    count += <span class="number">1</span></span><br><span class="line">                    self.dfs(i)</span><br><span class="line">        <span class="keyword">return</span> count</span><br><span class="line">                    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">dfs</span><span class="params">(self, i)</span>:</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(self.n):</span><br><span class="line">            <span class="keyword">if</span> self.M[i][j] == <span class="number">1</span> <span class="keyword">and</span> j <span class="keyword">not</span> <span class="keyword">in</span> self.visited:</span><br><span class="line">                self.visited.add(j)</span><br><span class="line">                self.dfs(j)</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰ç§æ–¹æ³•ï¼šBFSï¼ŒæŠŠä¸Šé¢çš„DFSçš„é€’å½’å†™æ³•æ”¹æˆBFSçš„é˜Ÿåˆ—å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">findCircleNum</span><span class="params">(self, M: List[List[int]])</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> M:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        n, visited, count, queue = len(M), set(), <span class="number">0</span>, deque()</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">            <span class="keyword">if</span> i <span class="keyword">not</span> <span class="keyword">in</span> visited:</span><br><span class="line">                count += <span class="number">1</span></span><br><span class="line">                queue.append(i)</span><br><span class="line">                <span class="keyword">while</span> queue:</span><br><span class="line">                    p = queue.popleft()</span><br><span class="line">                    visited.add(p)</span><br><span class="line">                    <span class="keyword">for</span> j <span class="keyword">in</span> range(n):</span><br><span class="line">                        <span class="keyword">if</span> M[p][j] == <span class="number">1</span> <span class="keyword">and</span> j <span class="keyword">not</span> <span class="keyword">in</span> visited:</span><br><span class="line">                            queue.append(j)</span><br><span class="line">        <span class="keyword">return</span> count</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Algorithm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LeetCode </tag>
            
            <tag> Algorithm </tag>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç²—è°ˆiOSä¸­ weakã€selfã€å¾ªç¯å¼•ç”¨çš„äºŒä¸‰äº‹</title>
      <link href="/2019-05-21-ios-weakself-retain-cycle/"/>
      <url>/2019-05-21-ios-weakself-retain-cycle/</url>
      
        <content type="html"><![CDATA[<p>æœ‰å…³weakã€selfã€å¾ªç¯å¼•ç”¨çš„ä¸€äº›é—®é¢˜</p><h2 id="0-ä»€ä¹ˆæ˜¯å¾ªç¯å¼•ç”¨ï¼Œåæœæ˜¯ä»€ä¹ˆ"><a href="#0-ä»€ä¹ˆæ˜¯å¾ªç¯å¼•ç”¨ï¼Œåæœæ˜¯ä»€ä¹ˆ" class="headerlink" title="0. ä»€ä¹ˆæ˜¯å¾ªç¯å¼•ç”¨ï¼Œåæœæ˜¯ä»€ä¹ˆ"></a>0. ä»€ä¹ˆæ˜¯å¾ªç¯å¼•ç”¨ï¼Œåæœæ˜¯ä»€ä¹ˆ</h2><a id="more"></a><p>å¾ªç¯å¼•ç”¨å¯ä»¥ç®€å•ç†è§£ä¸º<code>A</code>å¼•ç”¨äº†<code>B</code>ï¼Œè€Œ<code>B</code>åˆå¼•ç”¨äº†<code>A</code>ï¼ŒåŒæ–¹éƒ½åŒæ—¶ä¿æŒå¯¹æ–¹çš„ä¸€ä¸ªå¼•ç”¨ï¼Œå¯¼è‡´ä»»ä½•æ—¶å€™å¼•ç”¨è®¡æ•°éƒ½ä¸ä¸º<code>0</code>ï¼Œå§‹ç»ˆæ— æ³•é‡Šæ”¾ã€‚è‹¥å½“å‰å¯¹è±¡æ˜¯ä¸€ä¸ª<code>ViewController</code>ï¼Œåˆ™åœ¨<code>dismiss</code>æˆ–è€…<code>pop</code>ä¹‹åå…¶<code>dealloc</code>æ— æ³•è¢«è°ƒç”¨ï¼Œåœ¨é¢‘ç¹çš„<code>push</code>æˆ–è€…<code>present</code>ä¹‹åå†…å­˜æš´å¢ï¼Œå°±ä¼šCrashã€‚</p><p><a href="https://paaatrick.com/2019-05-19-ios-arc-gc/">å…³äºARCçš„ä»‹ç»</a></p><h2 id="1-åœ¨ä½¿ç”¨blockæ—¶ï¼Œä¸ºäº†é¿å…äº§ç”Ÿå¾ªç¯å¼•ç”¨ï¼Œé€šå¸¸ä¼šä½¿ç”¨weakSelfä¸strongSelfï¼Œä¾‹å¦‚å¦‚ä¸‹ä»£ç ï¼Œé‚£ä¹ˆä»€ä¹ˆæ—¶å€™åœ¨-blocké‡Œé¢ç”¨selfï¼Œä»€ä¹ˆæ—¶å€™ä¸éœ€è¦ä½¿ç”¨weakSelf"><a href="#1-åœ¨ä½¿ç”¨blockæ—¶ï¼Œä¸ºäº†é¿å…äº§ç”Ÿå¾ªç¯å¼•ç”¨ï¼Œé€šå¸¸ä¼šä½¿ç”¨weakSelfä¸strongSelfï¼Œä¾‹å¦‚å¦‚ä¸‹ä»£ç ï¼Œé‚£ä¹ˆä»€ä¹ˆæ—¶å€™åœ¨-blocké‡Œé¢ç”¨selfï¼Œä»€ä¹ˆæ—¶å€™ä¸éœ€è¦ä½¿ç”¨weakSelf" class="headerlink" title="1. åœ¨ä½¿ç”¨blockæ—¶ï¼Œä¸ºäº†é¿å…äº§ç”Ÿå¾ªç¯å¼•ç”¨ï¼Œé€šå¸¸ä¼šä½¿ç”¨weakSelfä¸strongSelfï¼Œä¾‹å¦‚å¦‚ä¸‹ä»£ç ï¼Œé‚£ä¹ˆä»€ä¹ˆæ—¶å€™åœ¨  blocké‡Œé¢ç”¨selfï¼Œä»€ä¹ˆæ—¶å€™ä¸éœ€è¦ä½¿ç”¨weakSelf"></a>1. åœ¨ä½¿ç”¨<code>block</code>æ—¶ï¼Œä¸ºäº†é¿å…äº§ç”Ÿå¾ªç¯å¼•ç”¨ï¼Œé€šå¸¸ä¼šä½¿ç”¨<code>weakSelf</code>ä¸<code>strongSelf</code>ï¼Œä¾‹å¦‚å¦‚ä¸‹ä»£ç ï¼Œé‚£ä¹ˆä»€ä¹ˆæ—¶å€™åœ¨  <code>block</code>é‡Œé¢ç”¨<code>self</code>ï¼Œä»€ä¹ˆæ—¶å€™ä¸éœ€è¦ä½¿ç”¨<code>weakSelf</code></h2><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">__<span class="keyword">weak</span> <span class="keyword">typeof</span>(<span class="keyword">self</span>) weakSelf = <span class="keyword">self</span>;</span><br><span class="line">[<span class="keyword">self</span> doSomeBlockJob:^&#123;</span><br><span class="line">    __<span class="keyword">strong</span> <span class="keyword">typeof</span>(weakSelf) strongSelf = weakSelf;</span><br><span class="line">    <span class="keyword">if</span> (strongSelf) &#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure><p>å½“ <code>block</code> æœ¬èº«ä¸è¢« <code>self</code> æŒæœ‰ï¼Œè€Œè¢«åˆ«çš„å¯¹è±¡æŒæœ‰ï¼ŒåŒæ—¶ä¸äº§ç”Ÿå¾ªç¯å¼•ç”¨çš„æ—¶å€™ï¼Œå°±ä¸éœ€è¦ä½¿ç”¨ <code>weakSelf</code> äº†ã€‚æœ€å¸¸è§çš„ä»£ç å°±æ˜¯ <code>UIView</code> çš„åŠ¨ç”»ä»£ç ï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨ <code>UIView</code> çš„ <code>animateWithDuration:animations</code> æ–¹æ³•åšåŠ¨ç”»çš„æ—¶å€™ï¼Œå¹¶ä¸éœ€è¦ä½¿ç”¨ <code>weakSelf</code>ï¼Œå› ä¸ºå¼•ç”¨æŒæœ‰å…³ç³»æ˜¯ï¼š</p><ul><li><code>UIView</code> çš„æŸä¸ªè´Ÿè´£åŠ¨ç”»çš„å¯¹è±¡æŒæœ‰äº† <code>block</code></li><li><code>block</code> æŒæœ‰äº† <code>self</code></li></ul><p>å› ä¸º <code>self</code> å¹¶ä¸æŒæœ‰ <code>block</code>ï¼Œæ‰€ä»¥å°±æ²¡æœ‰å¾ªç¯å¼•ç”¨äº§ç”Ÿï¼Œå› ä¸ºå°±ä¸éœ€è¦ä½¿ç”¨ <code>weakSelf</code> äº†ã€‚</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[<span class="built_in">UIView</span> animateWithDuration:<span class="number">0.2</span> animations:^&#123;</span><br><span class="line">    <span class="keyword">self</span>.alpha = <span class="number">1</span>;</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure><p>å½“åŠ¨ç”»ç»“æŸæ—¶ï¼Œ<code>UIView</code> ä¼šç»“æŸæŒæœ‰è¿™ä¸ª <code>block</code>ï¼Œå¦‚æœæ²¡æœ‰åˆ«çš„å¯¹è±¡æŒæœ‰ <code>block</code> çš„è¯ï¼Œ<code>block</code> å¯¹è±¡å°±ä¼šé‡Šæ”¾æ‰ï¼Œä»è€Œ <code>block</code> ä¼šé‡Šæ”¾æ‰å¯¹äº <code>self</code> çš„æŒæœ‰ã€‚æ•´ä¸ªå†…å­˜å¼•ç”¨å…³ç³»è¢«è§£é™¤ã€‚</p><h2 id="2-block-é‡Œé¢è¿˜éœ€è¦å†™ä¸€ä¸ª-strongSelf-çš„åŸå› ï¼Œå¦‚æœä¸å†™ä¼šå‘ç”Ÿä»€ä¹ˆ"><a href="#2-block-é‡Œé¢è¿˜éœ€è¦å†™ä¸€ä¸ª-strongSelf-çš„åŸå› ï¼Œå¦‚æœä¸å†™ä¼šå‘ç”Ÿä»€ä¹ˆ" class="headerlink" title="2. block é‡Œé¢è¿˜éœ€è¦å†™ä¸€ä¸ª strongSelf çš„åŸå› ï¼Œå¦‚æœä¸å†™ä¼šå‘ç”Ÿä»€ä¹ˆ"></a>2. <code>block</code> é‡Œé¢è¿˜éœ€è¦å†™ä¸€ä¸ª <code>strongSelf</code> çš„åŸå› ï¼Œå¦‚æœä¸å†™ä¼šå‘ç”Ÿä»€ä¹ˆ</h2><p>å¤–éƒ¨çš„<code>weakSelf</code>æ˜¯ä¸ºäº†æ‰“ç ´ç¯ï¼Œä»è€Œä½¿å¾—æ²¡æœ‰å¾ªç¯å¼•ç”¨ï¼Œè€Œå†…éƒ¨çš„<code>strongSelf</code>ä»…ä»…æ˜¯ä¸ªå±€éƒ¨å˜é‡ï¼Œå­˜åœ¨æ ˆä¸­ï¼Œä¼šåœ¨<code>block</code>æ‰§è¡Œç»“æŸåå›æ”¶ï¼Œä¸ä¼šå†é€ æˆå¾ªç¯å¼•ç”¨ã€‚</p><p>åœ¨ <code>block</code> ä¸­å…ˆå†™ä¸€ä¸ª <code>strongSelf</code>ï¼Œå…¶å®æ˜¯ä¸ºäº†é¿å…åœ¨ <code>block</code> çš„æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œçªç„¶å‡ºç° <code>self</code> è¢«é‡Šæ”¾çš„å°´å°¬æƒ…å†µã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œå¦‚æœä¸è¿™ä¹ˆåšçš„è¯ï¼Œè¿˜æ˜¯å¾ˆå®¹æ˜“å‡ºç°ä¸€äº›å¥‡æ€ªçš„é€»è¾‘ï¼Œç”šè‡³é—ªé€€ã€‚</p><p>ä»¥ <code>AFNetworking</code> ä¸­ <code>AFNetworkReachabilityManager.m</code> çš„ä¸€æ®µä»£ç ä¸¾ä¾‹ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">__<span class="keyword">weak</span> __<span class="keyword">typeof</span>(<span class="keyword">self</span>)weakSelf = <span class="keyword">self</span>;</span><br><span class="line">AFNetworkReachabilityStatusBlock callback = ^(AFNetworkReachabilityStatus status) &#123;</span><br><span class="line">    __<span class="keyword">strong</span> __<span class="keyword">typeof</span>(weakSelf)strongSelf = weakSelf;</span><br><span class="line"></span><br><span class="line">    strongSelf.networkReachabilityStatus = status;</span><br><span class="line">    <span class="keyword">if</span> (strongSelf.networkReachabilityStatusBlock) &#123;</span><br><span class="line">        strongSelf.networkReachabilityStatusBlock(status);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>å¦‚æœæ²¡æœ‰ <code>strongSelf</code> çš„é‚£è¡Œä»£ç ï¼Œé‚£ä¹ˆåé¢çš„æ¯ä¸€è¡Œä»£ç æ‰§è¡Œæ—¶ï¼Œ<code>self</code> éƒ½å¯èƒ½è¢«é‡Šæ”¾æ‰äº†ï¼Œè¿™æ ·å¾ˆå¯èƒ½é€ æˆé€»è¾‘å¼‚å¸¸ã€‚</p><p>ç‰¹åˆ«æ˜¯å½“æˆ‘ä»¬æ­£åœ¨æ‰§è¡Œ <code>strongSelf.networkReachabilityStatusBlock(status);</code>è¿™ä¸ª <code>block</code> é—­åŒ…æ—¶ï¼Œå¦‚æœè¿™ä¸ª <code>block</code> æ‰§è¡Œåˆ°ä¸€åŠæ—¶ <code>self</code> é‡Šæ”¾ï¼Œé‚£ä¹ˆå¤šåŠæƒ…å†µä¸‹ä¼š Crashã€‚</p><h2 id="3-æœ‰æ²¡æœ‰è¿™æ ·ä¸€ä¸ªéœ€æ±‚åœºæ™¯ï¼Œblock-ä¼šäº§ç”Ÿå¾ªç¯å¼•ç”¨ï¼Œä½†æ˜¯ä¸šåŠ¡åˆéœ€è¦ä½ ä¸èƒ½ä½¿ç”¨-weakSelf-å¦‚æœæœ‰ï¼Œè¯·ä¸¾ä¸€ä¸ªä¾‹å­å¹¶ä¸”è§£é‡Šè¿™ç§æƒ…å†µä¸‹å¦‚ä½•è§£å†³å¾ªç¯å¼•ç”¨é—®é¢˜ã€‚"><a href="#3-æœ‰æ²¡æœ‰è¿™æ ·ä¸€ä¸ªéœ€æ±‚åœºæ™¯ï¼Œblock-ä¼šäº§ç”Ÿå¾ªç¯å¼•ç”¨ï¼Œä½†æ˜¯ä¸šåŠ¡åˆéœ€è¦ä½ ä¸èƒ½ä½¿ç”¨-weakSelf-å¦‚æœæœ‰ï¼Œè¯·ä¸¾ä¸€ä¸ªä¾‹å­å¹¶ä¸”è§£é‡Šè¿™ç§æƒ…å†µä¸‹å¦‚ä½•è§£å†³å¾ªç¯å¼•ç”¨é—®é¢˜ã€‚" class="headerlink" title="3. æœ‰æ²¡æœ‰è¿™æ ·ä¸€ä¸ªéœ€æ±‚åœºæ™¯ï¼Œblock ä¼šäº§ç”Ÿå¾ªç¯å¼•ç”¨ï¼Œä½†æ˜¯ä¸šåŠ¡åˆéœ€è¦ä½ ä¸èƒ½ä½¿ç”¨ weakSelf? å¦‚æœæœ‰ï¼Œè¯·ä¸¾ä¸€ä¸ªä¾‹å­å¹¶ä¸”è§£é‡Šè¿™ç§æƒ…å†µä¸‹å¦‚ä½•è§£å†³å¾ªç¯å¼•ç”¨é—®é¢˜ã€‚"></a>3. æœ‰æ²¡æœ‰è¿™æ ·ä¸€ä¸ªéœ€æ±‚åœºæ™¯ï¼Œ<code>block</code> ä¼šäº§ç”Ÿå¾ªç¯å¼•ç”¨ï¼Œä½†æ˜¯ä¸šåŠ¡åˆéœ€è¦ä½ ä¸èƒ½ä½¿ç”¨ <code>weakSelf</code>? å¦‚æœæœ‰ï¼Œè¯·ä¸¾ä¸€ä¸ªä¾‹å­å¹¶ä¸”è§£é‡Šè¿™ç§æƒ…å†µä¸‹å¦‚ä½•è§£å†³å¾ªç¯å¼•ç”¨é—®é¢˜ã€‚</h2><p>éœ€è¦ä¸ä½¿ç”¨ <code>weakSelf</code> çš„åœºæ™¯æ˜¯ï¼šä½ éœ€è¦æ„é€ ä¸€ä¸ªå¾ªç¯å¼•ç”¨ï¼Œä»¥ä¾¿ä¿è¯å¼•ç”¨åŒæ–¹éƒ½å­˜åœ¨ã€‚æ¯”å¦‚ä½ æœ‰ä¸€ä¸ªåå°çš„ä»»åŠ¡ï¼Œå¸Œæœ›ä»»åŠ¡æ‰§è¡Œå®Œåï¼Œé€šçŸ¥å¦å¤–ä¸€ä¸ªå®ä¾‹ã€‚åœ¨ <code>YTKNetwork</code> ç½‘ç»œåº“çš„æºç ä¸­ï¼Œå°±æœ‰è¿™æ ·çš„åœºæ™¯ã€‚</p><p>åœ¨ <code>YTKNetwork</code> åº“ä¸­ï¼Œæˆ‘ä»¬çš„æ¯ä¸€ä¸ªç½‘ç»œè¯·æ±‚ API ä¼šæŒæœ‰å›è°ƒçš„ <code>block</code>ï¼Œå›è°ƒçš„ <code>block</code> ä¼šæŒæœ‰ <code>self</code>ï¼Œè€Œå¦‚æœ <code>self</code> ä¹ŸæŒæœ‰ç½‘ç»œè¯·æ±‚ API çš„è¯ï¼Œæˆ‘ä»¬å°±æ„é€ äº†ä¸€ä¸ªå¾ªç¯å¼•ç”¨ã€‚è™½ç„¶æˆ‘ä»¬æ„é€ å‡ºäº†å¾ªç¯å¼•ç”¨ï¼Œä½†æ˜¯å› ä¸ºåœ¨ç½‘ç»œè¯·æ±‚ç»“æŸæ—¶ï¼Œç½‘ç»œè¯·æ±‚ API ä¼šä¸»åŠ¨é‡Šæ”¾å¯¹ <code>block</code> çš„æŒæœ‰ï¼Œå› æ­¤ï¼Œæ•´ä¸ªå¾ªç¯é“¾æ¡è¢«è§£å¼€ï¼Œå¾ªç¯å¼•ç”¨å°±è¢«æ‰“ç ´äº†ï¼Œæ‰€ä»¥ä¸ä¼šæœ‰å†…å­˜æ³„æ¼é—®é¢˜ã€‚ä»£ç å…¶å®å¾ˆç®€å•ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//  YTKBaseRequest.m</span></span><br><span class="line">- (<span class="keyword">void</span>)clearCompletionBlock &#123;</span><br><span class="line">    <span class="comment">// nil out to break the retain cycle.</span></span><br><span class="line">    <span class="keyword">self</span>.successCompletionBlock = <span class="literal">nil</span>;</span><br><span class="line">    <span class="keyword">self</span>.failureCompletionBlock = <span class="literal">nil</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ€»ç»“æ¥è¯´ï¼Œè§£å†³å¾ªç¯å¼•ç”¨é—®é¢˜ä¸»è¦æœ‰ä¸¤ä¸ªåŠæ³•ï¼š</p><p>ç¬¬ä¸€ä¸ªåŠæ³•æ˜¯ã€Œäº‹å‰é¿å…ã€ï¼Œæˆ‘ä»¬åœ¨ä¼šäº§ç”Ÿå¾ªç¯å¼•ç”¨çš„åœ°æ–¹ä½¿ç”¨ <code>weak</code> å¼±å¼•ç”¨ï¼Œä»¥é¿å…äº§ç”Ÿå¾ªç¯å¼•ç”¨ã€‚</p><p>ç¬¬äºŒä¸ªåŠæ³•æ˜¯ã€Œäº‹åè¡¥æ•‘ã€ï¼Œæˆ‘ä»¬æ˜ç¡®çŸ¥é“ä¼šå­˜åœ¨å¾ªç¯å¼•ç”¨ï¼Œä½†æ˜¯æˆ‘ä»¬åœ¨åˆç†çš„ä½ç½®ä¸»åŠ¨æ–­å¼€ç¯ä¸­çš„ä¸€ä¸ªå¼•ç”¨ï¼Œä½¿å¾—å¯¹è±¡å¾—ä»¥å›æ”¶ã€‚</p><h2 id="4-weak-å˜é‡åœ¨å¼•ç”¨è®¡æ•°ä¸º0æ—¶ï¼Œä¼šè¢«è‡ªåŠ¨è®¾ç½®æˆ-nil-çš„è¿™ä¸ªç‰¹æ€§çš„å®ç°åŸç†"><a href="#4-weak-å˜é‡åœ¨å¼•ç”¨è®¡æ•°ä¸º0æ—¶ï¼Œä¼šè¢«è‡ªåŠ¨è®¾ç½®æˆ-nil-çš„è¿™ä¸ªç‰¹æ€§çš„å®ç°åŸç†" class="headerlink" title="4. weak å˜é‡åœ¨å¼•ç”¨è®¡æ•°ä¸º0æ—¶ï¼Œä¼šè¢«è‡ªåŠ¨è®¾ç½®æˆ nil çš„è¿™ä¸ªç‰¹æ€§çš„å®ç°åŸç†"></a>4. weak å˜é‡åœ¨å¼•ç”¨è®¡æ•°ä¸º0æ—¶ï¼Œä¼šè¢«è‡ªåŠ¨è®¾ç½®æˆ nil çš„è¿™ä¸ªç‰¹æ€§çš„å®ç°åŸç†</h2><blockquote><p>ç®€å•æ¥è¯´ï¼Œç³»ç»Ÿå¯¹äºæ¯ä¸€ä¸ªæœ‰å¼±å¼•ç”¨çš„å¯¹è±¡ï¼Œéƒ½ç»´æŠ¤ä¸€ä¸ªè¡¨æ¥è®°å½•å®ƒæ‰€æœ‰çš„å¼±å¼•ç”¨çš„æŒ‡é’ˆåœ°å€ã€‚è¿™æ ·ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨è®¡æ•°ä¸º <code>0</code> æ—¶ï¼Œç³»ç»Ÿå°±é€šè¿‡è¿™å¼ è¡¨ï¼Œæ‰¾åˆ°æ‰€æœ‰çš„å¼±å¼•ç”¨æŒ‡é’ˆï¼Œç»§è€ŒæŠŠå®ƒä»¬éƒ½ç½®æˆ <code>nil</code>ã€‚<br>æ‰€ä»¥ä½¿ç”¨<code>weak</code>ä¼šæœ‰é¢å¤–çš„å¼€é”€</p></blockquote><p>åœ¨ Friday QA ä¸Šï¼Œ<a href="https://mikeash.com/pyblog/friday-qa-2010-07-16-zeroing-weak-references-in-objective-c.html" target="_blank" rel="noopener">æœ‰ä¸€æœŸä¸“é—¨ä»‹ç»</a> <code>weak</code> çš„å®ç°åŸç†ã€‚</p><p>ã€ŠObjective-Cé«˜çº§ç¼–ç¨‹ã€‹ä¸€ä¹¦ä¸­ä¹Ÿä»‹ç»äº†ç›¸å…³çš„å†…å®¹ã€‚</p><p>ç³»ç»Ÿæœ‰ä¸€ä¸ªå…¨å±€çš„ <code>CFMutableDictionary</code> å®ä¾‹ï¼Œæ¥ä¿å­˜æ¯ä¸ªå¯¹è±¡çš„ <code>weak</code> æŒ‡é’ˆåˆ—è¡¨ï¼Œå› ä¸ºæ¯ä¸ªå¯¹è±¡å¯èƒ½æœ‰å¤šä¸ª <code>weak</code> æŒ‡é’ˆï¼Œæ‰€ä»¥è¿™ä¸ªå®ä¾‹çš„å€¼æ˜¯ <code>CFMutableSet</code> ç±»å‹ã€‚</p><p>å‰©ä¸‹æˆ‘ä»¬è¦åšçš„ï¼Œå°±æ˜¯åœ¨å¼•ç”¨è®¡æ•°å˜æˆ <code>0</code> çš„æ—¶å€™ï¼Œå»è¿™ä¸ªå…¨å±€çš„å­—å…¸é‡Œé¢ï¼Œæ‰¾åˆ°æ‰€æœ‰çš„ <code>weak</code> æŒ‡é’ˆï¼Œå°†å…¶å€¼è®¾ç½®æˆ <code>nil</code>ã€‚å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹å‘¢ï¼ŸFriday QA ä¸Šä»‹ç»äº†ä¸€ç§ç±»ä¼¼ <code>KVO</code> å®ç°çš„æ–¹å¼ã€‚å½“å¯¹è±¡å­˜åœ¨ <code>weak</code> æŒ‡é’ˆæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªå®ä¾‹æŒ‡å‘ä¸€ä¸ªæ–°åˆ›å»ºçš„å­ç±»ï¼Œç„¶åä¿®æ”¹è¿™ä¸ªå­ç±»çš„ <code>release</code> æ–¹æ³•ï¼Œåœ¨ <code>release</code> æ–¹æ³•ä¸­ï¼Œå»ä»å…¨å±€çš„ <code>CFMutableDictionary</code> å­—å…¸ä¸­æ‰¾åˆ°æ‰€æœ‰çš„ <code>weak</code> å¯¹è±¡ï¼Œå¹¶ä¸”è®¾ç½®æˆ <code>nil</code>ã€‚æˆ‘æ‘˜æŠ„äº† Friday QA ä¸Šçš„å®ç°çš„æ ¸å¿ƒä»£ç ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Class subclass = objc_allocateClassPair(class, newNameC, 0);</span><br><span class="line">Method release = class_getInstanceMethod(class, @selector(release));</span><br><span class="line">Method dealloc = class_getInstanceMethod(class, @selector(dealloc));</span><br><span class="line">class_addMethod(subclass, @selector(release), (IMP)CustomSubclassRelease, method_getTypeEncoding(release));</span><br><span class="line">class_addMethod(subclass, @selector(dealloc), (IMP)CustomSubclassDealloc, method_getTypeEncoding(dealloc));</span><br><span class="line">objc_registerClassPair(subclass);</span><br></pre></td></tr></table></figure><p>å½“ç„¶ï¼Œè¿™å¹¶ä¸ä»£è¡¨è‹¹æœå®˜æ–¹æ˜¯è¿™ä¹ˆå®ç°çš„ï¼Œå› ä¸ºè‹¹æœçš„è¿™éƒ¨åˆ†ä»£ç å¹¶æ²¡æœ‰å¼€æºã€‚ã€ŠObjective-Cé«˜çº§ç¼–ç¨‹ã€‹ä¸€ä¹¦ä¸­ä»‹ç»äº† <code>GNUStep</code> é¡¹ç›®ä¸­çš„å¼€æºä»£ç ï¼Œæ€æƒ³ä¹Ÿæ˜¯ç±»ä¼¼çš„ã€‚æ‰€ä»¥æˆ‘è®¤ä¸ºè™½ç„¶å®ç°ç»†èŠ‚ä¼šæœ‰å·®å¼‚ï¼Œä½†æ˜¯å¤§è‡´çš„å®ç°æ€è·¯åº”è¯¥å·®åˆ«ä¸å¤§ã€‚</p><h2 id="5-å¦‚æœæœ‰ä¸€äº›-UI-æ§ä»¶æˆ‘ä»¬è¦ç”¨ä»£ç çš„æ–¹å¼æ¥åˆ›å»ºï¼Œé‚£ä¹ˆå®ƒåº”è¯¥ç”¨-weak-è¿˜æ˜¯-strong"><a href="#5-å¦‚æœæœ‰ä¸€äº›-UI-æ§ä»¶æˆ‘ä»¬è¦ç”¨ä»£ç çš„æ–¹å¼æ¥åˆ›å»ºï¼Œé‚£ä¹ˆå®ƒåº”è¯¥ç”¨-weak-è¿˜æ˜¯-strong" class="headerlink" title="5. å¦‚æœæœ‰ä¸€äº› UI æ§ä»¶æˆ‘ä»¬è¦ç”¨ä»£ç çš„æ–¹å¼æ¥åˆ›å»ºï¼Œé‚£ä¹ˆå®ƒåº”è¯¥ç”¨ weak è¿˜æ˜¯ strong"></a>5. å¦‚æœæœ‰ä¸€äº› <code>UI</code> æ§ä»¶æˆ‘ä»¬è¦ç”¨ä»£ç çš„æ–¹å¼æ¥åˆ›å»ºï¼Œé‚£ä¹ˆå®ƒåº”è¯¥ç”¨ <code>weak</code> è¿˜æ˜¯ <code>strong</code></h2><p>æˆ‘ä»¬çŸ¥é“ï¼Œä» <code>Storyboard</code> å¾€ç¼–è¯‘å™¨æ‹–å‡ºæ¥çš„ <code>UI</code> æ§ä»¶çš„å±æ€§æ˜¯ <code>weak</code> çš„ï¼Œå¦‚ä¸‹æ‰€ç¤º</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span>, <span class="keyword">nonatomic</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UIButton</span> *myButton;</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆå¦‚æœæœ‰ä¸€äº› <code>UI</code> æ§ä»¶æˆ‘ä»¬è¦ç”¨ä»£ç çš„æ–¹å¼æ¥åˆ›å»ºï¼Œé‚£ä¹ˆå®ƒåº”è¯¥ç”¨ <code>weak</code> è¿˜æ˜¯ <code>strong</code>?</p><blockquote><p>ä»ä¸Šé¢å¼±å¼•ç”¨è‡ªåŠ¨ç½®<code>nil</code>çš„åŸç†å¯ä»¥çœ‹å‡ºï¼Œå¼±å¼•ç”¨çš„ä½¿ç”¨æ˜¯æœ‰é¢å¤–çš„å¼€é”€çš„ã€‚è™½ç„¶è¿™ä¸ªå¼€é”€å¾ˆå°ï¼Œä½†æ˜¯å¦‚æœä¸€ä¸ªåœ°æ–¹æˆ‘ä»¬è‚¯å®šå®ƒä¸éœ€è¦å¼±å¼•ç”¨çš„ç‰¹æ€§ï¼Œå°±ä¸åº”è¯¥ç›²ç›®ä½¿ç”¨å¼±å¼•ç”¨ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæœ‰äººå–œæ¬¢åœ¨æ‰‹å†™ç•Œé¢çš„æ—¶å€™ï¼Œå°†æ‰€æœ‰ç•Œé¢å…ƒç´ éƒ½è®¾ç½®æˆ <code>weak</code> çš„ï¼Œè¿™æŸç§ç¨‹åº¦ä¸Šä¸ <code>Xcode</code> é€šè¿‡ <code>Storyboard</code> æ‹–æ‹½ç”Ÿæˆçš„æ–°å˜é‡æ˜¯ä¸€è‡´çš„ã€‚</p></blockquote><p><code>UI</code> æ§ä»¶ç”¨é»˜è®¤ç”¨ <code>weak</code>ï¼Œæ ¹æºè¿˜æ˜¯è‹¹æœå¸Œæœ›åªæœ‰è¿™äº› <code>UI</code> æ§ä»¶çš„çˆ¶ <code>View</code> æ¥å¼ºå¼•ç”¨å®ƒä»¬ï¼Œè€Œ <code>ViewController</code> åªéœ€è¦å¼ºå¼•ç”¨ <code>ViewController.view</code> æˆå‘˜ï¼Œåˆ™å¯ä»¥é—´æ¥æŒæœ‰æ‰€æœ‰çš„ <code>UI</code> æ§ä»¶ã€‚è¿™æ ·æœ‰ä¸€ä¸ªå¥½å¤„æ˜¯ï¼šåœ¨ä»¥å‰ï¼Œå½“ç³»ç»Ÿæ”¶åˆ° <code>Memory Warning</code> æ—¶ï¼Œä¼šè§¦å‘ <code>ViewController</code> çš„ <code>viewDidUnload</code> æ–¹æ³•ï¼Œè¿™æ ·çš„å¼±å¼•ç”¨æ–¹å¼ï¼Œå¯ä»¥è®©æ•´ä¸ª <code>view</code> æ•´ä½“éƒ½å¾—åˆ°é‡Šæ”¾ï¼Œä¹Ÿæ›´æ–¹ä¾¿é‡å»ºæ—¶æ•´ä½“é‡æ–°æ„é€ ã€‚</p><p>ä½†æ˜¯é¦–å…ˆ <code>viewDidUnload</code> æ–¹æ³•åœ¨ <code>iOS 6</code> å¼€å§‹å°±è¢«åºŸå¼ƒæ‰äº†ï¼Œè‹¹æœç”¨äº†æ›´ç®€å•æœ‰æ•ˆåœ°æ–¹å¼æ¥è§£å†³å†…å­˜è­¦å‘Šæ—¶çš„è§†å›¾èµ„æºé‡Šæ”¾ï¼Œå…·ä½“å¦‚ä½•åšçš„å‘¢ï¼Ÿå—¯ï¼Œè¿™ä¸ªå¯ä»¥å½“ä½œæŸä¸€æœŸçš„é¢è¯•é¢˜å±•å¼€ä»‹ç»ã€‚æ€»ä¹‹å°±æ˜¯ï¼Œé™¤éä½ ç‰¹æ®Šåœ°æ“ä½œ <code>view</code> æˆå‘˜ï¼Œ<code>ViewController.view</code> çš„ç”Ÿå‘½æœŸå’Œ <code>ViewController</code> æ˜¯ä¸€æ ·çš„äº†ã€‚</p><p>æ‰€ä»¥åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå…¶å® <code>UI</code> æ§ä»¶æ˜¯ä¸æ˜¯ <code>weak</code> å…¶å®å…³ç³»å¹¶ä¸å¤§ã€‚å½“ <code>UI</code> æ§ä»¶æ˜¯ <code>weak</code> æ—¶ï¼Œå®ƒçš„å¼•ç”¨è®¡æ•°æ˜¯ <code>1</code>ï¼ŒæŒæœ‰å®ƒçš„æ˜¯å®ƒçš„ <code>superview</code>ï¼Œå½“ <code>UI</code> æ§ä»¶æ˜¯ <code>strong</code> æ—¶ï¼Œå®ƒçš„å¼•ç”¨è®¡æ•°æ˜¯ <code>2</code>ï¼ŒæŒæœ‰å®ƒçš„æœ‰ä¸¤ä¸ªåœ°æ–¹ï¼Œä¸€ä¸ªæ˜¯å®ƒçš„ <code>superview</code>ï¼Œå¦ä¸€ä¸ªæ˜¯è¿™ä¸ª <code>strong</code> çš„æŒ‡é’ˆã€‚<code>UI</code> æ§ä»¶å¹¶ä¸ä¼šæŒæœ‰åˆ«çš„å¯¹è±¡ï¼Œæ‰€ä»¥ï¼Œä¸ç®¡æ˜¯æ‰‹å†™ä»£ç è¿˜æ˜¯ <code>Storyboard</code>ï¼Œ<code>UI</code> æ§ä»¶æ˜¯ <code>strong</code> éƒ½ä¸ä¼šæœ‰å¾ªç¯å¼•ç”¨çš„ã€‚</p><p>é‚£ä¹ˆå›åˆ°æˆ‘ä»¬çš„æœ€åˆçš„é—®é¢˜ï¼Œè‡ªå·±å†™çš„ <code>view</code> æˆå‘˜ï¼Œåº”è¯¥ç”¨ <code>weak</code> è¿˜æ˜¯ <code>strong</code>ï¼Ÿæˆ‘ä¸ªäººè§‰å¾—åº”è¯¥ç”¨ <code>strong</code>ï¼Œå› ä¸ºç”¨ <code>weak</code> å¹¶æ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«çš„ä¼˜åŠ¿ï¼Œè€Œä¸”ç”±ä¸Šé¢ <code>weak</code>çš„å®ç°æ¥çœ‹ï¼Œ<code>weak</code> å˜é‡ä¼šæœ‰é¢å¤–çš„ç³»ç»Ÿç»´æŠ¤å¼€é”€çš„ï¼Œå¦‚æœä½ æ²¡æœ‰ä½¿ç”¨å®ƒçš„ç‰¹åˆ«çš„ç†ç”±ï¼Œé‚£ä¹ˆç”¨ <code>strong</code> çš„è¯åº”è¯¥æ›´å¥½ã€‚</p><p>å¦å¤–å¦‚æœè¦åšæ‡’åŠ è½½ï¼Œé‚£ä¹ˆä½ ä¹Ÿåªèƒ½é€‰æ‹©ç”¨ <code>strong</code>ã€‚</p><p>å½“ç„¶ï¼Œå¦‚æœä½ éè¦ç”¨ <code>weak</code>ï¼Œå…¶å®ä¹Ÿæ²¡ä»€ä¹ˆé—®é¢˜ï¼Œåªéœ€è¦æ³¨æ„åœ¨èµ‹å€¼å‰ï¼Œå…ˆæŠŠè¿™ä¸ªå¯¹è±¡ç”¨ <code>addSubView</code> åŠ åˆ°çˆ¶ <code>view</code> ä¸Šï¼Œå¦åˆ™å¯èƒ½åˆšåˆšåˆ›å»ºå®Œï¼Œå®ƒå°±è¢«é‡Šæ”¾äº†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Note </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
            <tag> Objective-C </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LeetCodeåšé¢˜ç¬”è®°â€”DPåŠ¨æ€è§„åˆ’ç›¸å…³é¢˜ç›®</title>
      <link href="/2019-05-20-leetcode-dynamic-programming/"/>
      <url>/2019-05-20-leetcode-dynamic-programming/</url>
      
        <content type="html"><![CDATA[<p>æœ‰å…³åŠ¨æ€è§„åˆ’ Dynamic Programming çš„åšé¢˜ç¬”è®°ï¼ŒPythonå®ç°</p><a id="more"></a><h2 id="70-çˆ¬æ¥¼æ¢¯-Climbing-Stairs"><a href="#70-çˆ¬æ¥¼æ¢¯-Climbing-Stairs" class="headerlink" title="70. çˆ¬æ¥¼æ¢¯ Climbing Stairs"></a>70. çˆ¬æ¥¼æ¢¯ Climbing Stairs</h2><p><a href="https://leetcode-cn.com/problems/climbing-stairs/" target="_blank" rel="noopener">LeetCodeCN ç¬¬70é¢˜é“¾æ¥</a></p><p>ç¬¬ä¸€ç§æ–¹æ³•ï¼šé€’å½’ï¼Œæ˜¾ç„¶æ˜¯ä¸ªæ–æ³¢é‚£å¥‘æ•°åˆ—ï¼Œæ—¶é—´å¤æ‚åº¦ $O(2^n)$å¾ˆé«˜ï¼Œè¿™æ ·æ²¡æ³•é€šè¿‡LeetCodeï¼Œå‚è€ƒ @wikizero çš„è§£æ³•å¯ä»¥åŠ ä¸ªLRUç¼“å­˜</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># from functools import lru_cache</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span>        </span><br><span class="line">    <span class="comment"># @lru_cache(10**8)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">climbStairs</span><span class="params">(self, n: int)</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> n &lt;= <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">return</span> n</span><br><span class="line">        <span class="keyword">return</span> self.climbStairs(n - <span class="number">1</span>) + self.climbStairs(n - <span class="number">2</span>)</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ–¹æ³•ï¼šåŠ¨æ€è§„åˆ’ï¼Œç”¨æ•°ç»„è®°å½•æ¯ä¸ªå°é˜¶çš„æ‰€æœ‰èµ°æ³•ä¸ªæ•°ï¼Œæ—¶é—´å¤æ‚åº¦é™ä¸º $O(n)$</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">climbStairs</span><span class="params">(self, n: int)</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> n &lt;= <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">return</span> n</span><br><span class="line">        f = [<span class="number">0</span>] * (n+<span class="number">1</span>)</span><br><span class="line">        f[<span class="number">0</span>] = f[<span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>, n+<span class="number">1</span>):</span><br><span class="line">            f[i] = f[i<span class="number">-1</span>] + f[i<span class="number">-2</span>]</span><br><span class="line">        <span class="keyword">return</span> f[n]</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰ç§æ–¹æ³•ï¼šåŠ¨æ€è§„åˆ’ï¼Œç”±äºåªéœ€è¦è¿”å›æœ€åä¸€æ­¥çš„æ‰€æœ‰èµ°æ³•ä¸ªæ•°ï¼Œä¸éœ€è¦æ•°ç»„è®°å½•è¿‡ç¨‹ï¼Œåˆ©ç”¨Pythonçš„åŒæ—¶èµ‹å€¼ç‰¹æ€§ï¼Œåªéœ€ä¸¤ä¸ªå˜é‡å°±è¡Œï¼Œç©ºé—´å¤æ‚åº¦é™ä¸º $O(1)$</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">climbStairs</span><span class="params">(self, n: int)</span> -&gt; int:</span></span><br><span class="line">        x = y = <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">1</span>, n):</span><br><span class="line">            x, y = x+y, x</span><br><span class="line">        <span class="keyword">return</span> x</span><br></pre></td></tr></table></figure><h2 id="120-ä¸‰è§’å½¢æœ€å°è·¯å¾„å’Œ-Triangle"><a href="#120-ä¸‰è§’å½¢æœ€å°è·¯å¾„å’Œ-Triangle" class="headerlink" title="120. ä¸‰è§’å½¢æœ€å°è·¯å¾„å’Œ Triangle"></a>120. ä¸‰è§’å½¢æœ€å°è·¯å¾„å’Œ Triangle</h2><p><a href="https://leetcode-cn.com/problems/triangle/" target="_blank" rel="noopener">LeetCodeCN ç¬¬120é¢˜é“¾æ¥</a></p><p>ç¬¬ä¸€ç§æ–¹æ³•ï¼šé€’å½’ï¼Œæ—¶é—´å¤æ‚åº¦<code>O(2^n)</code>ï¼ŒLeetCodeä¼šè¶…æ—¶è¿‡ä¸äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">minimumTotal</span><span class="params">(self, triangle: List[List[int]])</span> -&gt; int:</span></span><br><span class="line">        self.tri = triangle</span><br><span class="line">        self.path = []</span><br><span class="line">        self.helper(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> min(self.path)</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, i, j, res)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> i &gt;= len(self.tri):</span><br><span class="line">            self.path.append(res)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        res += self.tri[i][j]</span><br><span class="line">        self.helper(i+<span class="number">1</span>, j, res)</span><br><span class="line">        self.helper(i+<span class="number">1</span>, j+<span class="number">1</span>, res)</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ–¹æ³•ï¼šåŠ¨æ€è§„åˆ’ï¼Œæ–°å»ºä¸ªäºŒç»´æ•°ç»„<code>mini</code>ï¼Œå®šä¹‰<code>mini[i][j]</code>ä¸ºä»ä¸‰è§’å½¢åº•éƒ¨åˆ°<code>[i][j]</code>çš„æœ€å°è·¯å¾„å’Œï¼Œé€’æ¨å…¬å¼<code>mini[i][j] = triangle[i][j] + min(mini[i+1][j], mini[i+1][j+1])</code>å³æœ¬èº«èŠ‚ç‚¹çš„å€¼åŠ ä¸Šä¸‹ä¸€å±‚<code>[i+1]</code>é‡Œç›¸é‚»ä¸¤ä¸ªèŠ‚ç‚¹<code>mini</code>çš„æœ€å°å€¼ï¼Œé¦–å…ˆæŠŠä¸‰è§’å½¢æœ€åä¸€å±‚èµ‹å€¼ç»™<code>mini</code>çš„æœ€åä¸€å±‚ï¼Œç„¶åä¸¤ä¸ªå¾ªç¯ï¼Œæœ€åå¾—åˆ°<code>mini[0][0]</code>ä¸‰è§’å½¢é¡¶éƒ¨èŠ‚ç‚¹ï¼Œæ—¶é—´å¤æ‚åº¦<code>O(n^2)</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">minimumTotal</span><span class="params">(self, triangle: List[List[int]])</span> -&gt; int:</span></span><br><span class="line">        lens = len(triangle)</span><br><span class="line">        mini = [[<span class="number">0</span>]*lens <span class="keyword">for</span> _ <span class="keyword">in</span> range(lens)]</span><br><span class="line">        mini[lens<span class="number">-1</span>] = triangle[lens<span class="number">-1</span>]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(lens<span class="number">-2</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(len(triangle[i])):</span><br><span class="line">                mini[i][j] = triangle[i][j] + min(mini[i+<span class="number">1</span>][j], mini[i+<span class="number">1</span>][j+<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">return</span> mini[<span class="number">0</span>][<span class="number">0</span>]</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰ç§æ–¹æ³•ï¼šåœ¨ç¬¬äºŒç§æ–¹æ³•çš„åŸºç¡€ä¸Šï¼Œ<code>mini</code>åªéœ€ä¸€ç»´æ•°ç»„å³å¯ï¼Œæ›´æ–°è‡ªèº«</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">minimumTotal</span><span class="params">(self, triangle: List[List[int]])</span> -&gt; int:</span></span><br><span class="line">        mini = triangle[len(triangle)<span class="number">-1</span>]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(triangle)<span class="number">-2</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(len(triangle[i])):</span><br><span class="line">                mini[j] = triangle[i][j] + min(mini[j], mini[j+<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">return</span> mini[<span class="number">0</span>]</span><br></pre></td></tr></table></figure><p>ç¬¬å››ç§æ–¹æ³•ï¼šåœ¨ç¬¬äºŒç§æ–¹æ³•çš„åŸºç¡€ä¸Šï¼Œç›´æ¥ä¿®æ”¹ä¸‰è§’å½¢æ•°ç»„çš„å€¼ï¼Œç©ºé—´å¤æ‚åº¦ä¸º<code>O(1)</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">minimumTotal</span><span class="params">(self, triangle: List[List[int]])</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(triangle)<span class="number">-2</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(len(triangle[i])):</span><br><span class="line">                triangle[i][j] += min(triangle[i+<span class="number">1</span>][j], triangle[i+<span class="number">1</span>][j+<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">return</span> triangle[<span class="number">0</span>][<span class="number">0</span>]</span><br></pre></td></tr></table></figure><h2 id="152-ä¹˜ç§¯æœ€å¤§å­åºåˆ—-Maximum-Product-Subarray"><a href="#152-ä¹˜ç§¯æœ€å¤§å­åºåˆ—-Maximum-Product-Subarray" class="headerlink" title="152. ä¹˜ç§¯æœ€å¤§å­åºåˆ— Maximum Product Subarray"></a>152. ä¹˜ç§¯æœ€å¤§å­åºåˆ— Maximum Product Subarray</h2><p><a href="https://leetcode-cn.com/problems/maximum-product-subarray/" target="_blank" rel="noopener">LeetCodeCN ç¬¬152é¢˜é“¾æ¥</a></p><p>ç¬¬ä¸€ç§æ–¹æ³•ï¼šDPåŠ¨æ€è§„åˆ’ï¼Œåˆ›å»ºäºŒç»´æ•°ç»„<code>dp</code>ï¼Œ<code>dp[i][0]</code>å­˜æ”¾æ­£æ•°æœ€å¤§å€¼, <code>dp[i][1]</code>å­˜æ”¾æœ€å°å€¼å³è´Ÿæ•°çš„æœ€å¤§å€¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">maxProduct</span><span class="params">(self, nums: List[int])</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> nums <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        dp = [[<span class="number">0</span>]*<span class="number">2</span> <span class="keyword">for</span> _ <span class="keyword">in</span> range(len(nums))]</span><br><span class="line">        dp[<span class="number">0</span>][<span class="number">0</span>], dp[<span class="number">0</span>][<span class="number">1</span>] = nums[<span class="number">0</span>], nums[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, len(nums)):</span><br><span class="line">            dp[i][<span class="number">0</span>] = max(dp[i<span class="number">-1</span>][<span class="number">0</span>]*nums[i], dp[i<span class="number">-1</span>][<span class="number">1</span>]*nums[i], nums[i])</span><br><span class="line">            dp[i][<span class="number">1</span>] = min(dp[i<span class="number">-1</span>][<span class="number">0</span>]*nums[i], dp[i<span class="number">-1</span>][<span class="number">1</span>]*nums[i], nums[i])</span><br><span class="line">        result = []</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> dp:</span><br><span class="line">            result.append(j[<span class="number">0</span>])</span><br><span class="line">        <span class="keyword">return</span> max(result)</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ–¹æ³•ï¼šåœ¨ç¬¬ä¸€ç§æ–¹æ³•çš„åŸºç¡€ä¸Šï¼Œç”¨ä¸€ç»´æ»šåŠ¨æ•°ç»„<code>dp</code>ï¼Œæ¯æ¬¡å¾ªç¯äº¤æ›¿xå’Œyä¸º0å’Œ1</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">maxProduct</span><span class="params">(self, nums: List[int])</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> nums <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        dp = [[<span class="number">0</span>]*<span class="number">2</span> <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">2</span>)]</span><br><span class="line">        dp[<span class="number">0</span>][<span class="number">0</span>], dp[<span class="number">0</span>][<span class="number">1</span>], res = nums[<span class="number">0</span>], nums[<span class="number">0</span>], nums[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, len(nums)):</span><br><span class="line">            x, y = i &amp; <span class="number">1</span>, (i - <span class="number">1</span>) &amp; <span class="number">1</span></span><br><span class="line">            dp[x][<span class="number">0</span>] = max(dp[y][<span class="number">0</span>]*nums[i], dp[y][<span class="number">1</span>]*nums[i], nums[i])</span><br><span class="line">            dp[x][<span class="number">1</span>] = min(dp[y][<span class="number">0</span>]*nums[i], dp[y][<span class="number">1</span>]*nums[i], nums[i])</span><br><span class="line">            res = max(res, dp[x][<span class="number">0</span>])</span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure><h2 id="300-æœ€é•¿ä¸Šå‡å­åºåˆ—-Longest-Increasing-Subsequence"><a href="#300-æœ€é•¿ä¸Šå‡å­åºåˆ—-Longest-Increasing-Subsequence" class="headerlink" title="300. æœ€é•¿ä¸Šå‡å­åºåˆ— Longest Increasing Subsequence"></a>300. æœ€é•¿ä¸Šå‡å­åºåˆ— Longest Increasing Subsequence</h2><p><a href="https://leetcode-cn.com/problems/longest-increasing-subsequence/" target="_blank" rel="noopener">LeetCodeCN ç¬¬300é¢˜é“¾æ¥</a></p><p>DPåŠ¨æ€è§„åˆ’ï¼Œå®šä¹‰çŠ¶æ€<code>dp[i]</code>ä¸ºä»¥<code>nums[i]</code>ä¸ºç»“å°¾ä¸”å¿…é¡»åŒ…å«<code>nums[i]</code>æœ¬èº«çš„æœ€é•¿ä¸Šå‡å­åºåˆ—çš„é•¿åº¦ã€‚ä¸¤ä¸ªåµŒå¥—çš„å¾ªç¯ï¼ŒçŠ¶æ€è½¬ç§»æ–¹ç¨‹<code>dp[i] = max(dp[i], dp[j] + 1)</code>å³åœ¨å†…å±‚å¾ªç¯å†…é€šè¿‡æ¯”è¾ƒ<code>dp[j]</code>æ¥ä¸æ–­è¿­ä»£<code>dp[i]</code>ï¼Œæ‰¾åˆ°å‰é¢æœ€å¤§çš„ä¸€ä¸ª<code>dp</code>å€¼ç„¶ååŠ 1ã€‚æœ€å<code>dp</code>æ•°ç»„çš„æœ€å¤§å€¼å°±æ˜¯é—®é¢˜çš„è§£</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">lengthOfLIS</span><span class="params">(self, nums: List[int])</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> nums:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        n = len(nums)</span><br><span class="line">        dp = [<span class="number">1</span>]*n</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, n):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(i):</span><br><span class="line">                <span class="keyword">if</span> nums[i] &gt; nums[j]:</span><br><span class="line">                    dp[i] = max(dp[i], dp[j]+<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> max(dp)</span><br></pre></td></tr></table></figure><h2 id="322-é›¶é’±å…‘æ¢-Coin-Change"><a href="#322-é›¶é’±å…‘æ¢-Coin-Change" class="headerlink" title="322. é›¶é’±å…‘æ¢ Coin Change"></a>322. é›¶é’±å…‘æ¢ Coin Change</h2><p><a href="https://leetcode-cn.com/problems/coin-change/" target="_blank" rel="noopener">LeetCodeCN ç¬¬322é¢˜é“¾æ¥</a></p><p>ç¬¬ä¸€ç§æ–¹æ³•ï¼šDFSæ·±åº¦ä¼˜å…ˆæœç´¢ï¼Œæš´åŠ›æ“ä½œï¼ŒLeetCodeä¼šè¶…æ—¶è¿‡ä¸å»</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">coinChange</span><span class="params">(self, coins: List[int], amount: int)</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> amount &lt; <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span> </span><br><span class="line">        self.coins = sorted(coins, reverse=<span class="literal">True</span>)</span><br><span class="line">        self.res = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> self.coins:</span><br><span class="line">            self.dfs(amount, i, <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.res:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">        <span class="keyword">return</span> min(self.res)</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">dfs</span><span class="params">(self, amount, num, count)</span>:</span></span><br><span class="line">        last = amount - num</span><br><span class="line">        <span class="keyword">if</span> last &lt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> last:</span><br><span class="line">            self.res.append(count)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> self.coins:</span><br><span class="line">            self.dfs(last, i, count + <span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ–¹æ³•ï¼šDPåŠ¨æ€è§„åˆ’ï¼Œå®šä¹‰çŠ¶æ€<code>dp[i]</code>ä¸ºæ‹¼å‡‘æ•°é¢<code>i</code>æœ€å°‘æ‰€éœ€çš„ç¡¬å¸æ•°é‡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">coinChange</span><span class="params">(self, coins: List[int], amount: int)</span> -&gt; int:</span></span><br><span class="line">        dp = [amount+<span class="number">1</span>]*(amount+<span class="number">1</span>)</span><br><span class="line">        dp[<span class="number">0</span>] = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, amount+<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> coins:</span><br><span class="line">                <span class="keyword">if</span> i - c &gt;= <span class="number">0</span>:</span><br><span class="line">                    dp[i] = min(dp[i], dp[i-c] + <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> dp[amount] <span class="keyword">if</span> dp[amount] &lt;= amount <span class="keyword">else</span> <span class="number">-1</span></span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰ç§æ–¹æ³•ï¼šæŠŠ<code>coins</code>çš„å¾ªç¯æ”¾å¤–å±‚ï¼Œå‡å°‘å¾ªç¯æ¬¡æ•°åŠä¸€æ¬¡<code>if</code>åˆ¤æ–­</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">coinChange</span><span class="params">(self, coins: List[int], amount: int)</span> -&gt; int:</span></span><br><span class="line">        dp = [<span class="number">0</span>] + [amount+<span class="number">1</span>]*amount</span><br><span class="line">        <span class="keyword">for</span> coin <span class="keyword">in</span> coins:</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(coin, amount+<span class="number">1</span>):</span><br><span class="line">                dp[i] = min(dp[i], dp[i-coin]+<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> dp[<span class="number">-1</span>] <span class="keyword">if</span> dp[<span class="number">-1</span>] != amount+<span class="number">1</span> <span class="keyword">else</span> <span class="number">-1</span></span><br></pre></td></tr></table></figure><h2 id="72-ç¼–è¾‘è·ç¦»-Edit-Distance"><a href="#72-ç¼–è¾‘è·ç¦»-Edit-Distance" class="headerlink" title="72. ç¼–è¾‘è·ç¦» Edit Distance"></a>72. ç¼–è¾‘è·ç¦» Edit Distance</h2><p><a href="https://leetcode-cn.com/problems/edit-distance/" target="_blank" rel="noopener">LeetCodeCN ç¬¬72é¢˜é“¾æ¥</a></p><p>ç¬¬ä¸€ç§æ–¹æ³•ï¼šBFSæš´åŠ›æ±‚è§£</p><p>ç¬¬äºŒç§æ–¹æ³•ï¼šDPåŠ¨æ€è§„åˆ’ï¼Œå®šä¹‰çŠ¶æ€<code>dp[i][j]</code> è¡¨ç¤º<code>word1</code>çš„å‰<code>i</code>ä¸ªå­—æ¯å’Œ<code>word2</code>çš„å‰<code>j</code>ä¸ªå­—æ¯ä¹‹é—´çš„ç¼–è¾‘è·ç¦»ï¼Œå³<code>word1</code>çš„å‰<code>i</code>ä¸ªå­—ç¬¦è¦æ›¿æ¢åˆ°<code>word2</code>çš„å‰<code>j</code>ä¸ªå­—ç¬¦æ‰€éœ€è¦çš„æœ€å°‘æ“ä½œæ¬¡æ•°ã€‚å½“<code>word1[i-1] == word2[j-1]</code>æ—¶ï¼Œ<code>dp[i][j]</code>çš„çŠ¶æ€å°±æ˜¯ç›´æ¥è½¬ç§»<code>dp[i-1][j-1]</code>ï¼Œæ— éœ€ä»»ä½•æ­¥éª¤ï¼Œå¦åˆ™ï¼Œ<code>dp[i][j]</code>çš„çŠ¶æ€æ¥è‡ª<code>dp[i-1][j], dp[i][j-1], dp[i-1][j-1]</code>ï¼ˆæ·»åŠ ã€åˆ é™¤ã€æ›¿æ¢ï¼‰ä¸­çš„æœ€å°å€¼å¹¶åŠ æ“ä½œæ­¥éª¤<code>1</code>æ¬¡ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">minDistance</span><span class="params">(self, word1: str, word2: str)</span> -&gt; int:</span></span><br><span class="line">        n, m = len(word1), len(word2)</span><br><span class="line">        dp = [[<span class="number">0</span>]*(m+<span class="number">1</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> range(n+<span class="number">1</span>)]</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(n+<span class="number">1</span>):</span><br><span class="line">            dp[i][<span class="number">0</span>] = i</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(m+<span class="number">1</span>):</span><br><span class="line">            dp[<span class="number">0</span>][j] = j</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,n+<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>,m+<span class="number">1</span>):</span><br><span class="line">                <span class="keyword">if</span> word1[i<span class="number">-1</span>] == word2[j<span class="number">-1</span>]:</span><br><span class="line">                    dp[i][j] = dp[i<span class="number">-1</span>][j<span class="number">-1</span>]</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    dp[i][j] = min(dp[i<span class="number">-1</span>][j], dp[i][j<span class="number">-1</span>], dp[i<span class="number">-1</span>][j<span class="number">-1</span>]) + <span class="number">1</span></span><br><span class="line">                <span class="comment"># ä¸Šé¢çš„if elseé€»è¾‘å¯ä»¥å‹ç¼©æˆä¸€è¡Œ</span></span><br><span class="line">                <span class="comment"># dp[i][j] = min(dp[i-1][j]+1, dp[i][j-1]+1, dp[i-1][j-1]+(0 if word1[i-1] == word2[j-1] else 1))</span></span><br><span class="line">        <span class="keyword">return</span> dp[n][m]</span><br></pre></td></tr></table></figure><h2 id="42-æ¥é›¨æ°´-Trapping-Rain-Water"><a href="#42-æ¥é›¨æ°´-Trapping-Rain-Water" class="headerlink" title="42. æ¥é›¨æ°´ Trapping Rain Water"></a>42. æ¥é›¨æ°´ Trapping Rain Water</h2><p><a href="https://leetcode-cn.com/problems/trapping-rain-water/" target="_blank" rel="noopener">LeetCodeCN ç¬¬42é¢˜é“¾æ¥</a></p><p>ç¬¬ä¸€ç§æ–¹æ³•ï¼šDPåŠ¨æ€è§„åˆ’ï¼Œè®¡ç®—å‡ºæ¯ä¸ªç‚¹çš„å·¦è¾¹ç•Œæœ€å¤§ä¸å³è¾¹ç•Œæœ€å¤§ï¼Œæœ€åå‡å»è‡ªèº«é«˜åº¦</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">trap</span><span class="params">(self, height: List[int])</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> height:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        n, res = len(height), <span class="number">0</span></span><br><span class="line">        maxLeft, maxRight = [<span class="number">0</span>]*n, [<span class="number">0</span>]*n</span><br><span class="line">        maxLeft[<span class="number">0</span>] = height[<span class="number">0</span>]</span><br><span class="line">        maxRight[<span class="number">-1</span>] = height[<span class="number">-1</span>]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, n):</span><br><span class="line">            maxLeft[i] = max(height[i], maxLeft[i<span class="number">-1</span>])</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(n<span class="number">-2</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">            maxRight[j] = max(height[j], maxRight[j+<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> range(n):</span><br><span class="line">            res += min(maxLeft[k], maxRight[k]) - height[k]</span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ–¹æ³•ï¼šåŒæŒ‡é’ˆï¼Œæ¯æ¬¡çŸ®è¾¹å‘å†…æ¨è¿›ï¼Œå¦‚æœè‡ªèº«ä¸æ˜¯è¯¥è¾¹æœ€å¤§å€¼è¯æ˜æœ‰æ›´å¤§çš„è¾¹ï¼Œå°±å¯ä»¥æ¥é›¨æ°´äº†ï¼Œå¦åˆ™æ›´æ–°è‡ªå·±ä¸ºè¯¥è¾¹æœ€å¤§å€¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">trap</span><span class="params">(self, height: List[int])</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> height:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        l, r, left_max, right_max, res = <span class="number">0</span>, len(height)<span class="number">-1</span>, height[<span class="number">0</span>], height[<span class="number">-1</span>], <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> l &lt; r:</span><br><span class="line">            <span class="keyword">if</span> height[r] &gt;= height[l]:</span><br><span class="line">                <span class="keyword">if</span> left_max &gt; height[l]:</span><br><span class="line">                    res += left_max - height[l]</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    left_max = height[l]</span><br><span class="line">                l += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> right_max &gt; height[r]:</span><br><span class="line">                    res += right_max - height[r]</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    right_max = height[r]</span><br><span class="line">                r -= <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure><h2 id="62-ä¸åŒè·¯å¾„-Unique-Paths"><a href="#62-ä¸åŒè·¯å¾„-Unique-Paths" class="headerlink" title="62. ä¸åŒè·¯å¾„ Unique Paths"></a>62. ä¸åŒè·¯å¾„ Unique Paths</h2><p><a href="https://leetcode-cn.com/problems/unique-paths/" target="_blank" rel="noopener">LeetCodeCN ç¬¬62é¢˜é“¾æ¥</a></p><p>æ ‡å‡†çš„åŠ¨æ€è§„åˆ’ï¼Œä»å³ä¸‹ç›®æ ‡ç‚¹å¾€å·¦ä¸Šèµ°ï¼Œdpå‚¨å­˜å½“å‰ç‚¹ä½å…±æœ‰å¤šå°‘ç§èµ°æ³•ï¼Œ<code>dp[i][j]çš„èµ°æ³•æ•°é‡ = dp[i+1][j] + dp[i][j+1]</code> åº•è¾¹å’Œæœ€å³è¾¹æ ¼å­éƒ½æ˜¯1ï¼Œæ‰€ä»¥åˆ›å»ºdpæ•°ç»„æ—¶é¡ºä¾¿æŠŠåˆå§‹åŒ–ä¹Ÿå®Œæˆäº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">uniquePaths</span><span class="params">(self, m: int, n: int)</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> m <span class="keyword">or</span> <span class="keyword">not</span> n:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        dp = [[<span class="number">1</span>]*m <span class="keyword">for</span> _ <span class="keyword">in</span> range(n)]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(n<span class="number">-2</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(m<span class="number">-2</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">                dp[i][j] = dp[i+<span class="number">1</span>][j] + dp[i][j+<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">return</span> dp[<span class="number">0</span>][<span class="number">0</span>]</span><br></pre></td></tr></table></figure><h2 id="63-ä¸åŒè·¯å¾„-II-Unique-Paths-II"><a href="#63-ä¸åŒè·¯å¾„-II-Unique-Paths-II" class="headerlink" title="63. ä¸åŒè·¯å¾„ II Unique Paths II"></a>63. ä¸åŒè·¯å¾„ II Unique Paths II</h2><p><a href="https://leetcode-cn.com/problems/unique-paths-ii/" target="_blank" rel="noopener">LeetCodeCN ç¬¬63é¢˜é“¾æ¥</a></p><p>ä¸ä¸Šé¢˜62é¢˜æ€è·¯ä¸€æ ·ï¼Œä»å³ä¸‹ç›®æ ‡ç‚¹å¾€å·¦ä¸Šèµ°ï¼Œdpå‚¨å­˜å½“å‰ç‚¹ä½å…±æœ‰å¤šå°‘ç§èµ°æ³•ï¼Œ<code>dp[i][j]çš„èµ°æ³•æ•°é‡ = dp[i+1][j] + dp[i][j+1]</code>ï¼Œä¸è¿‡å› ä¸ºæœ‰éšœç¢ç‰©éœ€è¦é¢å¤–å¤„ç†ä¸€ä¸‹ï¼Œåˆ†åˆ«åˆå§‹åŒ–åº•è¾¹å’Œæœ€å³è¾¹ã€‚ç„¶åè¿­ä»£æ—¶åˆ¤æ–­ä¸€ä¸‹éšœç¢ç‰©å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">uniquePathsWithObstacles</span><span class="params">(self, obstacleGrid: List[List[int]])</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> obstacleGrid <span class="keyword">or</span> <span class="keyword">not</span> obstacleGrid[<span class="number">0</span>]:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        n, m = len(obstacleGrid), len(obstacleGrid[<span class="number">0</span>])</span><br><span class="line">        dp = [[<span class="number">1</span>]*m <span class="keyword">for</span> _ <span class="keyword">in</span> range(n)]</span><br><span class="line">        <span class="comment"># å¤„ç†æœ€å³åˆ—çš„åˆå§‹å€¼</span></span><br><span class="line">        flag = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(n<span class="number">-1</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">            <span class="keyword">if</span> flag:</span><br><span class="line">                dp[i][m<span class="number">-1</span>] = <span class="number">0</span></span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span> obstacleGrid[i][m<span class="number">-1</span>]:</span><br><span class="line">                dp[i][m<span class="number">-1</span>] = <span class="number">0</span></span><br><span class="line">                flag = <span class="number">1</span></span><br><span class="line">        <span class="comment"># å¤„ç†æœ€ä¸‹è¡Œçš„åˆå§‹å€¼</span></span><br><span class="line">        flag = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(m<span class="number">-1</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">            <span class="keyword">if</span> flag:</span><br><span class="line">                dp[n<span class="number">-1</span>][i] = <span class="number">0</span></span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span> obstacleGrid[n<span class="number">-1</span>][i]:</span><br><span class="line">                dp[n<span class="number">-1</span>][i] = <span class="number">0</span></span><br><span class="line">                flag = <span class="number">1</span></span><br><span class="line">        <span class="comment"># ä»å³ä¸‹åˆ°å·¦ä¸Šçš„DPé€’æ¨</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(n<span class="number">-2</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(m<span class="number">-2</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">                <span class="keyword">if</span> obstacleGrid[i][j]:</span><br><span class="line">                    dp[i][j] = <span class="number">0</span></span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                dp[i][j] = dp[i+<span class="number">1</span>][j] + dp[i][j+<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">return</span> dp[<span class="number">0</span>][<span class="number">0</span>]</span><br></pre></td></tr></table></figure><h2 id="64-æœ€å°è·¯å¾„å’Œ-Minimum-Path-Sum"><a href="#64-æœ€å°è·¯å¾„å’Œ-Minimum-Path-Sum" class="headerlink" title="64. æœ€å°è·¯å¾„å’Œ Minimum Path Sum"></a>64. æœ€å°è·¯å¾„å’Œ Minimum Path Sum</h2><p><a href="https://leetcode-cn.com/problems/minimum-path-sum/" target="_blank" rel="noopener">LeetCodeCN ç¬¬64é¢˜é“¾æ¥</a></p><p>åŠ¨æ€è§„åˆ’ï¼Œå®šä¹‰DPäºŒç»´æ•°ç»„å‚¨å­˜çš„æ˜¯ç»è¿‡è¯¥ç‚¹ä½çš„æœ€å°è·¯å¾„å’Œï¼Œé¦–å…ˆåˆå§‹åŒ–å¥½æœ€å³è¾¹å’Œåº•è¾¹çš„åˆå§‹å€¼ï¼Œç„¶åä»ç›®æ ‡å³ä¸‹é€’æ¨åˆ°èµ·å§‹ç‚¹å·¦ä¸Šï¼Œ<code>dp[0][0]</code>å³ç»“æœ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">minPathSum</span><span class="params">(self, grid: List[List[int]])</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> grid <span class="keyword">or</span> <span class="keyword">not</span> grid[<span class="number">0</span>]:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        n, m = len(grid), len(grid[<span class="number">0</span>])</span><br><span class="line">        dp = [[<span class="number">0</span>]*m <span class="keyword">for</span> _ <span class="keyword">in</span> range(n)]</span><br><span class="line">        dp[<span class="number">-1</span>][<span class="number">-1</span>] = grid[<span class="number">-1</span>][<span class="number">-1</span>]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(n<span class="number">-2</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">            dp[i][m<span class="number">-1</span>] = grid[i][m<span class="number">-1</span>] + dp[i+<span class="number">1</span>][m<span class="number">-1</span>]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(m<span class="number">-2</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">            dp[n<span class="number">-1</span>][i] = grid[n<span class="number">-1</span>][i] + dp[n<span class="number">-1</span>][i+<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(n<span class="number">-2</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(m<span class="number">-2</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">                dp[i][j] = min(dp[i+<span class="number">1</span>][j], dp[i][j+<span class="number">1</span>]) + grid[i][j]</span><br><span class="line">        <span class="keyword">return</span> dp[<span class="number">0</span>][<span class="number">0</span>]</span><br></pre></td></tr></table></figure><p>ç”¨æ»šåŠ¨æ•°ç»„é™ä½ç©ºé—´å¤æ‚åº¦ï¼Œä»å·¦ä¸Šè§’å¾€å³ä¸‹è§’è¿­ä»£</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">minPathSum</span><span class="params">(self, grid: List[List[int]])</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> grid <span class="keyword">or</span> <span class="keyword">not</span> grid[<span class="number">0</span>]:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        m, n = len(grid), len(grid[<span class="number">0</span>])</span><br><span class="line">        dp = [[<span class="number">0</span>]*n <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">2</span>)]</span><br><span class="line">        dp[<span class="number">0</span>][<span class="number">0</span>] = grid[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, n):</span><br><span class="line">            dp[<span class="number">0</span>][i] = dp[<span class="number">0</span>][i<span class="number">-1</span>] + grid[<span class="number">0</span>][i]</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, m):</span><br><span class="line">            x, y = i&amp;<span class="number">1</span>, (i<span class="number">-1</span>)&amp;<span class="number">1</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(n):</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> j:</span><br><span class="line">                    dp[x][j] = dp[y][j] + grid[i][j]</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    dp[x][j] = min(dp[y][j], dp[x][j<span class="number">-1</span>]) + grid[i][j]</span><br><span class="line">        <span class="keyword">return</span> dp[<span class="number">0</span>][<span class="number">-1</span>] <span class="keyword">if</span> m&amp;<span class="number">1</span> <span class="keyword">else</span> dp[<span class="number">1</span>][<span class="number">-1</span>]</span><br></pre></td></tr></table></figure><h2 id="198-æ‰“å®¶åŠ«èˆ-House-Robber"><a href="#198-æ‰“å®¶åŠ«èˆ-House-Robber" class="headerlink" title="198. æ‰“å®¶åŠ«èˆ House Robber"></a>198. æ‰“å®¶åŠ«èˆ House Robber</h2><p><a href="https://leetcode-cn.com/problems/house-robber/" target="_blank" rel="noopener">LeetCodeCN ç¬¬198é¢˜é“¾æ¥</a></p><p>ç¬¬ä¸€ç§æ–¹æ³•ï¼šåŠ¨æ€è§„åˆ’ï¼Œé€’æ¨æ–¹ç¨‹<code>f(i) = max(f(i-1), f(i-2)+nums[i])</code>ï¼Œå½“å‰ç‚¹ä½æœ€å¤§åˆ©æ¶¦å¯èƒ½æ¥è‡ªå‰ä¸€ä¸ªç‚¹ä½çš„æœ€å¤§åˆ©æ¶¦ï¼ˆå½“å‰ç‚¹ä½ä¸å·ï¼‰æˆ–è€…æ¥è‡ªå‰ä¸¤ä¸ªç‚¹ä½çš„æœ€å¤§åˆ©æ¶¦åŠ ä¸Šå·å½“å‰ç‚¹ä½ã€‚å¼€ä¸€ä¸ªé•¿åº¦ä¸º<code>n</code>çš„æ•°ç»„è®°å½•ï¼Œå–æ•°ç»„æœ«å°¾å³ç»“æœ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">rob</span><span class="params">(self, nums: List[int])</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> nums:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        n = len(nums)</span><br><span class="line">        <span class="keyword">if</span> n &lt;= <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">return</span> max(nums)</span><br><span class="line">        dp = [<span class="number">0</span>]*n</span><br><span class="line">        dp[<span class="number">0</span>], dp[<span class="number">1</span>] = nums[<span class="number">0</span>], max(nums[<span class="number">0</span>], nums[<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>, n):</span><br><span class="line">            dp[i] = max(dp[i<span class="number">-1</span>], dp[i<span class="number">-2</span>]+nums[i])</span><br><span class="line">        <span class="keyword">return</span> dp[<span class="number">-1</span>]</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ–¹æ³•ï¼šç”¨æ»šåŠ¨æ•°ç»„é™ä½ç©ºé—´å¤æ‚åº¦ï¼Œ<code>O(n)â†’O(1)</code>ï¼Œæ— éœ€æ”¹åŠ¨å¤ªå¤šä»£ç ï¼Œé€‚åˆé¢è¯•æ—¶æ”¹è¿›ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">rob</span><span class="params">(self, nums: List[int])</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> nums:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        n = len(nums)</span><br><span class="line">        <span class="keyword">if</span> n &lt;= <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">return</span> max(nums)</span><br><span class="line">        dp = [<span class="number">0</span>]*<span class="number">2</span></span><br><span class="line">        dp[<span class="number">0</span>], dp[<span class="number">1</span>] = nums[<span class="number">0</span>], max(nums[<span class="number">0</span>], nums[<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>, n):</span><br><span class="line">            x, y = i&amp;<span class="number">1</span>, (i+<span class="number">1</span>)&amp;<span class="number">1</span></span><br><span class="line">            dp[x] = max(dp[y], dp[x]+nums[i])</span><br><span class="line">        <span class="keyword">return</span> max(dp[<span class="number">0</span>], dp[<span class="number">1</span>])</span><br></pre></td></tr></table></figure><h2 id="5-æœ€é•¿å›æ–‡å­ä¸²-Longest-Palindromic-Substring"><a href="#5-æœ€é•¿å›æ–‡å­ä¸²-Longest-Palindromic-Substring" class="headerlink" title="5. æœ€é•¿å›æ–‡å­ä¸² Longest Palindromic Substring"></a>5. æœ€é•¿å›æ–‡å­ä¸² Longest Palindromic Substring</h2><p><a href="https://leetcode-cn.com/problems/longest-palindromic-substring/" target="_blank" rel="noopener">LeetCodeCN ç¬¬5é¢˜é“¾æ¥</a></p><p>ç¬¬ä¸€ç§æ–¹æ³•ï¼šåŠ¨æ€è§„åˆ’ï¼Œå®šä¹‰<code>dp[i][j]</code>ä¸ºä»ä½ç½®<code>j</code>åˆ°<code>i</code>çš„å­—ç¬¦ä¸²æ˜¯å¦æ˜¯å›æ–‡ä¸²ï¼Œé€’æ¨å¼å­æ˜¯<code>if (s[i] == s[j] and dp[i-1][j+1]) then dp[i][j] = 1</code>å…¶ä¸­åŠ å…¥ä¸€ä¸ªåˆ¤æ–­å¦‚æœå­ä¸²é•¿åº¦ä¸º2å°±ä¸ç”¨çœ‹<code>dp</code>äº†åŠ é€Ÿè®¡ç®—ã€‚ç„¶åå¦‚æœ<code>dp[i][j]</code>æ˜¯å›æ–‡ä¸²äº†ï¼Œå°±è·Ÿå½“å‰æœ€é•¿çš„å›æ–‡ä¸²æ¯”è¾ƒï¼Œå¦‚æœæ–°çš„æ›´é•¿å°±æ›´æ–°ç»“æœ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">longestPalindrome</span><span class="params">(self, s: str)</span> -&gt; str:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> s:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">''</span></span><br><span class="line">        n = len(s)</span><br><span class="line">        maxLen, res, dp = <span class="number">0</span>, <span class="string">''</span>, [[<span class="number">0</span>]*n <span class="keyword">for</span> _ <span class="keyword">in</span> range(n)]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(i, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">                <span class="keyword">if</span> s[i] == s[j] <span class="keyword">and</span> (i-j&lt;<span class="number">2</span> <span class="keyword">or</span> dp[i<span class="number">-1</span>][j+<span class="number">1</span>]):</span><br><span class="line">                    dp[i][j] = <span class="number">1</span></span><br><span class="line">                <span class="keyword">if</span> dp[i][j] <span class="keyword">and</span> maxLen &lt; i-j+<span class="number">1</span>:</span><br><span class="line">                    maxLen = i-j+<span class="number">1</span></span><br><span class="line">                    res = s[j:i+<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure><hr><h2 id="åŠ¨æ€è§„åˆ’â€”â€”ä¹°å–è‚¡ç¥¨æœ€ä½³æ—¶æœºç³»åˆ—é¢˜é“¾æ¥"><a href="#åŠ¨æ€è§„åˆ’â€”â€”ä¹°å–è‚¡ç¥¨æœ€ä½³æ—¶æœºç³»åˆ—é¢˜é“¾æ¥" class="headerlink" title="åŠ¨æ€è§„åˆ’â€”â€”ä¹°å–è‚¡ç¥¨æœ€ä½³æ—¶æœºç³»åˆ—é¢˜é“¾æ¥"></a><a href="https://paaatrick.com/2019-05-18-leetcode-best-time-to-buy-and-sell-stock-series/">åŠ¨æ€è§„åˆ’â€”â€”ä¹°å–è‚¡ç¥¨æœ€ä½³æ—¶æœºç³»åˆ—é¢˜é“¾æ¥</a></h2><hr>]]></content>
      
      
      <categories>
          
          <category> Algorithm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LeetCode </tag>
            
            <tag> Algorithm </tag>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç²—è°ˆARCè‡ªåŠ¨å¼•ç”¨è®¡æ•°å’ŒGCåƒåœ¾å›æ”¶</title>
      <link href="/2019-05-19-ios-arc-gc/"/>
      <url>/2019-05-19-ios-arc-gc/</url>
      
        <content type="html"><![CDATA[<p>ç²—è°ˆARCè‡ªåŠ¨å¼•ç”¨è®¡æ•°å’ŒGCåƒåœ¾å›æ”¶</p><h2 id="1-ARC-è‡ªåŠ¨å¼•ç”¨è®¡æ•°"><a href="#1-ARC-è‡ªåŠ¨å¼•ç”¨è®¡æ•°" class="headerlink" title="1. ARC è‡ªåŠ¨å¼•ç”¨è®¡æ•°"></a>1. ARC è‡ªåŠ¨å¼•ç”¨è®¡æ•°</h2><a id="more"></a><p>è‡ªåŠ¨å¼•ç”¨è®¡æ•°ï¼ˆ<code>Automatic Reference Count</code> ç®€ç§° <code>ARC</code>ï¼‰ï¼Œæ˜¯è‹¹æœåœ¨ WWDC 2011 å¹´å¤§ä¼šä¸Šæå‡ºçš„ç”¨äºå†…å­˜ç®¡ç†çš„æŠ€æœ¯ã€‚è™½ç„¶ <code>ARC</code> æå¤§åœ°ç®€åŒ–äº†æˆ‘ä»¬çš„å†…å­˜ç®¡ç†å·¥ä½œï¼Œä½†æ˜¯å¼•ç”¨è®¡æ•°è¿™ç§å†…å­˜ç®¡ç†æ–¹æ¡ˆå¦‚æœä¸è¢«ç†è§£ï¼Œé‚£ä¹ˆå°±æ— æ³•å¤„ç†å¥½é‚£äº›æ£˜æ‰‹çš„å¾ªç¯å¼•ç”¨é—®é¢˜ã€‚</p><p>å¼•ç”¨è®¡æ•°ï¼ˆ<code>Reference Count</code>ï¼‰æ˜¯ä¸€ä¸ªç®€å•è€Œæœ‰æ•ˆçš„ç®¡ç†å¯¹è±¡ç”Ÿå‘½å‘¨æœŸçš„æ–¹å¼ã€‚å½“æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡çš„æ—¶å€™ï¼Œå®ƒçš„å¼•ç”¨è®¡æ•°ä¸º <code>1</code>ï¼Œå½“æœ‰ä¸€ä¸ªæ–°çš„æŒ‡é’ˆæŒ‡å‘è¿™ä¸ªå¯¹è±¡æ—¶ï¼Œæˆ‘ä»¬å°†å…¶å¼•ç”¨è®¡æ•°åŠ  <code>1</code>ï¼Œå½“æŸä¸ªæŒ‡é’ˆä¸å†æŒ‡å‘è¿™ä¸ªå¯¹è±¡æ˜¯ï¼Œæˆ‘ä»¬å°†å…¶å¼•ç”¨è®¡æ•°å‡ <code>1</code>ï¼Œå½“å¯¹è±¡çš„å¼•ç”¨è®¡æ•°å˜ä¸º <code>0</code> æ—¶ï¼Œè¯´æ˜è¿™ä¸ªå¯¹è±¡ä¸å†è¢«ä»»ä½•æŒ‡é’ˆæŒ‡å‘äº†ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥å°†å¯¹è±¡é”€æ¯ï¼Œå›æ”¶å†…å­˜ã€‚ç”±äºå¼•ç”¨è®¡æ•°ç®€å•æœ‰æ•ˆï¼Œé™¤äº† <code>Objective-C</code> è¯­è¨€å¤–ï¼Œå¾®è½¯çš„ COMï¼ˆComponent Object Model ï¼‰ã€C++11ï¼ˆC++11 æä¾›äº†åŸºäºå¼•ç”¨è®¡æ•°çš„æ™ºèƒ½æŒ‡é’ˆ share_prtï¼‰ç­‰è¯­è¨€ä¹Ÿæä¾›äº†åŸºäºå¼•ç”¨è®¡æ•°çš„å†…å­˜ç®¡ç†æ–¹å¼ã€‚</p><p>å¼•ç”¨è®¡æ•°è¿™ç§å†…å­˜ç®¡ç†æ–¹å¼è™½ç„¶ç®€å•ï¼Œä½†æ˜¯æ‰‹å·¥å†™å¤§é‡çš„æ“ä½œå¼•ç”¨è®¡æ•°çš„ä»£ç ä¸ä½†ç¹çï¼Œè€Œä¸”å®¹æ˜“è¢«é—æ¼ã€‚äºæ˜¯è‹¹æœåœ¨ 2011 å¹´å¼•å…¥äº† <code>ARC</code>ã€‚<code>ARC</code> é¡¾åæ€ä¹‰ï¼Œæ˜¯è‡ªåŠ¨å¸®æˆ‘ä»¬å¡«å†™å¼•ç”¨è®¡æ•°ä»£ç çš„ä¸€é¡¹åŠŸèƒ½ã€‚</p><p><code>ARC</code> çš„æƒ³æ³•æ¥æºäºè‹¹æœåœ¨æ—©æœŸè®¾è®¡ <code>Xcode</code> çš„ <code>Analyzer</code> çš„æ—¶å€™ï¼Œå‘ç°ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶å¯ä»¥å¸®åŠ©å¤§å®¶å‘ç°å¾ˆå¤šå†…å­˜ç®¡ç†ä¸­çš„é—®é¢˜ã€‚åæ¥è‹¹æœå°±æƒ³ï¼Œèƒ½ä¸èƒ½å¹²è„†ç¼–è¯‘å™¨åœ¨ç¼–è¯‘çš„æ—¶å€™ï¼ŒæŠŠå†…å­˜ç®¡ç†çš„ä»£ç éƒ½è‡ªåŠ¨è¡¥ä¸Šï¼Œå¸¦ç€è¿™ç§æƒ³æ³•ï¼Œè‹¹æœä¿®æ”¹äº†ä¸€äº›å†…å­˜ç®¡ç†ä»£ç çš„ä¹¦å†™æ–¹å¼ï¼ˆä¾‹å¦‚å¼•å…¥äº† <code>@autoreleasepool</code> å…³é”®å­—ï¼‰åï¼Œåœ¨ <code>Xcode</code> ä¸­å®ç°äº†è¿™ä¸ªæƒ³æ³•ã€‚</p><p><code>ARC</code> çš„å·¥ä½œåŸç†å¤§è‡´æ˜¯è¿™æ ·ï¼šå½“æˆ‘ä»¬ç¼–è¯‘æºç çš„æ—¶å€™ï¼Œç¼–è¯‘å™¨ä¼šåˆ†ææºç ä¸­æ¯ä¸ªå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼Œç„¶ååŸºäºè¿™äº›å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼Œæ¥æ·»åŠ ç›¸åº”çš„å¼•ç”¨è®¡æ•°æ“ä½œä»£ç ã€‚æ‰€ä»¥ï¼Œ<code>ARC</code> æ˜¯å·¥ä½œåœ¨ç¼–è¯‘æœŸçš„ä¸€ç§æŠ€æœ¯æ–¹æ¡ˆï¼Œè¿™æ ·çš„å¥½å¤„æ˜¯ï¼š</p><p>ç¼–è¯‘ä¹‹åï¼Œ<code>ARC</code> ä¸é <code>ARC</code> ä»£ç æ˜¯æ²¡æœ‰ä»€ä¹ˆå·®åˆ«çš„ï¼Œæ‰€ä»¥äºŒè€…å¯ä»¥åœ¨æºç ä¸­å…±å­˜ã€‚å®é™…ä¸Šï¼Œä½ å¯ä»¥é€šè¿‡ç¼–è¯‘å‚æ•° <code>-fno-objc-arc</code> æ¥å…³é—­éƒ¨åˆ†æºä»£ç çš„ <code>ARC</code> ç‰¹æ€§ã€‚</p><p>ç›¸å¯¹äºåƒåœ¾å›æ”¶è¿™ç±»å†…å­˜ç®¡ç†æ–¹æ¡ˆï¼Œ<code>ARC</code> ä¸ä¼šå¸¦æ¥è¿è¡Œæ—¶çš„é¢å¤–å¼€é”€ï¼Œæ‰€ä»¥å¯¹äºåº”ç”¨çš„è¿è¡Œæ•ˆç‡ä¸ä¼šæœ‰å½±å“ã€‚ç›¸åï¼Œç”±äº <code>ARC</code> èƒ½å¤Ÿæ·±åº¦åˆ†ææ¯ä¸€ä¸ªå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼Œå®ƒèƒ½å¤Ÿåšåˆ°æ¯”äººå·¥ç®¡ç†å¼•ç”¨è®¡æ•°æ›´åŠ é«˜æ•ˆã€‚ä¾‹å¦‚åœ¨ä¸€ä¸ªå‡½æ•°ä¸­ï¼Œå¯¹ä¸€ä¸ªå¯¹è±¡åˆšå¼€å§‹æœ‰ä¸€ä¸ªå¼•ç”¨è®¡æ•° <code>+1</code> çš„æ“ä½œï¼Œä¹‹ååˆç´§æ¥ç€æœ‰ä¸€ä¸ª <code>-1</code> çš„æ“ä½œï¼Œé‚£ä¹ˆç¼–è¯‘å™¨å°±å¯ä»¥æŠŠè¿™ä¸¤ä¸ªæ“ä½œéƒ½ä¼˜åŒ–æ‰ã€‚</p><p>ä½†æ˜¯ä¹Ÿæœ‰äººè®¤ä¸ºï¼Œ<code>ARC</code> ä¹Ÿé™„å¸¦æœ‰è¿è¡ŒæœŸçš„ä¸€äº›æœºåˆ¶æ¥ä½¿ <code>ARC</code> èƒ½å¤Ÿæ›´å¥½çš„å·¥ä½œï¼Œä»–ä»¬ä¸»è¦æ˜¯æŒ‡ <code>weak</code> å…³é”®å­—ã€‚<code>weak</code> å˜é‡èƒ½å¤Ÿåœ¨å¼•ç”¨è®¡æ•°ä¸º <code>0</code> æ—¶è¢«è‡ªåŠ¨è®¾ç½®æˆ <code>nil</code>ï¼Œæ˜¾ç„¶æ˜¯æœ‰è¿è¡Œæ—¶é€»è¾‘åœ¨å·¥ä½œçš„ã€‚æˆ‘é€šå¸¸å¹¶æ²¡æœ‰æŠŠè¿™ä¸ªç®—åœ¨ <code>ARC</code> çš„æ¦‚å¿µå½“ä¸­ï¼Œå½“ç„¶ï¼Œè¿™æ›´å¤šæ˜¯ä¸€ä¸ªæ¦‚å¿µæˆ–å®šä¹‰ä¸Šçš„åˆ†æ­§ï¼Œå› ä¸ºé™¤å¼€ <code>weak</code> é€»è¾‘ä¹‹å¤–ï¼Œ<code>ARC</code> æ ¸å¿ƒçš„ä»£ç éƒ½æ˜¯åœ¨ç¼–è¯‘æœŸå¡«å……çš„ã€‚</p><h2 id="2-GC-åƒåœ¾å›æ”¶"><a href="#2-GC-åƒåœ¾å›æ”¶" class="headerlink" title="2. GC åƒåœ¾å›æ”¶"></a>2. GC åƒåœ¾å›æ”¶</h2><p><code>Android</code> æ‰‹æœºé€šå¸¸ä½¿ç”¨ <code>Java</code> æ¥å¼€å‘ï¼Œè€Œ <code>Java</code> æ˜¯ä½¿ç”¨åƒåœ¾å›æ”¶è¿™ç§å†…å­˜ç®¡ç†æ–¹å¼ã€‚ é‚£ä¹ˆï¼Œ<code>ARC</code> å’Œåƒåœ¾å›æ”¶å¯¹æ¯”ï¼Œæœ‰ä»€ä¹ˆä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Ÿ</p><p>è™½ç„¶åš <code>iOS</code> å¼€å‘å¹¶ä¸éœ€è¦ç”¨åˆ°åƒåœ¾å›æ”¶è¿™ç§å†…å­˜ç®¡ç†æœºåˆ¶ã€‚ä½†æ˜¯åƒåœ¾å›æ”¶è¢«ä½¿ç”¨å¾—éå¸¸æ™®éï¼Œä¸ä½†æœ‰ <code>Java</code>ï¼Œè¿˜åŒ…æ‹¬ <code>JavaScript</code>, <code>C#</code>ï¼Œ<code>Go</code> ç­‰è¯­è¨€ã€‚</p><h4 id="åƒåœ¾å›æ”¶ç®€ä»‹"><a href="#åƒåœ¾å›æ”¶ç®€ä»‹" class="headerlink" title="åƒåœ¾å›æ”¶ç®€ä»‹"></a>åƒåœ¾å›æ”¶ç®€ä»‹</h4><p>åƒåœ¾å›æ”¶ï¼ˆ<code>Garbage Collection</code>ï¼Œç®€ç§° <code>GC</code>ï¼‰è¿™ç§å†…å­˜ç®¡ç†æœºåˆ¶æœ€æ—©ç”±å›¾çµå¥–è·å¾—è€… John McCarthy åœ¨ 1959 å¹´æå‡ºï¼Œåƒåœ¾å›æ”¶çš„ç†è®ºä¸»è¦åŸºäºä¸€ä¸ªäº‹å®ï¼šå¤§éƒ¨åˆ†çš„å¯¹è±¡çš„ç”Ÿå‘½æœŸéƒ½å¾ˆçŸ­ã€‚</p><p>æ‰€ä»¥ï¼Œ<code>GC</code> å°†å†…å­˜ä¸­çš„å¯¹è±¡ä¸»è¦åˆ†æˆä¸¤ä¸ªåŒºåŸŸï¼š<code>Young</code> åŒºå’Œ <code>Old</code> åŒºã€‚å¯¹è±¡å…ˆåœ¨ <code>Young</code> åŒºè¢«åˆ›å»ºï¼Œç„¶åå¦‚æœç»è¿‡ä¸€æ®µæ—¶é—´è¿˜å­˜æ´»ç€ï¼Œåˆ™è¢«ç§»åŠ¨åˆ° <code>Old</code> åŒºã€‚ï¼ˆå…¶å®è¿˜æœ‰ä¸€ä¸ª <code>Perm</code> åŒºï¼Œä½†æ˜¯å†…å­˜å›æ”¶ç®—æ³•é€šå¸¸ä¸æ¶‰åŠè¿™ä¸ªåŒºåŸŸï¼‰</p><p><code>Young</code> åŒºå’Œ <code>Old</code> åŒºå› ä¸ºå¯¹è±¡çš„ç‰¹ç‚¹ä¸ä¸€æ ·ï¼Œæ‰€ä»¥é‡‡ç”¨äº†ä¸¤ç§å®Œå…¨ä¸åŒçš„å†…å­˜å›æ”¶ç®—æ³•ã€‚</p><p><code>Young</code> åŒºçš„å¯¹è±¡å› ä¸ºå¤§éƒ¨åˆ†ç”Ÿå‘½æœŸéƒ½å¾ˆçŸ­ï¼Œæ¯æ¬¡å›æ”¶ä¹‹ååªæœ‰å°‘éƒ¨åˆ†èƒ½å¤Ÿå­˜æ´»ï¼Œæ‰€ä»¥é‡‡ç”¨çš„ç®—æ³•å« <code>Copying</code> ç®—æ³•ï¼Œç®€å•è¯´æ¥å°±æ˜¯ç›´æ¥æŠŠæ´»ç€çš„å¯¹è±¡å¤åˆ¶åˆ°å¦ä¸€ä¸ªåœ°æ–¹ã€‚<code>Young</code> åŒºå†…éƒ¨åˆåˆ†æˆäº†ä¸‰å—åŒºåŸŸï¼š<code>Eden</code> åŒº , <code>From</code> åŒº , <code>To</code> åŒºã€‚æ¯æ¬¡æ‰§è¡Œ <code>Copying</code> ç®—æ³•æ—¶ï¼Œå³å°†å­˜æ´»çš„å¯¹è±¡ä» <code>Eden</code> åŒºå’Œ <code>From</code> åŒºå¤åˆ¶åˆ° <code>To</code> åŒºï¼Œç„¶åäº¤æ¢ <code>From</code> åŒºå’Œ <code>To</code> åŒºçš„åå­—ï¼ˆå³ <code>From</code> åŒºå˜æˆ <code>To</code> åŒºï¼Œ<code>To</code> åŒºå˜æˆ <code>From</code> åŒºï¼‰ã€‚</p><p><code>Old</code> åŒºçš„å¯¹è±¡å› ä¸ºéƒ½æ˜¯å­˜æ´»ä¸‹æ¥çš„è€å¸æœºäº†ï¼Œæ‰€ä»¥å¦‚æœç”¨ <code>Copying</code> ç®—æ³•çš„è¯ï¼Œå¾ˆå¯èƒ½ <code>90%</code> çš„å¯¹è±¡éƒ½å¾—å¤åˆ¶ä¸€éäº†ï¼Œä¸åˆ’ç®—å•Šï¼æ‰€ä»¥ <code>Old</code> åŒºçš„å›æ”¶ç®—æ³•å« <code>Mark-Sweep</code> ç®—æ³•ã€‚ç®€å•æ¥è¯´ï¼Œå°±æ˜¯åªæ˜¯æŠŠä¸ç”¨çš„å¯¹è±¡å…ˆæ ‡è®°ï¼ˆ<code>Mark</code>ï¼‰å‡ºæ¥ï¼Œç„¶åå›æ”¶ï¼ˆ<code>Sweep</code>ï¼‰ï¼Œæ´»ç€çš„å¯¹è±¡å°±ä¸åŠ¨å®ƒäº†ã€‚å› ä¸ºå¤§éƒ¨åˆ†å¯¹è±¡éƒ½æ´»ç€ï¼Œæ‰€ä»¥å›æ”¶ä¸‹æ¥çš„å¯¹è±¡å¹¶ä¸å¤šã€‚ä½†æ˜¯è¿™ä¸ªç®—æ³•ä¼šæœ‰ä¸€ä¸ªé—®é¢˜ï¼šå®ƒä¼šäº§ç”Ÿå†…å­˜ç¢ç‰‡ï¼Œæ‰€ä»¥å®ƒä¸€èˆ¬è¿˜ä¼šå¸¦æœ‰æ•´ç†å†…å­˜ç¢ç‰‡çš„é€»è¾‘ï¼Œåœ¨ç®—æ³•ä¸­å«åš <code>Compact</code>ã€‚å¦‚ä½•æ•´ç†å‘¢ï¼Ÿæ—©å¹´ç”¨è¿‡ <code>Windows</code> çš„ç¡¬ç›˜ç¢ç‰‡æ•´ç†ç¨‹åºçš„æœ‹å‹å¯èƒ½èƒ½ç†è§£ï¼Œå…¶å®å°±æ˜¯æŠŠå¯¹è±¡æ’åˆ°è¿™äº›ç©ºçš„ä½ç½®é‡Œã€‚è¿™é‡Œé¢è¿˜æ¶‰åŠå¾ˆå¤šä¼˜åŒ–çš„ç»†èŠ‚ï¼Œæˆ‘å°±ä¸ä¸€ä¸€å±•å¼€äº†ã€‚</p><p>è®²å®Œä¸»è¦çš„ç®—æ³•ï¼Œæ¥ä¸‹æ¥ <code>GC</code> éœ€è¦è§£å†³çš„é—®é¢˜å°±åªå‰©ä¸‹å¦‚ä½•æ‰¾å‡ºéœ€è¦å›æ”¶çš„åƒåœ¾å¯¹è±¡äº†ã€‚ä¸ºäº†é¿å… <code>ARC</code> è§£å†³ä¸äº†çš„å¾ªç¯å¼•ç”¨é—®é¢˜ï¼Œ<code>GC</code> å¼•å…¥äº†ä¸€ä¸ªå«åšã€Œå¯è¾¾æ€§ã€çš„æ¦‚å¿µï¼Œåº”ç”¨è¿™ä¸ªæ¦‚å¿µï¼Œå³ä½¿æ˜¯æœ‰å¾ªç¯å¼•ç”¨çš„åƒåœ¾å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥è¢«å›æ”¶æ‰ã€‚ä¸‹é¢å°±ç»™å¤§å®¶ä»‹ç»ä¸€ä¸‹è¿™ä¸ªæ¦‚å¿µã€‚</p><p>å½“ <code>GC</code> å·¥ä½œæ—¶ï¼Œ<code>GC</code> è®¤ä¸ºå½“å‰çš„ä¸€äº›å¯¹è±¡æ˜¯æœ‰æ•ˆçš„ï¼Œè¿™äº›å¯¹è±¡åŒ…æ‹¬ï¼šå…¨å±€å˜é‡ï¼Œæ ˆé‡Œé¢çš„å˜é‡ç­‰ï¼Œç„¶å <code>GC</code> ä»è¿™äº›å˜é‡å‡ºå‘ï¼Œå»æ ‡è®°è¿™äº›å˜é‡ã€Œå¯è¾¾ã€çš„å…¶å®ƒå˜é‡ï¼Œè¿™ä¸ªæ ‡è®°æ˜¯ä¸€ä¸ªé€’å½’çš„è¿‡ç¨‹ï¼Œæœ€åå°±åƒä»æ ‘æ ¹çš„å†…å­˜å¯¹è±¡å¼€å§‹ï¼ŒæŠŠæ‰€æœ‰çš„æ ‘æå’Œæ ‘å¶éƒ½è®°æˆå¯è¾¾çš„äº†ã€‚é‚£é™¤äº†è¿™äº›ã€Œå¯è¾¾ã€çš„å˜é‡ï¼Œåˆ«çš„å˜é‡å°±éƒ½éœ€è¦è¢«å›æ”¶äº†ã€‚</p><p>å¬èµ·æ¥å¾ˆç‰›é€¼å¯¹ä¸å¯¹ï¼Ÿé‚£ä¸ºä»€ä¹ˆè‹¹æœä¸ç”¨å‘¢ï¼Ÿå®é™…ä¸Šè‹¹æœåœ¨ OS X 10.5 çš„æ—¶å€™è¿˜çœŸç”¨äº†ï¼Œä¸è¿‡åœ¨ 10.7 çš„æ—¶å€™æŠŠ <code>GC</code> æ¢æˆäº† <code>ARC</code>ã€‚é‚£ä¹ˆï¼Œ<code>GC</code> æœ‰ä»€ä¹ˆé—®é¢˜è®©è‹¹æœä¸èƒ½å¿ï¼Œè¿™å°±æ˜¯ï¼šåƒåœ¾å›æ”¶çš„æ—¶å€™ï¼Œæ•´ä¸ªç¨‹åºéœ€è¦æš‚åœï¼Œè‹±æ–‡æŠŠè¿™ä¸ªè¿‡ç¨‹å«åšï¼š<code>Stop the World</code>ã€‚æ‰€ä»¥è¯´ï¼Œä½ çŸ¥é“ <code>Android</code> æ‰‹æœºæœ‰æ—¶å€™ä¸ºä»€ä¹ˆä¼šå¡å§ï¼Œ<code>GC</code> å°±ç›¸å½“äºæ˜¥è¿çš„æœ€åä¸€å¤©è¿”åŸé«˜å³°ã€‚å½“æ‰€æœ‰çš„å¯¹è±¡éƒ½éœ€è¦ä¸€èµ·å›æ”¶æ—¶ï¼Œé‚£ç§ä½“éªŒè‚¯å®šæ˜¯å½“æ—¶è¿˜åœ¨ä¸–çš„ä¹”å¸ƒæ–¯å¿å—ä¸äº†çš„ã€‚</p><p>çœ‹çœ‹ä¸‹é¢è¿™å¹…æ¼«ç”»ï¼ŒçœŸå®åœ°å±•ç°å‡º <code>GC</code> æœ€å°´å°¬çš„æƒ…å†µï¼ˆæ¼«ç”»ä¸­æåˆ°çš„ <code>Full GC</code>ï¼Œå°±æ˜¯æŒ‡æ‰§è¡Œ <code>Old</code> åŒºçš„å†…å­˜å›æ”¶ï¼‰ï¼š</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190603181612.webp" alt></p><p>å½“ç„¶ï¼Œäº‹å®ä¸Šç»è¿‡å¤šå¹´çš„å‘å±•ï¼Œ<code>GC</code> çš„å›æ”¶ç®—æ³•ä¸€ç›´åœ¨è¢«ä¼˜åŒ–ï¼Œäººä»¬æƒ³äº†å„ç§åŠæ³•æ¥ä¼˜åŒ–æš‚åœçš„æ—¶é—´ï¼Œæ‰€ä»¥æƒ…å†µå¹¶æ²¡æœ‰é‚£ä¹ˆç³Ÿç³•ã€‚</p><h4 id="ARC-ç›¸å¯¹äº-GC-çš„ä¼˜ç‚¹ï¼š"><a href="#ARC-ç›¸å¯¹äº-GC-çš„ä¼˜ç‚¹ï¼š" class="headerlink" title="ARC ç›¸å¯¹äº GC çš„ä¼˜ç‚¹ï¼š"></a><code>ARC</code> ç›¸å¯¹äº <code>GC</code> çš„ä¼˜ç‚¹ï¼š</h4><p><code>ARC</code> å·¥ä½œåœ¨ç¼–è¯‘æœŸï¼Œåœ¨è¿è¡Œæ—¶æ²¡æœ‰é¢å¤–å¼€é”€ã€‚</p><p><code>ARC</code> çš„å†…å­˜å›æ”¶æ˜¯å¹³ç¨³è¿›è¡Œçš„ï¼Œå¯¹è±¡ä¸è¢«ä½¿ç”¨æ—¶ä¼šç«‹å³è¢«å›æ”¶ã€‚è€Œ <code>GC</code> çš„å†…å­˜å›æ”¶æ˜¯ä¸€é˜µä¸€é˜µçš„ï¼Œå›æ”¶æ—¶éœ€è¦æš‚åœç¨‹åºï¼Œä¼šæœ‰ä¸€å®šçš„å¡é¡¿ã€‚</p><h4 id="ARC-ç›¸å¯¹äº-GC-çš„ç¼ºç‚¹ï¼š"><a href="#ARC-ç›¸å¯¹äº-GC-çš„ç¼ºç‚¹ï¼š" class="headerlink" title="ARC ç›¸å¯¹äº GC çš„ç¼ºç‚¹ï¼š"></a><code>ARC</code> ç›¸å¯¹äº <code>GC</code> çš„ç¼ºç‚¹ï¼š</h4><p><code>GC</code> çœŸçš„æ˜¯å¤ªç®€å•äº†ï¼ŒåŸºæœ¬ä¸Šå®Œå…¨ä¸ç”¨å¤„ç†å†…å­˜ç®¡ç†é—®é¢˜ï¼Œè€Œ <code>ARC</code> è¿˜æ˜¯éœ€è¦å¤„ç†ç±»ä¼¼å¾ªç¯å¼•ç”¨è¿™ç§å†…å­˜ç®¡ç†é—®é¢˜ã€‚</p><p><code>GC</code> ä¸€ç±»çš„è¯­è¨€ç›¸å¯¹æ¥è¯´å­¦ä¹ èµ·æ¥æ›´ç®€å•ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Note </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
            <tag> Objective-C </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LeetCodeåšé¢˜ç¬”è®°â€”ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºç³»åˆ—é¢˜ç›®</title>
      <link href="/2019-05-18-leetcode-best-time-to-buy-and-sell-stock-series/"/>
      <url>/2019-05-18-leetcode-best-time-to-buy-and-sell-stock-series/</url>
      
        <content type="html"><![CDATA[<p>è¿™æ˜¯ä¸€å¥—ç»å…¸çš„åŠ¨æ€è§„åˆ’é¢˜ç›®ï¼Œé¢˜ç›®ä¸»å¹²éƒ½æ˜¯ç»™å®šä¸€ä¸ªæ•°ç»„ï¼Œå®ƒçš„ç¬¬ i ä¸ªå…ƒç´ æ˜¯ä¸€æ”¯ç»™å®šè‚¡ç¥¨ç¬¬ i å¤©çš„ä»·æ ¼ï¼Œåœ¨ä¸åŒçš„æƒ…å†µä¸‹æ±‚åœ¨ä»€ä¹ˆæ—¶å€™ä¹°å–ä»¥è·å–æœ€å¤§åˆ©æ¶¦ã€‚</p><a id="more"></a><ul><li>121é¢˜æ˜¯åªèƒ½ä¹°å–ä¸€æ¬¡çš„æƒ…å†µä¸‹æ±‚æœ€å¤§åˆ©æ¶¦ï¼›</li><li>122é¢˜å¯ä»¥ä¹°å–ä»»æ„å¤šæ¬¡ï¼›</li><li>123é¢˜å¯ä»¥ä¹°å–ä¸¤æ¬¡ï¼›</li><li>188é¢˜æ˜¯å‰é¢ä¸‰é¢˜çš„æ³›åŒ–ç‰ˆæœ¬ï¼Œç»™å®šå‚æ•°kï¼Œæ±‚ä¹°å–kæ¬¡æƒ…å†µä¸‹çš„æœ€å¤§åˆ©æ¶¦ï¼›</li><li>309é¢˜æ˜¯åœ¨122é¢˜ä¹°å–ä»»æ„å¤šæ¬¡çš„åŸºç¡€ä¸ŠåŠ ä¸Šå†·å†»æœŸå³T+1æ‰èƒ½å–å‡ºã€‚</li></ul><p>å…¶ä¸­ä¹°å–kæ¬¡çš„188é¢˜æ˜¯æ ‡å‡†çš„ä¸‰ç»´åŠ¨æ€è§„åˆ’é¢˜ï¼Œç”¨è§£è¿™é¢˜çš„é€šç”¨æ–¹å¯ä»¥ç¨åŠ æ”¹é€ å°±èƒ½è§£å†³å‰ä¸‰é¢˜ï¼Œå½“ç„¶å‰ä¸‰é¢˜ä¹Ÿæœ‰å•ç‹¬çš„ç‰¹å®šç®€å•è§£æ³•ï¼Œè¿™é‡Œä¸ºäº†ç»ƒä¹ è¿˜æ˜¯é‡ç‚¹çœ‹åŠ¨æ€è§„åˆ’çš„è§£å†³æ–¹æ³•ã€‚</p><p>åœ¨188é¢˜çš„åŸºç¡€ä¸Šå¯ä»¥å†å˜å½¢å‡ºæ›´å¤šé¢˜ç›®ï¼Œæ¯”å¦‚ç°åœ¨è¿™äº›é¢˜éƒ½æ˜¯æœ€å¤šåªèƒ½æŒæœ‰1è‚¡ï¼Œå¦‚æœå¯ä»¥æŒæœ‰nè‚¡ï¼ˆæ¯å¤©åªèƒ½ä¹°å…¥æˆ–å–å‡º1è‚¡ï¼‰ï¼Œä¹Ÿèƒ½ç”¨è¿™ä¸ª188é¢˜çš„ä¸‰ç»´DPé€šè§£æ¥è§£å†³ã€‚</p><h2 id="121-ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº-Best-Time-to-Buy-and-Sell-Stock"><a href="#121-ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº-Best-Time-to-Buy-and-Sell-Stock" class="headerlink" title="121. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº Best Time to Buy and Sell Stock"></a>121. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº Best Time to Buy and Sell Stock</h2><p><a href="https://leetcode-cn.com/problems/best-time-to-buy-and-sell-stock/" target="_blank" rel="noopener">LeetCodeCN ç¬¬121é¢˜é“¾æ¥</a></p><p>ç»™å®šä¸€ä¸ªæ•°ç»„ï¼Œå®ƒçš„ç¬¬ i ä¸ªå…ƒç´ æ˜¯ä¸€æ”¯ç»™å®šè‚¡ç¥¨ç¬¬ i å¤©çš„ä»·æ ¼ã€‚</p><p>å¦‚æœä½ æœ€å¤šåªå…è®¸å®Œæˆä¸€ç¬”äº¤æ˜“ï¼ˆå³ä¹°å…¥å’Œå–å‡ºä¸€æ”¯è‚¡ç¥¨ï¼‰ï¼Œè®¾è®¡ä¸€ä¸ªç®—æ³•æ¥è®¡ç®—ä½ æ‰€èƒ½è·å–çš„æœ€å¤§åˆ©æ¶¦ã€‚</p><p>æ³¨æ„ä½ ä¸èƒ½åœ¨ä¹°å…¥è‚¡ç¥¨å‰å–å‡ºè‚¡ç¥¨ã€‚</p><h4 id="ç¤ºä¾‹-1"><a href="#ç¤ºä¾‹-1" class="headerlink" title="ç¤ºä¾‹ 1:"></a>ç¤ºä¾‹ 1:</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: [7,1,5,3,6,4]</span><br><span class="line">è¾“å‡º: 5</span><br><span class="line">è§£é‡Š: åœ¨ç¬¬ 2 å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼ = 1ï¼‰çš„æ—¶å€™ä¹°å…¥ï¼Œåœ¨ç¬¬ 5 å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼ = 6ï¼‰çš„æ—¶å€™å–å‡ºï¼Œæœ€å¤§åˆ©æ¶¦ = 6-1 = 5 ã€‚</span><br><span class="line">     æ³¨æ„åˆ©æ¶¦ä¸èƒ½æ˜¯ 7-1 = 6, å› ä¸ºå–å‡ºä»·æ ¼éœ€è¦å¤§äºä¹°å…¥ä»·æ ¼ã€‚</span><br></pre></td></tr></table></figure><h4 id="ç¤ºä¾‹-2"><a href="#ç¤ºä¾‹-2" class="headerlink" title="ç¤ºä¾‹ 2:"></a>ç¤ºä¾‹ 2:</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: [7,6,4,3,1]</span><br><span class="line">è¾“å‡º: 0</span><br><span class="line">è§£é‡Š: åœ¨è¿™ç§æƒ…å†µä¸‹, æ²¡æœ‰äº¤æ˜“å®Œæˆ, æ‰€ä»¥æœ€å¤§åˆ©æ¶¦ä¸º 0ã€‚</span><br></pre></td></tr></table></figure><h3 id="è§£ï¼š"><a href="#è§£ï¼š" class="headerlink" title="è§£ï¼š"></a>è§£ï¼š</h3><p>ç¬¬ä¸€ç§æ–¹æ³•ï¼šç”±äºä¸€æ¬¡äº¤æ˜“æ“ä½œï¼Œå¯ä»¥é€šè¿‡è®°å½•æœ€å°ä»·æ ¼ï¼Œè®¡ç®—æœ€å¤§åˆ©æ¶¦çš„æ–¹å¼ï¼Œç©ºé—´æ¢æ—¶é—´ï¼Œæ—¶é—´å¤æ‚åº¦<code>O(n)</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">maxProfit</span><span class="params">(self, prices: List[int])</span> -&gt; int:</span></span><br><span class="line">        res, low = <span class="number">0</span>, float(<span class="string">'inf'</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(prices)):</span><br><span class="line">            low = min(prices[i], low)</span><br><span class="line">            res = max(res, prices[i] - low)</span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ–¹æ³•ï¼šDPåŠ¨æ€è§„åˆ’ï¼Œä¸ä¸‹é¢122é¢˜ç›¸æ¯”ï¼Œç”±äºåªèƒ½ä¸€æ¬¡äº¤æ˜“æ“ä½œï¼Œç¬¬<code>i</code>å¤©çš„çŠ¶æ€å°±ä¸æ­¢â€œä¸æŒæœ‰â€å’Œâ€œæŒæœ‰â€ä¸¤ç§çŠ¶æ€ï¼Œè€Œæ˜¯â€œæœªæŒæœ‰â€ã€â€œæŒæœ‰â€ã€â€œå–å‡ºâ€ä¸‰ç§ï¼Œå¹¶éœ€è¦ä¸€ä¸ªå˜é‡å­˜å‚¨æœ€å¤§å€¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">maxProfit</span><span class="params">(self, prices: List[int])</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> prices:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        <span class="comment"># ç”Ÿæˆæ•°ç»„, ç„¶åç»™åˆå§‹çŠ¶æ€èµ‹å€¼</span></span><br><span class="line">        dp, res = [[<span class="number">0</span>]*<span class="number">3</span> <span class="keyword">for</span> _ <span class="keyword">in</span> range(len(prices))], <span class="number">0</span></span><br><span class="line">        dp[<span class="number">0</span>][<span class="number">0</span>], dp[<span class="number">0</span>][<span class="number">1</span>], dp[<span class="number">0</span>][<span class="number">2</span>] = <span class="number">0</span>, -prices[<span class="number">0</span>], <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, len(prices)):</span><br><span class="line">            <span class="comment"># dp[i][0] ç¬¬iå¤© ä¸€ç›´æ²¡æœ‰è‚¡ç¥¨çš„åˆ©æ¶¦</span></span><br><span class="line">            <span class="comment"># dp[i][1] ç¬¬iå¤© å½“å‰æœ‰è‚¡ç¥¨çš„åˆ©æ¶¦ å– max(å‰é¢æœ‰è‚¡ç¥¨ä»Šå¤©ä¸å–, å‰é¢æ²¡è‚¡ç¥¨ä»Šå¤©ä¹°å…¥)</span></span><br><span class="line">            <span class="comment"># dp[i][2] ç¬¬iå¤© ä¹‹å‰ä¹°å…¥ç°åœ¨å–äº†çš„åˆ©æ¶¦(å‰é¢æœ‰è‚¡ç¥¨ä»Šå¤©å–å‡º)</span></span><br><span class="line">            dp[i][<span class="number">0</span>] = dp[i<span class="number">-1</span>][<span class="number">0</span>]</span><br><span class="line">            dp[i][<span class="number">1</span>] = max(dp[i<span class="number">-1</span>][<span class="number">0</span>] - prices[i], dp[i<span class="number">-1</span>][<span class="number">1</span>])</span><br><span class="line">            dp[i][<span class="number">2</span>] = dp[i<span class="number">-1</span>][<span class="number">1</span>] + prices[i]</span><br><span class="line">            res = max(res, dp[i][<span class="number">0</span>], dp[i][<span class="number">2</span>])</span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure><h2 id="122-ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº-II-Best-Time-to-Buy-and-Sell-Stock-II"><a href="#122-ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº-II-Best-Time-to-Buy-and-Sell-Stock-II" class="headerlink" title="122. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº II Best Time to Buy and Sell Stock II"></a>122. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº II Best Time to Buy and Sell Stock II</h2><p><a href="https://leetcode-cn.com/problems/best-time-to-buy-and-sell-stock-ii/" target="_blank" rel="noopener">LeetCodeCN ç¬¬122é¢˜é“¾æ¥</a></p><p>ç»™å®šä¸€ä¸ªæ•°ç»„ï¼Œå®ƒçš„ç¬¬ i ä¸ªå…ƒç´ æ˜¯ä¸€æ”¯ç»™å®šè‚¡ç¥¨ç¬¬ i å¤©çš„ä»·æ ¼ã€‚</p><p>è®¾è®¡ä¸€ä¸ªç®—æ³•æ¥è®¡ç®—ä½ æ‰€èƒ½è·å–çš„æœ€å¤§åˆ©æ¶¦ã€‚ä½ å¯ä»¥å°½å¯èƒ½åœ°å®Œæˆæ›´å¤šçš„äº¤æ˜“ï¼ˆå¤šæ¬¡ä¹°å–ä¸€æ”¯è‚¡ç¥¨ï¼‰ã€‚</p><p>æ³¨æ„ï¼šä½ ä¸èƒ½åŒæ—¶å‚ä¸å¤šç¬”äº¤æ˜“ï¼ˆä½ å¿…é¡»åœ¨å†æ¬¡è´­ä¹°å‰å‡ºå”®æ‰ä¹‹å‰çš„è‚¡ç¥¨ï¼‰ã€‚</p><h4 id="ç¤ºä¾‹-1-1"><a href="#ç¤ºä¾‹-1-1" class="headerlink" title="ç¤ºä¾‹ 1:"></a>ç¤ºä¾‹ 1:</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: [7,1,5,3,6,4]</span><br><span class="line">è¾“å‡º: 7</span><br><span class="line">è§£é‡Š: åœ¨ç¬¬ 2 å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼ = 1ï¼‰çš„æ—¶å€™ä¹°å…¥ï¼Œåœ¨ç¬¬ 3 å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼ = 5ï¼‰çš„æ—¶å€™å–å‡º, è¿™ç¬”äº¤æ˜“æ‰€èƒ½è·å¾—åˆ©æ¶¦ = 5-1 = 4 ã€‚</span><br><span class="line">     éšåï¼Œåœ¨ç¬¬ 4 å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼ = 3ï¼‰çš„æ—¶å€™ä¹°å…¥ï¼Œåœ¨ç¬¬ 5 å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼ = 6ï¼‰çš„æ—¶å€™å–å‡º, è¿™ç¬”äº¤æ˜“æ‰€èƒ½è·å¾—åˆ©æ¶¦ = 6-3 = 3 ã€‚</span><br></pre></td></tr></table></figure><h4 id="ç¤ºä¾‹-2-1"><a href="#ç¤ºä¾‹-2-1" class="headerlink" title="ç¤ºä¾‹ 2:"></a>ç¤ºä¾‹ 2:</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: [1,2,3,4,5]</span><br><span class="line">è¾“å‡º: 4</span><br><span class="line">è§£é‡Š: åœ¨ç¬¬ 1 å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼ = 1ï¼‰çš„æ—¶å€™ä¹°å…¥ï¼Œåœ¨ç¬¬ 5 å¤© ï¼ˆè‚¡ç¥¨ä»·æ ¼ = 5ï¼‰çš„æ—¶å€™å–å‡º, è¿™ç¬”äº¤æ˜“æ‰€èƒ½è·å¾—åˆ©æ¶¦ = 5-1 = 4 ã€‚</span><br><span class="line">     æ³¨æ„ä½ ä¸èƒ½åœ¨ç¬¬ 1 å¤©å’Œç¬¬ 2 å¤©æ¥è¿è´­ä¹°è‚¡ç¥¨ï¼Œä¹‹åå†å°†å®ƒä»¬å–å‡ºã€‚</span><br><span class="line">     å› ä¸ºè¿™æ ·å±äºåŒæ—¶å‚ä¸äº†å¤šç¬”äº¤æ˜“ï¼Œä½ å¿…é¡»åœ¨å†æ¬¡è´­ä¹°å‰å‡ºå”®æ‰ä¹‹å‰çš„è‚¡ç¥¨ã€‚</span><br></pre></td></tr></table></figure><h4 id="ç¤ºä¾‹-3"><a href="#ç¤ºä¾‹-3" class="headerlink" title="ç¤ºä¾‹ 3:"></a>ç¤ºä¾‹ 3:</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: [7,6,4,3,1]</span><br><span class="line">è¾“å‡º: 0</span><br><span class="line">è§£é‡Š: åœ¨è¿™ç§æƒ…å†µä¸‹, æ²¡æœ‰äº¤æ˜“å®Œæˆ, æ‰€ä»¥æœ€å¤§åˆ©æ¶¦ä¸º 0ã€‚</span><br></pre></td></tr></table></figure><h3 id="è§£ï¼š-1"><a href="#è§£ï¼š-1" class="headerlink" title="è§£ï¼š"></a>è§£ï¼š</h3><p>ç¬¬ä¸€ç§æ–¹æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ï¼Œæ—¶é—´å¤æ‚åº¦<code>O(2^n)</code>ï¼Œè¿™ä¸ªé€šè¿‡ä¸äº†LeetCodeï¼Œä¸è¿‡èƒ½workï¼Œæµ‹è¯•äº†å¤šç»„æµ‹è¯•æ ·ä¾‹æ˜¯æ­£ç¡®çš„</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">maxProfit</span><span class="params">(self, prices: List[int])</span> -&gt; int:</span></span><br><span class="line">        self.prices = prices</span><br><span class="line">        self.profit = []</span><br><span class="line">        self.helper(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> max(self.profit)</span><br><span class="line">        </span><br><span class="line">    <span class="comment"># have 0:æœªæŒæœ‰  1:æŒæœ‰</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, i, have, profit)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> i == len(self.prices):</span><br><span class="line">            self.profit.append(profit)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">if</span> have: <span class="comment"># å¦‚æœæŒæœ‰ä¸­</span></span><br><span class="line">            self.helper(i+<span class="number">1</span>, <span class="number">0</span>, profit + self.prices[i]) <span class="comment"># å–å‡º</span></span><br><span class="line">            self.helper(i+<span class="number">1</span>, <span class="number">1</span>, profit) <span class="comment"># ä¸åŠ¨</span></span><br><span class="line">        <span class="keyword">else</span>: <span class="comment"># å¦‚æœæœªæŒæœ‰</span></span><br><span class="line">            self.helper(i+<span class="number">1</span>, <span class="number">0</span>, profit) <span class="comment"># ä¸åŠ¨</span></span><br><span class="line">            self.helper(i+<span class="number">1</span>, <span class="number">1</span>, profit - self.prices[i]) <span class="comment"># ä¹°å…¥</span></span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ–¹æ³•ï¼šè´ªå¿ƒç®—æ³•ï¼Œä¸€æ¬¡éå†ï¼Œåªè¦ä»Šå¤©ä»·æ ¼å°äºæ˜å¤©ä»·æ ¼å°±åœ¨ä»Šå¤©ä¹°å…¥ç„¶åæ˜å¤©å–å‡ºï¼Œæ—¶é—´å¤æ‚åº¦<code>O(n)</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">maxProfit</span><span class="params">(self, prices: List[int])</span> -&gt; int:</span></span><br><span class="line">        ans = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, len(prices)):</span><br><span class="line">            <span class="keyword">if</span> prices[i] &gt; prices[i<span class="number">-1</span>]:</span><br><span class="line">                ans += prices[i] - prices[i<span class="number">-1</span>]</span><br><span class="line">        <span class="keyword">return</span> ans</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰ç§æ–¹æ³•ï¼šæ ‡å‡†äºŒç»´DPåŠ¨æ€è§„åˆ’ï¼Œç¬¬<code>i</code>å¤©åªæœ‰ä¸¤ç§çŠ¶æ€ï¼Œä¸æŒæœ‰æˆ–æŒæœ‰è‚¡ç¥¨ï¼Œå½“å¤©ä¸æŒæœ‰è‚¡ç¥¨çš„çŠ¶æ€å¯èƒ½æ¥è‡ªæ˜¨å¤©å–å‡ºæˆ–è€…æ˜¨å¤©ä¹Ÿä¸æŒæœ‰ï¼ŒåŒç†ï¼Œå½“å¤©æŒæœ‰è‚¡ç¥¨çš„çŠ¶æ€å¯èƒ½æ¥è‡ªæ˜¨å¤©ä¹°å…¥æˆ–è€…æ˜¨å¤©ä¹ŸæŒæœ‰ä¸­ï¼Œå–æœ€åä¸€å¤©çš„ä¸æŒæœ‰è‚¡ç¥¨çŠ¶æ€å°±æ˜¯é—®é¢˜çš„è§£</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">maxProfit</span><span class="params">(self, prices: List[int])</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> prices:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        n = len(prices)</span><br><span class="line">        dp = [[<span class="number">0</span>]*<span class="number">2</span> <span class="keyword">for</span> _ <span class="keyword">in</span> range(n)]</span><br><span class="line">        <span class="comment"># dp[i][0]è¡¨ç¤ºç¬¬iå¤©ä¸æŒæœ‰è‚¡ç¥¨, dp[i][1]è¡¨ç¤ºç¬¬iå¤©æŒæœ‰è‚¡ç¥¨</span></span><br><span class="line">        dp[<span class="number">0</span>][<span class="number">0</span>], dp[<span class="number">0</span>][<span class="number">1</span>] = <span class="number">0</span>, - prices[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, n):</span><br><span class="line">            dp[i][<span class="number">0</span>] = max(dp[i<span class="number">-1</span>][<span class="number">0</span>], dp[i<span class="number">-1</span>][<span class="number">1</span>] + prices[i])</span><br><span class="line">            dp[i][<span class="number">1</span>] = max(dp[i<span class="number">-1</span>][<span class="number">1</span>], dp[i<span class="number">-1</span>][<span class="number">0</span>] - prices[i])</span><br><span class="line">        <span class="keyword">return</span> dp[n<span class="number">-1</span>][<span class="number">0</span>]</span><br></pre></td></tr></table></figure><h2 id="123-ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº-III-Best-Time-to-Buy-and-Sell-Stock-III"><a href="#123-ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº-III-Best-Time-to-Buy-and-Sell-Stock-III" class="headerlink" title="123.  ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº III Best Time to Buy and Sell Stock III"></a>123.  ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº III Best Time to Buy and Sell Stock III</h2><p><a href="https://leetcode-cn.com/problems/best-time-to-buy-and-sell-stock-iii/" target="_blank" rel="noopener">LeetCodeCN ç¬¬123é¢˜é“¾æ¥</a></p><p>ç»™å®šä¸€ä¸ªæ•°ç»„ï¼Œå®ƒçš„ç¬¬ i ä¸ªå…ƒç´ æ˜¯ä¸€æ”¯ç»™å®šçš„è‚¡ç¥¨åœ¨ç¬¬ i å¤©çš„ä»·æ ¼ã€‚</p><p>è®¾è®¡ä¸€ä¸ªç®—æ³•æ¥è®¡ç®—ä½ æ‰€èƒ½è·å–çš„æœ€å¤§åˆ©æ¶¦ã€‚ä½ æœ€å¤šå¯ä»¥å®Œæˆ ä¸¤ç¬” äº¤æ˜“ã€‚</p><p>æ³¨æ„: ä½ ä¸èƒ½åŒæ—¶å‚ä¸å¤šç¬”äº¤æ˜“ï¼ˆä½ å¿…é¡»åœ¨å†æ¬¡è´­ä¹°å‰å‡ºå”®æ‰ä¹‹å‰çš„è‚¡ç¥¨ï¼‰ã€‚</p><h4 id="ç¤ºä¾‹-1-2"><a href="#ç¤ºä¾‹-1-2" class="headerlink" title="ç¤ºä¾‹ 1:"></a>ç¤ºä¾‹ 1:</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: [3,3,5,0,0,3,1,4]</span><br><span class="line">è¾“å‡º: 6</span><br><span class="line">è§£é‡Š: åœ¨ç¬¬ 4 å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼ = 0ï¼‰çš„æ—¶å€™ä¹°å…¥ï¼Œåœ¨ç¬¬ 6 å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼ = 3ï¼‰çš„æ—¶å€™å–å‡ºï¼Œè¿™ç¬”äº¤æ˜“æ‰€èƒ½è·å¾—åˆ©æ¶¦ = 3-0 = 3 ã€‚</span><br><span class="line">     éšåï¼Œåœ¨ç¬¬ 7 å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼ = 1ï¼‰çš„æ—¶å€™ä¹°å…¥ï¼Œåœ¨ç¬¬ 8 å¤© ï¼ˆè‚¡ç¥¨ä»·æ ¼ = 4ï¼‰çš„æ—¶å€™å–å‡ºï¼Œè¿™ç¬”äº¤æ˜“æ‰€èƒ½è·å¾—åˆ©æ¶¦ = 4-1 = 3 ã€‚</span><br></pre></td></tr></table></figure><h4 id="ç¤ºä¾‹-2-2"><a href="#ç¤ºä¾‹-2-2" class="headerlink" title="ç¤ºä¾‹ 2:"></a>ç¤ºä¾‹ 2:</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: [1,2,3,4,5]</span><br><span class="line">è¾“å‡º: 4</span><br><span class="line">è§£é‡Š: åœ¨ç¬¬ 1 å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼ = 1ï¼‰çš„æ—¶å€™ä¹°å…¥ï¼Œåœ¨ç¬¬ 5 å¤© ï¼ˆè‚¡ç¥¨ä»·æ ¼ = 5ï¼‰çš„æ—¶å€™å–å‡º, è¿™ç¬”äº¤æ˜“æ‰€èƒ½è·å¾—åˆ©æ¶¦ = 5-1 = 4 ã€‚   </span><br><span class="line">     æ³¨æ„ä½ ä¸èƒ½åœ¨ç¬¬ 1 å¤©å’Œç¬¬ 2 å¤©æ¥è¿è´­ä¹°è‚¡ç¥¨ï¼Œä¹‹åå†å°†å®ƒä»¬å–å‡ºã€‚   </span><br><span class="line">     å› ä¸ºè¿™æ ·å±äºåŒæ—¶å‚ä¸äº†å¤šç¬”äº¤æ˜“ï¼Œä½ å¿…é¡»åœ¨å†æ¬¡è´­ä¹°å‰å‡ºå”®æ‰ä¹‹å‰çš„è‚¡ç¥¨ã€‚</span><br></pre></td></tr></table></figure><h4 id="ç¤ºä¾‹-3-1"><a href="#ç¤ºä¾‹-3-1" class="headerlink" title="ç¤ºä¾‹ 3:"></a>ç¤ºä¾‹ 3:</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: [7,6,4,3,1] </span><br><span class="line">è¾“å‡º: 0 </span><br><span class="line">è§£é‡Š: åœ¨è¿™ä¸ªæƒ…å†µä¸‹, æ²¡æœ‰äº¤æ˜“å®Œæˆ, æ‰€ä»¥æœ€å¤§åˆ©æ¶¦ä¸º 0ã€‚</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€ç§æ–¹æ³•ï¼šæ ‡å‡†çš„ä¸‰ç»´DPåŠ¨æ€è§„åˆ’ï¼Œä¸‰ä¸ªç»´åº¦ï¼Œç¬¬ä¸€ç»´è¡¨ç¤ºå¤©ï¼Œç¬¬äºŒç»´è¡¨ç¤ºäº¤æ˜“äº†å‡ æ¬¡ï¼Œç¬¬ä¸‰ç»´è¡¨ç¤ºæ˜¯å¦æŒæœ‰è‚¡ç¥¨ã€‚ä¸ä¸‹é¢188é¢˜ä¹°å–è‚¡ç¥¨4ä¸€æ ·çš„ä»£ç ï¼ŒæŠŠäº¤æ˜“kæ¬¡å®šä¹‰ä¸º2æ¬¡ã€‚å½“ç„¶ä¹Ÿå¯ä»¥æŠŠå†…å±‚çš„forå¾ªç¯æ‹†å‡ºæ¥ï¼Œåˆ†åˆ«åˆ—å‡ºäº¤æ˜“0æ¬¡ã€1æ¬¡ã€2æ¬¡çš„çŠ¶æ€è½¬ç§»æ–¹ç¨‹å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">maxProfit</span><span class="params">(self, prices: List[int])</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> prices:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        n = len(prices)</span><br><span class="line">        dp = [[[<span class="number">0</span>]*<span class="number">2</span> <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">3</span>)] <span class="keyword">for</span> _ <span class="keyword">in</span> range(n)]</span><br><span class="line">        <span class="comment"># dp[i][j][0]è¡¨ç¤ºç¬¬iå¤©äº¤æ˜“äº†jæ¬¡æ—¶ä¸æŒæœ‰è‚¡ç¥¨, dp[i][j][1]è¡¨ç¤ºç¬¬iå¤©äº¤æ˜“äº†jæ¬¡æ—¶æŒæœ‰è‚¡ç¥¨</span></span><br><span class="line">        <span class="comment"># å®šä¹‰å–å‡ºè‚¡ç¥¨æ—¶äº¤æ˜“æ¬¡æ•°åŠ 1</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">            dp[<span class="number">0</span>][i][<span class="number">0</span>], dp[<span class="number">0</span>][i][<span class="number">1</span>] = <span class="number">0</span>, -prices[<span class="number">0</span>]</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, n):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> j:</span><br><span class="line">                    dp[i][j][<span class="number">0</span>] = dp[i<span class="number">-1</span>][j][<span class="number">0</span>]</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    dp[i][j][<span class="number">0</span>] = max(dp[i<span class="number">-1</span>][j][<span class="number">0</span>], dp[i<span class="number">-1</span>][j<span class="number">-1</span>][<span class="number">1</span>] + prices[i])</span><br><span class="line">                dp[i][j][<span class="number">1</span>] = max(dp[i<span class="number">-1</span>][j][<span class="number">1</span>], dp[i<span class="number">-1</span>][j][<span class="number">0</span>] - prices[i])</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> max(dp[n<span class="number">-1</span>][<span class="number">0</span>][<span class="number">0</span>], dp[n<span class="number">-1</span>][<span class="number">1</span>][<span class="number">0</span>], dp[n<span class="number">-1</span>][<span class="number">2</span>][<span class="number">0</span>])</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ–¹æ³•ï¼šç”¨å˜é‡è€Œä¸æ˜¯å¤šç»´æ•°ç»„ä¿å­˜è¿­ä»£çš„å€¼ï¼Œä¼˜ç‚¹æ˜¯çœå†…å­˜ç©ºé—´ï¼Œç¼ºç‚¹æ˜¯ä¸æ˜¯æ ‡å‡†DPï¼Œæ²¡æ³•æ³›åŒ–</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">maxProfit</span><span class="params">(self, prices: List[int])</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> prices:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        buy1, sell1, buy2, sell2 = -prices[<span class="number">0</span>], <span class="number">0</span>, -prices[<span class="number">0</span>], <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,len(prices)):</span><br><span class="line">            buy1 = max(buy1,-prices[i])<span class="comment">#ç”¨è´Ÿå€¼ç»Ÿä¸€å˜é‡</span></span><br><span class="line">            sell1 = max(sell1,buy1 + prices[i])<span class="comment">#sell1ä¸º 0~i(å«)å¤©è‚¡å¸‚ä¸­ä¹°å–ä¸€æ¬¡çš„æœ€ä¼˜åˆ©æ¶¦</span></span><br><span class="line">            buy2 = max(buy2,sell1 - prices[i])<span class="comment">#ä»…å½“ï¼0æ‰ä¼šæ›´æ–°ï¼Œä¿è¯ ç¬¬äºŒæ¬¡ä¹°å…¥ä¸ä¼šä¸ç¬¬ä¸€æ¬¡å–å‡ºä¸ºåŒä¸€å¤©ã€‚è€Œsell1ä¸ºå†å²è®°å½•ä¿è¯ç¬¬äºŒæ¬¡ä¹°å…¥æ¯”ç¬¬ä¸€æ¬¡å–å‡ºæ™šã€‚</span></span><br><span class="line">            sell2 = max(sell2,buy2 + prices[i])<span class="comment">#è‹¥ç¬¬äºŒè½®ä¹°å–ä¸ºåŒä¸€å¤©ï¼Œåˆ™ä¸ä¼šæ›´æ–°ã€‚æ­¤æ“ä½œè‡ªç„¶ä¿è¯sell2ä¸ºä¹°å–è‡³å¤šä¸¤æ¬¡çš„æœ€ä¼˜åˆ©æ¶¦ã€‚</span></span><br><span class="line">        <span class="keyword">return</span> sell2</span><br></pre></td></tr></table></figure><h2 id="188-ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº-IV-Best-Time-to-Buy-and-Sell-Stock-IV"><a href="#188-ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº-IV-Best-Time-to-Buy-and-Sell-Stock-IV" class="headerlink" title="188. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº IV Best Time to Buy and Sell Stock IV"></a>188. ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº IV Best Time to Buy and Sell Stock IV</h2><p><a href="https://leetcode-cn.com/problems/best-time-to-buy-and-sell-stock-iv/" target="_blank" rel="noopener">LeetCodeCN ç¬¬188é¢˜é“¾æ¥</a></p><p>ç»™å®šä¸€ä¸ªæ•°ç»„ï¼Œå®ƒçš„ç¬¬ i ä¸ªå…ƒç´ æ˜¯ä¸€æ”¯ç»™å®šçš„è‚¡ç¥¨åœ¨ç¬¬ i å¤©çš„ä»·æ ¼ã€‚</p><p>è®¾è®¡ä¸€ä¸ªç®—æ³•æ¥è®¡ç®—ä½ æ‰€èƒ½è·å–çš„æœ€å¤§åˆ©æ¶¦ã€‚ä½ æœ€å¤šå¯ä»¥å®Œæˆ k ç¬”äº¤æ˜“ã€‚</p><p>æ³¨æ„: ä½ ä¸èƒ½åŒæ—¶å‚ä¸å¤šç¬”äº¤æ˜“ï¼ˆä½ å¿…é¡»åœ¨å†æ¬¡è´­ä¹°å‰å‡ºå”®æ‰ä¹‹å‰çš„è‚¡ç¥¨ï¼‰ã€‚</p><h4 id="ç¤ºä¾‹-1-3"><a href="#ç¤ºä¾‹-1-3" class="headerlink" title="ç¤ºä¾‹ 1:"></a>ç¤ºä¾‹ 1:</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: [2,4,1], k = 2</span><br><span class="line">è¾“å‡º: 2</span><br><span class="line">è§£é‡Š: åœ¨ç¬¬ 1 å¤© (è‚¡ç¥¨ä»·æ ¼ = 2) çš„æ—¶å€™ä¹°å…¥ï¼Œåœ¨ç¬¬ 2 å¤© (è‚¡ç¥¨ä»·æ ¼ = 4) çš„æ—¶å€™å–å‡ºï¼Œè¿™ç¬”äº¤æ˜“æ‰€èƒ½è·å¾—åˆ©æ¶¦ = 4-2 = 2 ã€‚</span><br></pre></td></tr></table></figure><h4 id="ç¤ºä¾‹-2-3"><a href="#ç¤ºä¾‹-2-3" class="headerlink" title="ç¤ºä¾‹ 2:"></a>ç¤ºä¾‹ 2:</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: [3,2,6,5,0,3], k = 2</span><br><span class="line">è¾“å‡º: 7</span><br><span class="line">è§£é‡Š: åœ¨ç¬¬ 2 å¤© (è‚¡ç¥¨ä»·æ ¼ = 2) çš„æ—¶å€™ä¹°å…¥ï¼Œåœ¨ç¬¬ 3 å¤© (è‚¡ç¥¨ä»·æ ¼ = 6) çš„æ—¶å€™å–å‡º, è¿™ç¬”äº¤æ˜“æ‰€èƒ½è·å¾—åˆ©æ¶¦ = 6-2 = 4 ã€‚</span><br><span class="line">     éšåï¼Œåœ¨ç¬¬ 5 å¤© (è‚¡ç¥¨ä»·æ ¼ = 0) çš„æ—¶å€™ä¹°å…¥ï¼Œåœ¨ç¬¬ 6 å¤© (è‚¡ç¥¨ä»·æ ¼ = 3) çš„æ—¶å€™å–å‡º, è¿™ç¬”äº¤æ˜“æ‰€èƒ½è·å¾—åˆ©æ¶¦ = 3-0 = 3 ã€‚</span><br></pre></td></tr></table></figure><h3 id="è§£ï¼š-2"><a href="#è§£ï¼š-2" class="headerlink" title="è§£ï¼š"></a>è§£ï¼š</h3><p>æ ‡å‡†çš„ä¸‰ç»´DPåŠ¨æ€è§„åˆ’ï¼Œä¸‰ä¸ªç»´åº¦ï¼Œç¬¬ä¸€ç»´è¡¨ç¤ºå¤©ï¼Œç¬¬äºŒç»´è¡¨ç¤ºäº¤æ˜“äº†å‡ æ¬¡ï¼Œç¬¬ä¸‰ç»´è¡¨ç¤ºæ˜¯å¦æŒæœ‰è‚¡ç¥¨ã€‚</p><p>é¦–å…ˆåˆå§‹åŒ–ä¸‰ç»´æ•°ç»„ï¼Œå¡«å……ç¬¬1å¤©æ“ä½œjæ¬¡çš„æ²¡ä¹°æˆ–ä¹°äº†çš„æƒ…å†µçš„åˆå§‹å€¼ï¼Œæ²¡ä¹°å°±æ˜¯<code>0</code>ï¼Œç¬¬ä¸€å¤©å°±ä¹°å…¥å³<code>-prices[0]</code>ã€‚è¿™é‡Œå®šä¹‰å–å‡ºæ“ä½œæ—¶äº¤æ˜“æ¬¡æ•°åŠ <code>1</code></p><p>ç„¶åæ˜¯çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼Œä¸‹é¢æè¿°çš„<code>i, j</code>éƒ½å¤§äº<code>0</code></p><p>ã€Œç¬¬<code>i</code>å¤©äº¤æ˜“æ¬¡æ•°<code>0</code>ä¸æŒæœ‰è‚¡ç¥¨ã€çš„æƒ…å†µåªèƒ½æ¥è‡ªã€Œç¬¬<code>i-1</code>å¤©äº¤æ˜“æ¬¡æ•°<code>0</code>ä¸æŒæœ‰è‚¡ç¥¨ã€ï¼›</p><p>ã€Œç¬¬<code>i</code>å¤©äº¤æ˜“<code>j</code>æ¬¡ä¸æŒæœ‰è‚¡ç¥¨ã€çš„çŠ¶æ€å¯ä»¥æ¥è‡ªã€Œç¬¬<code>i-1</code>å¤©äº¤æ˜“<code>j</code>æ¬¡ä¸æŒæœ‰è‚¡ç¥¨ã€æˆ–è€…ã€Œç¬¬<code>i-1</code>å¤©äº¤æ˜“<code>j-1</code>æ¬¡æŒæœ‰è‚¡ç¥¨ã€(å³ä»Šå¤©å–å‡ºè‚¡ç¥¨ï¼Œç„¶åäº¤æ˜“æ¬¡æ•°+1)ï¼›</p><p>ã€Œç¬¬<code>i</code>å¤©äº¤æ˜“<code>j</code>æ¬¡æŒæœ‰è‚¡ç¥¨ã€çš„çŠ¶æ€å¯ä»¥æ¥è‡ªã€Œç¬¬<code>i-1</code>å¤©äº¤æ˜“<code>j</code>æ¬¡æŒæœ‰è‚¡ç¥¨ã€æˆ–è€…ã€Œç¬¬<code>i-1</code>å¤©äº¤æ˜“<code>j</code>æ¬¡ä¸æŒæœ‰è‚¡ç¥¨ã€(å³ä»Šå¤©ä¹°å…¥è‚¡ç¥¨ï¼Œå› ä¸ºæ˜¯ä¹°å…¥æ“ä½œæ‰€ä»¥äº¤æ˜“æ¬¡æ•°ä¸å˜)</p><p>æœ€åå¯¹äºè¿™é¢˜LeetCodeçš„æµ‹è¯•æ ·ä¾‹é‡Œæœ‰è¶…å¤§kå€¼çš„æƒ…å†µï¼Œé€€åŒ–æˆ122é¢˜ä¸é™æ¬¡æ•°çš„æ“ä½œï¼Œå¯ä»¥ç”¨è´ªå¿ƒè§£å†³æˆ–è€…ç›´æ¥æ›¿æ¢kå€¼ä¸ºæ•°ç»„é•¿åº¦çš„ä¸€åŠ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">maxProfit</span><span class="params">(self, k: int, prices: List[int])</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> prices <span class="keyword">or</span> <span class="keyword">not</span> k:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        n = len(prices)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å½“kå¤§äºæ•°ç»„é•¿åº¦çš„ä¸€åŠæ—¶ï¼Œç­‰åŒäºä¸é™æ¬¡æ•°äº¤æ˜“å³122é¢˜ï¼Œç”¨è´ªå¿ƒç®—æ³•è§£å†³ï¼Œå¦åˆ™LeetCodeä¼šè¶…æ—¶ï¼Œä¹Ÿå¯ä»¥ç›´æ¥æŠŠè¶…å¤§çš„kæ›¿æ¢ä¸ºæ•°ç»„çš„ä¸€åŠï¼Œå°±ä¸ç”¨å†™é¢å¤–çš„è´ªå¿ƒç®—æ³•å‡½æ•°</span></span><br><span class="line">        <span class="keyword">if</span> k &gt; n//<span class="number">2</span>:</span><br><span class="line">            <span class="keyword">return</span> self.greedy(prices)</span><br><span class="line">        </span><br><span class="line">        dp, res = [[[<span class="number">0</span>]*<span class="number">2</span> <span class="keyword">for</span> _ <span class="keyword">in</span> range(k+<span class="number">1</span>)] <span class="keyword">for</span> _ <span class="keyword">in</span> range(n)], []</span><br><span class="line">        <span class="comment"># dp[i][k][0]è¡¨ç¤ºç¬¬iå¤©å·²äº¤æ˜“kæ¬¡æ—¶ä¸æŒæœ‰è‚¡ç¥¨ dp[i][k][1]è¡¨ç¤ºç¬¬iå¤©å·²äº¤æ˜“kæ¬¡æ—¶æŒæœ‰è‚¡ç¥¨</span></span><br><span class="line">        <span class="comment"># è®¾å®šåœ¨å–å‡ºæ—¶åŠ 1æ¬¡äº¤æ˜“æ¬¡æ•°</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(k+<span class="number">1</span>):</span><br><span class="line">            dp[<span class="number">0</span>][i][<span class="number">0</span>], dp[<span class="number">0</span>][i][<span class="number">1</span>] = <span class="number">0</span>, - prices[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, n):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(k+<span class="number">1</span>):</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> j:</span><br><span class="line">                    dp[i][j][<span class="number">0</span>] = dp[i<span class="number">-1</span>][j][<span class="number">0</span>]</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    dp[i][j][<span class="number">0</span>] = max(dp[i<span class="number">-1</span>][j][<span class="number">0</span>], dp[i<span class="number">-1</span>][j<span class="number">-1</span>][<span class="number">1</span>] + prices[i])</span><br><span class="line">                dp[i][j][<span class="number">1</span>] = max(dp[i<span class="number">-1</span>][j][<span class="number">1</span>], dp[i<span class="number">-1</span>][j][<span class="number">0</span>] - prices[i])</span><br><span class="line">        <span class="comment"># ã€Œæ‰€æœ‰äº¤æ˜“æ¬¡æ•°æœ€åä¸€å¤©ä¸æŒæœ‰è‚¡ç¥¨ã€çš„é›†åˆçš„æœ€å¤§å€¼å³ä¸ºé—®é¢˜çš„è§£</span></span><br><span class="line">        <span class="keyword">for</span> m <span class="keyword">in</span> range(k+<span class="number">1</span>):</span><br><span class="line">            res.append(dp[n<span class="number">-1</span>][m][<span class="number">0</span>])</span><br><span class="line">        <span class="keyword">return</span> max(res)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å¤„ç†kè¿‡å¤§å¯¼è‡´è¶…æ—¶çš„é—®é¢˜ï¼Œç”¨è´ªå¿ƒè§£å†³</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">greedy</span><span class="params">(self, prices)</span>:</span></span><br><span class="line">        res = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, len(prices)):</span><br><span class="line">            <span class="keyword">if</span> prices[i] &gt; prices[i<span class="number">-1</span>]:</span><br><span class="line">                res += prices[i] - prices[i<span class="number">-1</span>]</span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure><blockquote><p>ä¸€ä¸ªæŠ€å·§ï¼šä¹‹å‰ä¸ºäº†é™ä½ç©ºé—´å¤æ‚åº¦ï¼Œéœ€è¦æ”¹åŠ¨å¾ˆå¤šä»£ç æ¥æŠŠDPæ•°ç»„é™ç»´ï¼ˆæ¯”å¦‚ä¸‹é¢é¢˜ç›®çš„æ–¹æ³•äºŒï¼‰ï¼Œå…¶å®å¯ä»¥åœ¨æ ‡å‡†çš„DPè§£æ³•åŸºç¡€ä¸Šï¼ŒæŠŠæ—¶é—´ï¼ˆå¤©æ•°ï¼‰çš„ç»´åº¦ç¨åŠ æ”¹åŠ¨ï¼Œç”¨æ»šåŠ¨æ•°ç»„ï¼Œä¸¤ä¸ªå…ƒç´ å³å¯ä»£æ›¿nä¸ªå…ƒç´ ï¼Œæœ‰æ•ˆé™ä½ç©ºé—´å¤æ‚åº¦ï¼Œæ¯”å¦‚è¿™é¢˜åŸæœ¬ä¸‰ç»´DPæ•°ç»„çš„ç©ºé—´å¤æ‚åº¦æ˜¯O(nÃ—kÃ—2)å³O(n*k),ç”¨ä¸Šæ»šåŠ¨æ•°ç»„åå°±é™ä¸ºO(kÃ—2)å³O(k),æ€§èƒ½æå‡æ¯”è¾ƒæ˜¾è‘—ã€‚</p></blockquote><blockquote><p>æ»šåŠ¨æ•°ç»„å³ç”¨ä¸¤ä¸ªå€¼ x, y, åœ¨è¿­ä»£ n çš„æ—¶å€™, èµ‹å€¼ä¸º i&amp;1, (i-1)&amp;1, åˆ©ç”¨ä½è¿ç®—æ•ˆæœç­‰åŒäº i%2, å³å¥‡å¶åˆ¤æ–­å–1æˆ–0, å¦‚æ­¤å®ç° x, y äº¤æ›¿0å’Œ1ã€‚éœ€è¦æ³¨æ„ä¸€ä¸‹è¿­ä»£çš„èµ·å§‹å€¼æ˜¯1è¿˜æ˜¯0ã€‚ä¸‹é¢ä»£ç æ˜¯å¯¹ä¸Šé¢ä»£ç ç¨åŠ æ”¹åŠ¨çš„å®ç°ã€‚</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">maxProfit</span><span class="params">(self, k: int, prices: List[int])</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> prices <span class="keyword">or</span> <span class="keyword">not</span> k:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        n = len(prices)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å½“kå¤§äºæ•°ç»„é•¿åº¦çš„ä¸€åŠæ—¶ï¼Œç­‰åŒäºä¸é™æ¬¡æ•°äº¤æ˜“å³122é¢˜ï¼Œç”¨è´ªå¿ƒç®—æ³•è§£å†³ï¼Œå¦åˆ™LeetCodeä¼šè¶…æ—¶ï¼Œä¹Ÿå¯ä»¥ç›´æ¥æŠŠè¶…å¤§çš„kæ›¿æ¢ä¸ºæ•°ç»„çš„ä¸€åŠï¼Œå°±ä¸ç”¨å†™é¢å¤–çš„è´ªå¿ƒç®—æ³•å‡½æ•°</span></span><br><span class="line">        <span class="keyword">if</span> k &gt; n//<span class="number">2</span>:</span><br><span class="line">            <span class="keyword">return</span> self.greedy(prices)</span><br><span class="line">        </span><br><span class="line">        dp, res = [[[<span class="number">0</span>]*<span class="number">2</span> <span class="keyword">for</span> _ <span class="keyword">in</span> range(k+<span class="number">1</span>)] <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">2</span>)], []</span><br><span class="line">        <span class="comment"># dp[i][k][0]è¡¨ç¤ºç¬¬iå¤©å·²äº¤æ˜“kæ¬¡æ—¶ä¸æŒæœ‰è‚¡ç¥¨ dp[i][k][1]è¡¨ç¤ºç¬¬iå¤©å·²äº¤æ˜“kæ¬¡æ—¶æŒæœ‰è‚¡ç¥¨</span></span><br><span class="line">        <span class="comment"># è®¾å®šåœ¨å–å‡ºæ—¶åŠ 1æ¬¡äº¤æ˜“æ¬¡æ•°</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(k+<span class="number">1</span>):</span><br><span class="line">            dp[<span class="number">0</span>][i][<span class="number">0</span>], dp[<span class="number">0</span>][i][<span class="number">1</span>] = <span class="number">0</span>, - prices[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, n):</span><br><span class="line">            x, y = i&amp;<span class="number">1</span>, (i<span class="number">-1</span>)&amp;<span class="number">1</span></span><br><span class="line">            <span class="comment"># å¯¹ i ä¸ i-1 å–å¥‡å¶, ä»¤ x,y äº¤æ›¿ 0å’Œ1, å®ç°æ»šåŠ¨æ•°ç»„</span></span><br><span class="line">            <span class="comment"># å¯ä»¥å‡å°‘ä¸€ç»´DPæ•°ç»„, é™ä½ç©ºé—´å¤æ‚åº¦</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(k+<span class="number">1</span>):</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> j:</span><br><span class="line">                    dp[x][j][<span class="number">0</span>] = dp[y][j][<span class="number">0</span>]</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    dp[x][j][<span class="number">0</span>] = max(dp[y][j][<span class="number">0</span>], dp[y][j<span class="number">-1</span>][<span class="number">1</span>] + prices[i])</span><br><span class="line">                dp[x][j][<span class="number">1</span>] = max(dp[y][j][<span class="number">1</span>], dp[y][j][<span class="number">0</span>] - prices[i])</span><br><span class="line">        <span class="comment"># ã€Œæ‰€æœ‰äº¤æ˜“æ¬¡æ•°æœ€åä¸€å¤©ä¸æŒæœ‰è‚¡ç¥¨ã€çš„é›†åˆçš„æœ€å¤§å€¼å³ä¸ºé—®é¢˜çš„è§£</span></span><br><span class="line">        <span class="keyword">for</span> m <span class="keyword">in</span> range(k+<span class="number">1</span>):</span><br><span class="line">            res.append(dp[<span class="number">0</span>][m][<span class="number">0</span>])</span><br><span class="line">            res.append(dp[<span class="number">1</span>][m][<span class="number">0</span>])</span><br><span class="line">            <span class="comment"># è¿™é‡Œå› ä¸ºå‰é¢ç”¨äº†æ»šåŠ¨æ•°ç»„</span></span><br><span class="line">            <span class="comment"># ä¸çŸ¥é“æœ€åä¸€å¤©çš„å€¼åœ¨å“ªé‡Œ</span></span><br><span class="line">            <span class="comment"># æ‰€ä»¥éƒ½åŠ è¿›å»ç„¶åå–æœ€å¤§å€¼</span></span><br><span class="line">        <span class="keyword">return</span> max(res)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å¤„ç†kè¿‡å¤§å¯¼è‡´è¶…æ—¶çš„é—®é¢˜ï¼Œç”¨è´ªå¿ƒè§£å†³</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">greedy</span><span class="params">(self, prices)</span>:</span></span><br><span class="line">        res = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, len(prices)):</span><br><span class="line">            <span class="keyword">if</span> prices[i] &gt; prices[i<span class="number">-1</span>]:</span><br><span class="line">                res += prices[i] - prices[i<span class="number">-1</span>]</span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure><h2 id="309-æœ€ä½³ä¹°å–è‚¡ç¥¨æ—¶æœºå«å†·å†»æœŸ-Best-Time-to-Buy-and-Sell-Stock-with-Cooldown"><a href="#309-æœ€ä½³ä¹°å–è‚¡ç¥¨æ—¶æœºå«å†·å†»æœŸ-Best-Time-to-Buy-and-Sell-Stock-with-Cooldown" class="headerlink" title="309. æœ€ä½³ä¹°å–è‚¡ç¥¨æ—¶æœºå«å†·å†»æœŸ Best Time to Buy and Sell Stock with Cooldown"></a>309. æœ€ä½³ä¹°å–è‚¡ç¥¨æ—¶æœºå«å†·å†»æœŸ Best Time to Buy and Sell Stock with Cooldown</h2><p><a href="https://leetcode-cn.com/problems/best-time-to-buy-and-sell-stock-with-cooldown/" target="_blank" rel="noopener">LeetCodeCN ç¬¬309é¢˜é“¾æ¥</a></p><p>ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ï¼Œå…¶ä¸­ç¬¬ i ä¸ªå…ƒç´ ä»£è¡¨äº†ç¬¬ i å¤©çš„è‚¡ç¥¨ä»·æ ¼ ã€‚â€‹</p><p>è®¾è®¡ä¸€ä¸ªç®—æ³•è®¡ç®—å‡ºæœ€å¤§åˆ©æ¶¦ã€‚åœ¨æ»¡è¶³ä»¥ä¸‹çº¦æŸæ¡ä»¶ä¸‹ï¼Œä½ å¯ä»¥å°½å¯èƒ½åœ°å®Œæˆæ›´å¤šçš„äº¤æ˜“ï¼ˆå¤šæ¬¡ä¹°å–ä¸€æ”¯è‚¡ç¥¨ï¼‰:</p><p>ä½ ä¸èƒ½åŒæ—¶å‚ä¸å¤šç¬”äº¤æ˜“ï¼ˆä½ å¿…é¡»åœ¨å†æ¬¡è´­ä¹°å‰å‡ºå”®æ‰ä¹‹å‰çš„è‚¡ç¥¨ï¼‰ã€‚<br>å–å‡ºè‚¡ç¥¨åï¼Œä½ æ— æ³•åœ¨ç¬¬äºŒå¤©ä¹°å…¥è‚¡ç¥¨ (å³å†·å†»æœŸä¸º 1 å¤©)ã€‚</p><h4 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹:"></a>ç¤ºä¾‹:</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: [1,2,3,0,2]</span><br><span class="line">è¾“å‡º: 3 </span><br><span class="line">è§£é‡Š: å¯¹åº”çš„äº¤æ˜“çŠ¶æ€ä¸º: [ä¹°å…¥, å–å‡º, å†·å†»æœŸ, ä¹°å…¥, å–å‡º]</span><br></pre></td></tr></table></figure><h3 id="è§£ï¼š-3"><a href="#è§£ï¼š-3" class="headerlink" title="è§£ï¼š"></a>è§£ï¼š</h3><p>ç¬¬ä¸€ç§æ–¹æ³•ï¼šæ ‡å‡†DPåŠ¨æ€è§„åˆ’ï¼Œä¸‰ä¸ªç»´åº¦ï¼Œç¬¬ä¸€ç»´è¡¨ç¤ºå¤©ï¼Œç¬¬äºŒç»´è¡¨ç¤ºæ˜¯å¦å¤„äºå†·å†»æœŸï¼Œç¬¬ä¸‰ç»´è¡¨ç¤ºæ˜¯å¦æŒæœ‰è‚¡ç¥¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">maxProfit</span><span class="params">(self, prices: List[int])</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> prices:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        n = len(prices)</span><br><span class="line">        dp = [[[<span class="number">0</span>]*<span class="number">2</span> <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">2</span>)] <span class="keyword">for</span> _ <span class="keyword">in</span> range(n)]</span><br><span class="line">        <span class="comment"># dp[i][0][0]ç¬¬ä¸€ç»´è¡¨ç¤ºç¬¬iå¤©, ç¬¬äºŒç»´ç”¨0,1è¡¨ç¤ºæ˜¯å¦å¤„äºå†·å†»æœŸ, ç¬¬ä¸‰ç»´ç”¨0,1è¡¨ç¤ºæ˜¯å¦æŒæœ‰è‚¡ç¥¨</span></span><br><span class="line">        dp[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>], dp[<span class="number">0</span>][<span class="number">0</span>][<span class="number">1</span>], dp[<span class="number">0</span>][<span class="number">1</span>][<span class="number">0</span>] = <span class="number">0</span>, -prices[<span class="number">0</span>], <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, n):</span><br><span class="line">            dp[i][<span class="number">0</span>][<span class="number">0</span>] = max(dp[i<span class="number">-1</span>][<span class="number">1</span>][<span class="number">0</span>], dp[i<span class="number">-1</span>][<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line">            dp[i][<span class="number">1</span>][<span class="number">0</span>] = dp[i<span class="number">-1</span>][<span class="number">0</span>][<span class="number">1</span>] + prices[i]</span><br><span class="line">            dp[i][<span class="number">0</span>][<span class="number">1</span>] = max(dp[i<span class="number">-1</span>][<span class="number">0</span>][<span class="number">1</span>], dp[i<span class="number">-1</span>][<span class="number">0</span>][<span class="number">0</span>] - prices[i])</span><br><span class="line">        <span class="keyword">return</span> max(dp[n<span class="number">-1</span>][<span class="number">0</span>][<span class="number">0</span>], dp[n<span class="number">-1</span>][<span class="number">1</span>][<span class="number">0</span>])</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ–¹æ³•ï¼šä¼˜åŒ–ç‰ˆçš„åŠ¨æ€è§„åˆ’ï¼Œç”¨ä¸¤ä¸ªç»´åº¦å¤„ç†ï¼Œç¬¬ä¸€ç»´è¡¨ç¤ºå¤©ï¼Œç¬¬äºŒç»´ç”¨0è¡¨ç¤ºæœªæŒæœ‰ï¼Œ1è¡¨ç¤ºæŒæœ‰è‚¡ç¥¨ä¸­ï¼Œ2è¡¨ç¤ºå¤„äºå†·å†»æœŸ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">maxProfit</span><span class="params">(self, prices: List[int])</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> prices:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        n = len(prices)</span><br><span class="line">        dp = [[<span class="number">0</span>]*<span class="number">3</span> <span class="keyword">for</span> _ <span class="keyword">in</span> range(n)]</span><br><span class="line">        <span class="comment"># dp[i][0]è¡¨ç¤ºç¬¬iå¤©æœªæŒæœ‰, dp[i][1]è¡¨ç¤ºæŒæœ‰è‚¡ç¥¨, dp[i][2]è¡¨ç¤ºå‰ä¸€å¤©åˆšå–å‡ºä»Šå¤©å¤„äºå†·å†»æœŸ</span></span><br><span class="line">        dp[<span class="number">0</span>][<span class="number">0</span>], dp[<span class="number">0</span>][<span class="number">1</span>], dp[<span class="number">0</span>][<span class="number">2</span>] = <span class="number">0</span>, -prices[<span class="number">0</span>], <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, n):</span><br><span class="line">            dp[i][<span class="number">0</span>] = max(dp[i<span class="number">-1</span>][<span class="number">0</span>], dp[i<span class="number">-1</span>][<span class="number">2</span>])</span><br><span class="line">            dp[i][<span class="number">1</span>] = max(dp[i<span class="number">-1</span>][<span class="number">1</span>], dp[i<span class="number">-1</span>][<span class="number">0</span>] - prices[i])</span><br><span class="line">            dp[i][<span class="number">2</span>] = dp[i<span class="number">-1</span>][<span class="number">1</span>] + prices[i]</span><br><span class="line">        <span class="keyword">return</span> max(dp[n<span class="number">-1</span>][<span class="number">0</span>], dp[n<span class="number">-1</span>][<span class="number">2</span>])</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Algorithm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LeetCode </tag>
            
            <tag> Algorithm </tag>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LeetCodeåšé¢˜ç¬”è®°â€”ä½è¿ç®—ç›¸å…³é¢˜ç›®</title>
      <link href="/2019-05-13-leetcode-bitwise/"/>
      <url>/2019-05-13-leetcode-bitwise/</url>
      
        <content type="html"><![CDATA[<p>æœ‰å…³ä½è¿ç®—çš„åšé¢˜ç¬”è®°ï¼ŒPythonå®ç°</p><a id="more"></a><h2 id="191-ä½1çš„ä¸ªæ•°-Number-of-1-Bits"><a href="#191-ä½1çš„ä¸ªæ•°-Number-of-1-Bits" class="headerlink" title="191. ä½1çš„ä¸ªæ•° Number of 1 Bits"></a>191. ä½1çš„ä¸ªæ•° Number of 1 Bits</h2><p><a href="https://leetcode-cn.com/problems/number-of-1-bits/" target="_blank" rel="noopener">LeetCodeCN ç¬¬191é¢˜é“¾æ¥</a></p><p>ç¬¬ä¸€ç§æ–¹æ³•ï¼šéå†æ‰€æœ‰äºŒè¿›åˆ¶ä½ï¼Œé€šè¿‡å–æ¨¡<code>n%2</code>æˆ–è€…ä¸è¿ç®—<code>n&amp;1</code>åˆ¤æ–­å°¾æ•°æ˜¯å¦ä¸º1ï¼Œç„¶åæŠŠnå³ç§»ä¸€ä½</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">hammingWeight</span><span class="params">(self, n)</span>:</span></span><br><span class="line">        count = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> n:</span><br><span class="line">            count += n &amp; <span class="number">1</span></span><br><span class="line">            n &gt;&gt;= <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> count</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ–¹æ³•ï¼šé€šè¿‡<code>n &amp; (n - 1)</code>ç›´æ¥æ‘˜æ‰æœ€åä¸€ä½çš„1</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">hammingWeight</span><span class="params">(self, n)</span>:</span></span><br><span class="line">        count = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> n:</span><br><span class="line">            count += <span class="number">1</span></span><br><span class="line">            n = n &amp; (n - <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> count</span><br></pre></td></tr></table></figure><h2 id="231-2çš„å¹‚-Power-of-Two"><a href="#231-2çš„å¹‚-Power-of-Two" class="headerlink" title="231. 2çš„å¹‚ Power of Two"></a>231. 2çš„å¹‚ Power of Two</h2><p><a href="https://leetcode-cn.com/problems/power-of-two/" target="_blank" rel="noopener">LeetCodeCN ç¬¬231é¢˜é“¾æ¥</a></p><p>å…ˆæ’é™¤è´Ÿæ•°å’Œ0ï¼Œç”±äº2çš„å¹‚çš„äºŒè¿›åˆ¶åªæœ‰ç¬¬ä¸€ä½æ˜¯1ï¼Œé€šè¿‡<code>n &amp; (n - 1)</code>ç›´æ¥æ‘˜æ‰æœ€åä¸€ä½çš„1ï¼Œå¦‚æœæ‘˜æ‰åä¸º0å³ç¬¦åˆæ¡ä»¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isPowerOfTwo</span><span class="params">(self, n)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> n &gt; <span class="number">0</span> <span class="keyword">and</span> <span class="keyword">not</span> n &amp; (n - <span class="number">1</span>)</span><br></pre></td></tr></table></figure><h2 id="338-æ¯”ç‰¹ä½è®¡æ•°-Counting-Bits"><a href="#338-æ¯”ç‰¹ä½è®¡æ•°-Counting-Bits" class="headerlink" title="338. æ¯”ç‰¹ä½è®¡æ•° Counting Bits"></a>338. æ¯”ç‰¹ä½è®¡æ•° Counting Bits</h2><p><a href="https://leetcode-cn.com/problems/counting-bits/" target="_blank" rel="noopener">LeetCodeCN ç¬¬338é¢˜é“¾æ¥</a></p><p>ç¬¬ä¸€ç§æ–¹æ³•ï¼šéå†ï¼Œæ¯æ¬¡åˆ†åˆ«è®¡ç®—ä¸€æ¬¡æ¯”ç‰¹ä½ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºnä¹˜ä»¥æ¯ä¸ªæ•°çš„1ä½ä¸ªæ•°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">countBits</span><span class="params">(self, num)</span>:</span></span><br><span class="line">        result = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(num+<span class="number">1</span>):</span><br><span class="line">            count = <span class="number">0</span></span><br><span class="line">            <span class="keyword">while</span> i:</span><br><span class="line">                count += <span class="number">1</span></span><br><span class="line">                i = i &amp; (i - <span class="number">1</span>)</span><br><span class="line">            result.append(count)</span><br><span class="line">        <span class="keyword">return</span> result</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ–¹æ³•ï¼šç”¨ä¸€ä¸ªé€’æ¨å¼å­<code>count[i] = count[i&amp;(i-1)] + 1</code>ï¼ŒåŸç†æ˜¯<code>i&amp;(i-1)</code>çš„1çš„ä¸ªæ•°æ€»æ˜¯æ¯”<code>i</code>å°‘1ï¼ŒåŒæ—¶<code>i&amp;(i-1)</code>è¿™ä¸ªæ•°è‚¯å®šæ¯”<code>i</code>å°ï¼Œæ‰€ä»¥é¢„å…ˆæ˜¯ç®—è¿‡çš„ï¼Œè¿™æ ·æ—¶é—´å¤æ‚åº¦ä¸º<code>O(n)</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">countBits</span><span class="params">(self, num)</span>:</span></span><br><span class="line">        result = [<span class="number">0</span>] * (num+<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, num+<span class="number">1</span>):</span><br><span class="line">            result[i] = result[i&amp;(i<span class="number">-1</span>)] + <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> result</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Algorithm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LeetCode </tag>
            
            <tag> Algorithm </tag>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LeetCodeåšé¢˜ç¬”è®°â€”å¹¿åº¦ä¼˜å…ˆæœç´¢ã€æ·±åº¦ä¼˜å…ˆæœç´¢ã€å›æº¯ã€å‰ªæç›¸å…³é¢˜ç›®</title>
      <link href="/2019-05-09-leetcode-bfs-dfs-pruning/"/>
      <url>/2019-05-09-leetcode-bfs-dfs-pruning/</url>
      
        <content type="html"><![CDATA[<p>æœ‰å…³BFSï¼ˆå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼‰ä¸DFSï¼ˆæ·±åº¦ä¼˜å…ˆæœç´¢ï¼‰ã€å›æº¯ã€å‰ªæçš„åšé¢˜ç¬”è®°ï¼ŒPythonå®ç°</p><a id="more"></a><h2 id="102-äºŒå‰æ ‘çš„å±‚æ¬¡éå†-Binary-Tree-Level-Order-Traversal"><a href="#102-äºŒå‰æ ‘çš„å±‚æ¬¡éå†-Binary-Tree-Level-Order-Traversal" class="headerlink" title="102. äºŒå‰æ ‘çš„å±‚æ¬¡éå† Binary Tree Level Order Traversal"></a>102. äºŒå‰æ ‘çš„å±‚æ¬¡éå† Binary Tree Level Order Traversal</h2><p><a href="https://leetcode-cn.com/problems/binary-tree-level-order-traversal/" target="_blank" rel="noopener">LeetCodeCN ç¬¬102é¢˜é“¾æ¥</a></p><p>ç¬¬ä¸€ç§æ–¹æ³•ï¼šBFSå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼Œä½¿ç”¨åŒç«¯é˜Ÿåˆ—dequeï¼ˆå› ä¸ºæ€§èƒ½æ¯”å¦å¤–ä¸¤ç§Queueå¥½å¾—å¤šï¼‰ï¼Œåœ¨å¤§å¾ªç¯å†…å¯¹äºŒå‰æ ‘çš„æ¯ä¸ªå±‚åšä¸€æ¬¡éå†ï¼Œæ³¨æ„<code>range(len(queue))</code>ä½¿åªéå†å½“å‰çš„å±‚ã€‚ç”±äºæ¯ä¸ªèŠ‚ç‚¹ä»…è®¿é—®ä¸€æ¬¡ï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦<code>O(n)</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for a binary tree node.</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TreeNode</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, x)</span>:</span></span><br><span class="line">        self.val = x</span><br><span class="line">        self.left = <span class="literal">None</span></span><br><span class="line">        self.right = <span class="literal">None</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> collections</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">levelOrder</span><span class="params">(self, root: TreeNode)</span> -&gt; List[List[int]]:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line">        result = []</span><br><span class="line">        queue = collections.deque()</span><br><span class="line">        queue.append(root)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å¦‚æœä¸æ˜¯æ ‘è€Œæ˜¯å›¾çš„è¯è¦è®°å½•ä¸€ä¸‹è®¿é—®è¿‡çš„èŠ‚ç‚¹ï¼Œé¿å…é‡å¤è®¿é—®</span></span><br><span class="line">        <span class="comment"># visited = set(root)</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span> queue:</span><br><span class="line">            level_size = len(queue)</span><br><span class="line">            current_level = []</span><br><span class="line">            <span class="keyword">for</span> _ <span class="keyword">in</span> range(level_size):</span><br><span class="line">                node = queue.popleft()</span><br><span class="line">                current_level.append(node.val)</span><br><span class="line">                <span class="keyword">if</span> node.left:</span><br><span class="line">                    queue.append(node.left)</span><br><span class="line">                <span class="keyword">if</span> node.right:</span><br><span class="line">                    queue.append(node.right)</span><br><span class="line">            result.append(current_level)</span><br><span class="line">        <span class="keyword">return</span> result</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ–¹æ³•ï¼šDFSæ·±åº¦ä¼˜å…ˆæœç´¢ï¼Œåˆ©ç”¨é€’å½’çš„æ ˆï¼Œå€ŸåŠ©<code>level</code>è®°å·æŠŠèŠ‚ç‚¹æ”¾å…¥å¯¹åº”å±‚ï¼Œç”±äºæ¯ä¸ªèŠ‚ç‚¹ä»…è®¿é—®ä¸€æ¬¡ï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦<code>O(n)</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">levelOrder</span><span class="params">(self, root: TreeNode)</span> -&gt; List[List[int]]:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line">        self.result = []</span><br><span class="line">        self._dfs(root, <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> self.result</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_dfs</span><span class="params">(self, node, level)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> node:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">if</span> len(self.result) &lt; level + <span class="number">1</span>:</span><br><span class="line">            self.result.append([])</span><br><span class="line">        self.result[level].append(node.val)</span><br><span class="line">        self._dfs(node.left, level + <span class="number">1</span>)</span><br><span class="line">        self._dfs(node.right, level + <span class="number">1</span>)</span><br></pre></td></tr></table></figure><h2 id="104-äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦-Maximum-Depth-of-Binary-Tree"><a href="#104-äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦-Maximum-Depth-of-Binary-Tree" class="headerlink" title="104. äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦ Maximum Depth of Binary Tree"></a>104. äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦ Maximum Depth of Binary Tree</h2><p><a href="https://leetcode-cn.com/problems/maximum-depth-of-binary-tree/" target="_blank" rel="noopener">LeetCodeCN ç¬¬104é¢˜é“¾æ¥</a></p><p>ç¬¬ä¸€ç§æ–¹æ³•ï¼šBFSå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼Œä½¿ç”¨åŒç«¯é˜Ÿåˆ—dequeï¼ˆå› ä¸ºæ€§èƒ½æ¯”å¦å¤–ä¸¤ç§Queueå¥½å¾—å¤šï¼‰ï¼Œåœ¨å¤§å¾ªç¯å†…å¯¹äºŒå‰æ ‘çš„æ¯ä¸ªå±‚åšä¸€æ¬¡éå†ï¼Œ<code>range(len(queue))</code>ä½¿åªéå†å½“å‰çš„å±‚ï¼Œæ¯æ¬¡å¤§å¾ªç¯<code>ans</code>åŠ 1ã€‚ç”±äºæ¯ä¸ªèŠ‚ç‚¹ä»…è®¿é—®ä¸€æ¬¡ï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦<code>O(n)</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for a binary tree node.</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TreeNode</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, x)</span>:</span></span><br><span class="line">        self.val = x</span><br><span class="line">        self.left = <span class="literal">None</span></span><br><span class="line">        self.right = <span class="literal">None</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> collections</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">maxDepth</span><span class="params">(self, root: TreeNode)</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        queue = collections.deque()</span><br><span class="line">        queue.append(root)</span><br><span class="line">        ans = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> queue:</span><br><span class="line">            ans += <span class="number">1</span></span><br><span class="line">            <span class="keyword">for</span> _ <span class="keyword">in</span> range(len(queue)):</span><br><span class="line">                node = queue.popleft()</span><br><span class="line">                <span class="keyword">if</span> node.left:</span><br><span class="line">                    queue.append(node.left)</span><br><span class="line">                <span class="keyword">if</span> node.right:</span><br><span class="line">                    queue.append(node.right)</span><br><span class="line">        <span class="keyword">return</span> ans</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ–¹æ³•ï¼šDFSæ·±åº¦ä¼˜å…ˆæœç´¢ï¼Œåˆ©ç”¨é€’å½’çš„æ ˆï¼Œå€ŸåŠ©<code>level</code>æ ‡è®°å½“å‰å±‚ï¼Œç”±äºæ¯ä¸ªèŠ‚ç‚¹ä»…è®¿é—®ä¸€æ¬¡ï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦<code>O(n)</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">maxDepth</span><span class="params">(self, root: TreeNode)</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        self.ans = <span class="number">0</span></span><br><span class="line">        self._dfs(root, <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> self.ans</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_dfs</span><span class="params">(self, node, level)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> node:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">if</span> self.ans &lt; level + <span class="number">1</span>:</span><br><span class="line">            self.ans = level + <span class="number">1</span></span><br><span class="line">        self._dfs(node.left, level + <span class="number">1</span>)</span><br><span class="line">        self._dfs(node.right, level + <span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰ç§æ–¹æ³•ï¼šDFS+åˆ†æ²»ï¼Œè™½ç„¶ä»£ç ç®€æ´ä½†è€—æ—¶æ¯”ä¸Šé¢ä¸¤ç§æ–¹æ³•éƒ½ä¹…</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">maxDepth</span><span class="params">(self, root: TreeNode)</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span> + max(self.maxDepth(root.left), self.maxDepth(root.right))</span><br></pre></td></tr></table></figure><h2 id="111-äºŒå‰æ ‘çš„æœ€å°æ·±åº¦-Minimum-Depth-of-Binary-Tree"><a href="#111-äºŒå‰æ ‘çš„æœ€å°æ·±åº¦-Minimum-Depth-of-Binary-Tree" class="headerlink" title="111. äºŒå‰æ ‘çš„æœ€å°æ·±åº¦ Minimum Depth of Binary Tree"></a>111. äºŒå‰æ ‘çš„æœ€å°æ·±åº¦ Minimum Depth of Binary Tree</h2><p><a href="https://leetcode-cn.com/problems/minimum-depth-of-binary-tree/" target="_blank" rel="noopener">LeetCodeCN ç¬¬111é¢˜é“¾æ¥</a></p><p>ç¬¬ä¸€ç§æ–¹æ³•ï¼šBFSå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼Œä½¿ç”¨åŒç«¯é˜Ÿåˆ—dequeï¼ˆå› ä¸ºæ€§èƒ½æ¯”å¦å¤–ä¸¤ç§Queueå¥½å¾—å¤šï¼‰ï¼Œåœ¨å¤§å¾ªç¯å†…å¯¹äºŒå‰æ ‘çš„æ¯ä¸ªå±‚åšä¸€æ¬¡éå†ï¼Œ<code>range(len(queue))</code>ä½¿åªéå†å½“å‰çš„å±‚ã€‚ç”±äºæ¯ä¸ªèŠ‚ç‚¹ä»…è®¿é—®ä¸€æ¬¡ï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦<code>O(n)</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for a binary tree node.</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TreeNode</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, x)</span>:</span></span><br><span class="line">        self.val = x</span><br><span class="line">        self.left = <span class="literal">None</span></span><br><span class="line">        self.right = <span class="literal">None</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> collections</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">minDepth</span><span class="params">(self, root: TreeNode)</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        ans = <span class="number">0</span></span><br><span class="line">        queue = collections.deque()</span><br><span class="line">        queue.append(root)</span><br><span class="line">        <span class="keyword">while</span> queue:</span><br><span class="line">            ans += <span class="number">1</span></span><br><span class="line">            <span class="keyword">for</span> _ <span class="keyword">in</span> range(len(queue)):</span><br><span class="line">                node = queue.popleft()</span><br><span class="line">                <span class="keyword">if</span> node.left <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">and</span> node.right <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">                    <span class="keyword">return</span> ans</span><br><span class="line">                <span class="keyword">if</span> node.left:</span><br><span class="line">                    queue.append(node.left)</span><br><span class="line">                <span class="keyword">if</span> node.right:</span><br><span class="line">                    queue.append(node.right)</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ–¹æ³•ï¼šDFSæ·±åº¦ä¼˜å…ˆæœç´¢ï¼Œåˆ©ç”¨é€’å½’çš„æ ˆï¼Œå€ŸåŠ©<code>level</code>æ ‡è®°å½“å‰å±‚ï¼Œç”±äºæ¯ä¸ªèŠ‚ç‚¹ä»…è®¿é—®ä¸€æ¬¡ï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦<code>O(n)</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">minDepth</span><span class="params">(self, root: TreeNode)</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        self.ans = float(<span class="string">'inf'</span>)</span><br><span class="line">        self._dfs(root, <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> self.ans</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_dfs</span><span class="params">(self, node, level)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> node:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">if</span> node.left <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">and</span> node.right <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">if</span> self.ans &gt; level + <span class="number">1</span>:</span><br><span class="line">                self.ans = level + <span class="number">1</span></span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        self._dfs(node.left, level + <span class="number">1</span>)</span><br><span class="line">        self._dfs(node.right, level + <span class="number">1</span>)</span><br></pre></td></tr></table></figure><h2 id="22-æ‹¬å·ç”Ÿæˆ-Generate-Parentheses"><a href="#22-æ‹¬å·ç”Ÿæˆ-Generate-Parentheses" class="headerlink" title="22. æ‹¬å·ç”Ÿæˆ Generate Parentheses"></a>22. æ‹¬å·ç”Ÿæˆ Generate Parentheses</h2><p><a href="https://leetcode-cn.com/problems/generate-parentheses/" target="_blank" rel="noopener">LeetCodeCN ç¬¬22é¢˜é“¾æ¥</a></p><p>DFS+å‰ªæï¼Œåˆ©ç”¨å·¦æ‹¬å·ä¸å³æ‹¬å·åˆ†åˆ«å·²ç”¨çš„å‚æ•°ï¼Œå½“ä¸¤ä¸ªå‚æ•°éƒ½ä¸º<code>n</code>æ—¶å³å¡«å®Œä¸€ä¸ªç»“æœæ·»åŠ è¿›ç»“æœæ•°ç»„ï¼Œç²¾é«“åœ¨äº<code>if left_used &gt; right_used</code>ï¼Œåªæœ‰åœ¨å³æ‹¬å·å°‘äºå·¦æ‹¬å·æ—¶æ‰èƒ½å¡«å……å³æ‹¬å·ï¼Œä¿è¯è¾“å‡ºçš„ç»“æœæ˜¯åˆæ³•çš„</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">generateParenthesis</span><span class="params">(self, n: int)</span> -&gt; List[str]:</span></span><br><span class="line">        self.ans = []</span><br><span class="line">        self.helper(<span class="number">0</span>, <span class="number">0</span>, n, <span class="string">''</span>)</span><br><span class="line">        <span class="keyword">return</span> self.ans</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, left_used: int, right_used: int, n: int, result: str)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> left_used == n <span class="keyword">and</span> right_used == n:</span><br><span class="line">            self.ans.append(result)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">if</span> left_used &lt; n:</span><br><span class="line">            self.helper(left_used + <span class="number">1</span>, right_used, n, result + <span class="string">'('</span>)</span><br><span class="line">        <span class="keyword">if</span> left_used &gt; right_used <span class="keyword">and</span> right_used &lt; n:</span><br><span class="line">            self.helper(left_used, right_used + <span class="number">1</span>, n, result + <span class="string">')'</span>)</span><br></pre></td></tr></table></figure><h2 id="51-Nçš‡å-N-Queens-52-Nçš‡å-II-N-Queens-II"><a href="#51-Nçš‡å-N-Queens-52-Nçš‡å-II-N-Queens-II" class="headerlink" title="51. Nçš‡å N-Queens / 52. Nçš‡å II N-Queens II"></a>51. Nçš‡å N-Queens / 52. Nçš‡å II N-Queens II</h2><p><a href="https://leetcode-cn.com/problems/n-queens/" target="_blank" rel="noopener">LeetCodeCN ç¬¬51é¢˜é“¾æ¥</a><br><a href="https://leetcode-cn.com/problems/n-queens-ii/" target="_blank" rel="noopener">LeetCodeCN ç¬¬52é¢˜é“¾æ¥</a></p><p>ç”¨ä¸‰ä¸ª<code>set()</code>è®°å½•çŸ©é˜µå†…å› æ”¾å…¥çš‡åè€Œå°ä½çš„æ ¼å­ï¼Œ<code>self.col</code>æ˜¯åˆ—ï¼Œ<code>self.sum</code>æ˜¯<code>row+col</code>è¡¨ç¤ºçš„ â€˜/â€˜ æ–¹å‘ <code>self.dif</code>æ˜¯<code>row-col</code>è¡¨ç¤ºçš„ â€˜\â€˜ æ–¹å‘ã€‚</p><p>ç”¨æ·±åº¦ä¼˜å…ˆæœç´¢æ–¹æ³•ï¼Œé€è¡Œé€’å½’ä¸‹å»ï¼Œé€’å½’ç»ˆæ­¢æ¡ä»¶æ˜¯è¡Œæ•°åŠ åˆ°<code>n</code>æ—¶ï¼Œæ­¤æ—¶å³ç”Ÿæˆäº†ä¸€ç§è§£å†³æ–¹æ¡ˆï¼Œæ”¾å…¥ç»“æœæ•°ç»„ã€‚</p><p>æ¯æ¬¡é€’å½’å†…è¿­ä»£åˆ—<code>col</code>æ£€æŸ¥è¿™ä¸ªç‚¹ä½æ˜¯å¦èƒ½æ”¾ä¸‹ï¼Œèƒ½æ”¾ä¸‹çš„è¯æŠŠè‡ªèº«ç‚¹ä½åŠ å…¥ä¸‰ä¸ª<code>set</code>å†…ï¼Œç»§ç»­ä¸‹ä¸ªé€’å½’ï¼Œå‚æ•°<code>state</code>æ•°ç»„<code>append</code>è¿™ä¸€è¡Œçš„åˆ—å€¼ <code>col</code>ã€‚</p><p>é€’å½’å‡½æ•°åè®°å¾—æ¸…é™¤å› æ”¾å…¥è‡ªå·±çš„å½±å“å³ä¸‰ä¸ª<code>set</code>ã€‚</p><p>æœ€åä¸º51é¢˜ç”Ÿæˆç»“æœå›¾çš„å‡½æ•°<code>_gen</code>ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">solveNQueens</span><span class="params">(self, n: int)</span> -&gt; List[List[str]]:</span></span><br><span class="line">        self.result = []</span><br><span class="line">        self.col = set()</span><br><span class="line">        self.sum = set()</span><br><span class="line">        self.dif = set()</span><br><span class="line">        self._dfs(n, <span class="number">0</span>, [])</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 51é¢˜: è¾“å‡ºç‚¹é˜µå›¾</span></span><br><span class="line">        <span class="keyword">return</span> self._gen(n)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 52é¢˜: è¾“å‡ºç»“æœæ•°é‡</span></span><br><span class="line">        <span class="comment"># return len(self.result)</span></span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_dfs</span><span class="params">(self, n, row, state)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> row &gt;= n:</span><br><span class="line">            self.result.append(state)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">for</span> col <span class="keyword">in</span> range(n):</span><br><span class="line">            <span class="keyword">if</span> col <span class="keyword">in</span> self.col <span class="keyword">or</span> row+col <span class="keyword">in</span> self.sum <span class="keyword">or</span> row-col <span class="keyword">in</span> self.dif:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            self.col.add(col)</span><br><span class="line">            self.sum.add(row + col)</span><br><span class="line">            self.dif.add(row - col)</span><br><span class="line">            </span><br><span class="line">            self._dfs(n, row + <span class="number">1</span>, state + [col])</span><br><span class="line">            </span><br><span class="line">            self.col.remove(col)</span><br><span class="line">            self.sum.remove(row + col)</span><br><span class="line">            self.dif.remove(row - col)</span><br><span class="line">            </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_gen</span><span class="params">(self, n)</span>:</span></span><br><span class="line">        result = []</span><br><span class="line">        <span class="keyword">for</span> res <span class="keyword">in</span> self.result:</span><br><span class="line">            graph = []</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> res:</span><br><span class="line">                graph.append(<span class="string">'.'</span>*i + <span class="string">'Q'</span> + <span class="string">'.'</span>*(n-i<span class="number">-1</span>))</span><br><span class="line">            result.append(graph)</span><br><span class="line">        <span class="keyword">return</span> result</span><br></pre></td></tr></table></figure><h2 id="37-è§£æ•°ç‹¬-Sudoku-Solver"><a href="#37-è§£æ•°ç‹¬-Sudoku-Solver" class="headerlink" title="37. è§£æ•°ç‹¬ Sudoku Solver"></a>37. è§£æ•°ç‹¬ Sudoku Solver</h2><p><a href="https://leetcode-cn.com/problems/sudoku-solver/" target="_blank" rel="noopener">LeetCodeCN ç¬¬37é¢˜é“¾æ¥</a></p><p>DFSæœ´ç´ è§£æ³•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">solveSudoku</span><span class="params">(self, board: List[List[str]])</span> -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        Do not return anything, modify board in-place instead.</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">if</span> board <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">or</span> <span class="keyword">not</span> len(board):</span><br><span class="line">            <span class="keyword">return</span> </span><br><span class="line">        self.solve(board)</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">solve</span><span class="params">(self, board: List[List[str]])</span> -&gt; bool:</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(board)):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(len(board[<span class="number">0</span>])):</span><br><span class="line">                <span class="keyword">if</span> board[i][j] == <span class="string">'.'</span>:</span><br><span class="line">                    <span class="keyword">for</span> c <span class="keyword">in</span> [<span class="string">"1"</span>,<span class="string">"2"</span>,<span class="string">"3"</span>,<span class="string">"4"</span>,<span class="string">"5"</span>,<span class="string">"6"</span>,<span class="string">"7"</span>,<span class="string">"8"</span>,<span class="string">"9"</span>]:</span><br><span class="line">                        <span class="keyword">if</span> self.isValid(board, i, j, c):</span><br><span class="line">                            board[i][j] = c</span><br><span class="line">                            <span class="keyword">if</span> self.solve(board):</span><br><span class="line">                                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">                            <span class="keyword">else</span>:</span><br><span class="line">                                board[i][j] = <span class="string">'.'</span></span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isValid</span><span class="params">(self, board, row, col, c)</span> -&gt; bool:</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">9</span>):</span><br><span class="line">            <span class="keyword">if</span> board[row][i] != <span class="string">'.'</span> <span class="keyword">and</span> board[row][i] == c:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            <span class="keyword">if</span> board[i][col] != <span class="string">'.'</span> <span class="keyword">and</span> board[i][col] == c:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            <span class="keyword">if</span> board[<span class="number">3</span> * (row//<span class="number">3</span>) + i//<span class="number">3</span>][<span class="number">3</span> * (col//<span class="number">3</span>) + i%<span class="number">3</span>] != <span class="string">'.'</span> <span class="keyword">and</span> board[<span class="number">3</span> * (row//<span class="number">3</span>) + i//<span class="number">3</span>][<span class="number">3</span> * (col//<span class="number">3</span>) + i%<span class="number">3</span>] == c:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br></pre></td></tr></table></figure><h2 id="36-æœ‰æ•ˆçš„æ•°ç‹¬-Valid-Sudoku"><a href="#36-æœ‰æ•ˆçš„æ•°ç‹¬-Valid-Sudoku" class="headerlink" title="36. æœ‰æ•ˆçš„æ•°ç‹¬ Valid Sudoku"></a>36. æœ‰æ•ˆçš„æ•°ç‹¬ Valid Sudoku</h2><p>ç¬¬ä¸€ç§æ–¹æ³•ï¼šåˆ©ç”¨<code>collections</code>çš„<code>defaultdict</code>æ•°æ®ç»“æ„è®°å½•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> collections <span class="keyword">as</span> cl</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isValidSudoku</span><span class="params">(self, board)</span> -&gt; bool:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> board <span class="keyword">or</span> <span class="keyword">not</span> len(board):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        self.row, self.col, self.box = cl.defaultdict(set), cl.defaultdict(set), cl.defaultdict(set)</span><br><span class="line">        <span class="keyword">for</span> r <span class="keyword">in</span> range(<span class="number">9</span>):</span><br><span class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> range(<span class="number">9</span>):</span><br><span class="line">                <span class="keyword">if</span> board[r][c] != <span class="string">'.'</span>:</span><br><span class="line">                    <span class="keyword">if</span> board[r][c] <span class="keyword">not</span> <span class="keyword">in</span> self.row[r] <span class="keyword">and</span> board[r][c] <span class="keyword">not</span> <span class="keyword">in</span> self.col[c] <span class="keyword">and</span> board[r][c] <span class="keyword">not</span> <span class="keyword">in</span> self.box[(r//<span class="number">3</span>, c//<span class="number">3</span>)]:</span><br><span class="line">                        self.row[r].add(board[r][c])</span><br><span class="line">                        self.col[c].add(board[r][c])</span><br><span class="line">                        self.box[(r//<span class="number">3</span>, c//<span class="number">3</span>)].add(board[r][c])</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ–¹æ³•ï¼šä¸ç”¨é¢å¤–ç©ºé—´ï¼Œç›´æ¥å¾ªç¯æ£€æµ‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isValidSudoku</span><span class="params">(self, board: List[List[str]])</span> -&gt; bool:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> board <span class="keyword">or</span> <span class="keyword">not</span> len(board):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">for</span> r <span class="keyword">in</span> range(<span class="number">9</span>):</span><br><span class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> range(<span class="number">9</span>):</span><br><span class="line">                <span class="keyword">if</span> board[r][c] != <span class="string">'.'</span>:</span><br><span class="line">                    <span class="keyword">if</span> self.isValid(board, r, c, board[r][c]):</span><br><span class="line">                        <span class="keyword">continue</span></span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">                    </span><br><span class="line">                    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isValid</span><span class="params">(self, board, row, col, c)</span> -&gt; bool:</span></span><br><span class="line">        board[row][col] = <span class="string">'.'</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">9</span>):</span><br><span class="line">            <span class="keyword">if</span> board[row][i] != <span class="string">'.'</span> <span class="keyword">and</span> board[row][i] == c:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            <span class="keyword">if</span> board[i][col] != <span class="string">'.'</span> <span class="keyword">and</span> board[i][col] == c:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            <span class="keyword">if</span> board[<span class="number">3</span> * (row//<span class="number">3</span>) + i//<span class="number">3</span>][<span class="number">3</span> * (col//<span class="number">3</span>) + i%<span class="number">3</span>] != <span class="string">'.'</span> <span class="keyword">and</span> board[<span class="number">3</span> * (row//<span class="number">3</span>) + i//<span class="number">3</span>][<span class="number">3</span> * (col//<span class="number">3</span>) + i%<span class="number">3</span>] == c:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        board[row][col] = c    </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br></pre></td></tr></table></figure><h2 id="69-x-çš„å¹³æ–¹æ ¹-Sqrt-x"><a href="#69-x-çš„å¹³æ–¹æ ¹-Sqrt-x" class="headerlink" title="69. x çš„å¹³æ–¹æ ¹  Sqrt(x)"></a>69. x çš„å¹³æ–¹æ ¹  Sqrt(x)</h2><p><a href="https://leetcode-cn.com/problems/sqrtx/" target="_blank" rel="noopener">LeetCodeCN ç¬¬69é¢˜é“¾æ¥</a></p><p>ç¬¬ä¸€ç§æ–¹æ³•ï¼šäºŒåˆ†æŸ¥æ‰¾ï¼Œé¢˜ç›®å¥‡æ€ªè¦æ±‚è¿”å›æ•´æ•°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">mySqrt</span><span class="params">(self, x: int)</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> x == <span class="number">1</span> <span class="keyword">or</span> x == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> x</span><br><span class="line">        l, r = <span class="number">1</span>, x</span><br><span class="line">        <span class="keyword">while</span> l &lt; r:</span><br><span class="line">            mid = l + (r - l)//<span class="number">2</span></span><br><span class="line">            <span class="keyword">if</span> mid*mid &lt;= x &lt; (mid+<span class="number">1</span>)*(mid+<span class="number">1</span>):</span><br><span class="line">                <span class="keyword">return</span> mid</span><br><span class="line">            <span class="keyword">elif</span> mid*mid &lt; x:</span><br><span class="line">                l = mid</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                r = mid</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ–¹æ³•ï¼šç‰›é¡¿è¿­ä»£æ³•ï¼Œ$X_{n+1} = x_n - \frac{f(x_n)}{fâ€™(x_n)}$ï¼Œè¿™é‡Œçš„$f(x_n)$æ˜¯$x^2 - y_0$ï¼Œå³å¾—è¿­ä»£å…¬å¼$x_{n+1} = (x_n + \frac{y_0}{x_n}) / 2 $</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">mySqrt</span><span class="params">(self, x: int)</span> -&gt; int:</span>        </span><br><span class="line">        <span class="keyword">if</span> x &lt;= <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> x</span><br><span class="line">        r = x</span><br><span class="line">        <span class="keyword">while</span> r &gt; x / r:</span><br><span class="line">            r = (r + x / r)//<span class="number">2</span></span><br><span class="line">        <span class="keyword">return</span> int(r)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Algorithm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LeetCode </tag>
            
            <tag> Algorithm </tag>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LeetCodeåšé¢˜ç¬”è®°â€”é€’å½’ã€åˆ†æ²»ç›¸å…³é¢˜ç›®</title>
      <link href="/2019-05-07-leetcode-recursion-divide-conquer/"/>
      <url>/2019-05-07-leetcode-recursion-divide-conquer/</url>
      
        <content type="html"><![CDATA[<p>æœ‰å…³é€’å½’ä¸åˆ†æ²»çš„åšé¢˜ç¬”è®°ï¼ŒPythonå®ç°</p><a id="more"></a><h2 id="50-Pow-x-n"><a href="#50-Pow-x-n" class="headerlink" title="50. Pow(x, n)"></a>50. Pow(x, n)</h2><p><a href="https://leetcode-cn.com/problems/powx-n/" target="_blank" rel="noopener">LeetCodeCN ç¬¬50é¢˜é“¾æ¥</a></p><p>ç¬¬ä¸€ç§æ–¹æ³•ï¼šæš´åŠ›ä¹˜æ³•ï¼Œæ—¶é—´å¤æ‚åº¦<code>O(n)</code>ï¼ŒLeetCodeä¼šè¶…æ—¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">myPow</span><span class="params">(self, x: float, n: int)</span> -&gt; float:</span></span><br><span class="line">        <span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> x</span><br><span class="line">        <span class="keyword">if</span> n == <span class="number">-1</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>/x</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> n:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> n &lt; <span class="number">0</span>:</span><br><span class="line">            res = <span class="number">1</span>/x</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(abs(n)<span class="number">-1</span>):</span><br><span class="line">                res = res*(<span class="number">1</span>/x)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            res = x</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(abs(n)<span class="number">-1</span>):</span><br><span class="line">                res = res*x</span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ–¹æ³•ï¼šåˆ†æ²»ï¼ˆé€’å½’ï¼‰ ï¼Œæ—¶é—´å¤æ‚åº¦<code>O(logn)</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">myPow</span><span class="params">(self, x: float, n: int)</span> -&gt; float:</span></span><br><span class="line">        <span class="keyword">if</span> n == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> n &lt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span> / self.myPow(x, -n)</span><br><span class="line">        <span class="keyword">if</span> n % <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">return</span> x * self.myPow(x, n - <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> self.myPow(x * x, n / <span class="number">2</span>)</span><br></pre></td></tr></table></figure><p>ç¨å¾®æ”¹æˆä¸‹é¢è¿™æ ·å®¹æ˜“ç†è§£ä¸€äº›</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">myPow</span><span class="params">(self, x: float, n: int)</span> -&gt; float:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> n:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> n &lt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>/self.myPow(x, -n)</span><br><span class="line">        <span class="keyword">if</span> n &amp; <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> self.myPow(x, n - <span class="number">1</span>) * x</span><br><span class="line">        res = self.myPow(x, n&gt;&gt;<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> res*res</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ–¹æ³•ï¼šå¾ªç¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">myPow</span><span class="params">(self, x: float, n: int)</span> -&gt; float:</span></span><br><span class="line">        <span class="keyword">if</span> n &lt; <span class="number">0</span>:</span><br><span class="line">            x = <span class="number">1</span> / x</span><br><span class="line">            n = -n</span><br><span class="line">        ans = <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> n:</span><br><span class="line">            <span class="comment"># n&amp;1 æ˜¯ä¸è¿ç®—ï¼Œç”¨æ¥æ±‚å¥‡å¶ï¼Œæ•ˆæœä¸ n%2 ä¸€æ ·</span></span><br><span class="line">            <span class="keyword">if</span> n &amp; <span class="number">1</span>:</span><br><span class="line">                ans *= x</span><br><span class="line">            x = x * x</span><br><span class="line">            <span class="comment"># n&gt;&gt;=1 æ˜¯ä½è¿ç®—ï¼Œå³ç§»ä¸€ä½ï¼Œæ•ˆæœä¸ n//=2 ä¸€æ ·</span></span><br><span class="line">            n &gt;&gt;= <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> ans</span><br></pre></td></tr></table></figure><h2 id="169-æ±‚ä¼—æ•°-Majority-Element"><a href="#169-æ±‚ä¼—æ•°-Majority-Element" class="headerlink" title="169. æ±‚ä¼—æ•° Majority Element"></a>169. æ±‚ä¼—æ•° Majority Element</h2><p><a href="https://leetcode-cn.com/problems/majority-element/" target="_blank" rel="noopener">LeetCodeCN ç¬¬169é¢˜é“¾æ¥</a></p><p>ç¬¬ä¸€ç§æ–¹æ³•ï¼šä¸¤é‡å¾ªç¯æš´åŠ›æ±‚è§£ï¼Œæ—¶é—´å¤æ‚åº¦<code>O(n^2)</code>ï¼ŒLeetCodeä¼šè¶…æ—¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">majorityElement</span><span class="params">(self, nums: List[int])</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(nums)):</span><br><span class="line">            count = <span class="number">1</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(i+<span class="number">1</span>, len(nums)):</span><br><span class="line">                <span class="keyword">if</span> nums[i] == nums[j]:</span><br><span class="line">                    count += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> count &gt; len(nums) / <span class="number">2</span>:</span><br><span class="line">                <span class="keyword">return</span> nums[i]</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ–¹æ³•ï¼šå“ˆå¸Œè¡¨è®°å½•æ¯ä¸ªå…ƒç´ å‡ºç°æ¬¡æ•°ï¼Œå‘ç°å‡ºç°è¶…è¿‡<code>n/2</code>çš„å°±æ˜¯ä¼—æ•°ï¼Œæ—¶é—´å¤æ‚åº¦<code>O(n)</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">majorityElement</span><span class="params">(self, nums: List[int])</span> -&gt; int:</span></span><br><span class="line">        leng = len(nums)</span><br><span class="line">        <span class="keyword">if</span> leng == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> nums[<span class="number">0</span>]</span><br><span class="line">        dic = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> nums:</span><br><span class="line">            <span class="keyword">if</span> i <span class="keyword">in</span> dic:</span><br><span class="line">                dic[i] += <span class="number">1</span></span><br><span class="line">                <span class="keyword">if</span> dic[i] &gt;= leng / <span class="number">2</span>:</span><br><span class="line">                    <span class="keyword">return</span> i</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dic[i] = <span class="number">1</span></span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰ç§æ–¹æ³•ï¼šæ’åºåç›´æ¥è¿”å›ä¸­é—´å€¼ï¼Œå› ä¸ºé¢˜ç›®é™å®šæ¡ä»¶å¿…ç„¶å­˜åœ¨ä¼—æ•°ï¼Œæ—¶é—´å¤æ‚åº¦<code>O(n*logn)</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">majorityElement</span><span class="params">(self, nums: List[int])</span> -&gt; int:</span></span><br><span class="line">    <span class="keyword">return</span> sorted(nums)[len(nums)//<span class="number">2</span>]</span><br></pre></td></tr></table></figure><p>ç¬¬å››ç§æ–¹æ³•ï¼šç”¨<code>list.count()</code>æ–¹æ³•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">majorityElement</span><span class="params">(self, nums: List[int])</span> -&gt; int:</span></span><br><span class="line">    <span class="comment"># æ­¤å¤„å¦‚æœéå†æ•´ä¸ªnumsä¼šè¶…æ—¶</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> nums[len(nums)//<span class="number">2</span>:]:</span><br><span class="line">        <span class="keyword">if</span> nums.count(i) &gt; len(nums)//<span class="number">2</span>:</span><br><span class="line">            <span class="keyword">return</span> i</span><br></pre></td></tr></table></figure><p>ç¬¬äº”ç§æ–¹æ³•ï¼šåˆ†æ²»ï¼Œæ—¶é—´å¤æ‚åº¦<code>O(n*logn)</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">majorityElement</span><span class="params">(self, nums)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> nums:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    <span class="keyword">if</span> len(nums) == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> nums[<span class="number">0</span>]</span><br><span class="line">    a = self.majorityElement(nums[:len(nums)//<span class="number">2</span>])</span><br><span class="line">    b = self.majorityElement(nums[len(nums)//<span class="number">2</span>:])</span><br><span class="line">    <span class="keyword">if</span> a == b:</span><br><span class="line">        <span class="keyword">return</span> a</span><br><span class="line">    <span class="keyword">return</span> [b, a][nums.count(a) &gt; len(nums)//<span class="number">2</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è¿™ä¸ª return çš„å†™æ³•ç­‰åŒäºä¸‹é¢çš„ if else</span></span><br><span class="line">    <span class="comment"># å› ä¸ºè‹¥åä¸€ä¸ª[]é‡Œä¸ºTrueå³1æ‰€ä»¥å–[b,a][1]=a, Falseå³0å–[b,a][0]=b</span></span><br><span class="line">    <span class="comment"># </span></span><br><span class="line">    <span class="comment"># if nums.count(a) &gt; len(nums)//2:</span></span><br><span class="line">    <span class="comment">#     return a</span></span><br><span class="line">    <span class="comment"># else:</span></span><br><span class="line">    <span class="comment">#     return b</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Algorithm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LeetCode </tag>
            
            <tag> Algorithm </tag>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è€ƒå¯ŸObjCå¯¹è±¡å†…å­˜ç»“æ„ä¸isaæŒ‡é’ˆ</title>
      <link href="/2019-05-05-ios-object-struct-isa/"/>
      <url>/2019-05-05-ios-object-struct-isa/</url>
      
        <content type="html"><![CDATA[<p>è€ƒå¯ŸObjCå¯¹è±¡å†…å­˜ç»“æ„ä¸isaæŒ‡é’ˆ</p><h4 id="1-ä¸€ä¸ª-Objective-C-å¯¹è±¡çš„å†…å­˜ç»“æ„æ˜¯æ€æ ·çš„ï¼Ÿ"><a href="#1-ä¸€ä¸ª-Objective-C-å¯¹è±¡çš„å†…å­˜ç»“æ„æ˜¯æ€æ ·çš„ï¼Ÿ" class="headerlink" title="1. ä¸€ä¸ª Objective-C å¯¹è±¡çš„å†…å­˜ç»“æ„æ˜¯æ€æ ·çš„ï¼Ÿ"></a>1. ä¸€ä¸ª Objective-C å¯¹è±¡çš„å†…å­˜ç»“æ„æ˜¯æ€æ ·çš„ï¼Ÿ</h4><a id="more"></a><p>å¦‚æœæŠŠç±»çš„å®ä¾‹çœ‹æˆä¸€ä¸ªCè¯­è¨€çš„ç»“æ„ä½“ï¼ˆ<code>struct</code>ï¼‰ï¼Œå®ƒé¦–å…ˆåŒ…å«çš„æ˜¯ä¸€ä¸ª <code>isa</code> æŒ‡é’ˆï¼Œè€Œç±»çš„å…¶å®ƒæˆå‘˜å˜é‡ä¾æ¬¡æ’åˆ—åœ¨ç»“æ„ä½“ä¸­ã€‚æ’åˆ—é¡ºåºå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190603171627.png" alt></p><p>ä¸ºäº†éªŒè¯è¯¥è¯´æ³•ï¼Œæˆ‘ä»¬åœ¨Xcodeä¸­æ–°å»ºä¸€ä¸ªå·¥ç¨‹ï¼Œåœ¨main.mä¸­è¿è¡Œå¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;UIKit/UIKit.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Father</span> : <span class="title">NSObject</span> </span>&#123;    </span><br><span class="line">    <span class="keyword">int</span> _father;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span><span class="class"><span class="keyword">@implementation</span> <span class="title">Father</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Child</span> : <span class="title">Father</span> </span>&#123;    </span><br><span class="line"><span class="keyword">int</span> _child;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Child</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">char</span> * argv[])</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">  Child * child = [[Child alloc] init];  </span><br><span class="line">  <span class="keyword">@autoreleasepool</span> &#123;      </span><br><span class="line">       <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å°†æ–­ç‚¹ä¸‹åœ¨ <code>@autoreleasepool</code> å¤„ï¼Œç„¶ååœ¨<code>Console</code>ä¸­è¾“å…¥<code>p *child</code>,åˆ™å¯ä»¥çœ‹åˆ°<code>Xcode</code>è¾“å‡ºå¦‚ä¸‹å†…å®¹ï¼Œè¿™ä¸æˆ‘ä»¬ä¸Šé¢çš„è¯´æ³•ä¸€è‡´ã€‚</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">(lldb) p *child</span><br><span class="line">(Child) $<span class="number">0</span> = &#123;</span><br><span class="line">  (Father) Father = &#123;</span><br><span class="line">    (<span class="built_in">NSObject</span>) <span class="built_in">NSObject</span> = &#123;</span><br><span class="line">      (Class) isa = Child</span><br><span class="line">    &#125;</span><br><span class="line">    (<span class="keyword">int</span>) _father = <span class="number">0</span></span><br><span class="line">  &#125;</span><br><span class="line">  (<span class="keyword">int</span>) _child = <span class="number">0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å› ä¸ºå¯¹è±¡åœ¨å†…å­˜ä¸­çš„æ’å¸ƒå¯ä»¥çœ‹æˆä¸€ä¸ªç»“æ„ä½“ï¼Œè¯¥ç»“æ„ä½“çš„å¤§å°å¹¶ä¸èƒ½åŠ¨æ€å˜åŒ–ã€‚æ‰€ä»¥æ— æ³•åœ¨è¿è¡Œæ—¶åŠ¨æ€ç»™å¯¹è±¡å¢åŠ æˆå‘˜å˜é‡ã€‚</p><blockquote><p>æ³¨ï¼šéœ€è¦ç‰¹åˆ«è¯´æ˜ä¸€ä¸‹ï¼Œé€šè¿‡ <code>objc_setAssociatedObject</code>å’Œ <code>objc_getAssociatedObject</code>æ–¹æ³•å¯ä»¥å˜ç›¸åœ°ç»™å¯¹è±¡å¢åŠ æˆå‘˜å˜é‡ï¼Œä½†ç”±äºå®ç°æœºåˆ¶ä¸ä¸€æ ·ï¼Œæ‰€ä»¥å¹¶ä¸æ˜¯çœŸæ­£æ”¹å˜äº†å¯¹è±¡çš„å†…å­˜ç»“æ„ã€‚</p></blockquote><h4 id="2-Objective-C-å¯¹è±¡å†…å­˜ç»“æ„ä¸­çš„-isa-æŒ‡é’ˆæ˜¯ç”¨æ¥åšä»€ä¹ˆçš„ï¼Œæœ‰ä»€ä¹ˆç”¨ï¼Ÿ"><a href="#2-Objective-C-å¯¹è±¡å†…å­˜ç»“æ„ä¸­çš„-isa-æŒ‡é’ˆæ˜¯ç”¨æ¥åšä»€ä¹ˆçš„ï¼Œæœ‰ä»€ä¹ˆç”¨ï¼Ÿ" class="headerlink" title="2. Objective-C å¯¹è±¡å†…å­˜ç»“æ„ä¸­çš„ isa æŒ‡é’ˆæ˜¯ç”¨æ¥åšä»€ä¹ˆçš„ï¼Œæœ‰ä»€ä¹ˆç”¨ï¼Ÿ"></a>2. Objective-C å¯¹è±¡å†…å­˜ç»“æ„ä¸­çš„ isa æŒ‡é’ˆæ˜¯ç”¨æ¥åšä»€ä¹ˆçš„ï¼Œæœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h4><p><code>Objective-C</code> æ˜¯ä¸€é—¨é¢å‘å¯¹è±¡çš„ç¼–ç¨‹è¯­è¨€ã€‚æ¯ä¸€ä¸ªå¯¹è±¡éƒ½æ˜¯ä¸€ä¸ªç±»çš„å®ä¾‹ã€‚åœ¨ <code>Objective-C</code> è¯­è¨€çš„å†…éƒ¨ï¼Œæ¯ä¸€ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ªåä¸º <code>isa</code> çš„æŒ‡é’ˆï¼ŒæŒ‡å‘è¯¥å¯¹è±¡çš„ç±»ã€‚æ¯ä¸€ä¸ªç±»æè¿°äº†ä¸€ç³»åˆ—å®ƒçš„å®ä¾‹çš„ç‰¹ç‚¹ï¼ŒåŒ…æ‹¬æˆå‘˜å˜é‡çš„åˆ—è¡¨ï¼Œæˆå‘˜å‡½æ•°çš„åˆ—è¡¨ç­‰ã€‚æ¯ä¸€ä¸ªå¯¹è±¡éƒ½å¯ä»¥æ¥å—æ¶ˆæ¯ï¼Œè€Œå¯¹è±¡èƒ½å¤Ÿæ¥æ”¶çš„æ¶ˆæ¯åˆ—è¡¨æ˜¯ä¿å­˜åœ¨å®ƒæ‰€å¯¹åº”çš„ç±»ä¸­ã€‚</p><p>åœ¨ <code>Xcode</code> ä¸­æŒ‰<code>Shift + Command + O</code>, ç„¶åè¾“å…¥ <code>NSObject.h</code> å’Œ <code>objc.h</code>ï¼Œå¯ä»¥æ‰“å¼€ <code>NSObject</code> çš„å®šä¹‰å¤´æ–‡ä»¶ï¼Œé€šè¿‡å¤´æ–‡ä»¶æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ<code>NSObject</code> å°±æ˜¯ä¸€ä¸ªåŒ…å« isa æŒ‡é’ˆçš„ç»“æ„ä½“ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190603171935.png" alt></p><p>æŒ‰ç…§é¢å‘å¯¹è±¡è¯­è¨€çš„è®¾è®¡åŸåˆ™ï¼Œæ‰€æœ‰äº‹ç‰©éƒ½åº”è¯¥æ˜¯å¯¹è±¡ï¼ˆä¸¥æ ¼æ¥è¯´ <code>Objective-C</code> å¹¶æ²¡æœ‰å®Œå…¨åšåˆ°è¿™ä¸€ç‚¹ï¼Œå› ä¸ºå®ƒæœ‰è±¡ <code>int</code>, <code>double</code> è¿™æ ·çš„ç®€å•å˜é‡ç±»å‹ï¼Œè€Œ <code>Swift</code> è¯­è¨€ï¼Œè¿ <code>int</code> å˜é‡ä¹Ÿæ˜¯å¯¹è±¡ï¼‰ã€‚åœ¨ <code>Objective-C</code> è¯­è¨€ä¸­ï¼Œæ¯ä¸€ä¸ªç±»å®é™…ä¸Šä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚æ¯ä¸€ä¸ªç±»ä¹Ÿæœ‰ä¸€ä¸ªåä¸º <code>isa</code> çš„æŒ‡é’ˆã€‚æ¯ä¸€ä¸ªç±»ä¹Ÿå¯ä»¥æ¥å—æ¶ˆæ¯ï¼Œä¾‹å¦‚ä»£ç <code>[NSObject alloc]</code>ï¼Œå°±æ˜¯å‘ <code>NSObject</code> è¿™ä¸ªç±»å‘é€åä¸ºallocæ¶ˆæ¯ã€‚</p><p>åœ¨ <code>Xcode</code> ä¸­æŒ‰<code>Shift + Command + O</code>, ç„¶åè¾“å…¥ <code>runtime.h</code>ï¼Œå¯ä»¥æ‰“å¼€ <code>Class</code> çš„å®šä¹‰å¤´æ–‡ä»¶ï¼Œé€šè¿‡å¤´æ–‡ä»¶æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ<code>Class</code> ä¹Ÿæ˜¯ä¸€ä¸ªåŒ…å« <code>isa</code> æŒ‡é’ˆçš„ç»“æ„ä½“ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ï¼ˆå›¾ä¸­é™¤äº† <code>isa</code> å¤–è¿˜æœ‰å…¶å®ƒæˆå‘˜å˜é‡ï¼Œä½†é‚£æ˜¯ä¸ºäº†å…¼å®¹é 2.0 ç‰ˆçš„ <code>Objective-C</code> çš„é—ç•™é€»è¾‘ï¼Œå¤§å®¶å¯ä»¥å¿½ç•¥å®ƒã€‚ï¼‰</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190603172059.png" alt></p><p>å› ä¸ºç±»ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£å®ƒä¹Ÿå¿…é¡»æ˜¯å¦ä¸€ä¸ªç±»çš„å®ä¾‹ï¼Œè¿™ä¸ªç±»å°±æ˜¯å…ƒç±» (<code>metaclass</code>)ã€‚å…ƒç±»ä¿å­˜äº†ç±»æ–¹æ³•çš„åˆ—è¡¨ã€‚å½“ä¸€ä¸ªç±»æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œå…ƒç±»ä¼šé¦–å…ˆæŸ¥æ‰¾å®ƒæœ¬èº«æ˜¯å¦æœ‰è¯¥ç±»æ–¹æ³•çš„å®ç°ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™è¯¥å…ƒç±»ä¼šå‘å®ƒçš„çˆ¶ç±»æŸ¥æ‰¾è¯¥æ–¹æ³•ï¼Œç›´åˆ°ä¸€ç›´æ‰¾åˆ°ç»§æ‰¿é“¾çš„å¤´ã€‚</p><p>å…ƒç±» (<code>metaclass</code>) ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆå…ƒç±»çš„ <code>isa</code> æŒ‡é’ˆåˆæŒ‡å‘å“ªé‡Œå‘¢ï¼Ÿä¸ºäº†è®¾è®¡ä¸Šçš„å®Œæ•´ï¼Œæ‰€æœ‰çš„å…ƒç±»çš„ <code>isa</code> æŒ‡é’ˆéƒ½ä¼šæŒ‡å‘ä¸€ä¸ªæ ¹å…ƒç±» (<code>root metaclass</code>)ã€‚æ ¹å…ƒç±» (<code>root metaclass</code>) æœ¬èº«çš„ <code>isa</code> æŒ‡é’ˆæŒ‡å‘è‡ªå·±ï¼Œè¿™æ ·å°±è¡Œæˆäº†ä¸€ä¸ªé—­ç¯ã€‚ä¸Šé¢æåˆ°ï¼Œä¸€ä¸ªå¯¹è±¡èƒ½å¤Ÿæ¥æ”¶çš„æ¶ˆæ¯åˆ—è¡¨æ˜¯ä¿å­˜åœ¨å®ƒæ‰€å¯¹åº”çš„ç±»ä¸­çš„ã€‚åœ¨å®é™…ç¼–ç¨‹ä¸­ï¼Œæˆ‘ä»¬å‡ ä¹ä¸ä¼šé‡åˆ°å‘å…ƒç±»å‘æ¶ˆæ¯çš„æƒ…å†µï¼Œé‚£å®ƒçš„ <code>isa</code> æŒ‡é’ˆåœ¨å®é™…ä¸Šå¾ˆå°‘ç”¨åˆ°ã€‚ä¸è¿‡è¿™ä¹ˆè®¾è®¡ä¿è¯äº†é¢å‘å¯¹è±¡æ¦‚å¿µåœ¨ <code>Objective-C</code> è¯­è¨€ä¸­çš„å®Œæ•´ï¼Œå³è¯­è¨€ä¸­çš„æ‰€æœ‰äº‹ç‰©éƒ½æ˜¯å¯¹è±¡ï¼Œéƒ½æœ‰ <code>isa</code> æŒ‡é’ˆã€‚</p><p>æˆ‘ä»¬å†æ¥çœ‹çœ‹ç»§æ‰¿å…³ç³»ï¼Œç”±äºç±»æ–¹æ³•çš„å®šä¹‰æ˜¯ä¿å­˜åœ¨å…ƒç±» (<code>metaclass</code>) ä¸­ï¼Œè€Œæ–¹æ³•è°ƒç”¨çš„è§„åˆ™æ˜¯ï¼Œå¦‚æœè¯¥ç±»æ²¡æœ‰ä¸€ä¸ªæ–¹æ³•çš„å®ç°ï¼Œåˆ™å‘å®ƒçš„çˆ¶ç±»ç»§ç»­æŸ¥æ‰¾ã€‚æ‰€ä»¥ï¼Œä¸ºäº†ä¿è¯çˆ¶ç±»çš„ç±»æ–¹æ³•å¯ä»¥åœ¨å­ç±»ä¸­å¯ä»¥è¢«è°ƒç”¨ï¼Œæ‰€ä»¥å­ç±»çš„å…ƒç±»ä¼šç»§æ‰¿çˆ¶ç±»çš„å…ƒç±»ï¼Œæ¢è€Œè¨€ä¹‹ï¼Œç±»å¯¹è±¡å’Œå…ƒç±»å¯¹è±¡æœ‰ç€åŒæ ·çš„ç»§æ‰¿å…³ç³»ã€‚</p><p>æˆ‘å¾ˆæƒ³æŠŠå…³ç³»è¯´æ¸…æ¥šä¸€äº›ï¼Œä½†æ˜¯è¿™å—å„¿ç¡®å®æœ‰ç‚¹ç»•ï¼Œæˆ‘ä»¬è¿˜æ˜¯æ¥çœ‹å›¾å§ï¼Œå¾ˆå¤šæ—¶å€™å›¾è±¡æ¯”æ–‡å­—è¡¨è¾¾èµ·æ¥æ›´ä¸ºç›´è§‚ã€‚ä¸‹é¢è¿™å¼ å›¾æˆ–è®¸èƒ½å¤Ÿè®©å¤§å®¶å¯¹ <code>isa</code> å’Œç»§æ‰¿çš„å…³ç³»æ¸…æ¥šä¸€äº›ï¼š</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190603172152.png" alt></p><p>æˆ‘ä»¬å¯ä»¥ä»å›¾ä¸­çœ‹å‡ºï¼š</p><p><code>NSObject</code> çš„ç±»ä¸­å®šä¹‰äº†å®ä¾‹æ–¹æ³•ï¼Œä¾‹å¦‚ <code>-(id)init</code> æ–¹æ³• å’Œ <code>- (void)dealloc</code> æ–¹æ³•ã€‚</p><p><code>NSObject</code> çš„å…ƒç±»ä¸­å®šä¹‰äº†ç±»æ–¹æ³•ï¼Œä¾‹å¦‚ <code>+(id)alloc</code> æ–¹æ³• å’Œ <code>+ (void)load</code> ã€<code>+ (void)initialize</code> æ–¹æ³•ã€‚</p><p><code>NSObject</code> çš„å…ƒç±»ç»§æ‰¿è‡ª <code>NSObject</code> ç±»ï¼Œæ‰€ä»¥ <code>NSObject</code> ç±»æ˜¯æ‰€æœ‰ç±»çš„æ ¹ï¼Œå› æ­¤ <code>NSObject</code> ä¸­å®šä¹‰çš„å®ä¾‹æ–¹æ³•å¯ä»¥è¢«æ‰€æœ‰å¯¹è±¡è°ƒç”¨ï¼Œä¾‹å¦‚ <code>- (id)init</code> æ–¹æ³• å’Œ <code>- (void)dealloc</code> æ–¹æ³•ã€‚</p><p><code>NSObject</code> çš„å…ƒç±»çš„ <code>isa</code> æŒ‡å‘è‡ªå·±ã€‚</p><h4 id="isa-swizzling-çš„åº”ç”¨"><a href="#isa-swizzling-çš„åº”ç”¨" class="headerlink" title="isa swizzling çš„åº”ç”¨"></a>isa swizzling çš„åº”ç”¨</h4><p>ç³»ç»Ÿæä¾›çš„ <code>KVO</code> çš„å®ç°ï¼Œå°±åˆ©ç”¨äº†åŠ¨æ€åœ°ä¿®æ”¹ <code>isa</code> æŒ‡é’ˆçš„å€¼çš„æŠ€æœ¯ã€‚åœ¨ è‹¹æœçš„æ–‡æ¡£<br>ä¸­å¯ä»¥çœ‹åˆ°å¦‚ä¸‹æè¿°ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Key-Value Observing Implementation Details</span><br><span class="line"></span><br><span class="line">Automatic key-value observing is implemented using a technique called isa-swizzling.</span><br><span class="line"></span><br><span class="line">The isa pointer, as the name suggests, points to the objectâ€™s class which maintains a dispatch table. This dispatch table essentially contains pointers to the methods the class implements, among other data.</span><br><span class="line"></span><br><span class="line">When an observer is registered for an attribute of an object the isa pointer of the observed object is modified, pointing to an intermediate class rather than at the true class. As a result the value of the isa pointer does not necessarily reflect the actual class of the instance.</span><br><span class="line"></span><br><span class="line">You should never rely on the isa pointer to determine class membership. Instead, you should use the class method to determine the class of an object instance.</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Note </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
            <tag> Objective-C </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LeetCodeåšé¢˜ç¬”è®°â€”äºŒå‰æ ‘ç›¸å…³é¢˜ç›®</title>
      <link href="/2019-05-04-leetcode-tree/"/>
      <url>/2019-05-04-leetcode-tree/</url>
      
        <content type="html"><![CDATA[<p>æœ‰å…³äºŒå‰æ ‘çš„åšé¢˜ç¬”è®°ï¼ŒPythonå®ç°</p><a id="more"></a><h2 id="äºŒå‰æ ‘çš„å®šä¹‰"><a href="#äºŒå‰æ ‘çš„å®šä¹‰" class="headerlink" title="äºŒå‰æ ‘çš„å®šä¹‰"></a>äºŒå‰æ ‘çš„å®šä¹‰</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for a binary tree node.</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TreeNode</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, x)</span>:</span></span><br><span class="line">        self.val = x</span><br><span class="line">        self.left = <span class="literal">None</span></span><br><span class="line">        self.right = <span class="literal">None</span></span><br></pre></td></tr></table></figure><h2 id="226-ç¿»è½¬äºŒå‰æ ‘-Invert-Binary-Tree"><a href="#226-ç¿»è½¬äºŒå‰æ ‘-Invert-Binary-Tree" class="headerlink" title="226. ç¿»è½¬äºŒå‰æ ‘ Invert Binary Tree"></a>226. ç¿»è½¬äºŒå‰æ ‘ Invert Binary Tree</h2><p><a href="https://leetcode-cn.com/problems/invert-binary-tree/" target="_blank" rel="noopener">LeetCodeCN ç¬¬226é¢˜é“¾æ¥</a></p><p>ç¬¬ä¸€ç§æ–¹æ³•ï¼šé€’å½’</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">invertTree</span><span class="params">(self, root: TreeNode)</span> -&gt; TreeNode:</span></span><br><span class="line">        <span class="keyword">if</span> root:</span><br><span class="line">            root.left, root.right = self.invertTree(root.right), self.invertTree(root.left)</span><br><span class="line">            <span class="keyword">return</span> root</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ–¹æ³•ï¼šéå†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">invertTree</span><span class="params">(self, root: TreeNode)</span> -&gt; TreeNode:</span></span><br><span class="line">        stack = [root]</span><br><span class="line">        <span class="keyword">while</span> stack:</span><br><span class="line">            node = stack.pop()</span><br><span class="line">            <span class="keyword">if</span> node:</span><br><span class="line">                node.left, node.right = node.right, node.left</span><br><span class="line">                stack.append(node.left)</span><br><span class="line">                stack.append(node.right)</span><br><span class="line">        <span class="keyword">return</span> root</span><br></pre></td></tr></table></figure><h2 id="98-éªŒè¯äºŒå‰æœç´¢æ ‘-Validate-Binary-Search-Tree"><a href="#98-éªŒè¯äºŒå‰æœç´¢æ ‘-Validate-Binary-Search-Tree" class="headerlink" title="98. éªŒè¯äºŒå‰æœç´¢æ ‘ Validate Binary Search Tree"></a>98. éªŒè¯äºŒå‰æœç´¢æ ‘ Validate Binary Search Tree</h2><p><a href="https://leetcode-cn.com/problems/validate-binary-search-tree/" target="_blank" rel="noopener">LeetCodeCN ç¬¬98é¢˜é“¾æ¥</a></p><p>ç¬¬ä¸€ç§æ–¹æ³•ï¼šä¸­åºéå†äºŒå‰æ ‘å­˜å…¥æ•°ç»„ï¼Œä¸ç›´æ¥å‡åºæ’åºå»é‡åçš„åŸäºŒå‰æ ‘å¯¹æ¯”</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isValidBST</span><span class="params">(self, root: TreeNode)</span> -&gt; bool:</span></span><br><span class="line">        inorder = self.inorder(root)</span><br><span class="line">        <span class="keyword">return</span> inorder == list(sorted(set(inorder)))</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inorder</span><span class="params">(self, root)</span> -&gt; list:</span></span><br><span class="line">        <span class="keyword">if</span> root <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line">        <span class="keyword">return</span> self.inorder(root.left) + [root.val] + self.inorder(root.right)</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ–¹æ³•ï¼šä¸­åºéå†åªç”¨æ¯”è¾ƒå‰ä¸€èŠ‚ç‚¹çš„å€¼æ˜¯å¦å°äºå½“å‰èŠ‚ç‚¹çš„å€¼å³å¯ï¼Œä¸ç”¨å‚¨å­˜</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isValidBST</span><span class="params">(self, root: TreeNode)</span> -&gt; bool:</span></span><br><span class="line">        self.prev = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">return</span> self.helper(root)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(self, root)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> root <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.helper(root.left):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">if</span> self.prev <span class="keyword">and</span> self.prev.val &gt;= root.val:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        self.prev = root</span><br><span class="line">        <span class="keyword">return</span> self.helper(root.right)</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰ç§æ–¹æ³•ï¼šé€’å½’éªŒè¯æ¯ä¸ªèŠ‚ç‚¹å·¦å­©å­çš„å€¼æ˜¯å¦å°äºçˆ¶äº²èŠ‚ç‚¹çš„å€¼ä»¥åŠå³å­©å­çš„å€¼æ˜¯å¦å¤§äºçˆ¶äº²èŠ‚ç‚¹çš„å€¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isValidBST</span><span class="params">(self, root: TreeNode)</span> -&gt; bool:</span></span><br><span class="line">        mini, maxi = float(<span class="string">'-inf'</span>), float(<span class="string">'inf'</span>) </span><br><span class="line">        <span class="keyword">return</span> self.isValid(root, mini, maxi)</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isValid</span><span class="params">(self, root: TreeNode, mini: int, maxi: int)</span> -&gt; bool:</span></span><br><span class="line">        <span class="keyword">if</span> root <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> mini &gt;= root.val <span class="keyword">or</span> maxi &lt;= root.val:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> self.isValid(root.left, mini, root.val) <span class="keyword">and</span> self.isValid(root.right, root.val, maxi)</span><br></pre></td></tr></table></figure><h2 id="236-äºŒå‰æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ-Lowest-Common-Ancestor-of-a-Binary-Tree"><a href="#236-äºŒå‰æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ-Lowest-Common-Ancestor-of-a-Binary-Tree" class="headerlink" title="236. äºŒå‰æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ Lowest Common Ancestor of a Binary Tree"></a>236. äºŒå‰æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ Lowest Common Ancestor of a Binary Tree</h2><p><a href="https://leetcode-cn.com/problems/lowest-common-ancestor-of-a-binary-tree/" target="_blank" rel="noopener">LeetCodeCN ç¬¬236é¢˜é“¾æ¥</a></p><p>é¦–å…ˆå¦‚æœrootä¸ºç©ºï¼Œè¿”å›rootï¼Œç„¶åå¦‚æœrootå°±æ˜¯pæˆ–è€…qï¼Œé‚£rootå°±æ˜¯æœ€è¿‘å…¬å…±ç¥–å…ˆã€‚ç„¶ååˆ†åˆ«å¯¹å·¦å­æ ‘å’Œå³å­æ ‘åšé€’å½’å¹¶ä¿å­˜ç»“æœï¼Œå¦‚æœä¸¤è¾¹éƒ½èƒ½æ‰¾åˆ°ï¼Œè¯æ˜æœ¬èŠ‚ç‚¹å°±æ˜¯æœ€è¿‘å…¬å…±ç¥–å…ˆï¼Œå¦‚æœä¸€è¾¹æ‰¾å¾—åˆ°ï¼Œä¸€è¾¹æ‰¾ä¸åˆ°ï¼Œåˆ™å¾€èƒ½æ‰¾åˆ°çš„é‚£è¾¹ç»§ç»­æ‰¾ä¸‹å»ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">lowestCommonAncestor</span><span class="params">(self, root: <span class="string">'TreeNode'</span>, p: <span class="string">'TreeNode'</span>, q: <span class="string">'TreeNode'</span>)</span> -&gt; 'TreeNode':</span></span><br><span class="line">        <span class="keyword">if</span> root <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="keyword">if</span> root == p <span class="keyword">or</span> root == q:</span><br><span class="line">            <span class="keyword">return</span> root</span><br><span class="line">        left = self.lowestCommonAncestor(root.left, p, q)</span><br><span class="line">        right = self.lowestCommonAncestor(root.right, p, q)</span><br><span class="line">        <span class="keyword">if</span> left <span class="keyword">or</span> right:</span><br><span class="line">            <span class="keyword">if</span> left <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">                <span class="keyword">return</span> right</span><br><span class="line">            <span class="keyword">elif</span> right <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">                <span class="keyword">return</span> left</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> root</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br></pre></td></tr></table></figure><h2 id="235-äºŒå‰æœç´¢æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ-Lowest-Common-Ancestor-of-a-Binary-Search-Tree"><a href="#235-äºŒå‰æœç´¢æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ-Lowest-Common-Ancestor-of-a-Binary-Search-Tree" class="headerlink" title="235. äºŒå‰æœç´¢æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ Lowest Common Ancestor of a Binary Search Tree"></a>235. äºŒå‰æœç´¢æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ Lowest Common Ancestor of a Binary Search Tree</h2><p><a href="https://leetcode-cn.com/problems/lowest-common-ancestor-of-a-binary-search-tree/" target="_blank" rel="noopener">LeetCodeCN ç¬¬235é¢˜é“¾æ¥</a></p><p>ç¬¬ä¸€ç§æ–¹æ³•ï¼šè¿˜ç”¨ä¸Šé¢çš„æ–¹æ³•</p><p>ç¬¬äºŒç§æ–¹æ³•ï¼šåˆ©ç”¨äºŒå‰æœç´¢æ ‘çš„å·¦å­æ ‘éƒ½å°äºçˆ¶äº²èŠ‚ç‚¹ï¼Œå³å­æ ‘éƒ½å¤§äºçˆ¶äº²èŠ‚ç‚¹çš„ç‰¹æ€§ï¼Œå¯ä»¥æŠŠç¬¬ä¸€ç§æ–¹æ³•ç®€åŒ–ä¸€ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">lowestCommonAncestor</span><span class="params">(self, root: <span class="string">'TreeNode'</span>, p: <span class="string">'TreeNode'</span>, q: <span class="string">'TreeNode'</span>)</span> -&gt; 'TreeNode':</span></span><br><span class="line">        <span class="keyword">if</span> p.val &lt; root.val <span class="keyword">and</span> q.val &lt; root.val:</span><br><span class="line">            <span class="keyword">return</span> self.lowestCommonAncestor(root.left, p, q)</span><br><span class="line">        <span class="keyword">if</span> p.val &gt; root.val <span class="keyword">and</span> q.val &gt; root.val:</span><br><span class="line">            <span class="keyword">return</span> self.lowestCommonAncestor(root.right, p, q)</span><br><span class="line">        <span class="keyword">return</span> root</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰ç§æ–¹æ³•ï¼šè·Ÿæ–¹æ³•äºŒçš„æ€è·¯ä¸€æ ·ï¼ŒæŠŠé€’å½’æ”¹æˆå¾ªç¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">lowestCommonAncestor</span><span class="params">(self, root: <span class="string">'TreeNode'</span>, p: <span class="string">'TreeNode'</span>, q: <span class="string">'TreeNode'</span>)</span> -&gt; 'TreeNode':</span></span><br><span class="line">    <span class="keyword">while</span> root:</span><br><span class="line">        <span class="keyword">if</span> p.val &lt; root.val <span class="keyword">and</span> q.val &lt; root.val:</span><br><span class="line">            root = root.left</span><br><span class="line">        <span class="keyword">elif</span> p.val &gt; root.val <span class="keyword">and</span> q.val &gt; root.val:</span><br><span class="line">            root = root.right</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> root</span><br></pre></td></tr></table></figure><h2 id="112-è·¯å¾„æ€»å’Œ-Path-Sum"><a href="#112-è·¯å¾„æ€»å’Œ-Path-Sum" class="headerlink" title="112. è·¯å¾„æ€»å’Œ Path Sum"></a>112. è·¯å¾„æ€»å’Œ Path Sum</h2><p><a href="https://leetcode-cn.com/problems/path-sum/" target="_blank" rel="noopener">LeetCodeCN ç¬¬112é¢˜é“¾æ¥</a></p><p>ç¬¬ä¸€ç§æ–¹æ³•ï¼šDFSï¼Œç”¨ä¸€ä¸ªæ•°ç»„è®°å½•æ¯æ¡è·¯çº¿çš„è·¯å¾„å’Œï¼Œæœ€åæ£€æŸ¥ç›®æ ‡å€¼æ˜¯å¦åœ¨æ•°ç»„å†…</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">hasPathSum</span><span class="params">(self, root: TreeNode, sum: int)</span> -&gt; bool:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        self.res = []</span><br><span class="line">        self.dfs(root, <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">if</span> sum <span class="keyword">in</span> self.res:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">dfs</span><span class="params">(self, node, tmp)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> node.left <span class="keyword">and</span> <span class="keyword">not</span> node.right:</span><br><span class="line">            self.res.append(tmp+node.val)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">if</span> node.left:</span><br><span class="line">            self.dfs(node.left, tmp+node.val)</span><br><span class="line">        <span class="keyword">if</span> node.right:</span><br><span class="line">            self.dfs(node.right, tmp+node.val)</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ–¹æ³•ï¼šæ¯æ¬¡é€’å½’æ—¶ä»ç›®æ ‡å€¼é‡Œæ‰£é™¤è‡ªèº«èŠ‚ç‚¹çš„å€¼ï¼Œå¦‚æœåˆ°æŸä¸ªå¶å­èŠ‚ç‚¹æ­£å¥½å‰©ä½™ç›®æ ‡å€¼ç­‰äºå¶å­èŠ‚ç‚¹çš„å€¼è¯´æ˜å­˜åœ¨è¯¥è·¯å¾„</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">hasPathSum</span><span class="params">(self, root: TreeNode, sum: int)</span> -&gt; bool:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> root.left <span class="keyword">and</span> <span class="keyword">not</span> root.right <span class="keyword">and</span> sum == root.val:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        sum -= root.val</span><br><span class="line">        <span class="keyword">return</span> self.hasPathSum(root.left, sum) <span class="keyword">or</span> self.hasPathSum(root.right, sum)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Algorithm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LeetCode </tag>
            
            <tag> Algorithm </tag>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LeetCodeåšé¢˜ç¬”è®°â€”å“ˆå¸Œè¡¨ç›¸å…³é¢˜ç›®</title>
      <link href="/2019-05-01-leetcode-hashtable/"/>
      <url>/2019-05-01-leetcode-hashtable/</url>
      
        <content type="html"><![CDATA[<p>æœ‰å…³å“ˆå¸Œè¡¨çš„åšé¢˜ç¬”è®°ï¼ŒPythonå®ç°</p><a id="more"></a><h2 id="242-æœ‰æ•ˆçš„å­—æ¯å¼‚ä½è¯-Valid-Anagram"><a href="#242-æœ‰æ•ˆçš„å­—æ¯å¼‚ä½è¯-Valid-Anagram" class="headerlink" title="242. æœ‰æ•ˆçš„å­—æ¯å¼‚ä½è¯ Valid Anagram"></a>242. æœ‰æ•ˆçš„å­—æ¯å¼‚ä½è¯ Valid Anagram</h2><p><a href="https://leetcode-cn.com/problems/valid-anagram/" target="_blank" rel="noopener">LeetCodeCN ç¬¬242é¢˜é“¾æ¥</a></p><p>ç¬¬ä¸€ç§æ–¹æ³•ï¼šå¯¹ä¸¤ä¸ªå­—ç¬¦ä¸²æ’åºåå¯¹æ¯”</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isAnagram</span><span class="params">(self, s: str, t: str)</span> -&gt; bool:</span></span><br><span class="line">        <span class="keyword">return</span> sorted(s) == sorted(t)</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ–¹æ³•ï¼šç”¨å“ˆå¸Œè¡¨å¯¹å­—ç¬¦ä¸²å†…æ¯ä¸ªå­—ç¬¦è®¡æ•°ï¼Œæœ€åæ¯”å¯¹å“ˆå¸Œè¡¨ï¼Œè¿™é‡Œç”¨dictå®ç°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isAnagram</span><span class="params">(self, s: str, t: str)</span> -&gt; bool:</span></span><br><span class="line">        map1, map2 = &#123;&#125;, &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">            map1[i] = map1.get(i, <span class="number">0</span>) + <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> t:</span><br><span class="line">            map2[j] = map2.get(j, <span class="number">0</span>) + <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> map1 == map2</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰ç§æ–¹æ³•ï¼šç”±äºåªæœ‰26ä¸ªå°å†™å­—æ¯å…ƒç´ ï¼Œå¯ä»¥ç”¨æ•°ç»„è‡ªå·±å®ç°ä¸€ä¸ªå“ˆå¸Œè¡¨ï¼ŒåŸç†ä¸ä¸Šé¢ä¸€æ ·</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isAnagram</span><span class="params">(self, s: str, t: str)</span> -&gt; bool:</span></span><br><span class="line">        map1, map2 = [<span class="number">0</span>]*<span class="number">26</span>, [<span class="number">0</span>]*<span class="number">26</span></span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> s:</span><br><span class="line">            map1[ord(c)-ord(<span class="string">'a'</span>)] += <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> d <span class="keyword">in</span> t:</span><br><span class="line">            map2[ord(d)-ord(<span class="string">'a'</span>)] += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> map1 == map2</span><br></pre></td></tr></table></figure><h2 id="1-ä¸¤æ•°ä¹‹å’Œ-Two-Sum"><a href="#1-ä¸¤æ•°ä¹‹å’Œ-Two-Sum" class="headerlink" title="1. ä¸¤æ•°ä¹‹å’Œ Two Sum"></a>1. ä¸¤æ•°ä¹‹å’Œ Two Sum</h2><p><a href="https://leetcode-cn.com/problems/two-sum/" target="_blank" rel="noopener">LeetCodeCN ç¬¬1é¢˜é“¾æ¥</a></p><p>ç¬¬ä¸€ç§æ–¹æ³•ï¼šç”¨å“ˆå¸Œè¡¨ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯<code>O(n)</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">twoSum</span><span class="params">(self, nums: List[int], target: int)</span> -&gt; List[int]:</span></span><br><span class="line">        dic = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(nums)):</span><br><span class="line">            <span class="keyword">if</span> nums[i] <span class="keyword">in</span> dic:</span><br><span class="line">                <span class="keyword">return</span> [dic[nums[i]], i]</span><br><span class="line">            <span class="keyword">else</span>:            </span><br><span class="line">                dic[target - nums[i]] = i</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ–¹æ³•ï¼šæš´åŠ›ä¸¤é‡éå†ï¼Œè¿™æ ·æ—¶é—´å¤æ‚åº¦æ˜¯<code>O(n^2)</code>ï¼Œåœ¨LeetCodeé‡Œæäº¤ä¼šè¶…æ—¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">twoSum</span><span class="params">(self, nums: List[int], target: int)</span> -&gt; List[int]:</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(nums)):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(i+<span class="number">1</span>, len(nums)):</span><br><span class="line">                <span class="keyword">if</span> nums[i] + nums[j] == target:</span><br><span class="line">                    <span class="keyword">return</span> [i, j]</span><br></pre></td></tr></table></figure><h2 id="15-ä¸‰æ•°ä¹‹å’Œ-3Sum"><a href="#15-ä¸‰æ•°ä¹‹å’Œ-3Sum" class="headerlink" title="15. ä¸‰æ•°ä¹‹å’Œ 3Sum"></a>15. ä¸‰æ•°ä¹‹å’Œ 3Sum</h2><p><a href="https://leetcode-cn.com/problems/3sum/" target="_blank" rel="noopener">LeetCodeCN ç¬¬15é¢˜é“¾æ¥</a></p><p>ç¬¬ä¸€ç§æ–¹æ³•ï¼šä¸‰é‡éå†ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º<code>O(n^3)</code></p><p>ç¬¬äºŒç§æ–¹æ³•ï¼šä¸¤é‡éå†å¾—åˆ°å‰ä¸¤ä¸ªæ•°ï¼Œç„¶åæŸ¥è¯¢ç¬¬ä¸‰ä¸ªæ•°<code>-(a+b)</code>æ˜¯å¦å­˜åœ¨ã€‚ç”¨å“ˆå¸Œè¡¨<code>set()</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">threeSum</span><span class="params">(self, nums)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        :type nums: List[int]</span></span><br><span class="line"><span class="string">        :rtype: List[List[int]]</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">if</span> len(nums) &lt; <span class="number">3</span>:</span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line">        nums.sort()</span><br><span class="line">        res = set()</span><br><span class="line">        <span class="keyword">for</span> i, v <span class="keyword">in</span> enumerate(nums[:<span class="number">-2</span>]) :</span><br><span class="line">            <span class="keyword">if</span> i &gt;= <span class="number">1</span> <span class="keyword">and</span> v == nums[i<span class="number">-1</span>]:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            d = &#123;&#125;</span><br><span class="line">            <span class="keyword">for</span> x <span class="keyword">in</span> nums[i+<span class="number">1</span>:]:</span><br><span class="line">                <span class="keyword">if</span> x <span class="keyword">not</span> <span class="keyword">in</span> d:</span><br><span class="line">                    d[-(v+x)] = <span class="number">1</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    res.add((v, -(v+x), x))</span><br><span class="line">        <span class="keyword">return</span> map(list, res)</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰ç§æ–¹æ³•ï¼šå…ˆå‡åºæ’åºï¼Œä¸€ééå†ï¼Œç„¶ååœ¨åé¢çš„æ–°æ•°ç»„é‡Œç”¨åŒæŒ‡é’ˆæ£€æŸ¥ä¸‰ä¸ªæ•°ä¹‹å’Œæ˜¯å¦ä¸º0ï¼Œå¤§äº0åˆ™å³æŒ‡é’ˆå‘å·¦èµ°ï¼Œå°äº0åˆ™å·¦æŒ‡é’ˆå‘å³èµ°ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">threeSum</span><span class="params">(self, nums)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> len(nums) &lt; <span class="number">3</span>:</span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line">        nums.sort()</span><br><span class="line">        res = []</span><br><span class="line">        <span class="keyword">for</span> i, x <span class="keyword">in</span> enumerate(nums[:<span class="number">-2</span>]):</span><br><span class="line">            <span class="keyword">if</span> i &gt;= <span class="number">1</span> <span class="keyword">and</span> x == nums[i<span class="number">-1</span>]:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            l, r = i+<span class="number">1</span>, len(nums)<span class="number">-1</span></span><br><span class="line">            <span class="keyword">while</span> l &lt; r:</span><br><span class="line">                s = nums[i] + nums[l] + nums[r]</span><br><span class="line">                <span class="keyword">if</span> s &lt; <span class="number">0</span>:</span><br><span class="line">                    l += <span class="number">1</span></span><br><span class="line">                <span class="keyword">elif</span> s &gt; <span class="number">0</span>:</span><br><span class="line">                    r -= <span class="number">1</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    res.append((nums[i], nums[l], nums[r]))</span><br><span class="line">                    <span class="keyword">while</span> l &lt; r <span class="keyword">and</span> nums[l] == nums[l+<span class="number">1</span>]:</span><br><span class="line">                        l += <span class="number">1</span></span><br><span class="line">                    <span class="keyword">while</span> l &lt; r <span class="keyword">and</span> nums[r] == nums[r<span class="number">-1</span>]:</span><br><span class="line">                        r -= <span class="number">1</span></span><br><span class="line">                    l += <span class="number">1</span></span><br><span class="line">                    r -= <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure><h2 id="146-LRUç¼“å­˜æœºåˆ¶-LRU-Cache"><a href="#146-LRUç¼“å­˜æœºåˆ¶-LRU-Cache" class="headerlink" title="146. LRUç¼“å­˜æœºåˆ¶ LRU Cache"></a>146. LRUç¼“å­˜æœºåˆ¶ LRU Cache</h2><p><a href="https://leetcode-cn.com/problems/lru-cache/" target="_blank" rel="noopener">LeetCodeCN ç¬¬146é¢˜é“¾æ¥</a></p><p>åˆ©ç”¨ Python collections åº“å†…çš„é¡ºåºå“ˆå¸Œè¡¨ OrderedDict() ç±»å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å®ç°</p><blockquote><p>ä¸€èˆ¬LRUç¼“å­˜æ˜¯é€šè¿‡å“ˆå¸Œè¡¨é…åˆåŒå‘é“¾è¡¨å®ç°çš„ã€‚å¦‚å›¾æ‰€ç¤ºï¼Œå“ˆå¸Œè¡¨ä½¿è®¿é—®æŸ¥æ‰¾çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(1)ï¼ŒåŒå‘é“¾è¡¨å¯ä»¥è·å¾—å‰é©±èŠ‚ç‚¹ä½¿åˆ é™¤æ“ä½œä¹Ÿæ˜¯O(1)</p></blockquote><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190611173846.jpg" alt></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> OrderedDict</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LRUCache</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, capacity: int)</span>:</span></span><br><span class="line">        self.dic = OrderedDict()</span><br><span class="line">        self.remain = capacity</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self, key: int)</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> key <span class="keyword">not</span> <span class="keyword">in</span> self.dic:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">        item = self.dic[key]</span><br><span class="line">        self.dic.pop(key)</span><br><span class="line">        self.dic[key] = item</span><br><span class="line">        <span class="keyword">return</span> item</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">put</span><span class="params">(self, key: int, value: int)</span> -&gt; <span class="keyword">None</span>:</span></span><br><span class="line">        <span class="keyword">if</span> key <span class="keyword">in</span> self.dic:</span><br><span class="line">            self.dic.pop(key)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> self.remain &gt; <span class="number">0</span>:</span><br><span class="line">                self.remain -= <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self.dic.popitem(last=<span class="literal">False</span>)</span><br><span class="line">        self.dic[key] = value</span><br><span class="line"></span><br><span class="line"><span class="comment"># Your LRUCache object will be instantiated and called as such:</span></span><br><span class="line"><span class="comment"># obj = LRUCache(capacity)</span></span><br><span class="line"><span class="comment"># param_1 = obj.get(key)</span></span><br><span class="line"><span class="comment"># obj.put(key,value)</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Algorithm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LeetCode </tag>
            
            <tag> Algorithm </tag>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LeetCodeåšé¢˜ç¬”è®°â€”æ ˆã€å †ã€é˜Ÿåˆ—ç›¸å…³é¢˜ç›®</title>
      <link href="/2019-04-29-leetcode-stack-heap-queue/"/>
      <url>/2019-04-29-leetcode-stack-heap-queue/</url>
      
        <content type="html"><![CDATA[<p>æœ‰å…³æ ˆã€å †ã€é˜Ÿåˆ—çš„åšé¢˜ç¬”è®°ï¼ŒPythonå®ç°</p><a id="more"></a><h1 id="æ ˆ-Stack"><a href="#æ ˆ-Stack" class="headerlink" title="æ ˆ Stack"></a>æ ˆ Stack</h1><h2 id="20-æœ‰æ•ˆçš„æ‹¬å·-Valid-Parentheses"><a href="#20-æœ‰æ•ˆçš„æ‹¬å·-Valid-Parentheses" class="headerlink" title="20. æœ‰æ•ˆçš„æ‹¬å· Valid Parentheses"></a>20. æœ‰æ•ˆçš„æ‹¬å· Valid Parentheses</h2><p><a href="https://leetcode-cn.com/problems/valid-parentheses/" target="_blank" rel="noopener">LeetCodeCN ç¬¬20é¢˜é“¾æ¥</a></p><p>ä½¿ç”¨ Stack æ ˆ æ¥æ“ä½œï¼Œç”¨äº†ä¸€ä¸ªæŠ€å·§æ˜¯å…ˆåšä¸€ä¸ªå­—å…¸ï¼Œ<code>key</code>ä¸ºå³æ‹¬å·ï¼Œ<code>value</code>ä¸ºå·¦æ‹¬å·ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">isValid</span><span class="params">(self, s: str)</span> -&gt; bool:</span></span><br><span class="line">        stack = []</span><br><span class="line">        mapping = &#123;<span class="string">')'</span>:<span class="string">'('</span>, <span class="string">'&#125;'</span>:<span class="string">'&#123;'</span>, <span class="string">']'</span>:<span class="string">'['</span>&#125;</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> s:</span><br><span class="line">            <span class="keyword">if</span> c <span class="keyword">not</span> <span class="keyword">in</span> mapping:</span><br><span class="line">                stack.append(c)</span><br><span class="line">            <span class="keyword">elif</span> <span class="keyword">not</span> stack <span class="keyword">or</span> mapping[c] != stack.pop():</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">not</span> stack</span><br></pre></td></tr></table></figure><h2 id="71-ç®€åŒ–è·¯å¾„-Simplify-Path"><a href="#71-ç®€åŒ–è·¯å¾„-Simplify-Path" class="headerlink" title="71. ç®€åŒ–è·¯å¾„ Simplify Path"></a>71. ç®€åŒ–è·¯å¾„ Simplify Path</h2><p><a href="https://leetcode-cn.com/problems/simplify-path/" target="_blank" rel="noopener">LeetCode ç¬¬71é¢˜é“¾æ¥</a></p><p>ä½¿ç”¨æ ˆï¼Œéå†ç”¨<code>/</code>åˆ†å‰²åçš„å­—ç¬¦ä¸²æ•°ç»„ï¼Œæ­¤æ—¶å­—ç¬¦ä¸²ä¸å­˜åœ¨æ–œæ äº†ï¼Œå½“å­—ç¬¦ä¸æ˜¯ç©ºå­—ç¬¦æˆ–<code>.</code>ã€<code>..</code>æ—¶å³æ­£å¸¸è·¯å¾„åå‹å…¥æ ˆä¸­ï¼Œå½“é‡åˆ°ç©ºå­—ç¬¦æˆ–è€…<code>.</code>æ—¶ç•¥è¿‡ï¼Œå½“é‡åˆ°<code>..</code>æ—¶<code>pop</code>ä¸€ä¸‹å³è¿”å›ä¸Šçº§ç›®å½•ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">simplifyPath</span><span class="params">(self, path: str)</span> -&gt; str:</span></span><br><span class="line">        stack = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> path.split(<span class="string">'/'</span>):</span><br><span class="line">            <span class="keyword">if</span> i <span class="keyword">not</span> <span class="keyword">in</span> [<span class="string">''</span>, <span class="string">'.'</span>, <span class="string">'..'</span>]:</span><br><span class="line">                stack.append(i)</span><br><span class="line">            <span class="keyword">elif</span> i == <span class="string">'..'</span> <span class="keyword">and</span> stack:</span><br><span class="line">                    stack.pop()</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'/'</span> + <span class="string">'/'</span>.join(stack)</span><br></pre></td></tr></table></figure><h1 id="å †-Heap"><a href="#å †-Heap" class="headerlink" title="å † Heap"></a>å † Heap</h1><h2 id="703-æ•°æ®æµä¸­çš„ç¬¬Kå¤§å…ƒç´ -Kth-Largest-Element-in-a-Stream"><a href="#703-æ•°æ®æµä¸­çš„ç¬¬Kå¤§å…ƒç´ -Kth-Largest-Element-in-a-Stream" class="headerlink" title="703. æ•°æ®æµä¸­çš„ç¬¬Kå¤§å…ƒç´  Kth Largest Element in a Stream"></a>703. æ•°æ®æµä¸­çš„ç¬¬Kå¤§å…ƒç´  Kth Largest Element in a Stream</h2><p><a href="https://leetcode-cn.com/problems/kth-largest-element-in-a-stream/" target="_blank" rel="noopener">LeetCodeCN ç¬¬703é¢˜é“¾æ¥</a></p><p>ç¬¬ä¸€ç§æ–¹æ³•ï¼šç›´æ¥å¯¹æ•´ä¸ª<code>nums</code>é™åºæ’åºï¼Œç„¶åå–ç¬¬kä¸ªå…ƒç´ è¿”å›ï¼Œ<code>add</code>æ—¶æ¯æ¬¡éƒ½å†åŠ å…¥è¿›<code>nums</code>ç„¶åæ’åºä¸€æ¬¡ï¼Œè¿™æ ·<code>add</code>æ“ä½œçš„æ—¶é—´å¤æ‚åº¦ä¸º<code>O(n*logn)</code>ï¼Œ<code>n</code>æ˜¯<code>nums</code>çš„é•¿åº¦</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">KthLargest</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, k: int, nums: List[int])</span>:</span></span><br><span class="line">        self.nums = nums</span><br><span class="line">        self.k = k</span><br><span class="line">        self.nums.sort(reverse = <span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">while</span> len(self.nums) &gt; k:</span><br><span class="line">            self.nums.pop()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(self, val: int)</span> -&gt; int:</span></span><br><span class="line">        self.nums.append(val)</span><br><span class="line">        self.nums.sort(reverse = <span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">if</span> len(self.nums) &gt; self.k:</span><br><span class="line">            self.nums.pop()</span><br><span class="line">        <span class="keyword">return</span> self.nums[<span class="number">-1</span>]</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ–¹æ³•ï¼šç»´æŠ¤ä¸€ä¸ªé•¿åº¦ä¸º<code>k</code>çš„æ•°ç»„ï¼Œåˆå§‹åŒ–æ—¶èµ‹å€¼ä¸ºé™åºæ’åºåçš„<code>nums</code>çš„å‰<code>k</code>ä¸ªå…ƒç´ ï¼Œ<code>add</code>æ“ä½œæ—¶å…ˆçœ‹å¦‚æœæ•°ç»„é•¿åº¦å°äº<code>k</code>çš„è¯å°±ç›´æ¥åŠ è¿›å»ç„¶åæ’åºä¸€æ¬¡ï¼Œå¦åˆ™å°±åˆ¤æ–­å¦‚æœ<code>val</code>å¤§äºæ•°ç»„æœ«å°¾çš„å…ƒç´ å°±å°†æœ«å°¾å…ƒç´ å‰”é™¤å¹¶åŠ å…¥<code>val</code>ç„¶åæ’åºä¸€æ¬¡ï¼Œå¦‚æœ<code>val</code>å°äºç­‰äºæ•°ç»„æœ«å°¾çš„å…ƒç´ å°±ä¸æ“ä½œï¼Œè¿™æ ·<code>add</code>æ“ä½œçš„æ—¶é—´å¤æ‚åº¦ä¸º<code>O(k*logk)</code>ï¼Œ<code>k</code>æ˜¯æ•°ç»„<code>k</code>çš„é•¿åº¦</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">KthLargest</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, k: int, nums: List[int])</span>:</span></span><br><span class="line">        self.kl = sorted(nums, reverse=<span class="literal">True</span>)[:k]</span><br><span class="line">        self.k = k</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(self, val: int)</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> len(self.kl) &lt; self.k:</span><br><span class="line">            self.kl.append(val)</span><br><span class="line">            self.kl.sort(reverse=<span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">elif</span> val &gt; self.kl[<span class="number">-1</span>]:</span><br><span class="line">            self.kl.pop()</span><br><span class="line">            self.kl.append(val)</span><br><span class="line">            self.kl.sort(reverse=<span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">return</span> self.kl[<span class="number">-1</span>]</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰ç§æ–¹æ³•ï¼šä½¿ç”¨å°é¡¶å †å®ç°çš„ä¼˜å…ˆé˜Ÿåˆ—ï¼ŒPython ä¸­æ ‡å‡†åº“ heapq å°±æ˜¯å°é¡¶å †ï¼Œé¦–å…ˆå°†<code>nums</code>å †åŒ–ï¼Œç„¶å<code>pop</code>å…ƒç´ ç›´åˆ°å †çš„é•¿åº¦ä¸º<code>k</code>ï¼Œ<code>add</code>æ“ä½œæ—¶å¦‚æœå †ä¸­å…ƒç´ ä¸æ»¡<code>k</code>ä¸ªå°±ç›´æ¥æŠŠå€¼<code>push</code>è¿›å †ï¼Œå¦‚æœå€¼å¤§äºå †é¡¶å…ƒç´ åˆ™æ›´æ–°å †ï¼Œæ—¶é—´å¤æ‚åº¦é™ä½ä¸º<code>O(logk)</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">KthLargest</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, k: int, nums: List[int])</span>:</span></span><br><span class="line">        self.pool, self.k = nums, k</span><br><span class="line">        heapq.heapify(self.pool)</span><br><span class="line">        <span class="keyword">while</span> len(self.pool) &gt; k:</span><br><span class="line">            heapq.heappop(self.pool)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(self, val: int)</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">if</span> len(self.pool) &lt; self.k:</span><br><span class="line">            heapq.heappush(self.pool, val)</span><br><span class="line">        <span class="keyword">elif</span> val &gt; self.pool[<span class="number">0</span>]:</span><br><span class="line">            heapq.heapreplace(self.pool, val)</span><br><span class="line">        <span class="keyword">return</span> self.pool[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Your KthLargest object will be instantiated and called as such:</span></span><br><span class="line"><span class="comment"># obj = KthLargest(k, nums)</span></span><br><span class="line"><span class="comment"># param_1 = obj.add(val)</span></span><br></pre></td></tr></table></figure><h2 id="215-æ•°ç»„ä¸­çš„ç¬¬Kä¸ªæœ€å¤§å…ƒç´ -Kth-Largest-Element-in-an-Array"><a href="#215-æ•°ç»„ä¸­çš„ç¬¬Kä¸ªæœ€å¤§å…ƒç´ -Kth-Largest-Element-in-an-Array" class="headerlink" title="215. æ•°ç»„ä¸­çš„ç¬¬Kä¸ªæœ€å¤§å…ƒç´  Kth Largest Element in an Array"></a>215. æ•°ç»„ä¸­çš„ç¬¬Kä¸ªæœ€å¤§å…ƒç´  Kth Largest Element in an Array</h2><p><a href="https://leetcode-cn.com/problems/kth-largest-element-in-an-array/" target="_blank" rel="noopener">LeetCodeCN ç¬¬215é¢˜é“¾æ¥</a></p><p>ç¬¬ä¸€ç§æ–¹æ³•ï¼šç”¨åº“å‡½æ•°æ’åºç›´æ¥è¿”å›ç¬¬<code>k</code>å¤§çš„å…ƒç´ ï¼Œæ—¶é—´å¤æ‚åº¦<code>O(n*logn)</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">findKthLargest</span><span class="params">(self, nums: List[int], k: int)</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">return</span> sorted(nums, reverse=<span class="literal">True</span>)[k<span class="number">-1</span>]</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ–¹æ³•ï¼šä¸ä¸Šé¢˜ä¸€æ ·ï¼Œä½¿ç”¨å°é¡¶å †å®ç°çš„ä¼˜å…ˆé˜Ÿåˆ—ï¼Œä¸€èˆ¬æƒ…å†µä¸‹æ—¶é—´å¤æ‚åº¦ä¸º<code>O(k + (n-k)*logk)</code>ï¼Œå½“<code>n</code>æå¤§æ—¶ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º<code>O(n*logk)</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">findKthLargest</span><span class="params">(self, nums: List[int], k: int)</span> -&gt; int:</span></span><br><span class="line">        heap = nums[:k]</span><br><span class="line">        heapq.heapify(heap)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> nums[k:]:</span><br><span class="line">            <span class="keyword">if</span> i &gt; heap[<span class="number">0</span>]:</span><br><span class="line">                heapq.heapreplace(heap, i)</span><br><span class="line">        <span class="keyword">return</span> heap[<span class="number">0</span>]</span><br></pre></td></tr></table></figure><h2 id="239-æ»‘åŠ¨çª—å£æœ€å¤§å€¼-Sliding-Window-Maximum"><a href="#239-æ»‘åŠ¨çª—å£æœ€å¤§å€¼-Sliding-Window-Maximum" class="headerlink" title="239. æ»‘åŠ¨çª—å£æœ€å¤§å€¼ Sliding Window Maximum"></a>239. æ»‘åŠ¨çª—å£æœ€å¤§å€¼ Sliding Window Maximum</h2><p><a href="https://leetcode-cn.com/problems/sliding-window-maximum/" target="_blank" rel="noopener">LeetCodeCN ç¬¬239é¢˜é“¾æ¥</a></p><p>ç¬¬ä¸€ç§æ–¹æ³•ï¼šç”¨ä¼˜å…ˆé˜Ÿåˆ—ï¼šå¤§é¡¶å †</p><p>ç¬¬äºŒç§æ–¹æ³•ï¼šå› ä¸ºçª—å£å¤§å°å›ºå®šï¼Œåªéœ€è¦ä¸€ä¸ªåŒç«¯é˜Ÿåˆ—å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">maxSlidingWindow</span><span class="params">(self, nums: List[int], k: int)</span> -&gt; List[int]:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> nums:</span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line">        window, res = [], []</span><br><span class="line">        <span class="keyword">for</span> i, x <span class="keyword">in</span> enumerate(nums):</span><br><span class="line">            <span class="keyword">if</span> i &gt;= k <span class="keyword">and</span> window[<span class="number">0</span>] &lt;= i - k:</span><br><span class="line">                window.pop(<span class="number">0</span>)</span><br><span class="line">            <span class="keyword">while</span> window <span class="keyword">and</span> nums[window[<span class="number">-1</span>]] &lt;= x:</span><br><span class="line">                window.pop()</span><br><span class="line">            window.append(i)</span><br><span class="line">            <span class="keyword">if</span> i &gt;= k - <span class="number">1</span>:</span><br><span class="line">                res.append(nums[window[<span class="number">0</span>]])</span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Algorithm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LeetCode </tag>
            
            <tag> Algorithm </tag>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LeetCodeåšé¢˜ç¬”è®°â€”é“¾è¡¨ç›¸å…³é¢˜ç›®</title>
      <link href="/2019-04-28-leetcode-linklist/"/>
      <url>/2019-04-28-leetcode-linklist/</url>
      
        <content type="html"><![CDATA[<p>æœ‰å…³é“¾è¡¨çš„åšé¢˜ç¬”è®°ï¼ŒPythonå®ç°</p><a id="more"></a><h2 id="é“¾è¡¨å®šä¹‰"><a href="#é“¾è¡¨å®šä¹‰" class="headerlink" title="é“¾è¡¨å®šä¹‰"></a>é“¾è¡¨å®šä¹‰</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for singly-linked list.</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ListNode</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, x)</span>:</span></span><br><span class="line">        self.val = x</span><br><span class="line">        self.next = <span class="literal">None</span></span><br></pre></td></tr></table></figure><h2 id="206-åè½¬é“¾è¡¨-Reverse-Linked-List"><a href="#206-åè½¬é“¾è¡¨-Reverse-Linked-List" class="headerlink" title="206. åè½¬é“¾è¡¨ Reverse Linked List"></a>206. åè½¬é“¾è¡¨ Reverse Linked List</h2><p><a href="https://leetcode-cn.com/problems/reverse-linked-list/" target="_blank" rel="noopener">LeetCodeCN ç¬¬206é¢˜é“¾æ¥</a></p><p>éå†é“¾è¡¨ï¼Œè¿­ä»£å‰èŠ‚ç‚¹prevï¼Œç¼“å­˜å½“å‰èŠ‚ç‚¹currentçš„ä¸‹ä¸€èŠ‚ç‚¹ï¼Œç„¶åæŠŠå½“å‰èŠ‚ç‚¹çš„nextæŒ‡é’ˆæŒ‡å‘å‰èŠ‚ç‚¹prev</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">reverseList</span><span class="params">(self, head: ListNode)</span> -&gt; ListNode:</span></span><br><span class="line">        current = head</span><br><span class="line">        prev = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">while</span> current:</span><br><span class="line">            tmp = current.next</span><br><span class="line">            current.next = prev</span><br><span class="line">            prev = current</span><br><span class="line">            current = tmp</span><br><span class="line">        <span class="keyword">return</span> prev</span><br></pre></td></tr></table></figure><p>ç”¨Pythonä¸‰å…ƒäº¤æ¢èƒ½åŒæ—¶èµ‹å€¼ä¸éœ€è¦ç¼“å­˜çš„ç‰¹æ€§å¯ä»¥ä¸€è¡Œå®Œæˆäº¤æ¢</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">reverseList</span><span class="params">(self, head: ListNode)</span> -&gt; ListNode:</span></span><br><span class="line">        current = head</span><br><span class="line">        prev = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">while</span> current:</span><br><span class="line">            current.next, prev, current = prev, current, current.next</span><br><span class="line">        <span class="keyword">return</span> prev</span><br></pre></td></tr></table></figure><h2 id="24-ä¸¤ä¸¤äº¤æ¢é“¾è¡¨ä¸­çš„èŠ‚ç‚¹-Swap-Nodes-in-Pairs"><a href="#24-ä¸¤ä¸¤äº¤æ¢é“¾è¡¨ä¸­çš„èŠ‚ç‚¹-Swap-Nodes-in-Pairs" class="headerlink" title="24. ä¸¤ä¸¤äº¤æ¢é“¾è¡¨ä¸­çš„èŠ‚ç‚¹ Swap Nodes in Pairs"></a>24. ä¸¤ä¸¤äº¤æ¢é“¾è¡¨ä¸­çš„èŠ‚ç‚¹ Swap Nodes in Pairs</h2><p><a href="https://leetcode-cn.com/problems/swap-nodes-in-pairs/" target="_blank" rel="noopener">LeetCodeCN ç¬¬24é¢˜é“¾æ¥</a></p><p>è®°å½•å½“å‰èŠ‚ç‚¹çš„å‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå½“å½“å‰èŠ‚ç‚¹å’Œä¸‹ä¸€èŠ‚ç‚¹éƒ½å­˜åœ¨æ—¶ï¼Œä¸‰å…ƒäº¤æ¢ä¸‰ä¸ªèŠ‚ç‚¹çš„nextæŒ‡é’ˆ<br>è¿”å›äº¤æ¢å®Œåçš„é¦–èŠ‚ç‚¹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">swapPairs</span><span class="params">(self, head: ListNode)</span> -&gt; ListNode:</span></span><br><span class="line">        prev, prev.next = self, head</span><br><span class="line">        <span class="keyword">while</span> prev.next <span class="keyword">and</span> prev.next.next:</span><br><span class="line">            l, r = prev.next, prev.next.next</span><br><span class="line">            prev.next, l.next, r.next = r, r.next, l</span><br><span class="line">            prev = l</span><br><span class="line">        <span class="keyword">return</span> self.next</span><br></pre></td></tr></table></figure><blockquote><p>çœ‹åˆ°å¥½å¤šå°ä¼™ä¼´åœ¨é—®ï¼Œæˆ‘æ¥å°è¯•è§£é‡Šä¸€ä¸‹â€œé“¾è¡¨äº¤æ¢ç›¸é‚»å…ƒç´ â€ä¸­ self æ˜¯æ€ä¹ˆå›äº‹ã€‚<br>1.é¦–å…ˆçœ‹åˆ°æœ€å return self.next ï¼Œå¯ä»¥çœ‹åˆ°ä½œè€…æ˜¯æƒ³æŠŠ self å½“åšé“¾è¡¨çš„å¤´æŒ‡é’ˆä½¿ç”¨çš„ï¼ˆæ³¨æ„ï¼šå¤´æŒ‡é’ˆ pHead ä¸ä¼ å…¥çš„å‚æ•° head æ˜¯ä¸åŒçš„ï¼Œhead æ˜¯ç¬¬ä¸€ä¸ªç»“ç‚¹ï¼Œè€Œ pHead.next == next ï¼‰ã€‚ç”¨å¤´æŒ‡é’ˆæœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿå› ä¸ºæˆ‘ä»¬è®©å¤´æŒ‡é’ˆçš„ next åŸŸï¼ˆpHead.nextï¼‰æ°¸è¿œæŒ‡å‘ç¬¬ä¸€ä¸ªç»“ç‚¹ï¼Œå°±æ˜¯é¿å…æœ€åè¿”å›çš„æ—¶å€™æ‰¾ä¸åˆ°ç¬¬ä¸€ä¸ªç»“ç‚¹äº†ã€‚<br>2.é‚£ä¹ˆä½œè€…ä¸ºä»€ä¹ˆå¯ä»¥ pre, pre.next = self, head è¿™æ ·å†™å‘¢ï¼Ÿå› ä¸º self æ˜¯è¿™ä¸ªç±»çš„ä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥åœ¨ç±»å®šä¹‰çš„æ—¶å€™å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ï¼Œç»™ self å¢åŠ æ–°çš„å±æ€§ã€‚ç›¸ä¿¡å¤§å®¶éƒ½çŸ¥é“åœ¨ <strong>init</strong>(self, attr) é‡Œé¢å¯ä»¥å®šä¹‰é€šè¿‡ self.myattr = attr æ¥å®šä¹‰ä¸€ä¸ª myattr å±æ€§ã€‚å…¶å®è¿™ä¸ªè¯­å¥å†™åœ¨ä»»æ„ä¸€ä¸ªç±»çš„æ–¹æ³•é‡Œéƒ½å¯ä»¥ï¼Œæ‰€ä»¥åœ¨åŸæ–‡ swapPairs() é‡Œé¢å½“ç„¶ä¹Ÿå¯ä»¥å®šä¹‰æ–°çš„å±æ€§ã€‚æ‰€ä»¥è¿™è¡Œä»£ç åº”è¯¥ç†è§£ä¸ºï¼Œpre æŒ‡å‘ selfï¼ˆè™½ç„¶ self ä¸æ˜¯ä¸€ä¸ª ListNode ç±»å‹çš„å¯¹è±¡ï¼Œä½†å®ƒåªè¦æœ‰ä¸€ä¸ª next å°±å¯ä»¥äº†ï¼‰ï¼ŒåŒæ—¶ä¸º preï¼ˆåŒæ—¶ä¹Ÿæ˜¯ä¸º selfï¼Œå®ƒä»¬æ˜¯ä¸€æ ·çš„ç°åœ¨ï¼‰å¢åŠ ä¸€ä¸ª next å±æ€§ï¼Œè¿™ä¸ª next å±æ€§æŒ‡å‘ç¬¬ä¸€ä¸ªç»“ç‚¹ headã€‚<br>3.æ˜ç™½ä¸Šé¢ä¹‹åï¼Œè¿™é‡Œå°±å¥½åŠäº†ã€‚åœ¨ç¬¬ä¸€æ¬¡ while å¾ªç¯çš„æ—¶å€™ï¼Œpre.next è¢«èµ‹å€¼ä¸º bï¼ˆä¹Ÿå°±æ˜¯åŸæ¥ç¬¬äºŒä¸ªç»“ç‚¹ï¼Œè½¬æ¢ä¸ºå˜æˆäº†ç¬¬ä¸€ä¸ªï¼Œä¹Ÿå°±æˆä¸ºäº†æ–°é“¾è¡¨çš„ç¬¬ä¸€ä¸ªç»“ç‚¹ã€‚å¦‚æœåŸæ¥æ˜¯[1,2,3,4]ï¼Œé‚£ä¹ˆç°åœ¨å°±æ˜¯[2,1,3,4]ï¼Œè¿™ä¸ª self.next å°±æ˜¯æŒ‡å‘ 2 è¿™ä¸ªç»“ç‚¹ï¼‰ã€‚æ‰€ä»¥æœ€ååªè¦è¿”å› self.next å°±å¾—åˆ°äº†ç­”æ¡ˆã€‚<br>å…¶å®æ¢ä¸ªå†™æ³•å¤§å®¶å°±å¥½ç†è§£å¾ˆå¤šäº†ï¼š<br>pHead = ListNode(None)<br>pre, pre.next = pHead, head<br>ä¹Ÿå°±æ˜¯è¯´ä¸ç”¨ self ä¹Ÿå¯ä»¥ï¼Œåªæ˜¯åŸä½œè€…ç§€äº†ä¸€æŠŠå°æŠ€å·§è€Œå·²ã€‚</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">swapPairs</span><span class="params">(self, head: ListNode)</span> -&gt; ListNode:</span></span><br><span class="line">        pHead = ListNode(<span class="literal">None</span>)</span><br><span class="line">        prev, prev.next = pHead, head</span><br><span class="line">        <span class="keyword">while</span> prev.next <span class="keyword">and</span> prev.next.next:</span><br><span class="line">            l, r = prev.next, prev.next.next</span><br><span class="line">            prev.next, l.next, r.next = r, r.next, l</span><br><span class="line">            prev = l</span><br><span class="line">        <span class="keyword">return</span> pHead.next</span><br></pre></td></tr></table></figure><h2 id="141-ç¯å½¢é“¾è¡¨-Linked-List-Cycle"><a href="#141-ç¯å½¢é“¾è¡¨-Linked-List-Cycle" class="headerlink" title="141. ç¯å½¢é“¾è¡¨ Linked List Cycle"></a>141. ç¯å½¢é“¾è¡¨ Linked List Cycle</h2><p><a href="https://leetcode-cn.com/problems/linked-list-cycle/" target="_blank" rel="noopener">LeetCodeCN ç¬¬141é¢˜é“¾æ¥</a></p><p>ä¸‰ç§æ–¹æ³•<br>1.ç¡¬åšï¼Œå¯ä»¥è®¾ç½®è¶…æ—¶æˆ–è€…å›ºå®šå¾ªç¯æ¬¡æ•°ï¼Œä¸é è°±<br>2.åšè®°å·ï¼Œä½¿ç”¨setæ¥å‚¨å­˜éå†è¿‡çš„èŠ‚ç‚¹ï¼Œéœ€è¦é¢å¤–å†…å­˜ç©ºé—´<br>3.å¿«æ…¢æŒ‡é’ˆï¼Œæ…¢æŒ‡é’ˆæ¯æ¬¡å‰ç§»ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¿«æŒ‡é’ˆæ¯æ¬¡å‰ç§»ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œå¦‚æœé“¾è¡¨å­˜åœ¨å¾ªç¯é‚£å¿«æ…¢æŒ‡é’ˆè‚¯å®šä¼šç›¸é‡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="comment"># 1.ç¡¬åš</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">hasCycle1</span><span class="params">(self, head)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        :type head: ListNode</span></span><br><span class="line"><span class="string">        :rtype: bool</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> head:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        curr = head</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">100000</span>):</span><br><span class="line">            curr = curr.next</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> curr:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 2.setè®°å½•</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">hasCycle2</span><span class="params">(self, head)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        :type head: ListNode</span></span><br><span class="line"><span class="string">        :rtype: bool</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        rec = set()</span><br><span class="line">        curr = head</span><br><span class="line">        <span class="keyword">while</span> curr:</span><br><span class="line">            <span class="keyword">if</span> curr <span class="keyword">in</span> rec:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">            rec.add(curr)</span><br><span class="line">            curr = curr.next</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 3.å¿«æ…¢æŒ‡é’ˆ</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">hasCycle3</span><span class="params">(self, head)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        :type head: ListNode</span></span><br><span class="line"><span class="string">        :rtype: bool</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        slow = fast = head</span><br><span class="line">        <span class="keyword">while</span> slow <span class="keyword">and</span> fast <span class="keyword">and</span> fast.next:</span><br><span class="line">            slow = slow.next</span><br><span class="line">            fast = fast.next.next</span><br><span class="line">            <span class="keyword">if</span> slow == fast:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br></pre></td></tr></table></figure><h2 id="142-ç¯å½¢é“¾è¡¨-II-Linked-List-Cycle-II"><a href="#142-ç¯å½¢é“¾è¡¨-II-Linked-List-Cycle-II" class="headerlink" title="142. ç¯å½¢é“¾è¡¨ II Linked List Cycle II"></a>142. ç¯å½¢é“¾è¡¨ II Linked List Cycle II</h2><p><a href="https://leetcode-cn.com/problems/linked-list-cycle-ii/" target="_blank" rel="noopener">LeetCodeCN ç¬¬142é¢˜é“¾æ¥</a></p><p>ç¬¬ä¸€ç§æ–¹æ³•è¿˜æ˜¯ä¸Šé¢çš„ç”¨å“ˆå¸Œè¡¨setæ¥è®°å½•ï¼Œå ç”¨ç©ºé—´</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">detectCycle</span><span class="params">(self, head)</span>:</span></span><br><span class="line">        curr, rec = head, set()</span><br><span class="line">        <span class="keyword">while</span> curr:</span><br><span class="line">            <span class="keyword">if</span> curr <span class="keyword">in</span> rec:</span><br><span class="line">                <span class="keyword">return</span> curr</span><br><span class="line">            rec.add(curr)</span><br><span class="line">            curr = curr.next</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ–¹æ³•ç”¨å¿«æ…¢æŒ‡é’ˆï¼Œå…ˆå¦‚ä¸Šé¢˜ä¸€æ ·æ£€æµ‹æ˜¯å¦æœ‰ç¯ï¼Œæœ‰çš„è¯è®¾ç½®ä¸€ä¸ªæ–°çš„æ£€æµ‹èŠ‚ç‚¹ä»å¤´(head)å¼€å§‹è¿­ä»£ï¼ŒåŒæ—¶slowèŠ‚ç‚¹ä¹Ÿç»§ç»­è¿­ä»£ï¼Œç›´åˆ°äºŒè€…ç›¸é‡çš„ç‚¹å°±æ˜¯ç¯çš„å…¥å£èŠ‚ç‚¹ã€‚</p><blockquote><p>åŸç†ï¼š<br>é¦–å…ˆï¼Œå¤´ç»“ç‚¹åˆ°å…¥ç¯ç»“ç‚¹çš„è·ç¦»ä¸ºaï¼Œå…¥ç¯ç»“ç‚¹åˆ°ç›¸é‡ç»“ç‚¹çš„è·ç¦»ä¸ºbï¼Œç›¸é‡ç»“ç‚¹åˆ°å…¥ç¯ç»“ç‚¹çš„è·ç¦»ä¸ºcã€‚ç„¶åï¼Œå½“fä»¥sçš„ä¸¤å€é€Ÿåº¦å‰è¿›å¹¶å’Œsç›¸é‡æ—¶ï¼Œfèµ°è¿‡çš„è·ç¦»æ˜¯sçš„ä¸¤å€ï¼Œå³æœ‰ç­‰å¼ï¼ša+b+c+b = 2(a+b) ï¼Œå¯ä»¥å¾—å‡º a = c ï¼Œæ‰€ä»¥è¯´ï¼Œè®©fastå’Œslowåˆ†åˆ«ä»ç›¸é‡ç»“ç‚¹å’Œå¤´ç»“ç‚¹åŒæ—¶åŒæ­¥é•¿å‡ºå‘ï¼Œä»–ä»¬çš„ç›¸é‡ç»“ç‚¹å°±æ˜¯å…¥ç¯ç»“ç‚¹ã€‚<br>å½“å¿«ã€æ…¢æŒ‡é’ˆåŒæ—¶ä»å…¥ç¯ç‚¹å‡ºå‘ï¼Œé‚£ä¹ˆä¸€å®šä¼šåœ¨å…¥ç¯ç‚¹ç›¸é‡ã€‚å¦‚æœå¿«ã€æ…¢æŒ‡é’ˆåŒæ—¶ä»å…¥ç¯ç‚¹å‰ä¸€èŠ‚ç‚¹å‡ºå‘ï¼Œé‚£ä¹ˆå¿«æ…¢ã€æŒ‡é’ˆåˆ™ä¼šåœ¨å…¥ç¯ç‚¹çš„å‰ä¸€èŠ‚ç‚¹ç›¸é‡ï¼Œä»¥æ­¤ç±»æ¨ã€‚</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">detectCycle</span><span class="params">(self, head)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        :type head: ListNode</span></span><br><span class="line"><span class="string">        :rtype: ListNode</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        slow = fast = head</span><br><span class="line">        <span class="keyword">while</span> slow <span class="keyword">and</span> fast <span class="keyword">and</span> fast.next:</span><br><span class="line">            slow = slow.next</span><br><span class="line">            fast = fast.next.next</span><br><span class="line">            <span class="keyword">if</span> slow == fast:</span><br><span class="line">                detection = head</span><br><span class="line">                <span class="keyword">while</span> slow != detection:</span><br><span class="line">                    slow = slow.next</span><br><span class="line">                    detection = detection.next</span><br><span class="line">                <span class="keyword">return</span> detection</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br></pre></td></tr></table></figure><h2 id="25-kä¸ªä¸€ç»„ç¿»è½¬é“¾è¡¨-Reverse-Nodes-in-k-Group"><a href="#25-kä¸ªä¸€ç»„ç¿»è½¬é“¾è¡¨-Reverse-Nodes-in-k-Group" class="headerlink" title="25. kä¸ªä¸€ç»„ç¿»è½¬é“¾è¡¨ Reverse Nodes in k-Group"></a>25. kä¸ªä¸€ç»„ç¿»è½¬é“¾è¡¨ Reverse Nodes in k-Group</h2><p><a href="https://leetcode-cn.com/problems/reverse-nodes-in-k-group/" target="_blank" rel="noopener">LeetCodeCN ç¬¬25é¢˜é“¾æ¥</a></p><p>ç¬¬ä¸€ç§æ–¹æ³•ï¼šåˆ©ç”¨æ•°ç»„æ¥å®ç°kä¸ªä¸€ç»„çš„ç¿»è½¬ï¼Œç„¶åé‡æ–°è¿æ¥æˆé“¾è¡¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">reverseKGroup</span><span class="params">(self, head: ListNode, k: int)</span> -&gt; ListNode:</span></span><br><span class="line">        arr, i = [], <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> head:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="keyword">while</span> head:</span><br><span class="line">            arr.append(head)</span><br><span class="line">            head = head.next</span><br><span class="line">        <span class="keyword">while</span> i &lt;= len(arr) - k:</span><br><span class="line">            arr[i:i+k] = arr[i:i+k][::<span class="number">-1</span>]</span><br><span class="line">            i += k</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(len(arr) - <span class="number">1</span>):</span><br><span class="line">            arr[j].next = arr[j+<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">if</span> arr:</span><br><span class="line">            arr[<span class="number">-1</span>].next = <span class="literal">None</span></span><br><span class="line">            <span class="keyword">return</span> arr[<span class="number">0</span>]</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ–¹æ³•ï¼šç”¨æ ˆï¼Œæˆ‘ä»¬æŠŠ k ä¸ªæ•°å‹å…¥æ ˆä¸­ï¼Œç„¶åå¼¹å‡ºæ¥çš„é¡ºåºå°±æ˜¯ç¿»è½¬çš„ã€‚è¿™é‡Œè¦æ³¨æ„å‡ ä¸ªé—®é¢˜ï¼š1.å‰©ä¸‹çš„é“¾è¡¨ä¸ªæ•°å¤Ÿä¸å¤Ÿ k ä¸ªï¼ˆå› ä¸ºä¸å¤Ÿ k ä¸ªä¸ç”¨ç¿»è½¬ï¼‰ï¼›2.å·²ç»ç¿»è½¬çš„éƒ¨åˆ†è¦ä¸å‰©ä¸‹é“¾è¡¨è¿æ¥èµ·æ¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">reverseKGroup</span><span class="params">(self, head: ListNode, k: int)</span> -&gt; ListNode:</span></span><br><span class="line">        dummy = ListNode(<span class="number">0</span>)</span><br><span class="line">        p = dummy</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            count = k </span><br><span class="line">            stack = []</span><br><span class="line">            tmp = head</span><br><span class="line">            <span class="keyword">while</span> count <span class="keyword">and</span> tmp:</span><br><span class="line">                stack.append(tmp)</span><br><span class="line">                tmp = tmp.next</span><br><span class="line">                count -= <span class="number">1</span></span><br><span class="line">            <span class="comment"># æ³¨æ„,ç›®å‰tmpæ‰€åœ¨k+1ä½ç½®</span></span><br><span class="line">            <span class="comment"># è¯´æ˜å‰©ä¸‹çš„é“¾è¡¨ä¸å¤Ÿkä¸ª,è·³å‡ºå¾ªç¯</span></span><br><span class="line">            <span class="keyword">if</span> count : </span><br><span class="line">                p.next = head</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="comment"># ç¿»è½¬æ“ä½œ</span></span><br><span class="line">            <span class="keyword">while</span> stack:</span><br><span class="line">                p.next = stack.pop()</span><br><span class="line">                p = p.next</span><br><span class="line">            <span class="comment">#ä¸å‰©ä¸‹é“¾è¡¨è¿æ¥èµ·æ¥ </span></span><br><span class="line">            p.next = tmp</span><br><span class="line">            head = tmp</span><br><span class="line">        <span class="keyword">return</span> dummy.next</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰ç§æ–¹æ³•ï¼šé€’å½’ï¼Œåˆ©ç”¨206é¢˜åè½¬é“¾è¡¨çš„å‡½æ•°ç¨åŠ æ”¹é€ ï¼Œæ·»åŠ ä¸€ä¸ªcountå‚æ•°æå‰ç»“æŸåè½¬ã€‚æ¯æ¬¡é€’å½’ä¸»å‡½æ•°æ—¶å³å¤„ç†å½“å‰kä¸ªçš„åè½¬ç„¶åé“¾è¡¨å°¾ç«¯æ¥ä¸Šä¸‹ä¸€ä¸ªé€’å½’çš„å€¼ï¼Œæ³¨æ„å…¶ä¸­ç¬¬12è¡Œçš„<code>head.next</code>ï¼Œå› ä¸ºç»è¿‡ä¸Šä¸€è¡Œçš„åè½¬åï¼Œ<code>head</code>å°±æˆäº†æœ¬æ¬¡å¤„ç†kä¸ªçš„æœ«å°¾èŠ‚ç‚¹ï¼Œ<code>prev</code>æˆäº†æœ¬æ¬¡çš„å¤´èŠ‚ç‚¹ï¼Œè€Œ<code>new_head</code>ä¸º<code>head</code>çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ä¹Ÿå³ä¸‹ä¸€ä¸ªé€’å½’çš„å¤´èŠ‚ç‚¹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">reverseKGroup</span><span class="params">(self, head: ListNode, k: int)</span> -&gt; ListNode:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> head:</span><br><span class="line">            <span class="keyword">return</span> head</span><br><span class="line">        p, count = head, k</span><br><span class="line">        <span class="keyword">while</span> p <span class="keyword">and</span> count:</span><br><span class="line">            p = p.next</span><br><span class="line">            count -= <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> count &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> head</span><br><span class="line">        prev, new_head = self.reverse(head, k)</span><br><span class="line">        head.next = self.reverseKGroup(new_head, k)</span><br><span class="line">        <span class="keyword">return</span> prev</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">reverse</span><span class="params">(self, node, count)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> node:</span><br><span class="line">            <span class="keyword">return</span> node</span><br><span class="line">        prev, curr = <span class="literal">None</span>, node</span><br><span class="line">        <span class="keyword">while</span> curr <span class="keyword">and</span> count:</span><br><span class="line">            curr.next, prev, curr = prev, curr, curr.next</span><br><span class="line">            count -= <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> (prev, curr)</span><br></pre></td></tr></table></figure><h2 id="2-ä¸¤æ•°ç›¸åŠ -Add-Two-Numbers"><a href="#2-ä¸¤æ•°ç›¸åŠ -Add-Two-Numbers" class="headerlink" title="2. ä¸¤æ•°ç›¸åŠ  Add Two Numbers"></a>2. ä¸¤æ•°ç›¸åŠ  Add Two Numbers</h2><p><a href="https://leetcode-cn.com/problems/add-two-numbers/" target="_blank" rel="noopener">LeetCodeCN ç¬¬2é¢˜é“¾æ¥</a></p><p>è§£æ³•å¾ˆå®¹æ˜“æƒ³åˆ°ï¼Œä½†æ˜¯ä»£ç å®ç°ä¸å®¹æ˜“ï¼Œéœ€è¦å°å¿ƒå¤„ç†è¿›ä½</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">addTwoNumbers</span><span class="params">(self, l1: ListNode, l2: ListNode)</span> -&gt; ListNode:</span></span><br><span class="line">        dummy = ListNode(<span class="number">0</span>)</span><br><span class="line">        node = dummy</span><br><span class="line">        carry = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> l1 <span class="keyword">or</span> l2:</span><br><span class="line">            x = l1.val <span class="keyword">if</span> l1 <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">            y = l2.val <span class="keyword">if</span> l2 <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">            s = carry + x + y</span><br><span class="line">            carry = s//<span class="number">10</span></span><br><span class="line">            node.next = ListNode(s%<span class="number">10</span>)</span><br><span class="line">            node = node.next</span><br><span class="line">            <span class="keyword">if</span> l1:</span><br><span class="line">                l1 = l1.next</span><br><span class="line">            <span class="keyword">if</span> l2:</span><br><span class="line">                l2 = l2.next</span><br><span class="line">        <span class="keyword">if</span> carry:</span><br><span class="line">            node.next = ListNode(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> dummy.next</span><br></pre></td></tr></table></figure><h2 id="21-åˆå¹¶ä¸¤ä¸ªæœ‰åºé“¾è¡¨-Merge-Two-Sorted-Lists"><a href="#21-åˆå¹¶ä¸¤ä¸ªæœ‰åºé“¾è¡¨-Merge-Two-Sorted-Lists" class="headerlink" title="21. åˆå¹¶ä¸¤ä¸ªæœ‰åºé“¾è¡¨ Merge Two Sorted Lists"></a>21. åˆå¹¶ä¸¤ä¸ªæœ‰åºé“¾è¡¨ Merge Two Sorted Lists</h2><p><a href="https://leetcode-cn.com/problems/merge-two-sorted-lists/" target="_blank" rel="noopener">LeetCodeCN ç¬¬21é¢˜</a></p><p>ç¬¬ä¸€ç§æ–¹æ³•ï¼šè¿­ä»£ï¼Œæ‰§è¡Œé€»è¾‘æ¯”è¾ƒç›´è§‚ï¼Œç”±äºæ¯ä¸ªèŠ‚ç‚¹ä»…è®¿é—®ä¸€æ¬¡ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º<code>O(n+m)</code>ï¼Œ<code>n</code>ã€<code>m</code>åˆ†åˆ«ä¸ºä¸¤ä¸ªé“¾è¡¨çš„é•¿åº¦ï¼Œç„¶åå› ä¸ºä»…ç”¨åˆ°å‡ ä¸ªè¾…åŠ©å˜é‡ï¼Œç©ºé—´å¤æ‚åº¦ä¸º<code>O(1)</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">mergeTwoLists</span><span class="params">(self, l1: ListNode, l2: ListNode)</span> -&gt; ListNode:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> l1 <span class="keyword">and</span> <span class="keyword">not</span> l2:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        p = dummy = ListNode(<span class="literal">None</span>)</span><br><span class="line">        <span class="keyword">while</span> l1 <span class="keyword">and</span> l2:</span><br><span class="line">            <span class="keyword">if</span> l1.val &lt; l2.val:</span><br><span class="line">                p.next = l1</span><br><span class="line">                l1 = l1.next</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                p.next = l2</span><br><span class="line">                l2 = l2.next</span><br><span class="line">            p = p.next</span><br><span class="line">        p.next = l1 <span class="keyword">if</span> l1 <span class="keyword">else</span> l2</span><br><span class="line">        <span class="keyword">return</span> dummy.next</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ–¹æ³•ï¼šé€’å½’ï¼Œéœ€è¦é€’å½’<code>n</code>+<code>m</code>æ¬¡ï¼Œé€’å½’è°ƒç”¨æ ˆå ç”¨ç©ºé—´ï¼Œç©ºé—´å¤æ‚åº¦ä¸º<code>O(n+m)</code>ï¼Œå› ä¸ºæ¯ä¸ªèŠ‚ç‚¹ä¹Ÿåªè®¿é—®ä¸€æ¬¡ï¼Œæ—¶é—´å¤æ‚åº¦<code>O(n+m)</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">mergeTwoLists</span><span class="params">(self, l1: ListNode, l2: ListNode)</span> -&gt; ListNode:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> l1:</span><br><span class="line">            <span class="keyword">return</span> l2</span><br><span class="line">        <span class="keyword">elif</span> <span class="keyword">not</span> l2:</span><br><span class="line">            <span class="keyword">return</span> l1</span><br><span class="line">        <span class="keyword">if</span> l1.val &lt; l2.val:</span><br><span class="line">            l1.next = self.mergeTwoLists(l1.next, l2)</span><br><span class="line">            <span class="keyword">return</span> l1</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            l2.next = self.mergeTwoLists(l1, l2.next)</span><br><span class="line">            <span class="keyword">return</span> l2</span><br></pre></td></tr></table></figure><h2 id="23-åˆå¹¶Kä¸ªæ’åºé“¾è¡¨-Merge-k-Sorted-Lists"><a href="#23-åˆå¹¶Kä¸ªæ’åºé“¾è¡¨-Merge-k-Sorted-Lists" class="headerlink" title="23. åˆå¹¶Kä¸ªæ’åºé“¾è¡¨ Merge k Sorted Lists"></a>23. åˆå¹¶Kä¸ªæ’åºé“¾è¡¨ Merge k Sorted Lists</h2><p><a href="https://leetcode-cn.com/problems/merge-k-sorted-lists/" target="_blank" rel="noopener">LeetCodeCN ç¬¬23é¢˜é“¾æ¥</a></p><p>ç¬¬ä¸€ç§æ–¹æ³•ï¼šåˆ†è€Œæ²»ä¹‹ï¼Œåˆ©ç”¨ç¬¬21é¢˜åˆå¹¶ä¸¤ä¸ªæœ‰åºé“¾è¡¨çš„ç®—æ³•ï¼Œé€ä¸ªåˆå¹¶kä¸ªé“¾è¡¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">mergeKLists</span><span class="params">(self, lists: List[ListNode])</span> -&gt; ListNode:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> lists:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        self.lists = lists</span><br><span class="line">        <span class="keyword">return</span> self.divide(<span class="number">0</span>, len(lists)<span class="number">-1</span>)</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">divide</span><span class="params">(self, l, r)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> l == r:</span><br><span class="line">            <span class="keyword">return</span> self.lists[l]</span><br><span class="line">        mid = r + (l - r) // <span class="number">2</span></span><br><span class="line">        l1 = self.divide(l, mid)</span><br><span class="line">        l2 = self.divide(mid+<span class="number">1</span>, r)</span><br><span class="line">        <span class="keyword">return</span> self.mergeTwoLists(l1, l2)</span><br><span class="line">            </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">mergeTwoLists</span><span class="params">(self, l1, l2)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> l1 <span class="keyword">and</span> <span class="keyword">not</span> l2:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        p = dummy = ListNode(<span class="literal">None</span>)</span><br><span class="line">        <span class="keyword">while</span> l1 <span class="keyword">and</span> l2:</span><br><span class="line">            <span class="keyword">if</span> l1.val &lt; l2.val:</span><br><span class="line">                p.next = l1</span><br><span class="line">                l1 = l1.next</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                p.next = l2</span><br><span class="line">                l2 = l2.next</span><br><span class="line">            p = p.next</span><br><span class="line">        p.next = l1 <span class="keyword">if</span> l1 <span class="keyword">else</span> l2</span><br><span class="line">        <span class="keyword">return</span> dummy.next</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ–¹æ³•ï¼šä¼˜å…ˆçº§é˜Ÿåˆ—ï¼ˆå°é¡¶å †ï¼‰ï¼Œ<code>Python3</code>ä¸­<code>heapq</code>å­˜å‚¨å¯¹è±¡äºŒå…ƒç»„ä¼šå¯¼è‡´ä¸å¯æ¯”è¾ƒçš„é”™è¯¯ï¼Œæ‰€ä»¥ç”¨å­˜å‚¨ä¸‰å…ƒç»„ï¼Œä¸­é—´ç”¨ä¸€ä¸ªæ•°å€¼éš”å¼€</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">mergeKLists</span><span class="params">(self, lists: List[ListNode])</span> -&gt; ListNode:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> lists:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        heap = []</span><br><span class="line">        p = dummy = ListNode(<span class="literal">None</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(lists)):</span><br><span class="line">            <span class="keyword">if</span> lists[i]:</span><br><span class="line">                heapq.heappush(heap, (lists[i].val, i, lists[i]))</span><br><span class="line">        <span class="keyword">while</span> heap:</span><br><span class="line">            node = heapq.heappop(heap)</span><br><span class="line">            i = node[<span class="number">1</span>]</span><br><span class="line">            p.next = node[<span class="number">2</span>]</span><br><span class="line">            p = p.next</span><br><span class="line">            <span class="keyword">if</span> p.next:</span><br><span class="line">                heapq.heappush(heap, (p.next.val, i, p.next))</span><br><span class="line">        <span class="keyword">return</span> dummy.next</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Algorithm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LeetCode </tag>
            
            <tag> Algorithm </tag>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…³äº NSUserDefaults setBool çš„å€¼å–å‡ºåifåˆ¤æ–­ä¸äº†çš„é—®é¢˜</title>
      <link href="/2019-04-23-nsuserdefaults-setbool-forkey/"/>
      <url>/2019-04-23-nsuserdefaults-setbool-forkey/</url>
      
        <content type="html"><![CDATA[<p>ä½¿ç”¨  <code>[[NSUserDefaults standardUserDefaults] setBool:(BOOL)value forKey:(NSString *)defaultName]</code> è®¾ç½®çš„å€¼ï¼Œå¦‚æœç”¨æ™®é€šçš„<code>objectForKey:</code>å–å‡ºçš„å€¼æ˜¯<code>__NSCFBoolean</code>ç±»å‹ï¼Œ<code>if</code>è¯­å¥æ— æ³•åˆ¤æ–­ï¼Œå³ä½¿ååŠ <code>== YES</code>ä¹Ÿæ²¡ç”¨ï¼Œè¿˜ä¼šå‡ºé—®é¢˜ã€‚</p><a id="more"></a><p>è¦ç”¨ <code>[[NSUserDefaults standardUserDefaults] boolForKey:(NSString *)defaultName]</code> æ¥å–å€¼ï¼Œ</p><p>åŒç†ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)setInteger:(<span class="built_in">NSInteger</span>)value forKey:(<span class="built_in">NSString</span> *)defaultName;</span><br><span class="line">- (<span class="keyword">void</span>)setFloat:(<span class="keyword">float</span>)value forKey:(<span class="built_in">NSString</span> *)defaultName;</span><br><span class="line">- (<span class="keyword">void</span>)setDouble:(<span class="keyword">double</span>)value forKey:(<span class="built_in">NSString</span> *)defaultName;</span><br><span class="line">- (<span class="keyword">void</span>)setBool:(<span class="built_in">BOOL</span>)value forKey:(<span class="built_in">NSString</span> *)defaultName;</span><br><span class="line">- (<span class="keyword">void</span>)setURL:(<span class="keyword">nullable</span> <span class="built_in">NSURL</span> *)url forKey:(<span class="built_in">NSString</span> *)defaultName;</span><br></pre></td></tr></table></figure><p>å¦‚ä¸Šæ‰€ç¤ºç­‰å…¥å€¼æ–¹æ³•ï¼Œéƒ½ç”¨å¯¹åº”é…å¥—çš„å–å€¼æ–¹æ³•</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">NSInteger</span>)integerForKey:(<span class="built_in">NSString</span> *)defaultName;</span><br><span class="line">- (<span class="keyword">float</span>)floatForKey:(<span class="built_in">NSString</span> *)defaultName;</span><br><span class="line">- (<span class="keyword">double</span>)doubleForKey:(<span class="built_in">NSString</span> *)defaultName;</span><br><span class="line">- (<span class="built_in">BOOL</span>)boolForKey:(<span class="built_in">NSString</span> *)defaultName;</span><br><span class="line">- (<span class="keyword">nullable</span> <span class="built_in">NSURL</span> *)URLForKey:(<span class="built_in">NSString</span> *)defaultName;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Note </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
            <tag> Objective-C </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•é¢è¯•ä¸€ä¸ª iOS å·¥ç¨‹å¸ˆ</title>
      <link href="/2019-04-09-how-to-interview-an-ios-developer/"/>
      <url>/2019-04-09-how-to-interview-an-ios-developer/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¨èåº"><a href="#æ¨èåº" class="headerlink" title="æ¨èåº"></a>æ¨èåº</h2><p>ç§ä¸‹å’Œå¾ˆå¤šæœ‹å‹äº¤æµè¿‡è¿™ä¸ªè¯é¢˜ï¼Œå¤§éƒ¨åˆ†æ±‚èŒè€…è®¤ä¸ºï¼Œæˆ‘èƒ½åšåŸºæœ¬çš„ iOS å¼€å‘å·¥ä½œï¼Œå°±è¾¾åˆ°å…¬å¸çš„è¦æ±‚äº†ï¼Œæ®Šä¸çŸ¥å…¬å¸æ‹›è˜å‘˜å·¥ï¼Œæ›´å¸Œæœ›çš„æ˜¯è¿™ä¸ªäººèƒ½å¤Ÿåœ¨å…³é”®æ—¶å€™èƒ½å¤Ÿå‘æŒ¥ä¸€èˆ¬äººåšä¸åˆ°çš„èƒ½åŠ›ã€‚</p><p>è¿™ç¯‡æ–‡ç« æ˜¯æ¥è‡ªå¾®ä¿¡è¯»ä¹¦çš„ bang ï¼Œæˆ‘å®Œå…¨åŒæ„ä»–çš„è§‚ç‚¹ã€‚é™¤äº†ä»–çš„è¿™äº›é¢è¯•æ–¹æ³•å¤–ï¼Œæˆ‘è¿˜è®¤ä¸ºåšæ¯”è¯´æ›´é‡è¦ï¼Œæ‰€ä»¥æˆ‘æ›´å–œæ¬¢åœ¨é¢è¯•çš„æ—¶å€™ï¼Œæ‹¿å‡ºä¸€å¼ ç™½çº¸ï¼Œè®©æ±‚èŒè€…å†™ä¸€æ®µå¯Œæœ‰é€»è¾‘æ€§çš„ä»£ç ï¼Œçœ‹çœ‹ä»–çš„æ€ç»´æ˜¯å¦ä¸¥è°¨ï¼Œå¯¹äºä¸€äº›å¸¸è§çš„æ•°æ®ç»“æ„å’Œç®—æ³•åŸºç¡€æœ‰äº†è§£ã€‚</p><p>ä½œè€…ä»‹ç»ï¼šbangï¼ŒiOS å¼€å‘è€…ï¼Œæ¨ç‰¹ä¸­æ–‡åœˆ / JSPatchä½œè€…ï¼Œåšå®¢ <a href="http://cnbang.net" target="_blank" rel="noopener">http://cnbang.net</a> ï¼Œ ç›®å‰å°±èŒäºå¹¿å·è…¾è®¯ã€‚</p><a id="more"></a><p><a href="https://mp.weixin.qq.com/s/ml4EWoEiKUaM1H-WTrDbuw" target="_blank" rel="noopener">æœ¬æ–‡è½¬è½½è‡ªå”å·§çš„å…¬ä¼—å·</a></p><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><p>å‚åŠ äº†å†…éƒ¨é¢å§”ä¼šçš„ä¸€ä¸ªåˆ†äº«ï¼Œç»“åˆæˆ‘è‡ªå·±çš„æ–¹å¼ï¼Œè¯´è¯´æ€æ ·é¢è¯•ä¸€ä¸ªæ™®é€šçš„ iOS å·¥ç¨‹å¸ˆã€‚</p><p>ä¸€èˆ¬æˆ‘å€¾å‘çš„è€ƒå¯Ÿåˆ†ä¸¤ä¸ªä¸»è¦çš„éƒ¨åˆ†ï¼Œç¬¬ä¸€æ˜¯åœ¨ç®€å†é‡Œæåˆ°çš„é¡¹ç›®ç»å†ä¸­æ‰¾æŒ–æ˜ç‚¹ï¼Œç¬¬äºŒæ˜¯åŸºç¡€çŸ¥è¯†è€ƒå¯Ÿã€‚å¦å¤–ä¹Ÿä¼šçœ‹æƒ…å†µåšä¸€äº›è½¯å®åŠ›çš„è€ƒå¯Ÿå’Œæ€§æ ¼ç‰¹å¾çš„åˆ¤æ–­ã€‚</p><h3 id="é¡¹ç›®ç»å†"><a href="#é¡¹ç›®ç»å†" class="headerlink" title="é¡¹ç›®ç»å†"></a>é¡¹ç›®ç»å†</h3><p>å¦‚æœé¡ºåˆ©çš„è¯è¿™ç¬¬ä¸€æ­¥å çš„æ¯”ä¾‹ä¼šå¾ˆå¤§ï¼Œå› ä¸ºæ¯ä¸ªç¨‹åºå‘˜éƒ½ä¸ä¼šæ–¹æ–¹é¢é¢çŸ¥è¯†éƒ½ç†Ÿæ‚‰ï¼Œä½†è‡³å°‘ä»–å†™åœ¨ç®€å†ä¸Šçš„åšè¿‡çš„é¡¹ç›®æ˜¯ç†Ÿæ‚‰çš„ï¼Œè®²è‡ªå·±ç†Ÿæ‚‰çš„ä¸œè¥¿å®¹æ˜“è®©ä»–è¿›å…¥çŠ¶æ€ï¼Œå±•ç¤ºå¥½çš„ä¸€é¢ã€‚è¿™é‡Œä¸»è¦è€ƒå¯Ÿä¸¤æ–¹é¢ï¼Œä¸€æ˜¯æœ‰æ²¡æœ‰åœ¨æŸäº›ç‚¹ä¸Šæœ‰è¿‡æ·±å…¥ç ”ç©¶ã€‚äºŒæ˜¯å¯¹é¡¹ç›®æ•´ä½“äº†è§£å¦‚ä½•ã€‚</p><h3 id="æ·±å…¥ç ”ç©¶"><a href="#æ·±å…¥ç ”ç©¶" class="headerlink" title="æ·±å…¥ç ”ç©¶"></a>æ·±å…¥ç ”ç©¶</h3><p>åœ¨ä¸­å¤§å‹çš„å…¬å¸é‡Œæ¯”è¾ƒæ³¨é‡å·¥ç¨‹å¸ˆæœ‰æ·±å…¥ç ”ç©¶çš„èƒ½åŠ›ï¼Œå¦‚æœèƒ½æŠŠä¸€ä¸ªåŠŸèƒ½è®²å¾—å¾ˆæ¸…æ™°æ˜¯æ¯”è¾ƒå¥½çš„åŠ åˆ†é¡¹ï¼Œè¿™é‡Œä¼šé—®å®ç°çš„æ€è·¯ï¼Œé€šè¿‡è¿½é—®å»äº†è§£å€™é€‰äººåœ¨è¿™å—æ·±å…¥çš„ç¨‹åº¦ï¼Œä»æ€è·¯åˆ°æ–¹æ³•ï¼Œä»ä¸Šå±‚ API è°ƒç”¨åˆ°æ¡†æ¶æµç¨‹å†åˆ°åº•å±‚å®ç°ã€‚å¦‚æœå€™é€‰äººåœ¨è®²è¿°æ—¶æœ‰ä¸€æ¡é€»è¾‘ä¸»çº¿ï¼Œä¾‹å¦‚è®²è¿°ä¸šç•Œæ™®éæ˜¯æ€ä¹ˆåšçš„ï¼Œè‡ªå·±åœ¨ä¸šç•Œæ–¹æ¡ˆåŸºç¡€ä¸Šåšäº†ä»€ä¹ˆæ”¹è¿›ï¼Œæ€æ ·åšåˆ°æ›´å¥½ï¼Œè¿›ä¸€æ­¥æ”¹è¿›çš„æ€è·¯æ˜¯æ€æ ·ï¼Œè¿™æ˜¯æœ€å¥½çš„ã€‚å¦‚æœè¿˜èƒ½æŠŠè§£å†³é—®é¢˜çš„æ–¹æ³•å½’çº³èµ·æ¥è¿ç”¨åœ¨å…¶ä»–åœ°æ–¹ï¼Œèƒ½ä¸¾ä¸€åä¸‰ï¼ŒåŒ…è£…æˆé€šç”¨è§£å†³æ–¹æ¡ˆï¼Œæˆ–è€…åšå¼€æºè´¡çŒ®ï¼Œå°±æ›´å¥½äº†ã€‚</p><p>ä¸€èˆ¬ä¼šé—®å€™é€‰äººå“ªä¸€ä¸ªé¡¹ç›®æŠ€æœ¯ç‚¹æœ€èƒ½ä½“ç°è‡ªå·±çš„æŠ€æœ¯ï¼Œç„¶åä¸åœè¿½é—®æŠ€æœ¯ç»†èŠ‚ï¼Œä¾‹å¦‚åšäº†ä¸€ä¸ªç›¸å†Œé¡¹ç›®ï¼Œè§‰å¾—åˆ—è¡¨ä¼˜åŒ–æ˜¯æœ€èƒ½ä½“ç°æŠ€æœ¯ç‚¹çš„ï¼Œä¼šé—®è¿™é‡Œä¼˜åŒ–çš„æ€è·¯æ˜¯ä»€ä¹ˆï¼Œæ€æ ·è¯„ä¼°ï¼Œé‡åˆ°è¿‡ä»€ä¹ˆå›°éš¾ï¼Œæ€ä¹ˆè§£å†³çš„ï¼Œå¦‚æœç”¨åˆ°å›¾ç‰‡ç¼“å­˜å¼€æºé¡¹ç›®ï¼Œè¯´è¯´å®ƒå…·ä½“åšäº†ä»€ä¹ˆäº‹ï¼Œç¼“å­˜ç­–ç•¥æ˜¯ä»€ä¹ˆï¼Œä»ä¸‹è½½åˆ°æ˜¾ç¤ºçš„æ•´ä¸ªæµç¨‹æ˜¯æ€æ ·çš„ï¼Œè¿˜æœ‰æ²¡æœ‰æ›´å¥½çš„æ–¹æ¡ˆï¼Œè¿½é—®åˆ°ä¸€å®šç¨‹åº¦åä¹Ÿä¼šå‘æ•£å»é—®è·Ÿè¿™ä¸ªè¯é¢˜ç›¸å…³è”çš„é—®é¢˜ï¼Œä¾‹å¦‚å¦‚æœæœ‰éƒ¨åˆ†ç”¨æˆ·åé¦ˆå›¾ç‰‡æ˜¾ç¤ºä¸äº†ï¼Œä½ ä¼šæ€æ ·æ’æŸ¥é—®é¢˜ï¼Œæ’æŸ¥ä¿®å¤åæ€æ ·ç›‘æ§ï¼Œå°±ä¼šè¿‡åº¦åˆ°ä¸€äº›ç½‘ç»œå’Œè¿è¥ç›‘æ§æ–¹é¢çš„å†…å®¹ï¼Œä¹Ÿä¼šé¡ºä¾¿é—®åˆ°ä¸€äº›åŸºç¡€çŸ¥è¯†ã€‚</p><h3 id="æ•´ä½“äº†è§£"><a href="#æ•´ä½“äº†è§£" class="headerlink" title="æ•´ä½“äº†è§£"></a>æ•´ä½“äº†è§£</h3><p>é—®å®Œè‡ªå·±èŒè´£èŒƒå›´å†…çš„åŠŸèƒ½æŠ€æœ¯ç‚¹åï¼Œè¿˜ä¼šçœ‹çœ‹å¯¹é¡¹ç›®é‡Œå…¶ä»–çš„å®ç°æœ‰æ²¡æœ‰äº†è§£ï¼Œç‰¹åˆ«æ˜¯é¡¹ç›®çš„å¤§è‡´æ¶æ„å’Œæ ¸å¿ƒåŠŸèƒ½ï¼Œæœ€å¥½èƒ½ç”»å‡ºé¡¹ç›®å¤§è‡´ç»“æ„ï¼Œçœ‹æƒ…å†µé—®é—®ç½‘ç»œå±‚å’Œæ•°æ®å±‚æ˜¯æ€æ ·å®ç°çš„ï¼Œä¸ºä»€ä¹ˆè¿™æ ·å®ç°ï¼Œé¡¹ç›®æœ€æ ¸å¿ƒåŠŸèƒ½æ˜¯æ€æ ·å®ç°çš„ï¼Œä¾‹å¦‚åšè¯»ä¹¦çš„è‡³å°‘è¦çŸ¥é“é¡¹ç›®é‡Œçš„æ’ç‰ˆå¼•æ“çš„å¤§è‡´å®ç°æ–¹å¼ï¼Œåš QQ çš„è¦çŸ¥é“æ¶ˆæ¯æ”¶å‘çš„æœºåˆ¶ï¼Œå¦‚æœä¸çŸ¥é“ï¼Œä¹Ÿå¯ä»¥è¯´è¯´å¦‚æœè‡ªå·±å®ç°ä¼šæ€ä¹ˆåšã€‚è¿™é‡Œä¸»è¦çœ‹çœ‹æœ‰æ²¡æœ‰æŠ€æœ¯å¥½å¥‡å¿ƒï¼Œä¼šä¸ä¼šç§¯æä¸»åŠ¨äº†è§£é¡¹ç›®é‡Œå·²æœ‰çš„éèŒè´£èŒƒå›´å†…çš„æŠ€æœ¯ç‚¹ï¼Œä¸»åŠ¨å’Œå¥½å­¦è¿™ä¸¤ç‚¹æ˜¯å¾ˆé‡è¦çš„ã€‚</p><h3 id="åŸºç¡€çŸ¥è¯†"><a href="#åŸºç¡€çŸ¥è¯†" class="headerlink" title="åŸºç¡€çŸ¥è¯†"></a>åŸºç¡€çŸ¥è¯†</h3><p>å¦‚æœé¡¹ç›®ç»å†é‡Œèƒ½é—®å‡ºå¤§éƒ¨åˆ†ä¸œè¥¿ï¼Œè¿™éƒ¨åˆ†æ¯”ä¾‹å°±ä¼šæ¯”è¾ƒå°‘äº†ï¼Œè¿™æ˜¯æ¯”è¾ƒå¥½çš„æƒ…å†µï¼Œå¦åˆ™å°±æŒ‰å¥—è·¯å»å¤šè€ƒå¯Ÿä¸€äº›åŸºç¡€çŸ¥è¯†ï¼ŒåŒ…æ‹¬ iOS å¼€å‘çš„åŸºç¡€å’Œè®¡ç®—æœºåŸºç¡€ï¼Œåƒå†…å­˜ / ç½‘ç»œ / å­˜å‚¨ / çº¿ç¨‹ç­‰ï¼Œä¾‹å¦‚ ARC æ˜¯æ€æ ·åšåˆ°è‡ªåŠ¨ç®¡ç†å†…å­˜çš„ï¼Œè·Ÿ java/js çš„åƒåœ¾å›æ”¶çš„åŒºåˆ«ï¼Œç½‘ç»œ http åè®®æ˜¯æ€æ ·çš„ï¼Œç”¨è¿‡ä»€ä¹ˆæ•°æ®åº“æ¡†æ¶ï¼Œdb ç´¢å¼•æ˜¯ä»€ä¹ˆï¼Œå¤šçº¿ç¨‹å¼€å‘è¦æ³¨æ„ä»€ä¹ˆï¼Œè·Ÿ runloop çš„å…³ç³»æ˜¯ä»€ä¹ˆç­‰ç­‰ï¼Œè¿™ç±»é—®é¢˜åœ¨ç½‘ä¸Šéƒ½æœ‰å¾ˆå¤šï¼Œå°±ä¸å¤šè¯´äº†ã€‚æ•°æ®ç»“æ„å’Œç®—æ³•åœ¨ç¬”è¯•æ—¶ä¼šæ¶‰åŠï¼Œé¢è¯•ä¼šæ¯”è¾ƒå°‘ï¼Œå¦‚æœé—®ç®—æ³•çš„è¯åªä¼šé—®é—®æ€è·¯ï¼Œä¸€èˆ¬æˆ‘è§‰å¾—å¦‚æœé¡¹ç›®ç»å†æ–¹é¢ä¸å¤ªå¥½ï¼Œæ‰ä¼šè€ƒè™‘è€ƒè€ƒç®—æ³•ä½œä¸ºè¾…åŠ©åˆ¤æ–­ã€‚</p><h3 id="è½¯å®åŠ›"><a href="#è½¯å®åŠ›" class="headerlink" title="è½¯å®åŠ›"></a>è½¯å®åŠ›</h3><p>ä¸€äº›é€šç”¨èƒ½åŠ›åƒé€»è¾‘æ€ç»´èƒ½åŠ›ï¼Œæ²Ÿé€šèƒ½åŠ›ï¼Œè‡ªæˆ‘é©±åŠ¨èƒ½åŠ›ç­‰éƒ½å¯ä»¥åœ¨ä¸Šé¢é‚£äº›é—®é¢˜çš„äº¤æµä¸­è¡¨ç°å‡ºæ¥ï¼Œå¦å¤–åƒå›¢é˜Ÿåä½œèƒ½åŠ›ã€æŠ—å‹èƒ½åŠ›å’Œæ€§æ ¼ç‰¹å¾è¿™äº›ä¹Ÿä¼šçœ‹æƒ…å†µè€ƒå¯Ÿä¸€ä¸‹ï¼Œä¾‹å¦‚é—®é—®å¦‚æœäº§å“è®©ä½ åšä¸ªéœ€æ±‚ï¼Œä½ è§‰å¾—ä¸é è°±ï¼Œä¼šæ€æ ·åšï¼Œè®¾è®¡è®©ä½ åšä¸ªå¾ˆéš¾å®ç°çš„æ•ˆæœï¼Œä½ ä¼šæ€æ ·è¯„ä¼°ï¼Ÿæˆ–è€…é—®ä¸ªä½çº§é—®é¢˜ï¼Œæ•…æ„è¯´ä¸ªé”™è¯¯çš„ç­”æ¡ˆï¼Œçœ‹çœ‹ä»–çš„ååº”æ˜¯æ€æ ·ï¼Œæ˜¯è¡¨ç°å‡ºå˜²ç¬‘å’Œæ”»å‡»æ€§ï¼Œè¿˜æ˜¯æ€€ç–‘è‡ªå·±ï¼Œè¿˜æ˜¯ç»†å¿ƒæ±‚è¯ã€‚æŠ—å‹èƒ½åŠ›çš„è€ƒå¯Ÿæœ‰äº›äººæ¯”è¾ƒå–œæ¬¢ï¼Œæˆ‘æ˜¯è§‰å¾—é¢è¯•è¿˜æ˜¯è½»æ¾ä¸€ç‚¹å¥½ã€‚è½¯å®åŠ›æ–¹é¢çš„è€ƒå¯Ÿåœ¨ä¸€é¢ä¼šæ¯”è¾ƒå°‘ï¼Œæˆ–è€…ä¸ä¼šæ¶‰åŠï¼Œå®é™…ä¸Šè¿™æ–¹é¢æˆ‘ä¹Ÿæ²¡å¤ªå¤šç»éªŒï¼Œä¹Ÿåœ¨æ‘¸ç´¢ä¸­ã€‚</p><h3 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h3><p>ä½œä¸ºç¨‹åºå‘˜ï¼Œå¦‚æœæœ‰ GitHub å¼€æºé¡¹ç›®æ˜¯æœ€å¥½çš„ï¼Œç›´æ¥å¯ä»¥çœ‹åˆ°ä»£ç é£æ ¼ï¼Œä»£ç è´¨é‡ï¼Œå¤„ç† issue å’Œ PR çš„æ–¹å¼ï¼Œå¦‚æœæœ‰æŠ€æœ¯åšå®¢ä¹Ÿæ˜¯å¾ˆå¥½çš„ï¼Œå¯ä»¥æå‰çœ‹åˆ°å¹³æ—¶çš„ä¸€äº›æŠ€æœ¯ç§¯ç´¯ï¼Œçœäº†å¾ˆå¤šäº‹ã€‚ä½†å¦‚æœ GitHub å†…å®¹æ˜¯åŸ¹è®­ç­çš„é‚£ç§ä»¿å†™ APPï¼Œåšå®¢å†…å®¹æ˜¯æ‘˜æŠ„æ–‡ç« ä»€ä¹ˆçš„å°±æ˜¯è´Ÿåˆ†äº†ã€‚</p><p>ä»¥ä¸Šæ˜¯æ­£å¸¸å¥—è·¯ï¼Œè‹¥å€™é€‰äººæœ‰ç‰¹æ®Šç»å†æˆ–æŠ€èƒ½ï¼Œä¾‹å¦‚ç‰› X å¤§å­¦æ¯•ä¸šï¼ŒACM å† å†›ï¼Œé€šè¯» linux æºç ï¼Œphp æºç è´¡çŒ®è€…ä¹‹ç±»ï¼Œä¼šå¦å½“åˆ«è®ºï¼Œé’ˆå¯¹æ€§è¿›è¡Œé¢è¯•ï¼Œè¿™ä¸æ˜¯å”¯ä¸€çš„æ ‡å‡†ã€‚å¦å¤–é’ˆå¯¹ä¸åŒçš„å·¥ä½œå¹´é™ä¹Ÿæœ‰ä¸åŒçš„é—®æ³•å’Œè¦æ±‚ï¼Œå·¥ä½œå¹´é™è¶Šé«˜è¦æ±‚è¶Šé«˜ã€‚</p><h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>å…¶å®é¢è¯•å°±æ˜¯æƒ³ä½æˆæœ¬æ‰¾åˆ°åˆé€‚åœ¨å›¢é˜Ÿé‡Œä¸€èµ·å·¥ä½œçš„äººï¼Œå› ä¸ºå¦‚æœé€šè¿‡ä¸€èµ·å·¥ä½œä¸€æ®µæ—¶é—´å»åˆ¤æ–­æ˜¯å¦åˆé€‚æˆæœ¬å¤ªé«˜ã€‚è¿™ç§ä½æˆæœ¬çš„ä»£ä»·å°±æ˜¯ä¼šè¯¯åˆ¤ï¼Œæœ‰äº›å·¥ç¨‹å¸ˆæ˜¯ç†è®ºå‹ï¼Œæœ‰äº›æ˜¯å®è·µå‹ï¼Œé¢è¯•çš„æ–¹å¼ä¼šå¯¹å®è·µå‹çš„äººä¸åˆ©ï¼Œå°½ç®¡ä»–ä»¬å¦‚æœæ‹›è¿›æ¥ä¼šæ˜¯é€‚åˆçš„äººï¼Œè€Œä¸”äººä¼šåœ¨ä¸åŒç¯å¢ƒä¸‹ä¼šæœ‰ä¸åŒçš„è¡¨ç°ï¼Œåªæ ¹æ®è¿‡å»çš„ç»å†å»åˆ¤æ–­æœ‰æ—¶æ˜¯ä¸å‡†ç¡®çš„ã€‚åªèƒ½å°½é‡é‡‡å–ä¸€äº›æªæ–½å»å‡å°‘è¯¯åˆ¤çš„æ¦‚ç‡ï¼Œä¾‹å¦‚æé«˜é¢è¯•å®˜çš„åˆ¤æ–­èƒ½åŠ›ï¼Œæˆ–å¤šå‡ è½®é¢è¯•ã€‚ä¸€èˆ¬å¦‚æœä¸æ˜¯æ€¥æ‹›ï¼Œç­–ç•¥éƒ½ä¼šæ˜¯å®æ€é”™ä¸æ”¾è¿‡ï¼Œæ‰€ä»¥å…¶å®å°±ç®—é¢è¯•è¢«å¦äº†ï¼Œä¹Ÿä¸ä¸€å®šä»£è¡¨èƒ½åŠ›ä¸è¡Œã€‚</p><p>å¦å¤–æ¯ä¸ªé¢è¯•å®˜å¯èƒ½éƒ½æœ‰è‡ªå·±æ‘¸ç´¢å‡ºæ¥çš„ä¸€ç§åˆ¤æ–­æ–¹å¼ï¼Œå¹¶éšç€é¢è¯•ç»éªŒçš„ä¸°å¯Œä¸æ–­æ”¹è¿›ï¼Œè¾¾åˆ°æ›´å‡†çš„åˆ¤æ–­æ¦‚ç‡ï¼Œè¿™åªæ˜¯æˆ‘ä¸ªäººåœ¨ç›®å‰æœ‰é™çš„ç»éªŒé‡Œçš„ä¸€ç‚¹å°æ€»ç»“ï¼Œä»…ä¾›å‚è€ƒã€‚</p><p><a href="https://mp.weixin.qq.com/s/ml4EWoEiKUaM1H-WTrDbuw" target="_blank" rel="noopener">æœ¬æ–‡è½¬è½½è‡ªå”å·§çš„å…¬ä¼—å·</a></p>]]></content>
      
      
      <categories>
          
          <category> Tech </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOSé›†æˆæ”¯ä»˜å®H5æ”¯ä»˜å®ç°è·³è½¬ä¸å›è°ƒçš„è§£å†³æ–¹æ¡ˆ</title>
      <link href="/2019-03-22-ios-alipay-h5-solution/"/>
      <url>/2019-03-22-ios-alipay-h5-solution/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æœ€è¿‘æœ‰ä¸ªéœ€æ±‚ï¼Œä¸èƒ½åœ¨iOSå®¢æˆ·ç«¯å†…é›†æˆæ”¯ä»˜å®å’Œå¾®ä¿¡çš„Appæ”¯ä»˜SDKï¼ˆä¸ºäº†é˜²è‹¹æœå®¡æ ¸æ£€æµ‹SDKï¼‰ï¼Œå› æ­¤ä½¿ç”¨H5æ”¯ä»˜ï¼Œè™½ç„¶å¾®ä¿¡å’Œæ”¯ä»˜å®çš„H5æ”¯ä»˜æ–‡æ¡£éƒ½è¯´ä¸è¦åœ¨Appå†…ä½¿ç”¨H5æ”¯ä»˜è€Œæ˜¯ä½¿ç”¨Appæ”¯ä»˜ï¼Œä½†åŠæ³•æ€»æ˜¯æœ‰çš„ã€‚</p><p>è¿™ç¯‡è®²çš„æ˜¯æ”¯ä»˜å®H5æ”¯ä»˜å¦‚ä½•ä»Appè·³è½¬æ”¯ä»˜å®ä»¥åŠå¦‚ä½•ä»æ”¯ä»˜å®è·³è½¬å›Appï¼Œå¾®ä¿¡æ”¯ä»˜çš„è§è¿™ç¯‡ï¼š</p><blockquote><p> <a href="https://paaatrick.com/2019-03-22-ios-wxpay-h5-solution/">iOSé›†æˆH5å¾®ä¿¡æ”¯ä»˜å®ç°è·³è½¬ä¸å›è°ƒçš„è§£å†³æ–¹æ¡ˆ</a></p></blockquote><p>å®ç°çš„æ•ˆæœæ˜¯ï¼šAppâ†’æ”¯ä»˜å®â†’æ”¯ä»˜(æˆåŠŸå¤±è´¥æˆ–å–æ¶ˆ)â†’App</p><a id="more"></a><h1 id="å‰ç½®å‡†å¤‡"><a href="#å‰ç½®å‡†å¤‡" class="headerlink" title="å‰ç½®å‡†å¤‡"></a>å‰ç½®å‡†å¤‡</h1><p>æœ¬é¡¹ç›®ä½¿ç”¨WKWebViewï¼Œå‰ç½®åŠ¨ä½œæ˜¯åç«¯å°ä¼™ä¼´å·²ç»å¤„ç†å¥½æ”¯ä»˜å®H5æ”¯ä»˜ä¸‹å•é“¾æ¥ï¼Œå®¢æˆ·ç«¯æ¥æ”¶åˆ°ä¸‹å•é“¾æ¥åçš„æ“ä½œã€‚</p><p>ä¸‹å•é“¾æ¥å³ä¸º<a href="https://docs.open.alipay.com/203/107090/" target="_blank" rel="noopener">æ”¯ä»˜å®H5æ”¯ä»˜æ–‡æ¡£-å‚æ•°è¯´æ˜-å…¬å…±å‚æ•°</a>ä¸­æ„é€ çš„<code>https://openapi.alipay.com/gateway.do</code>å¼€å¤´çš„çš„é“¾æ¥ï¼Œæ„é€ é“¾æ¥çš„æ“ä½œäº¤ç”±åç«¯å¤„ç†ã€‚</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190322204641.png" alt></p><h1 id="æ“ä½œæ­¥éª¤"><a href="#æ“ä½œæ­¥éª¤" class="headerlink" title="æ“ä½œæ­¥éª¤"></a>æ“ä½œæ­¥éª¤</h1><h2 id="1-æ·»åŠ -URL-Scheme-å¹¶æŠŠæ”¯ä»˜å®åŠ å…¥ç™½åå•"><a href="#1-æ·»åŠ -URL-Scheme-å¹¶æŠŠæ”¯ä»˜å®åŠ å…¥ç™½åå•" class="headerlink" title="1. æ·»åŠ  URL Scheme å¹¶æŠŠæ”¯ä»˜å®åŠ å…¥ç™½åå•"></a>1. æ·»åŠ  URL Scheme å¹¶æŠŠæ”¯ä»˜å®åŠ å…¥ç™½åå•</h2><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190322175421.png" alt></p><p>æ·»åŠ  URL Schemeã€‚åœ¨ <code>xcodeproj</code> æ–‡ä»¶ <code>Info</code> é€‰é¡¹å¡æœ€ä¸‹é¢çš„ <code>URL Types</code>å†…è®¾ç½®ã€‚ è¯¥ URL Scheme ä¸åƒå¾®ä¿¡æ”¯ä»˜å› ä¸ºè¦æ ¡éªŒå¿…é¡»è®¾ç½®å•†æˆ·åå°å¡«çš„ä¸€çº§åŸŸåï¼Œæ”¯ä»˜å®çš„è¿™ä¸ªå¯ä»¥ä»»æ„è®¾ç½®ã€‚</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190322175420.png" alt></p><p>æŠŠæ”¯ä»˜å®çš„ URL Scheme <code>alipay</code> å’Œ <code>alipays</code> å¡«å…¥é¡¹ç›®çš„ç™½åå•ã€‚åœ¨ <code>xcodeproj</code> æ–‡ä»¶ <code>Info</code> é€‰é¡¹å¡å†…çš„ <code>Custom iOS Target Properties</code> çš„ <code>LSApplicationQueriesSchemes</code> é‡Œæ·»åŠ ä¸Šè¿°ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œè‹¥æ²¡æœ‰ <code>LSApplicationQueriesSchemes</code> å°±æ‰‹åŠ¨è¾“å…¥æ·»åŠ ï¼Œç±»å‹ä¸ºæ•°ç»„ Arrayã€‚</p><h2 id="2-WKWebViewåŠ è½½é“¾æ¥"><a href="#2-WKWebViewåŠ è½½é“¾æ¥" class="headerlink" title="2. WKWebViewåŠ è½½é“¾æ¥"></a>2. WKWebViewåŠ è½½é“¾æ¥</h2><p>æ·»åŠ åè®® <code>WKNavigationDelegate</code>å’Œ<code>WKUIDelegate</code>ã€‚</p><p>åˆ›å»ºä¸€ä¸ªWKWebViewï¼Œå¹¶åŠ è½½ç»Ÿä¸€ä¸‹å•é“¾æ¥ã€‚</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)buildWKWebView &#123;</span><br><span class="line">    <span class="built_in">WKWebView</span> *webView = [[<span class="built_in">WKWebView</span> alloc] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, NAV_HEIGHT, SCREEN_WIDTH, SCREEN_HEIGHT - NAV_HEIGHT)];</span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:webView];</span><br><span class="line">    webView.navigationDelegate = <span class="keyword">self</span>;</span><br><span class="line">    webView.UIDelegate = <span class="keyword">self</span>;</span><br><span class="line">    <span class="built_in">NSURL</span> *payURL = [<span class="built_in">NSURL</span> URLWithString:<span class="keyword">self</span>.payString];</span><br><span class="line">    <span class="built_in">NSMutableURLRequest</span> *request = [<span class="built_in">NSMutableURLRequest</span> requestWithURL:payURL];</span><br><span class="line">    [webView loadRequest:request];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤å¤„self.payStringå°±æ˜¯åå°ä¼ æ¥çš„æ”¯ä»˜å®5æ”¯ä»˜ç»Ÿä¸€ä¸‹å•é“¾æ¥ï¼Œæ ¼å¼ä¸ºï¼š</p><p><code>https://openapi.alipay.com/gateway.do?app_id=2015081808011180&amp;biz_content={&quot;body&quot;%3A&quot;æ”¯ä»˜å®å……å€¼&quot;%2C&quot;subject&quot;%3A&quot;10000å®çŸ³&quot;%2C&quot;out_trade_no&quot;%3A&quot;30677&quot;%2C&quot;total_amount&quot;%3A&quot;1.00&quot;%2C&quot;seller_id&quot;%3A&quot;2088721584425035&quot;%2C&quot;product_code&quot;%3A&quot;QUICK_WAP_PAY&quot;%2C&quot;goods_type&quot;%3A&quot;1&quot;%2C&quot;passback_params&quot;%3A&quot;20190322083556lkkzmwT2wi0bAaFL1W&quot;%2C&quot;store_id&quot;%3A&quot;company&quot;%2C&quot;timeout_express&quot;%3A&quot;3m&quot;}&amp;charset=UTF-8&amp;format=JSON&amp;method=alipay.trade.wap.pay&amp;notify_url=https%3A%2F%2Fsttv3-api.company.com%2FaliNotify&amp;return_url=https%3A%2F%2Fwww.company.com&amp;sign_type=RSA2&amp;timestamp=2019-03-22+20%3A35%3A56&amp;version=1.0&amp;sign=rmnKUOsZBYi%2BWzDELY%2B5ixnSFn0b0S38K0NR45SRZBAvmzr0qaXm7mnKaXm7OrvmnKUOsZRYiaJ2LNAaFL1K0hvJ3L3hZqH5HifNCIJ0hfTr1OkA5Lgyn1SCx74SrSWVfXdMXqiLurpN0Mj%2B2zs7vDee%2B8vxwzhRG3a5EaZbOHDQFN1%2OrvvVcdv%2F%2FBJCwISBhoXhBelvfZRYiaJ2LNAaFL1KdrJvjlo2lR%2BEzvda0ppMKFzjMLxRZBAvmzr0qNwxyTMfAuxjAT2%2BXAaF3hZqH5Hlo2lRiaJ2LNE</code></p><p>ä¸åƒå¾®ä¿¡æ”¯ä»˜è¿˜è¦åŠ ä¸ªè¯·æ±‚å¤´ï¼Œæ”¯ä»˜å®çš„ç®€å•çš„å¤šï¼Œç›´æ¥è®¿é—®å³å¯ã€‚</p><h2 id="3-å®ç°ä»£ç†æ–¹æ³•æ‹¦æˆªé“¾æ¥å¹¶è·³è½¬æ”¯ä»˜å®"><a href="#3-å®ç°ä»£ç†æ–¹æ³•æ‹¦æˆªé“¾æ¥å¹¶è·³è½¬æ”¯ä»˜å®" class="headerlink" title="3. å®ç°ä»£ç†æ–¹æ³•æ‹¦æˆªé“¾æ¥å¹¶è·³è½¬æ”¯ä»˜å®"></a>3. å®ç°ä»£ç†æ–¹æ³•æ‹¦æˆªé“¾æ¥å¹¶è·³è½¬æ”¯ä»˜å®</h2><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)webView:(<span class="built_in">WKWebView</span> *)webView decidePolicyForNavigationAction:(<span class="built_in">WKNavigationAction</span> *)navigationAction decisionHandler:(<span class="keyword">void</span> (^)(<span class="built_in">WKNavigationActionPolicy</span>))decisionHandler &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ([navigationAction.request.URL.scheme isEqualToString:<span class="string">@"alipay"</span>]) &#123;</span><br><span class="line">        <span class="comment">//  1.ä»¥ï¼Ÿå·æ¥åˆ‡å‰²å­—ç¬¦ä¸²</span></span><br><span class="line">        <span class="built_in">NSArray</span> *urlBaseArr = [navigationAction.request.URL.absoluteString componentsSeparatedByString:<span class="string">@"?"</span>];</span><br><span class="line">        <span class="built_in">NSString</span> *urlBaseStr = urlBaseArr.firstObject;</span><br><span class="line">        <span class="built_in">NSString</span> *urlNeedDecode = urlBaseArr.lastObject;</span><br><span class="line">        <span class="comment">//  2.å°†æˆªå–ä»¥åçš„Strï¼Œåšä¸€ä¸‹URLDecodeï¼Œæ–¹ä¾¿æˆ‘ä»¬å¤„ç†æ•°æ®</span></span><br><span class="line">        <span class="built_in">NSMutableString</span> *afterDecodeStr = [<span class="built_in">NSMutableString</span> stringWithString:[SmallTools decoderUrlEncodeStr:urlNeedDecode]];</span><br><span class="line">        <span class="comment">//  3.æ›¿æ¢é‡Œé¢çš„é»˜è®¤Schemeä¸ºè‡ªå·±çš„Scheme</span></span><br><span class="line">        <span class="built_in">NSString</span> *afterHandleStr = [afterDecodeStr stringByReplacingOccurrencesOfString:<span class="string">@"alipays"</span> withString:<span class="string">@"alipayreturn.company.com"</span>];</span><br><span class="line">        <span class="comment">//  4.ç„¶åæŠŠå¤„ç†åçš„ï¼Œå’Œæœ€å¼€å§‹åˆ‡å‰²çš„åšä¸‹æ‹¼æ¥ï¼Œå°±å¾—åˆ°äº†æœ€ç»ˆçš„å­—ç¬¦ä¸²</span></span><br><span class="line">        <span class="built_in">NSString</span> *finalStr = [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%@?%@"</span>,urlBaseStr, [SmallTools urlEncodeStr:afterHandleStr]];</span><br><span class="line">        </span><br><span class="line">        dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(<span class="number">0.5</span> * <span class="built_in">NSEC_PER_SEC</span>)), dispatch_get_main_queue(), ^&#123;</span><br><span class="line">            <span class="comment">//  åˆ¤æ–­ä¸€ä¸‹ï¼Œæ˜¯å¦å®‰è£…äº†æ”¯ä»˜å®APPï¼ˆä¹Ÿå°±æ˜¯çœ‹çœ‹èƒ½ä¸èƒ½æ‰“å¼€è¿™ä¸ªURLï¼‰</span></span><br><span class="line">            <span class="keyword">if</span> ([[<span class="built_in">UIApplication</span> sharedApplication] canOpenURL:[<span class="built_in">NSURL</span> URLWithString:finalStr]]) &#123;</span><br><span class="line">                [[<span class="built_in">UIApplication</span> sharedApplication] openURL:[<span class="built_in">NSURL</span> URLWithString:finalStr]];</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">//æœªå®‰è£…æ”¯ä»˜å®, è‡ªè¡Œå¤„ç†</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        </span><br><span class="line">        decisionHandler(<span class="built_in">WKNavigationActionPolicyCancel</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    decisionHandler(<span class="built_in">WKNavigationActionPolicyAllow</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¡ºä¾¿é™„å¸¦ä¸€ä¸‹ URL çš„ Encode å’Œ Decode æ–¹æ³•ã€‚</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//urlEncodeç¼–ç </span></span><br><span class="line">+ (<span class="built_in">NSString</span> *)urlEncodeStr:(<span class="built_in">NSString</span> *)input &#123;</span><br><span class="line">    <span class="built_in">NSString</span> *charactersToEscape = <span class="string">@"?!@#$^&amp;%*+,:;='\"`&lt;&gt;()[]&#123;&#125;/\\| "</span>;</span><br><span class="line">    <span class="built_in">NSCharacterSet</span> *allowedCharacters = [[<span class="built_in">NSCharacterSet</span> characterSetWithCharactersInString:charactersToEscape] invertedSet];</span><br><span class="line">    <span class="built_in">NSString</span> *upSign = [input stringByAddingPercentEncodingWithAllowedCharacters:allowedCharacters];</span><br><span class="line">    <span class="keyword">return</span> upSign;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//urlEncodeè§£ç </span></span><br><span class="line">+ (<span class="built_in">NSString</span> *)decoderUrlEncodeStr: (<span class="built_in">NSString</span> *) input &#123;</span><br><span class="line">    <span class="built_in">NSMutableString</span> *outputStr = [<span class="built_in">NSMutableString</span> stringWithString:input];</span><br><span class="line">    [outputStr replaceOccurrencesOfString:<span class="string">@"+"</span> withString:<span class="string">@""</span> options:<span class="built_in">NSLiteralSearch</span> range:<span class="built_in">NSMakeRange</span>(<span class="number">0</span>,[outputStr length])];</span><br><span class="line">    <span class="keyword">return</span> [outputStr stringByRemovingPercentEncoding];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-AppDelegate-ä¸­æ¥æ”¶è·³è½¬åŠ¨ä½œ"><a href="#4-AppDelegate-ä¸­æ¥æ”¶è·³è½¬åŠ¨ä½œ" class="headerlink" title="4. AppDelegate ä¸­æ¥æ”¶è·³è½¬åŠ¨ä½œ"></a>4. AppDelegate ä¸­æ¥æ”¶è·³è½¬åŠ¨ä½œ</h2><p>å½“ç„¶ä½ ä¹Ÿä¸ä¸€å®šéœ€è¦åœ¨AppDelegateé‡Œæ¥æ”¶è¿”å›åŠ¨ä½œï¼Œä¹Ÿå¯ä»¥ç›´æ¥è¿”å›æ”¯ä»˜ç•Œé¢ï¼Œè‡ªè¡Œæ“ä½œåç»­é€»è¾‘ã€‚</p><p>ä»¥ä¸‹æ˜¯AppDelegateæ¥æ”¶è¿”å›åŠ¨ä½œçš„ç¤ºä¾‹ã€‚</p><p>å…¶ä¸­æ”¯ä»˜å®å›è°ƒçš„ host æ˜¯å›ºå®šçš„ safepayï¼Œè€Œå¾®ä¿¡æ”¯ä»˜çš„ host éšæ„å®šä¹‰ã€‚</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">BOOL</span>)application:(<span class="built_in">UIApplication</span> *)app openURL:(<span class="built_in">NSURL</span> *)url options:(<span class="built_in">NSDictionary</span>&lt;<span class="built_in">NSString</span> *,<span class="keyword">id</span>&gt; *)options&#123;</span><br><span class="line">    <span class="comment">//safepayæ˜¯æ”¯ä»˜å®H5æ”¯ä»˜çš„å›è°ƒhost, </span></span><br><span class="line">    <span class="keyword">if</span> ([url.host isEqualToString:<span class="string">@"wxpaycallback"</span>] || [url.host isEqualToString:<span class="string">@"safepay"</span>]) &#123;</span><br><span class="line">        <span class="comment">// è‡ªè¡Œæ“ä½œä¸šåŠ¡é€»è¾‘ï¼Œæ¯”å¦‚ä½¿ç”¨é€šçŸ¥è¯·æ±‚æŸ¥è¯¢è®¢å•çŠ¶æ€ï¼ŒpopViewå›ä¸Šçº§é¡µé¢ç­‰</span></span><br><span class="line">        <span class="built_in">UITabBarController</span> *tabBarVC = (<span class="built_in">UITabBarController</span> *)topRootViewController;</span><br><span class="line">        <span class="built_in">UINavigationController</span> *navVC = tabBarVC.viewControllers[tabBarVC.selectedIndex];</span><br><span class="line">        [navVC popViewControllerAnimated:<span class="literal">YES</span>];</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">NSString</span> *orderId = [[<span class="built_in">NSUserDefaults</span> standardUserDefaults] objectForKey:<span class="string">@"PayOrderId"</span>];</span><br><span class="line">            <span class="built_in">NSString</span> *payFee = [[<span class="built_in">NSUserDefaults</span> standardUserDefaults] objectForKey:<span class="string">@"PayFee"</span>];</span><br><span class="line">            <span class="comment">//ä»¥åŠæ›´å¤šå‚æ•°</span></span><br><span class="line">        <span class="built_in">NSDictionary</span> *resultDict = @&#123;<span class="string">@"order_id"</span>:orderId, <span class="string">@"payFee"</span>:payFee&#125;;</span><br><span class="line">        [[<span class="built_in">NSNotificationCenter</span> defaultCenter] postNotificationName:<span class="string">@"htmlPaymentNotification"</span> object:<span class="keyword">self</span> userInfo:resultDict];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr>]]></content>
      
      
      <categories>
          
          <category> Tech </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
            <tag> Objective-C </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOSé›†æˆH5å¾®ä¿¡æ”¯ä»˜å®ç°è·³è½¬ä¸å›è°ƒçš„è§£å†³æ–¹æ¡ˆ</title>
      <link href="/2019-03-22-ios-wxpay-h5-solution/"/>
      <url>/2019-03-22-ios-wxpay-h5-solution/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æœ€è¿‘æœ‰ä¸ªéœ€æ±‚ï¼Œä¸èƒ½åœ¨iOSå®¢æˆ·ç«¯å†…é›†æˆæ”¯ä»˜å®å’Œå¾®ä¿¡çš„Appæ”¯ä»˜SDKï¼ˆä¸ºäº†é˜²è‹¹æœå®¡æ ¸æ£€æµ‹SDKï¼‰ï¼Œå› æ­¤ä½¿ç”¨H5æ”¯ä»˜ï¼Œè™½ç„¶å¾®ä¿¡å’Œæ”¯ä»˜å®çš„H5æ”¯ä»˜æ–‡æ¡£éƒ½è¯´ä¸è¦åœ¨Appå†…ä½¿ç”¨H5æ”¯ä»˜è€Œæ˜¯ä½¿ç”¨Appæ”¯ä»˜ï¼Œä½†åŠæ³•æ€»æ˜¯æœ‰çš„ã€‚</p><p>è¿™ç¯‡è®²çš„æ˜¯H5å¾®ä¿¡æ”¯ä»˜å¦‚ä½•ä»Appè·³è½¬å¾®ä¿¡ä»¥åŠå¦‚ä½•ä»å¾®ä¿¡è·³è½¬å›Appï¼Œæ”¯ä»˜å®çš„è§è¿™ç¯‡ï¼š</p><blockquote><p> <a href="https://paaatrick.com/2019-03-22-ios-alipay-h5-solution/">iOSé›†æˆæ”¯ä»˜å®H5æ”¯ä»˜å®ç°è·³è½¬ä¸å›è°ƒçš„è§£å†³æ–¹æ¡ˆ</a></p></blockquote><p>å®ç°çš„æ•ˆæœæ˜¯ï¼šAppâ†’å¾®ä¿¡â†’æ”¯ä»˜(æˆåŠŸå¤±è´¥æˆ–å–æ¶ˆ)â†’App</p><a id="more"></a><h1 id="å‰ç½®å‡†å¤‡"><a href="#å‰ç½®å‡†å¤‡" class="headerlink" title="å‰ç½®å‡†å¤‡"></a>å‰ç½®å‡†å¤‡</h1><p>æœ¬é¡¹ç›®ä½¿ç”¨WKWebViewï¼Œå‰ç½®åŠ¨ä½œæ˜¯åç«¯å°ä¼™ä¼´å·²ç»å¤„ç†å¥½å¾®ä¿¡H5æ”¯ä»˜ä¸‹å•é“¾æ¥ï¼Œå®¢æˆ·ç«¯æ¥æ”¶åˆ°ä¸‹å•é“¾æ¥åçš„æ“ä½œã€‚</p><p>ä¸‹å•é“¾æ¥å³ä¸º<a href="https://pay.weixin.qq.com/wiki/doc/api/H5.php?chapter=9_20&index=1" target="_blank" rel="noopener">å¾®ä¿¡æ”¯ä»˜æ–‡æ¡£-ç»Ÿä¸€ä¸‹å•API</a>ä¸­è¿”å›çš„ <code>mweb_url</code>ï¼Œæ ¼å¼ä¸º <code>https://wx.tenpay.com/cgi-bin/mmpayweb-bin/checkmweb?prepay_id=wx2016121516420242444321ca0631331346&amp;package=1405458241</code>ã€‚</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190322180048.png" alt></p><h1 id="æ“ä½œæ­¥éª¤"><a href="#æ“ä½œæ­¥éª¤" class="headerlink" title="æ“ä½œæ­¥éª¤"></a>æ“ä½œæ­¥éª¤</h1><h2 id="1-æ·»åŠ -URL-Scheme-å¹¶æŠŠå¾®ä¿¡åŠ å…¥ç™½åå•"><a href="#1-æ·»åŠ -URL-Scheme-å¹¶æŠŠå¾®ä¿¡åŠ å…¥ç™½åå•" class="headerlink" title="1. æ·»åŠ  URL Scheme å¹¶æŠŠå¾®ä¿¡åŠ å…¥ç™½åå•"></a>1. æ·»åŠ  URL Scheme å¹¶æŠŠå¾®ä¿¡åŠ å…¥ç™½åå•</h2><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190322175422.png" alt></p><p>æ·»åŠ  URL Schemeã€‚åœ¨ <code>xcodeproj</code> æ–‡ä»¶ <code>Info</code> é€‰é¡¹å¡æœ€ä¸‹é¢çš„ <code>URL Types</code>å†…è®¾ç½®ã€‚ æ³¨æ„æ­¤URLçš„ä¸€çº§åŸŸåéœ€è¦ä¸å¾®ä¿¡å•†æˆ·åå°(å¾®ä¿¡å•†æˆ·å¹³å°-äº§å“ä¸­å¿ƒ-å¼€å‘é…ç½®-H5æ”¯ä»˜)è®¾ç½®çš„çš„ä¸€çº§åŸŸåä¸€è‡´ï¼Œæ¯”å¦‚å¾®ä¿¡å•†æˆ·é‡Œè®¾ç½®çš„æ˜¯<code>company.com</code>ï¼Œé‚£ URL Schemes å¯ä»¥è®¾ä¸º <code>a1.company.com</code>ï¼Œæ­¤ç‰¹æ€§ä½¿å¾—ä¸€å¥—H5æ”¯ä»˜å¯ä»¥æ–¹ä¾¿å¾—é›†æˆåˆ°å¤šä¸ªAppã€‚åªæœ‰ä¸€ä¸ªAppéœ€è¦H5æ”¯ä»˜çš„è¯ä¹Ÿå¯ä»¥ç›´æ¥å¡«ä¸å¾®ä¿¡åå°çš„ä¸€è‡´çš„ <code>company.com</code> ã€‚</p><blockquote><p>2019å¹´4æœˆ10æ—¥æ›´æ–°<br>å¦‚æœåƒä¸Šå›¾é‚£æ ·å¡«çš„æ˜¯ <code>www.company.com</code>ï¼Œé‚£ URL Scheme åªèƒ½è®¾ä¸ºå…¶ä¸‰çº§åŸŸåå¦‚ <code>a2.www.company.com</code> æˆ–åŒæ ·çš„ <code>www.company.com</code></p></blockquote><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190322175420.png" alt></p><p>æŠŠå¾®ä¿¡çš„ URL Scheme <code>weixin</code> å’Œ <code>wechat</code> å¡«å…¥é¡¹ç›®çš„ç™½åå•ã€‚åœ¨ <code>xcodeproj</code> æ–‡ä»¶ <code>Info</code> é€‰é¡¹å¡å†…çš„ <code>Custom iOS Target Properties</code> çš„ <code>LSApplicationQueriesSchemes</code> é‡Œæ·»åŠ ä¸Šè¿°ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œè‹¥æ²¡æœ‰ <code>LSApplicationQueriesSchemes</code> å°±æ‰‹åŠ¨è¾“å…¥æ·»åŠ ï¼Œç±»å‹ä¸ºæ•°ç»„ Arrayã€‚</p><h2 id="2-WKWebViewåŠ è½½é“¾æ¥"><a href="#2-WKWebViewåŠ è½½é“¾æ¥" class="headerlink" title="2. WKWebViewåŠ è½½é“¾æ¥"></a>2. WKWebViewåŠ è½½é“¾æ¥</h2><p>æ·»åŠ åè®® <code>WKNavigationDelegate</code>å’Œ<code>WKUIDelegate</code>ã€‚</p><p>åˆ›å»ºä¸€ä¸ªWKWebViewï¼Œå¹¶åŠ è½½ç»Ÿä¸€ä¸‹å•é“¾æ¥ã€‚</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)buildWKWebView &#123;</span><br><span class="line">    <span class="built_in">WKWebView</span> *webView = [[<span class="built_in">WKWebView</span> alloc] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, NAV_HEIGHT, SCREEN_WIDTH, SCREEN_HEIGHT - NAV_HEIGHT)];</span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:webView];</span><br><span class="line">    webView.navigationDelegate = <span class="keyword">self</span>;</span><br><span class="line">    webView.UIDelegate = <span class="keyword">self</span>;</span><br><span class="line">    <span class="built_in">NSURL</span> *payURL = [<span class="built_in">NSURL</span> URLWithString:<span class="keyword">self</span>.payString];</span><br><span class="line">    <span class="built_in">NSMutableURLRequest</span> *request = [<span class="built_in">NSMutableURLRequest</span> requestWithURL:payURL];</span><br><span class="line">    [request setValue:<span class="string">@"a1.company.com://wxpaycallback/"</span> forHTTPHeaderField:<span class="string">@"Referer"</span>];</span><br><span class="line">    [webView loadRequest:request];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤å¤„self.payStringå°±æ˜¯åå°ä¼ æ¥çš„å¾®ä¿¡H5æ”¯ä»˜ç»Ÿä¸€ä¸‹å•é“¾æ¥ï¼Œæ ¼å¼ä¸º <code>https://wx.tenpay.com/cgi-bin/mmpayweb-bin/checkmweb?prepay_id=wx2016121516420242444321ca0631331346&amp;package=1405458041</code>ã€‚</p><p>æˆ‘ä»¬éœ€è¦åšçš„å¤„ç†æ˜¯æ ¹æ®æ–‡æ¡£ç»™è¿™ä¸ªè¯·æ±‚æ·»åŠ è¯·æ±‚å¤´ <code>Referer</code>ï¼Œå…³é”®åœ¨äºè¿™ä¸ª <code>a1.company.com://wxpaycallback/</code> æ—¢æ»¡è¶³äº†å¾®ä¿¡æ£€æµ‹åˆ°æœ‰å•†æˆ·åå°è®¾ç½®å¥½çš„ä¸€çº§åŸŸåï¼ŒåŒæ—¶æŠŠè¿™ä¸ªé“¾æ¥åšæˆäº† URL Scheme ä½¿å¾—å¯ä»¥åœ¨è·³è½¬å¾®ä¿¡å®¢æˆ·ç«¯åï¼ˆä¸ç®¡æ”¯ä»˜æˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼‰èƒ½é¡ºåˆ©è·³è½¬å›è‡ªå·±çš„Appã€‚å…¶ä¸­çš„ host <code>wxpaycallback/</code> å¯ä»¥ä»»æ„è®¾ç½®ï¼Œæ–¹ä¾¿åœ¨ <code>AppDelegate</code> é‡Œå¤„ç†è·³è½¬å›æ¥åéƒ¨ç½²ä¸šåŠ¡é€»è¾‘ã€‚å½“ç„¶å¦‚æœä½ ä¸éœ€è¦åœ¨ <code>AppDelegate</code> é‡Œæ¥æ”¶åŠ¨ä½œè€Œæ˜¯ç›´æ¥è·³å›æ”¯ä»˜ç•Œé¢è‡ªè¡Œåç»­å¤„ç†çš„è¯å°±åªç”¨è®¾ä¸ºå‰ä¸€æ­¥åœ¨ URL Scheme <code>a1.company.com://</code> å³å¯ã€‚</p><blockquote><p>2019.4.10 æ›´æ–° </p><p>ç»è¿‡æµ‹è¯•ï¼Œå¯¹äºAppå†…çš„H5æ”¯ä»˜è€Œè¨€ï¼Œå®é™…ä¸Šæ˜¯ä¸‹é¢æ­¥éª¤é‡Œ<br><code>@&quot;https://wx.tenpay.com/cgi-bin/mmpayweb-bin/checkmweb&quot;</code><br>åæ¥çš„å‚æ•° <code>redirect_url</code> å¯¹æ”¯ä»˜åè·³å›Appèµ·ä½œç”¨ï¼Œ<code>Referer</code>åªèµ·åˆ°ç»™å¾®ä¿¡æ ¡éªŒçš„ä½œç”¨ã€‚</p><p>æ‰€ä»¥ <code>Referer</code> åªéœ€è¦è®¾ç½®æˆå¾®ä¿¡H5æ”¯ä»˜ç™»è®°çš„åŸŸåçš„å­åŸŸåå³å¯ï¼Œå¦‚<br><code>[request setValue:@&quot;a1.company.com&quot; forHTTPHeaderField:@&quot;Referer&quot;];</code></p></blockquote><h2 id="3-å®ç°ä»£ç†æ–¹æ³•æ‹¦æˆªé“¾æ¥å¹¶è·³è½¬å¾®ä¿¡"><a href="#3-å®ç°ä»£ç†æ–¹æ³•æ‹¦æˆªé“¾æ¥å¹¶è·³è½¬å¾®ä¿¡" class="headerlink" title="3. å®ç°ä»£ç†æ–¹æ³•æ‹¦æˆªé“¾æ¥å¹¶è·³è½¬å¾®ä¿¡"></a>3. å®ç°ä»£ç†æ–¹æ³•æ‹¦æˆªé“¾æ¥å¹¶è·³è½¬å¾®ä¿¡</h2><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)webView:(<span class="built_in">WKWebView</span> *)webView decidePolicyForNavigationAction:(<span class="built_in">WKNavigationAction</span> *)navigationAction decisionHandler:(<span class="keyword">void</span> (^)(<span class="built_in">WKNavigationActionPolicy</span>))decisionHandler &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSURLRequest</span> *request = navigationAction.request;</span><br><span class="line">    <span class="built_in">NSString</span> *absoluteString = [navigationAction.request.URL.absoluteString stringByRemovingPercentEncoding];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ‹¦æˆªWKWebViewåŠ è½½çš„å¾®ä¿¡æ”¯ä»˜ç»Ÿä¸€ä¸‹å•é“¾æ¥, å°†redirect_urlå‚æ•°ä¿®æ”¹ä¸ºå”¤èµ·è‡ªå·±Appçš„URLScheme</span></span><br><span class="line">    <span class="keyword">if</span> ([absoluteString hasPrefix:<span class="string">@"https://wx.tenpay.com/cgi-bin/mmpayweb-bin/checkmweb"</span>] &amp;&amp; ![absoluteString hasSuffix:[<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"redirect_url=a1.company.com://wxpaycallback/"</span>]]) &#123;</span><br><span class="line">        decisionHandler(<span class="built_in">WKNavigationActionPolicyCancel</span>);</span><br><span class="line">        <span class="built_in">NSString</span> *redirectUrl = <span class="literal">nil</span>;</span><br><span class="line">        <span class="keyword">if</span> ([absoluteString containsString:<span class="string">@"redirect_url="</span>]) &#123;</span><br><span class="line">            <span class="built_in">NSRange</span> redirectRange = [absoluteString rangeOfString:<span class="string">@"redirect_url"</span>];</span><br><span class="line">            redirectUrl = [[absoluteString substringToIndex:redirectRange.location] stringByAppendingString:[<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"redirect_url=a1.company.com://wxpaycallback/"</span>]];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            redirectUrl = [absoluteString stringByAppendingString:[<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"redirect_url=a1.company.com://wxpaycallback/"</span>]];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">NSMutableURLRequest</span> *newRequest = [<span class="built_in">NSMutableURLRequest</span> requestWithURL:[<span class="built_in">NSURL</span> URLWithString:redirectUrl] cachePolicy:<span class="built_in">NSURLRequestUseProtocolCachePolicy</span> timeoutInterval:<span class="number">30</span>];</span><br><span class="line">        newRequest.allHTTPHeaderFields = request.allHTTPHeaderFields;</span><br><span class="line">        newRequest.URL = [<span class="built_in">NSURL</span> URLWithString:redirectUrl];</span><br><span class="line">        [webView loadRequest:newRequest];</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//æ‹¦æˆªé‡å®šå‘çš„è·³è½¬å¾®ä¿¡çš„ URL Scheme, æ‰“å¼€å¾®ä¿¡</span></span><br><span class="line">    <span class="keyword">if</span> ([absoluteString hasPrefix:<span class="string">@"weixin://"</span>]) &#123;</span><br><span class="line">        decisionHandler(<span class="built_in">WKNavigationActionPolicyAllow</span>);</span><br><span class="line">        dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(<span class="number">0.5</span> * <span class="built_in">NSEC_PER_SEC</span>)), dispatch_get_main_queue(), ^&#123;</span><br><span class="line">            <span class="keyword">if</span> ([[<span class="built_in">UIApplication</span> sharedApplication] canOpenURL:navigationAction.request.URL]) &#123;</span><br><span class="line">                [[<span class="built_in">UIApplication</span> sharedApplication] openURL:navigationAction.request.URL];</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">//æœªå®‰è£…å¾®ä¿¡, è‡ªè¡Œå¤„ç†</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    decisionHandler(<span class="built_in">WKNavigationActionPolicyAllow</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-AppDelegate-ä¸­æ¥æ”¶è·³è½¬åŠ¨ä½œ"><a href="#4-AppDelegate-ä¸­æ¥æ”¶è·³è½¬åŠ¨ä½œ" class="headerlink" title="4. AppDelegate ä¸­æ¥æ”¶è·³è½¬åŠ¨ä½œ"></a>4. AppDelegate ä¸­æ¥æ”¶è·³è½¬åŠ¨ä½œ</h2><p>å½“ç„¶ä½ ä¹Ÿä¸ä¸€å®šéœ€è¦åœ¨AppDelegateé‡Œæ¥æ”¶è¿”å›åŠ¨ä½œï¼Œä¹Ÿå¯ä»¥ç›´æ¥è¿”å›æ”¯ä»˜ç•Œé¢ï¼Œè‡ªè¡Œæ“ä½œåç»­é€»è¾‘ã€‚</p><p>ä»¥ä¸‹æ˜¯AppDelegateæ¥æ”¶è¿”å›åŠ¨ä½œçš„ç¤ºä¾‹ã€‚</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">BOOL</span>)application:(<span class="built_in">UIApplication</span> *)app openURL:(<span class="built_in">NSURL</span> *)url options:(<span class="built_in">NSDictionary</span>&lt;<span class="built_in">NSString</span> *,<span class="keyword">id</span>&gt; *)options&#123;</span><br><span class="line">    <span class="comment">//safepayæ˜¯æ”¯ä»˜å®H5æ”¯ä»˜çš„å›è°ƒhost</span></span><br><span class="line">    <span class="keyword">if</span> ([url.host isEqualToString:<span class="string">@"wxpaycallback"</span>] || [url.host isEqualToString:<span class="string">@"safepay"</span>]) &#123;</span><br><span class="line">        <span class="comment">// è‡ªè¡Œæ“ä½œä¸šåŠ¡é€»è¾‘ï¼Œæ¯”å¦‚ä½¿ç”¨é€šçŸ¥è¯·æ±‚æŸ¥è¯¢è®¢å•çŠ¶æ€ï¼ŒpopViewå›ä¸Šçº§é¡µé¢ç­‰</span></span><br><span class="line">        <span class="built_in">UITabBarController</span> *tabBarVC = (<span class="built_in">UITabBarController</span> *)topRootViewController;</span><br><span class="line">        <span class="built_in">UINavigationController</span> *navVC = tabBarVC.viewControllers[tabBarVC.selectedIndex];</span><br><span class="line">        [navVC popViewControllerAnimated:<span class="literal">YES</span>];</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">NSString</span> *orderId = [[<span class="built_in">NSUserDefaults</span> standardUserDefaults] objectForKey:<span class="string">@"PayOrderId"</span>];</span><br><span class="line">            <span class="built_in">NSString</span> *payFee = [[<span class="built_in">NSUserDefaults</span> standardUserDefaults] objectForKey:<span class="string">@"PayFee"</span>];</span><br><span class="line">            <span class="comment">//ä»¥åŠæ›´å¤šå‚æ•°</span></span><br><span class="line">        <span class="built_in">NSDictionary</span> *resultDict = @&#123;<span class="string">@"order_id"</span>:orderId, <span class="string">@"payFee"</span>:payFee&#125;;</span><br><span class="line">        [[<span class="built_in">NSNotificationCenter</span> defaultCenter] postNotificationName:<span class="string">@"htmlPaymentNotification"</span> object:<span class="keyword">self</span> userInfo:resultDict];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="5-å…³äºå¾®ä¿¡H5æ”¯ä»˜åŸŸåè®¾ç½®"><a href="#5-å…³äºå¾®ä¿¡H5æ”¯ä»˜åŸŸåè®¾ç½®" class="headerlink" title="5. å…³äºå¾®ä¿¡H5æ”¯ä»˜åŸŸåè®¾ç½®"></a>5. å…³äºå¾®ä¿¡H5æ”¯ä»˜åŸŸåè®¾ç½®</h2><blockquote><p>2019å¹´4æœˆ10æ—¥æ›´æ–°</p></blockquote><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190410183635.png" alt></p><p>è¿™é‡Œé¢å¤–æä¸€ä¸‹ï¼Œæˆªæ­¢åˆ°2019å¹´4æœˆï¼Œå¾®ä¿¡æ”¯ä»˜è®¾ç½®é¡µé¢æ˜ç¡®è¯´äº†</p><blockquote><p>æ·»åŠ åŸŸååï¼Œå…¶æ‰€å±çš„å­åŸŸåå°†éƒ½æœ‰æƒé™</p></blockquote><p>ä¹Ÿå°±æ˜¯è¯´åªéœ€è¦å¡«ä¸€ä¸ªä¸€çº§åŸŸåæ¯”å¦‚ <code>company.com</code> ï¼Œå°±å¯ä»¥æœ‰æ— é™å¤šä¸ªäºŒçº§åŸŸåå¯ä¾›ä¸åŒAppä½¿ç”¨ï¼Œç»•è¿‡å¾®ä¿¡H5æ”¯ä»˜åªèƒ½æ·»åŠ 5ä¸ªåŸŸåçš„é™åˆ¶ã€‚å¦‚æœå¡«çš„æ˜¯äºŒçº§åŸŸåæ¯”å¦‚ <code>www.company.com</code>ï¼Œé‚£ä¹ˆåªèƒ½å¾€ä¸‹ä½¿ç”¨ä¸‰çº§åŸŸåæ¯”å¦‚ <code>a1.www.company.com</code></p><p>ä»¥å¾®ä¿¡H5æ”¯ä»˜åŸŸåå¡«äº† <code>company.com</code> ä¸ºä¾‹ï¼Œé‚£å¯ä»¥è¿™æ ·æ“ä½œ</p><table><thead><tr><th align="center">App</th><th align="center">Alpha</th><th align="center">Beta-A1</th><th align="center">Beta-A2</th><th>Gamma</th></tr></thead><tbody><tr><td align="center">æ·»åŠ çš„Referer</td><td align="center">alpha.company.com</td><td align="center">a1.beta.company.com</td><td align="center">a2.beta.company.com</td><td>gamma.company.com</td></tr><tr><td align="center">è¦æ›¿æ¢çš„redirect_url</td><td align="center">alpha.company.com://optional</td><td align="center">a1.beta.company.com://</td><td align="center">a2.beta.company.com://optional</td><td>gamma.company.com://</td></tr><tr><td align="center">URL Scheme</td><td align="center">alpha.company.com</td><td align="center">a1.beta.company.com</td><td align="center">a2.beta.company.com</td><td>gamma.company.com</td></tr></tbody></table><p><a href="https://www.cnblogs.com/Life-Record/p/8472319.html" target="_blank" rel="noopener"><strong>å‚è€ƒåšå®¢é“¾æ¥</strong></a></p><hr>]]></content>
      
      
      <categories>
          
          <category> Tech </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
            <tag> Objective-C </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ¤æ–­ä¸€ä¸ª NSArray æ˜¯å¦ä¸ºç©º</title>
      <link href="/2019-03-12-if-nsarray-null/"/>
      <url>/2019-03-12-if-nsarray-null/</url>
      
        <content type="html"><![CDATA[<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ([array isKindOfClass:[<span class="built_in">NSArray</span> <span class="keyword">class</span>]] &amp;&amp; array.count &gt; <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"è¿™æ˜¯ä¸€ä¸ªéç©ºæ•°ç»„"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr>]]></content>
      
      
      <categories>
          
          <category> Note </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
            <tag> Objective-C </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iPhoneå±å¹•å„ç§å°ºå¯¸åˆ†è¾¨ç‡ï¼ˆæ›´æ–°è‡³XSï¼‰</title>
      <link href="/2019-03-05-iphone-pixel-point-size-scale/"/>
      <url>/2019-03-05-iphone-pixel-point-size-scale/</url>
      
        <content type="html"><![CDATA[<table><thead><tr><th>Device</th><th>Logic Point</th><th>Logic Pixel</th><th>Size</th><th>Scale</th></tr></thead><tbody><tr><td>iPhone 2G</td><td>480 Ã— 320</td><td>480 Ã— 320</td><td>3.5</td><td>1x</td></tr><tr><td>iPhone 3</td><td>480 Ã— 320</td><td>480 Ã— 320</td><td>3.5</td><td>1x</td></tr><tr><td>iPhone 3GS</td><td>480 Ã— 320</td><td>480 Ã— 320</td><td>3.5</td><td>1x</td></tr><tr><td>iPhone 4</td><td>480 Ã— 320</td><td>960 Ã— 640</td><td>3.5</td><td>2x</td></tr><tr><td>iPhone 4S</td><td>480 Ã— 320</td><td>960 Ã— 640</td><td>3.5</td><td>2x</td></tr><tr><td>iPhone 5</td><td>568 Ã— 320</td><td>1136 Ã— 640</td><td>4.0</td><td>2x</td></tr><tr><td>iPhone 5S</td><td>568 Ã— 320</td><td>1136 Ã— 640</td><td>4.0</td><td>2x</td></tr><tr><td>iPhone 5C</td><td>568 Ã— 320</td><td>1136 Ã— 640</td><td>4.0</td><td>2x</td></tr><tr><td>iPhone 6</td><td>667 Ã— 375</td><td>1334 Ã— 750</td><td>4.7</td><td>2x</td></tr><tr><td>iPhone 6 Plus</td><td>736 Ã— 414</td><td>2208 Ã— 1242</td><td>5.5</td><td>3x</td></tr><tr><td>iPhone 6S</td><td>667 Ã— 375</td><td>1334 Ã— 750</td><td>4.7</td><td>2x</td></tr><tr><td>iPhone 6S Plus</td><td>736 Ã— 414</td><td>2208 Ã— 1242</td><td>5.5</td><td>3x</td></tr><tr><td>iPhone SE</td><td>568 Ã— 320</td><td>1136 Ã— 640</td><td>4.0</td><td>2x</td></tr><tr><td>iPhone 7</td><td>667 Ã— 375</td><td>1334 Ã— 750</td><td>4.7</td><td>2x</td></tr><tr><td>iPhone 7 Plus</td><td>736 Ã— 414</td><td>2208 Ã— 1242</td><td>5.5</td><td>3x</td></tr><tr><td>iPhone 8</td><td>667 Ã— 375</td><td>1334 Ã— 750</td><td>4.7</td><td>2x</td></tr><tr><td>iPhone 8 Plus</td><td>736 Ã— 414</td><td>2208 Ã— 1242</td><td>5.5</td><td>3x</td></tr><tr><td>iPhone X</td><td>812 Ã— 375</td><td>2436 Ã— 1125</td><td>5.8</td><td>3x</td></tr><tr><td>iPhone XS</td><td>812 Ã— 375</td><td>2436 Ã— 1125</td><td>5.8</td><td>3x</td></tr><tr><td>iPhone XR</td><td>896 Ã— 414</td><td>1792 Ã— 828</td><td>6.1</td><td>2x</td></tr><tr><td>iPhone XS Max</td><td>896 Ã— 414</td><td>2688 Ã— 1242</td><td>6.5</td><td>3x</td></tr></tbody></table><hr>]]></content>
      
      
      <categories>
          
          <category> Note </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
            <tag> Objective-C </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸€äº›iOSé¢è¯•åŸºç¡€é¢˜æ€»ç»“</title>
      <link href="/2019-03-01-ios-interview-thing/"/>
      <url>/2019-03-01-ios-interview-thing/</url>
      
        <content type="html"><![CDATA[<p>ä¸€äº›iOSé¢è¯•åŸºç¡€é¢˜æ€»ç»“</p><a id="more"></a><h2 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h2><ol><li>å¤šçº¿ç¨‹</li><li>AutoLayout</li><li>objc_msgSend</li><li>Runtime</li><li>æ¶ˆæ¯è½¬å‘</li><li>Category</li><li>NSObject ä¸ objc_class</li><li>Runloop</li><li>AutoreleasePool</li><li>iOSç³»ç»Ÿæ¶æ„</li><li>Appå¯åŠ¨è¿‡ç¨‹å’Œä¼˜åŒ–</li><li>UIScrollView çš„ä»£ç†æ–¹æ³•</li><li>å“åº”é“¾å’Œäº‹ä»¶ä¼ é€’</li><li>UIView å’Œ CALayer çš„åŒºåˆ«å’Œè”ç³»</li><li>è½®æ’­å›¾æœ´ç´ å®ç°çš„å‡ ç§æ–¹æ³•</li><li>TableView å’Œ CollectionView å¿…é€‰çš„ä»£ç†æ–¹æ³•</li><li>UITableView çš„ä¼˜åŒ–æ€è·¯</li></ol><h2 id="å¤šçº¿ç¨‹"><a href="#å¤šçº¿ç¨‹" class="headerlink" title="å¤šçº¿ç¨‹"></a>å¤šçº¿ç¨‹</h2><h4 id="çº¿ç¨‹ä¹‹é—´åŒæ­¥"><a href="#çº¿ç¨‹ä¹‹é—´åŒæ­¥" class="headerlink" title="çº¿ç¨‹ä¹‹é—´åŒæ­¥"></a>çº¿ç¨‹ä¹‹é—´åŒæ­¥</h4><ol><li>åŸå­æ“ä½œ Atomic</li><li>åŠ é”ï¼ˆäº’æ–¥é”ã€é€’å½’é”ã€è¯»å†™é”ï¼‰NSLockï¼ŒOSSpinLock</li></ol><h4 id="å¤šçº¿ç¨‹ä¹‹é—´é€šä¿¡"><a href="#å¤šçº¿ç¨‹ä¹‹é—´é€šä¿¡" class="headerlink" title="å¤šçº¿ç¨‹ä¹‹é—´é€šä¿¡"></a>å¤šçº¿ç¨‹ä¹‹é—´é€šä¿¡</h4><ul><li>performSelectorOnMainThread:withObject:waitUntilDone:</li></ul><h4 id="å¦‚ä½•ä¿è¯çº¿ç¨‹å®‰å…¨"><a href="#å¦‚ä½•ä¿è¯çº¿ç¨‹å®‰å…¨" class="headerlink" title="å¦‚ä½•ä¿è¯çº¿ç¨‹å®‰å…¨"></a>å¦‚ä½•ä¿è¯çº¿ç¨‹å®‰å…¨</h4><ol><li>OSSpinLock è‡ªæ—‹é”</li><li>dispatch_semaphore</li><li>NSLock ç­‰å„ç§é”</li><li>@synchronized</li></ol><h4 id="å¤šçº¿ç¨‹çš„å‘"><a href="#å¤šçº¿ç¨‹çš„å‘" class="headerlink" title="å¤šçº¿ç¨‹çš„å‘"></a>å¤šçº¿ç¨‹çš„å‘</h4><ol><li>å¸¸é©»çº¿ç¨‹</li></ol><p>å¸¸é©»çº¿ç¨‹å¤šäº†å½±å“CPUæ•ˆç‡</p><p>AFNetworking2.0å› ä¸ºç”¨çš„NSURLConnectionæœ‰ç¼ºé™·ï¼Œéœ€è¦æ‰€åœ¨çº¿ç¨‹ä¸€ç›´å­˜æ´»ï¼Œæ‰€ä»¥ä¿æŒäº†ä¸ªå¸¸é©»çº¿ç¨‹ï¼Œ3.0ç”¨äº†NSURLSessionï¼Œå¯ä»¥æŒ‡å®šå›è°ƒçš„delegateQueueäºæ˜¯å¼ƒç”¨å¸¸é©»çº¿ç¨‹ã€‚</p><p>[runloop run]æ˜¯å¸¸é©»çº¿ç¨‹ï¼Œ[runloop runUntilDate]æŒ‡å®šä¿æ´»æ—¶é•¿</p><ol start="2"><li>å¹¶å‘</li></ol><p>GCDæœ¬ç€æœ€å¤§åŒ–CPUæ•ˆç‡çš„åŸåˆ™ä¼šå¤šåˆ›å»ºçº¿ç¨‹ï¼Œä½†å¦‚æœæ˜¯IOç±»æ“ä½œï¼Œéœ€è¦ç­‰å¾…æ•°æ®çš„ç©ºæ¡£ä¼šç»§ç»­åˆ›å»ºæ–°çº¿ç¨‹å¯¼è‡´å†…å­˜å¤±æ§ã€‚ç±»ä¼¼æ•°æ®åº“æ“ä½œå°½é‡ç”¨ä¸²è¡Œé˜Ÿåˆ—é¿å…å¤šçº¿ç¨‹å¹¶å‘å¯¼è‡´é—®é¢˜ã€‚å› ä¸ºåˆ›å»ºçº¿ç¨‹éœ€è¦å †æ ˆå†…å­˜ï¼Œåˆ‡æ¢çº¿ç¨‹ä¹Ÿæ¶ˆè€—CPUã€‚</p><ol start="3"><li>æ­»é”</li></ol><p>ä¸²è¡Œé˜Ÿåˆ—ï¼ˆå¦‚ä¸»é˜Ÿåˆ—ï¼‰åŒæ­¥æ“ä½œ</p><h2 id="AutoLayout"><a href="#AutoLayout" class="headerlink" title="AutoLayout"></a>AutoLayout</h2><p>æ›´æ–°å±å¹•æ—¶ï¼ŒLayout Engineä»ä¸Šåˆ°ä¸‹è°ƒç”¨layoutSubviews()é€šè¿‡ Cassowary ç®—æ³•è®¡ç®—å„ä¸ªå­è§†å›¾çš„ä½ç½®ï¼Œç®—å‡ºæ¥åå°†å­è§†å›¾çš„ frame ä» Layout Engine é‡Œæ‹·è´å‡ºæ¥ï¼Œæ¥ä¸‹æ¥çš„è¿‡ç¨‹å°±è·Ÿæ‰‹å†™frameæ˜¯ä¸€æ ·çš„äº†ã€‚iOS12ä¼˜åŒ–äº†æ€§èƒ½ï¼Œä»¥å‰å…ƒç´ å¤šäº†ä¼šå¯¼è‡´æ€§èƒ½ä¸‹é™ï¼Œç°æ­£ä¸ä¼šäº†</p><h2 id="objc-msgSend"><a href="#objc-msgSend" class="headerlink" title="objc_msgSend"></a>objc_msgSend</h2><ol><li>æ£€æŸ¥è¿™ä¸ªselectoræ˜¯ä¸æ˜¯è¦å¿½ç•¥çš„</li><li>æ£€æŸ¥targetæ˜¯ä¸æ˜¯nil<ul><li>å¦‚æœæœ‰ç›¸åº”å¤„ç†nilçš„å‡½æ•°å°±è·³è½¬åˆ°è¯¥å‡½æ•°</li><li>å¦‚æœæ²¡æœ‰å°±è‡ªåŠ¨æ¸…ç†ç°åœºå¹¶è¿”å›ï¼Œè¿™å°±æ˜¯OCä¸­ç»™nilå‘æ¶ˆæ¯ä¸ä¼šå´©æºƒçš„åŸå› </li></ul></li><li>ç¡®å®šä¸æ˜¯ç»™nilå‘æ¶ˆæ¯åï¼Œåœ¨è¯¥classçš„ç¼“å­˜ä¸­æŸ¥æ‰¾æ–¹æ³•å¯¹åº”çš„IMPå®ç°<ul><li>å¦‚æœæ‰¾åˆ°å°±è·³è½¬è¿›å»</li><li>å¦‚æœæ²¡æ‰¾åˆ°å°±åœ¨æ–¹æ³•åˆ†å‘è¡¨é‡Œç»§ç»­æŸ¥æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°NSObjectä¸ºæ­¢</li></ul></li><li>å¦‚æœè¿˜æ²¡æ‰¾åˆ°å°±å¼€å§‹æ¶ˆæ¯è½¬å‘ï¼Œä¸Šè¿°è¿‡ç¨‹å°±æ˜¯é€šè¿‡SELå¿«é€ŸæŸ¥æ‰¾IMPçš„è¿‡ç¨‹</li></ol><h2 id="Runtime"><a href="#Runtime" class="headerlink" title="Runtime"></a>Runtime</h2><p>Cè¯­è¨€ä¸­ï¼Œç¼–è¯‘æœŸå‡½æ•°çš„è°ƒç”¨å°±å†³å®šè°ƒç”¨å“ªä¸ªå‡½æ•°ï¼Œè€ŒOCåªæœ‰åœ¨çœŸæ­£è¿è¡Œæ—¶æ‰æ ¹æ®å‡½æ•°åç§°æ‰¾åˆ°å¯¹åº”å‡½æ•°æ¥è°ƒç”¨ã€‚éœ€è¦ä¸€ä¸ªè¿è¡Œæ—¶ç³»ç»Ÿæ¥åŠ¨æ€åœ°åˆ›å»ºç±»å’Œå¯¹è±¡ã€æ¶ˆæ¯ä¼ é€’å’Œè½¬å‘</p><ol><li><p>è®²ä¸€ä¸‹ OC çš„æ¶ˆæ¯æœºåˆ¶</p><ul><li>OCä¸­çš„æ–¹æ³•è°ƒç”¨å…¶å®éƒ½æ˜¯è½¬æˆäº†objc_msgSendå‡½æ•°çš„è°ƒç”¨ï¼Œç»™receiverï¼ˆæ–¹æ³•è°ƒç”¨è€…ï¼‰å‘é€äº†ä¸€æ¡æ¶ˆæ¯ï¼ˆselectoræ–¹æ³•åï¼‰</li><li>objc_msgSendåº•å±‚æœ‰3å¤§é˜¶æ®µ:æ¶ˆæ¯å‘é€ï¼ˆå½“å‰ç±»ã€çˆ¶ç±»ä¸­æŸ¥æ‰¾ï¼‰ã€åŠ¨æ€æ–¹æ³•è§£æã€æ¶ˆæ¯è½¬å‘</li><li>å½“é€’å½’åœ°æ‰¾ä¸åˆ°selectoræ—¶ï¼Œå¯åŠ¨æ¶ˆæ¯è½¬å‘ï¼šresolveInstanceMethodã€resolveClassMethodã€forwardingTargetForSelector</li></ul></li><li><p>ä»€ä¹ˆæ˜¯Runtimeï¼Ÿå¹³æ—¶é¡¹ç›®ä¸­æœ‰ç”¨è¿‡ä¹ˆï¼Ÿ</p><ul><li>OCæ˜¯ä¸€é—¨åŠ¨æ€æ€§æ¯”è¾ƒå¼ºçš„ç¼–ç¨‹è¯­è¨€ï¼Œå…è®¸å¾ˆå¤šæ“ä½œæ¨è¿Ÿåˆ°ç¨‹åºè¿è¡Œæ—¶å†è¿›è¡Œ</li><li>OCçš„åŠ¨æ€æ€§å°±æ˜¯ç”±Runtimeæ¥æ”¯æ’‘å’Œå®ç°çš„ï¼ŒRuntimeæ˜¯ä¸€å¥—Cè¯­è¨€çš„APIï¼Œå°è£…äº†å¾ˆå¤šåŠ¨æ€æ€§ç›¸å…³çš„å‡½æ•°</li><li>å¹³æ—¶ç¼–å†™çš„OCä»£ç ï¼Œåº•å±‚éƒ½æ˜¯è½¬æ¢æˆäº†Runtime APIè¿›è¡Œè°ƒç”¨</li></ul></li><li><p>Runtime çš„åº”ç”¨ï¼ˆä¼˜ç‚¹ï¼‰ï¼š</p><ul><li>å®ç°å¤šç»§æ‰¿ Multiple Inheritance</li><li>Method Swizzling -&gt; æ— ä¾µå…¥åŸ‹ç‚¹ -&gt; ä½¿ç”¨Categoryè¿›è¡Œ</li><li>Aspect Oriented Prigramming é¢å‘åˆ‡é¢ç¼–ç¨‹AOP -&gt; å¦‚æ—¥å¿—ã€èº«ä»½éªŒè¯ã€ç¼“å­˜ç­‰æ¨¡å—</li><li>isa Swizzling -&gt; KVOçš„å®ç°</li><li>Associated Objectå…³è”å¯¹è±¡(ç»™Categoryæ·»åŠ å±æ€§) objc_set(get)AssociatedObject </li><li>åŠ¨æ€åœ°å¢åŠ æ–¹æ³•</li><li>NSCoding çš„è‡ªåŠ¨å½’æ¡£å’Œè‡ªåŠ¨è§£æ¡£</li><li>å­—å…¸å’Œæ¨¡å‹ç›¸äº’è½¬æ¢ï¼</li><li>å¼‚å¸¸ä¿æŠ¤ï¼ˆä¿æŠ¤æ•°ç»„è¶Šç•Œé—®é¢˜ï¼‰</li></ul></li><li><p>Runtime çš„ç¼ºç‚¹</p><ul><li>Method Swizzling ä¸æ˜¯åŸå­æ“ä½œï¼Œæ”¾åœ¨+loadé‡Œæ²¡é—®é¢˜ï¼Œæ”¾åœ¨+initializeé‡Œå°±æœ‰é—®é¢˜äº†</li><li>é‡å†™æ–¹æ³•è€Œä¸è°ƒç”¨superæ–¹æ³•å¯èƒ½æœ‰é—®é¢˜</li></ul></li><li><p>Runtime æ³¨æ„äº‹é¡¹</p><ul><li>Swizzlingåº”è¯¥æ€»åœ¨+loadä¸­æ‰§è¡Œ</li><li>Swizzlingåº”è¯¥æ€»åœ¨dispatch_onceä¸­æ‰§è¡Œ -&gt; å› ä¸ºä¼šæ”¹å˜å…¨å±€çŠ¶æ€æ‰€ä»¥åº”è¯¥åªæ‰§è¡Œä¸€æ¬¡</li><li>+loadä¸­æ‰§è¡ŒSwizzlingæ—¶ï¼Œä¸è¦è°ƒç”¨[super load] -&gt; é¿å…å¶æ•°æ¬¡æ‰§è¡ŒSwizzling</li></ul></li></ol><ul><li>SELå…¶æœ¬èº«æ˜¯ä¸€ä¸ªIntç±»å‹çš„åœ°å€ï¼Œåœ°å€ä¸­å­˜æ”¾ç€æ–¹æ³•çš„åå­—ã€‚</li></ul><h2 id="Method-Swizzling"><a href="#Method-Swizzling" class="headerlink" title="Method Swizzling"></a>Method Swizzling</h2><h4 id="å‡ ä¸ªå¸¸è§æ–¹æ³•"><a href="#å‡ ä¸ªå¸¸è§æ–¹æ³•" class="headerlink" title="å‡ ä¸ªå¸¸è§æ–¹æ³•"></a>å‡ ä¸ªå¸¸è§æ–¹æ³•</h4><ol><li>method_setImplementation</li></ol><p>ä¸ºä¸€ä¸ªæ–¹æ³•åè®¾ç½®IMP(å®ç°)</p><ol start="2"><li>method_exchangeImplementations</li></ol><p>äº¤æ¢ä¸¤ä¸ªæ–¹æ³•åçš„å®ç°ï¼Œå³æ‰§è¡Œä¸¤æ¬¡ method_setImplementation</p><ol start="3"><li>class_addMethod</li></ol><p>æ ¹æ®å®˜æ–¹æ³¨é‡Šè§£é‡Šï¼Œè¿™ä¸ªæ–¹æ³•ç”¨äºç»™æŒ‡å®šçš„ç±»å¢åŠ æ–¹æ³•åå’ŒIMP(å®ç°)ï¼Œå¦‚æœè¯¥å·²ç»å­˜åœ¨è¿™ä¸ªæ–¹æ³•åï¼Œä¸åšäº‹ï¼Œè¿”å›NOï¼Œå¦‚æœè¯¥ç±»ä¸å­˜åœ¨è¿™ä¸ªæ–¹æ³•åï¼ˆå³ä½¿çˆ¶ç±»å­˜åœ¨ï¼‰ï¼Œæ·»åŠ è¿™ä¸ªæ–¹æ³•ï¼Œè¿”å›YES</p><ol start="4"><li>class_replaceMethod</li></ol><p>æ ¹æ®å®˜æ–¹æ³¨é‡Šè§£é‡Šï¼Œå®ƒæœ‰ä¸¤ç§ä¸åŒçš„è¡Œä¸ºã€‚å½“ç±»ä¸­æ²¡æœ‰æƒ³æ›¿æ¢çš„åŸæ–¹æ³•æ—¶ï¼Œè¯¥æ–¹æ³•ä¼šè°ƒç”¨ class_addMethod æ¥ä¸ºè¯¥ç±»å¢åŠ ä¸€ä¸ªæ–°æ–¹æ³•ã€‚è‹¥å·²å­˜åœ¨ï¼Œåˆ™ç­‰åŒäº method_setImplementation ä¸ºè¯¥æ–¹æ³•åæ›¿æ¢IMP(å®ç°)</p><h4 id="Swizzling-æ¨¡æ¿"><a href="#Swizzling-æ¨¡æ¿" class="headerlink" title="Swizzling æ¨¡æ¿"></a>Swizzling æ¨¡æ¿</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">+ (<span class="keyword">void</span>)hookClass:(Class)classObject fromSelector:(SEL)fromSelector toSelector:(SEL)toSelector &#123;</span><br><span class="line">    Class <span class="keyword">class</span> = classObject;</span><br><span class="line">    Method fromMethod = class_getInstanceMethod(<span class="keyword">class</span>, fromSelector); <span class="comment">// å¾—åˆ°è¢«äº¤æ¢ç±»çš„å®ä¾‹æ–¹æ³•</span></span><br><span class="line">    Method toMethod = class_getInstanceMethod(<span class="keyword">class</span>, toSelector); <span class="comment">// å¾—åˆ°äº¤æ¢ç±»çš„å®ä¾‹æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">if</span>(class_addMethod(<span class="keyword">class</span>, fromSelector, method_getImplementation(toMethod), method_getTypeEncoding(toMethod))) &#123;</span><br><span class="line">        class_replaceMethod(<span class="keyword">class</span>, toSelector, method_getImplementation(fromMethod), method_getTypeEncoding(fromMethod)); <span class="comment">// è¿›è¡Œæ–¹æ³•çš„äº¤æ¢</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        method_exchangeImplementations(fromMethod, toMethod); <span class="comment">// äº¤æ¢ IMP æŒ‡é’ˆ</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">+ (<span class="keyword">void</span>)load &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="built_in">dispatch_once_t</span> onceToken;</span><br><span class="line">    <span class="built_in">dispatch_once</span>(&amp;onceToken, ^&#123;</span><br><span class="line">        Class aClass = [<span class="keyword">self</span> <span class="keyword">class</span>];</span><br><span class="line">        </span><br><span class="line">        SEL originalSelector = <span class="keyword">@selector</span>(viewWillAppear:);</span><br><span class="line">        SEL swizzledSelector = <span class="keyword">@selector</span>(xxx_viewWillAppear:);</span><br><span class="line">        </span><br><span class="line">        Method originalMethod = class_getInstanceMethod(aClass, originalSelector);</span><br><span class="line">        Method swizzledMethod = class_getInstanceMethod(aClass, swizzledSelector);</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">BOOL</span> didAddMethod =</span><br><span class="line">        class_addMethod(aClass,</span><br><span class="line">                        originalSelector,</span><br><span class="line">                        method_getImplementation(swizzledMethod),</span><br><span class="line">                        method_getTypeEncoding(swizzledMethod));</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (didAddMethod) &#123;</span><br><span class="line">            class_replaceMethod(aClass,</span><br><span class="line">                                swizzledSelector,</span><br><span class="line">                                method_getImplementation(originalMethod),</span><br><span class="line">                                method_getTypeEncoding(originalMethod));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            method_exchangeImplementations(originalMethod, swizzledMethod);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ¶ˆæ¯è½¬å‘"><a href="#æ¶ˆæ¯è½¬å‘" class="headerlink" title="æ¶ˆæ¯è½¬å‘"></a>æ¶ˆæ¯è½¬å‘</h2><p>ä»€ä¹ˆæ—¶å€™ä¼šæŠ¥unrecognized selectorçš„å¼‚å¸¸ï¼Ÿ</p><blockquote><p>å½“è°ƒç”¨è¯¥å¯¹è±¡ä¸ŠæŸä¸ªæ–¹æ³•,è€Œè¯¥å¯¹è±¡ä¸Šæ²¡æœ‰å®ç°è¿™ä¸ªæ–¹æ³•çš„æ—¶å€™ï¼Œ å¯ä»¥é€šè¿‡â€œæ¶ˆæ¯è½¬å‘â€è¿›è¡Œè§£å†³ã€‚</p></blockquote><p>objcåœ¨å‘ä¸€ä¸ªå¯¹è±¡å‘é€æ¶ˆæ¯æ—¶ï¼Œruntimeåº“ä¼šæ ¹æ®å¯¹è±¡çš„isaæŒ‡é’ˆæ‰¾åˆ°è¯¥å¯¹è±¡å®é™…æ‰€å±çš„ç±»ï¼Œç„¶ååœ¨è¯¥ç±»ä¸­çš„æ–¹æ³•åˆ—è¡¨ä»¥åŠå…¶çˆ¶ç±»æ–¹æ³•åˆ—è¡¨ä¸­å¯»æ‰¾æ–¹æ³•è¿è¡Œï¼Œå¦‚æœï¼Œåœ¨æœ€é¡¶å±‚çš„çˆ¶ç±»ä¸­ä¾ç„¶æ‰¾ä¸åˆ°ç›¸åº”çš„æ–¹æ³•æ—¶ï¼Œç¨‹åºåœ¨è¿è¡Œæ—¶ä¼šæŒ‚æ‰å¹¶æŠ›å‡ºå¼‚å¸¸unrecognized selector sent to XXX ã€‚ä½†æ˜¯åœ¨è¿™ä¹‹å‰ï¼Œobjcçš„è¿è¡Œæ—¶ä¼šç»™å‡ºä¸‰æ¬¡æ‹¯æ•‘ç¨‹åºå´©æºƒçš„æœºä¼šï¼š</p><ol><li>Method resolution</li></ol><p>objcè¿è¡Œæ—¶ä¼šè°ƒç”¨<code>+resolveInstanceMethod:</code>æˆ–è€… +resolveClassMethod:ï¼Œè®©ä½ æœ‰æœºä¼šæä¾›ä¸€ä¸ªå‡½æ•°å®ç°ã€‚å¦‚æœä½ æ·»åŠ äº†å‡½æ•°ï¼Œé‚£è¿è¡Œæ—¶ç³»ç»Ÿå°±ä¼šé‡æ–°å¯åŠ¨ä¸€æ¬¡æ¶ˆæ¯å‘é€çš„è¿‡ç¨‹ï¼Œå¦åˆ™ ï¼Œè¿è¡Œæ—¶å°±ä¼šç§»åˆ°ä¸‹ä¸€æ­¥ï¼Œæ¶ˆæ¯è½¬å‘ï¼ˆMessage Forwardingï¼‰ã€‚</p><ol start="2"><li>Fast forwarding</li></ol><p>å¦‚æœç›®æ ‡å¯¹è±¡å®ç°äº†<code>-forwardingTargetForSelector:</code>ï¼ŒRuntime è¿™æ—¶å°±ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œç»™ä½ æŠŠè¿™ä¸ªæ¶ˆæ¯è½¬å‘ç»™å…¶ä»–å¯¹è±¡çš„æœºä¼šã€‚ åªè¦è¿™ä¸ªæ–¹æ³•è¿”å›çš„ä¸æ˜¯nilå’Œselfï¼Œæ•´ä¸ªæ¶ˆæ¯å‘é€çš„è¿‡ç¨‹å°±ä¼šè¢«é‡å¯ï¼Œå½“ç„¶å‘é€çš„å¯¹è±¡ä¼šå˜æˆä½ è¿”å›çš„é‚£ä¸ªå¯¹è±¡ã€‚å¦åˆ™ï¼Œå°±ä¼šç»§ç»­Normal Fowardingã€‚ è¿™é‡Œå«Fastï¼Œåªæ˜¯ä¸ºäº†åŒºåˆ«ä¸‹ä¸€æ­¥çš„è½¬å‘æœºåˆ¶ã€‚å› ä¸ºè¿™ä¸€æ­¥ä¸ä¼šåˆ›å»ºä»»ä½•æ–°çš„å¯¹è±¡ï¼Œä½†ä¸‹ä¸€æ­¥è½¬å‘ä¼šåˆ›å»ºä¸€ä¸ªNSInvocationå¯¹è±¡ï¼Œæ‰€ä»¥ç›¸å¯¹æ›´å¿«ç‚¹ã€‚</p><ol start="3"><li>Normal forwarding</li></ol><p>è¿™ä¸€æ­¥æ˜¯Runtimeæœ€åä¸€æ¬¡ç»™ä½ æŒ½æ•‘çš„æœºä¼šã€‚é¦–å…ˆå®ƒä¼šå‘é€<code>-methodSignatureForSelector:</code>æ¶ˆæ¯è·å¾—å‡½æ•°çš„å‚æ•°å’Œè¿”å›å€¼ç±»å‹ã€‚å¦‚æœ-methodSignatureForSelector:è¿”å›nilï¼ŒRuntimeåˆ™ä¼šå‘å‡º-doesNotRecognizeSelector:æ¶ˆæ¯ï¼Œç¨‹åºè¿™æ—¶ä¹Ÿå°±æŒ‚æ‰äº†ã€‚å¦‚æœè¿”å›äº†ä¸€ä¸ªå‡½æ•°ç­¾åï¼ŒRuntimeå°±ä¼šåˆ›å»ºä¸€ä¸ªNSInvocationå¯¹è±¡å¹¶å‘é€<code>-forwardInvocation:</code>æ¶ˆæ¯ç»™ç›®æ ‡å¯¹è±¡ã€‚</p><h2 id="Category"><a href="#Category" class="headerlink" title="Category"></a>Category</h2><p>é€šè¿‡Runtimeç»™ç±»æ·»åŠ æ–¹æ³•ï¼Œå¯ä»¥æŠŠç±»çš„å®ç°åˆ†å¼€åœ¨å‡ ä¸ªä¸åŒçš„æ–‡ä»¶ï¼Œå‡å°‘å•ä¸ªæ–‡ä»¶ä½“ç§¯ã€ä¸åŒåŠŸèƒ½ç»„ç»‡åˆ°ä¸åŒçš„Categoryé‡Œã€å¯ä»¥ç”±å¤šäººå¼€å‘ä¸€ä¸ªç±»ã€å¯ä»¥æŒ‰éœ€åŠ è½½æƒ³è¦çš„categoryã€å¯ä»¥æŠŠframeworkçš„ç§æœ‰æ–¹æ³•å…¬å¼€</p><p>ä¸extensionä¸åŒçš„æ˜¯ï¼Œextensionéœ€è¦æœ‰ç±»çš„æºç æ‰èƒ½æ·»åŠ ï¼Œæ‰€ä»¥æ— æ³•ä¸ºç³»ç»Ÿç±»æ·»åŠ extensionã€‚</p><p>è€Œcategoryæ˜¯è¿è¡Œæ—¶æ·»åŠ çš„ã€‚æ‰€ä»¥ï¼Œextensionå¯ä»¥æ·»åŠ å®ä¾‹å˜é‡ï¼Œè€Œcategoryåªèƒ½æ·»åŠ å®ä¾‹æ–¹æ³•ã€ç±»æ–¹æ³•ã€åè®®ã€å±æ€§ï¼Œä½†æ˜¯ä¸èƒ½æ·»åŠ å®ä¾‹å˜é‡ã€‚</p><p>categoryå¹¶ä¸æ˜¯å®Œå…¨æ›¿æ¢æ‰åŸæ¥ç±»çš„æ–¹æ³•ï¼Œè€Œæ˜¯é™„åŠ åˆ°æ–¹æ³•åˆ—è¡¨çš„å‰é¢ï¼Œè€Œruntimeå¯»æ‰¾æ–¹æ³•æ˜¯é¡ºç€æ‰¾çš„ï¼Œæ‰¾åˆ°categoryè¦†ç›–çš„æ–¹æ³•åå°±æ‰§è¡Œäº†</p><h2 id="NSObject-ä¸-objc-class"><a href="#NSObject-ä¸-objc-class" class="headerlink" title="NSObject ä¸ objc_class"></a>NSObject ä¸ objc_class</h2><p>NSObject ç»§æ‰¿è‡ª objc_class<br>objc_class ç»§æ‰¿è‡ª objc_object</p><p><code>objc_object -&gt; objc_class -&gt; NSObject</code></p><p>æ‰€ä»¥OCä¸­ï¼Œç±»ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚</p><p>objc_classä¸­ï¼Œé™¤äº†isaï¼Œè¿˜æœ‰3ä¸ªæˆå‘˜å˜é‡ï¼Œä¸€ä¸ªæ˜¯çˆ¶ç±»çš„æŒ‡é’ˆï¼Œä¸€ä¸ªæ˜¯æ–¹æ³•ç¼“å­˜ï¼Œæœ€åä¸€ä¸ªè¿™ä¸ªç±»çš„å®ä¾‹æ–¹æ³•é“¾è¡¨ã€‚</p><p>æ¯ä¸ªç±»éƒ½æœ‰å•ç‹¬çš„å…ƒç±»ï¼Œæ‰€ä»¥ç±»çš„superclassæŒ‡é’ˆé€’å½’æœ€åæŒ‡å‘NSObjectï¼ŒNSObjectæ²¡æœ‰è¶…ç±»æ‰€ä»¥æŒ‡å‘nilã€‚ç±»çš„isaæŒ‡å‘å¯¹åº”å”¯ä¸€çš„å…ƒç±»ï¼Œæ¯ä¸ªå…ƒç±»çš„isaéƒ½æŒ‡å‘rootMetaClassï¼ŒrootMetaClassçš„superClassæŒ‡å‘NSObjectï¼ŒisaæŒ‡å‘è‡ªå·±</p><p>å…ƒç±»ä¸­ä¿å­˜äº†åˆ›å»ºç±»å¯¹è±¡ä»¥åŠç±»æ–¹æ³•æ‰€éœ€çš„æ‰€æœ‰ä¿¡æ¯</p><h2 id="Runloop"><a href="#Runloop" class="headerlink" title="Runloop"></a>Runloop</h2><p>å¯ä»¥å…ˆç²—çœ‹è¿™ç¯‡<a href="https://blog.ibireme.com/2015/05/18/runloop/" target="_blank" rel="noopener">YYKitå¤§ç¥ibiremeçš„æ–‡ç« </a>ï¼Œå¤§æ¦‚è¿‡ä¸€éï¼Œä¸ç”¨çº ç»“æºç å’Œçœ‹ä¸æ‡‚çš„åœ°æ–¹ã€‚<br>ç„¶åçœ‹è¿™ä¸ª<a href="https://v.youku.com/v_show/id_XODgxODkzODI0.html" target="_blank" rel="noopener">å­™æºçš„çº¿ä¸‹åˆ†äº«ä¼šè§†é¢‘</a>ï¼Œæœ€åå†ç»†çœ‹ä¸€éé‚£ç¯‡æ–‡ç« </p><h4 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h4><p>è¿è¡Œå¾ªç¯ï¼Œåœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­å¾ªç¯åšä¸€äº›äº‹æƒ…ï¼Œå¦‚æœæ²¡æœ‰Runloopç¨‹åºæ‰§è¡Œå®Œæ¯•å°±ä¼šç«‹å³é€€å‡ºï¼Œå¦‚æœæœ‰Runloopç¨‹åºä¼šä¸€ç›´è¿è¡Œï¼Œå¹¶ä¸”æ—¶æ—¶åˆ»åˆ»åœ¨ç­‰å¾…ç”¨æˆ·çš„è¾“å…¥æ“ä½œã€‚RunLoopå¯ä»¥åœ¨éœ€è¦çš„æ—¶å€™è‡ªå·±è·‘èµ·æ¥è¿è¡Œï¼Œåœ¨æ²¡æœ‰æ“ä½œçš„æ—¶å€™å°±åœä¸‹æ¥ä¼‘æ¯ã€‚å……åˆ†èŠ‚çœCPUèµ„æºï¼Œæé«˜ç¨‹åºæ€§èƒ½ã€‚ç®€å•æ¥è¯´å°±æ˜¯è®©è½¯ä»¶ä¸€ç›´æ´»ç€ã€‚</p><h4 id="ç»“æ„"><a href="#ç»“æ„" class="headerlink" title="ç»“æ„"></a>ç»“æ„</h4><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190611111951.png" alt></p><ul><li>ä¸€ä¸ªçº¿ç¨‹å¯¹åº”ä¸€ä¸ª<code>Runloop</code>ï¼Œä¸»çº¿ç¨‹çš„Runloopé»˜è®¤å¼€å¯ï¼Œå­çº¿ç¨‹å¦‚æœä¸æ‰‹åŠ¨å¼€å¯å°±æ²¡æœ‰ã€‚</li><li>æ¯ä¸ªRunloopå†…æœ‰å¤šä¸ªModeï¼Œä½†RunloopåŒä¸€æ—¶é—´åªèƒ½æ‰§è¡Œä¸€ä¸ªModeï¼Œæ¢Modeéœ€è¦åœä¸‹åˆ‡æ¢ã€‚</li><li>æ¯ä¸ªModeå†…æœ‰ä»»æ„å¤šä¸ª<code>Source</code>ã€<code>Timer</code>ã€<code>Observer</code></li></ul><h4 id="Timer"><a href="#Timer" class="headerlink" title="Timer"></a>Timer</h4><ul><li>å³ <code>CFRunloopTimer</code></li><li><code>NSTimer</code>ã€<code>performSelector:afterDelay:</code>ã€<code>CADisplayLink</code>éƒ½æ˜¯å¯¹<code>RunloopTimer</code>çš„å°è£…</li></ul><h4 id="Source"><a href="#Source" class="headerlink" title="Source"></a>Source</h4><ul><li>å³ <code>CFRunlopSource</code>ï¼Œæ˜¯Runloopçš„æ•°æ®æºæŠ½è±¡ç±»</li><li>Sourceåˆ†<code>Source0</code>å’Œ<code>Source1</code></li><li><code>Source0</code>å¤„ç†Appå†…éƒ¨äº‹ä»¶ã€Appè‡ªå·±è´Ÿè´£ç®¡ç†è§¦å‘ã€å¦‚<code>UIEvent</code>ã€<code>CFSocker</code></li><li><code>Source1</code>æœ‰Runloopå’Œå†…æ ¸ç®¡ç†ï¼Œ<code>Mach Port</code>é©±åŠ¨ï¼Œå¦‚<code>CFMachPort</code>ã€<code>CFMessagePort</code></li></ul><h4 id="Observer"><a href="#Observer" class="headerlink" title="Observer"></a>Observer</h4><ul><li>å‘å¤–éƒ¨æŠ¥å‘ŠRunloopå½“å‰çŠ¶æ€çš„æ›´æ”¹</li><li>æ¡†æ¶ä¸­å¾ˆå¤šæœºåˆ¶éƒ½ç”±RunLoopObserverè§¦å‘ï¼Œå¦‚CAAnimation</li><li>ä¸ AutoreleasePool çš„å…³ç³»ï¼šUIKité€šè¿‡Observeråœ¨RunLoopä¸¤ä¸ªSleepä¹‹é—´å¯¹AutoreleasePoolè¿›è¡ŒPopå’ŒPushï¼Œå°†è¿™æ¬¡Loopä¸­äº§ç”Ÿçš„Autoreleaseå¯¹è±¡é‡Šæ”¾</li></ul><h4 id="CFRunLoopMode"><a href="#CFRunLoopMode" class="headerlink" title="CFRunLoopMode"></a>CFRunLoopMode</h4><ul><li>æ¯ä¸ªRunloopå†…æœ‰å¤šä¸ªModeï¼Œä½†RunloopåŒä¸€æ—¶é—´åªèƒ½æ‰§è¡Œä¸€ä¸ªModeï¼Œæ¢Modeéœ€è¦åœæ­¢å½“å‰Loopåˆ‡æ¢ç„¶åé‡å¯Loopã€‚</li></ul><ol><li>é»˜è®¤Modeï¼š<code>NSDefaultRunLoopMode</code>, ç©ºé—²çŠ¶æ€ã€æ™®é€šäº‹ä»¶ç­‰</li><li>ç•Œé¢è¿½è¸ªModeï¼š<code>UITrackingRunLoopMode</code>, æ»‘åŠ¨æ—¶ï¼ˆScrollViewï¼‰</li><li>ç§æœ‰Modeï¼šUIInitializationRunLoopMode, Appåˆšå¯åŠ¨æ—¶, ä¸é‡è¦</li></ol><ul><li><code>NSRunLoopCommonModes</code>æ˜¯ä¸€ä¸ªé›†åˆï¼ˆæ‰“æ ‡ç­¾ï¼‰ï¼Œé»˜è®¤åŒ…å«ä¸Šé¢çš„1å’Œ2ä¸¤ä¸ªModeï¼Œå¯ä»¥è‡ªå·±æ·»åŠ Modeè¿›å»</li><li>å¼€å§‹æ»‘åŠ¨æ—¶ï¼Œä¼šä»DefaultRunLoopModeåˆ‡æ¢æˆUITrackingRunLoopModeï¼Œåœæ­¢æ»‘åŠ¨æ—¶ä¼šåˆ‡æ¢å›æ¥</li><li>æƒ³è®©<code>NSTimer</code>æ»‘åŠ¨æ—¶ä¹Ÿè·‘ï¼Œé»˜è®¤æ˜¯åŠ åˆ°DefaultModeçš„ï¼Œéœ€è¦æ‰‹åŠ¨åŠ åˆ°CommonModesé‡Œï¼Œä½¿å…¶æ»‘åŠ¨æ—¶ä¹Ÿæ‰§è¡Œï¼Œ<code>[(NSRunLoop) addTimer:forMode:]</code></li></ul><h4 id="RunLoop-ä¸-GCD-çš„å…³ç³»"><a href="#RunLoop-ä¸-GCD-çš„å…³ç³»" class="headerlink" title="RunLoop ä¸ GCD çš„å…³ç³»"></a>RunLoop ä¸ GCD çš„å…³ç³»</h4><ul><li>åªåœ¨ç”¨åˆ° main queue æ—¶</li><li>GCD ä¸­ dispatch åˆ° main queue çš„ block è¢«åˆ†å‘åˆ° main RunLoop ä¸­æ‰§è¡Œ</li></ul><h4 id="RunLoop-çš„æŒ‚èµ·ä¸å”¤é†’"><a href="#RunLoop-çš„æŒ‚èµ·ä¸å”¤é†’" class="headerlink" title="RunLoop çš„æŒ‚èµ·ä¸å”¤é†’"></a>RunLoop çš„æŒ‚èµ·ä¸å”¤é†’</h4><ul><li>æŒ‡å®šç”¨äºå”¤é†’çš„ mach_port ç«¯å£</li><li>è°ƒç”¨ mach_msg ç›‘å¬å”¤é†’ç«¯å£ï¼Œè¢«å”¤é†’å‰ï¼Œç³»ç»Ÿå†…æ ¸å°†è¿™ä¸ªçº¿ç¨‹æŒ‚èµ·ï¼Œåœç•™åœ¨ mach_msg_trap çŠ¶æ€<br><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20190611150612.png" alt></li><li>ç”±å¦ä¸€ä¸ªçº¿ç¨‹ï¼ˆæˆ–å¦ä¸€ä¸ªè¿›ç¨‹ä¸­çš„æŸä¸ªçº¿ç¨‹ï¼‰å‘å†…æ ¸å‘é€è¯¥ç«¯å£çš„msgåï¼ŒtrapçŠ¶æ€è¢«å”¤é†’ï¼ŒRunLoopç»§ç»­ä¸‹ä¸€è½®</li></ul><h4 id="ä½œç”¨"><a href="#ä½œç”¨" class="headerlink" title="ä½œç”¨"></a>ä½œç”¨</h4><ol><li>ä¿æŒç¨‹åºæŒç»­è¿è¡Œï¼Œç¨‹åºä¸€å¯åŠ¨å°±ä¼šå¼€ä¸€ä¸ªä¸»çº¿ç¨‹ï¼Œä¸»çº¿ç¨‹ä¸€å¼€èµ·æ¥å°±ä¼šè·‘ä¸€ä¸ªä¸»çº¿ç¨‹å¯¹åº”çš„RunLoop,RunLoopä¿è¯ä¸»çº¿ç¨‹ä¸ä¼šè¢«é”€æ¯ï¼Œä¹Ÿå°±ä¿è¯äº†ç¨‹åºçš„æŒç»­è¿è¡Œï¼Œå¯¹äºå­çº¿ç¨‹å¯ä»¥ä½¿ç”¨runæ¥å¸¸é©»çº¿ç¨‹ã€‚</li><li>ä¿è¯NSTimeræ­£å¸¸è¿è½¬</li><li>çº¿ä¸Šç›‘æµ‹Appå¡é¡¿æƒ…å†µ</li><li>å¤„ç†Appä¸­çš„å„ç§äº‹ä»¶ï¼ˆæ¯”å¦‚ï¼šè§¦æ‘¸äº‹ä»¶ï¼Œå®šæ—¶å™¨äº‹ä»¶ï¼ŒSelectoräº‹ä»¶ç­‰ï¼‰</li><li>èŠ‚çœCPUèµ„æºï¼Œæé«˜ç¨‹åºæ€§èƒ½ï¼Œç¨‹åºè¿è¡Œèµ·æ¥æ—¶ï¼Œå½“ä»€ä¹ˆæ“ä½œéƒ½æ²¡æœ‰åšçš„æ—¶å€™ï¼ŒRunLoopå°±å‘Šè¯‰CUPï¼Œç°åœ¨æ²¡æœ‰äº‹æƒ…åšï¼Œæˆ‘è¦å»ä¼‘æ¯ï¼Œè¿™æ—¶CUPå°±ä¼šå°†å…¶èµ„æºé‡Šæ”¾å‡ºæ¥å»åšå…¶ä»–çš„äº‹æƒ…ï¼Œå½“æœ‰äº‹æƒ…åšçš„æ—¶å€™RunLoopå°±ä¼šç«‹é©¬èµ·æ¥å»åšäº‹æƒ…</li></ol><h4 id="è¿‡ç¨‹"><a href="#è¿‡ç¨‹" class="headerlink" title="è¿‡ç¨‹"></a>è¿‡ç¨‹</h4><ol><li>è¿›å…¥loop</li><li>do while ä¿æ´»çº¿ç¨‹ï¼šè§¦å‘Timerå›è°ƒã€è§¦å‘Source()å›è°ƒã€æ‰§è¡Œblock</li><li>è¿›å…¥ä¼‘çœ </li><li>ç­‰å¾…mach_portæ¶ˆæ¯ï¼ˆå¦‚Timeræ—¶é—´åˆ°ã€Runloopè¶…æ—¶ã€è¢«è°ƒç”¨è€…å”¤é†’ï¼‰</li><li>å”¤é†’ï¼Œå¤„ç†æ¶ˆæ¯</li><li>åˆ¤æ–­æ˜¯å¦è¿›å…¥ä¸‹ä¸€ä¸ªloop</li></ol><h4 id="AFNetworkingçš„RunLoopç”¨æ³•"><a href="#AFNetworkingçš„RunLoopç”¨æ³•" class="headerlink" title="AFNetworkingçš„RunLoopç”¨æ³•"></a>AFNetworkingçš„RunLoopç”¨æ³•</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">+ (<span class="keyword">void</span>)networkRequestThreadEntryPoint:(<span class="keyword">id</span>)__unused object &#123;</span><br><span class="line">    <span class="keyword">@autoreleasepool</span> &#123;</span><br><span class="line">        [[<span class="built_in">NSThread</span> currentThread] setName:<span class="string">@"AFNetworking"</span>];</span><br><span class="line">        <span class="built_in">NSRunLoop</span> *runLoop = [<span class="built_in">NSRunLoop</span> currentRunLoop];</span><br><span class="line">        [runLoop addPort:[<span class="built_in">NSMachPort</span> port] forMode:<span class="built_in">NSDefaultRunLoopMode</span>];</span><br><span class="line">        [runLoop run];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">+ (<span class="built_in">NSThread</span> *)networkRequestThread &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="built_in">NSThread</span> *_networkRequestThread = <span class="literal">nil</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="built_in">dispatch_once_t</span> oncePredicate;</span><br><span class="line">    <span class="built_in">dispatch_once</span>(&amp;oncePredicate, ^&#123;</span><br><span class="line">        _networkRequestThread = [[<span class="built_in">NSThread</span> alloc] initWithTarget:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(networkRequestThreadEntryPoint:) object:<span class="literal">nil</span>];</span><br><span class="line">        [_networkRequestThread start];</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> _networkRequestThread;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>åœ¨å­çº¿ç¨‹å¼€å¯RunLoopï¼Œæ·»åŠ ä¸€ä¸ªä¸ä¼šç”¨åˆ°çš„portä½œä¸ºSourceé˜²æ­¢RunLoopåœæ­¢</li><li><code>[runloop run]</code>ä½¿å­çº¿ç¨‹å¸¸é©»ï¼Œä»è€Œæ¥æ”¶NSURLConnectionçš„å›è°ƒ</li><li>åœ¨AFçš„3.0ç‰ˆæœ¬é‡Œæ›¿æ¢æˆNSURLSessionå°±ä¸éœ€è¦å¸¸é©»çº¿ç¨‹äº†</li></ul><h4 id="åˆ©ç”¨RunLoopå»¶æ—¶åŠ è½½å›¾ç‰‡"><a href="#åˆ©ç”¨RunLoopå»¶æ—¶åŠ è½½å›¾ç‰‡" class="headerlink" title="åˆ©ç”¨RunLoopå»¶æ—¶åŠ è½½å›¾ç‰‡"></a>åˆ©ç”¨RunLoopå»¶æ—¶åŠ è½½å›¾ç‰‡</h4><ul><li>å½“scrollviewæ»‘åŠ¨æ—¶åŠ è½½å›¾ç‰‡å¯èƒ½å¯¼è‡´å¡é¡¿</li><li>åŸæœ¬åšæ³•å¯ä»¥é€šè¿‡delegateå¤„ç†æ˜¯å¦åŠ è½½</li><li>åˆ©ç”¨RunLoopï¼šæŠŠå›¾ç‰‡åŠ è½½çš„æ–¹æ³•æ”¾åœ¨<code>NSDefaultRunLoopMode</code>é‡Œï¼Œè¿™æ ·å½“æ»‘åŠ¨æ—¶å°±åˆ‡æ¢å‡ºäº†è¿™ä¸ªModeï¼Œæš‚åœåŠ è½½</li></ul><h4 id="Crashæ—¶é‡å¯RunLoop"><a href="#Crashæ—¶é‡å¯RunLoop" class="headerlink" title="Crashæ—¶é‡å¯RunLoop"></a>Crashæ—¶é‡å¯RunLoop</h4><ul><li>æ¥åˆ° Crash çš„ Signal åæ‰‹åŠ¨é‡å¯ RunLoop</li><li>ä¸é€‚ç”¨äº BAD_ACCESS</li></ul><h4 id="ç›‘æµ‹å¡é¡¿çš„æ–¹æ³•"><a href="#ç›‘æµ‹å¡é¡¿çš„æ–¹æ³•" class="headerlink" title="ç›‘æµ‹å¡é¡¿çš„æ–¹æ³•"></a>ç›‘æµ‹å¡é¡¿çš„æ–¹æ³•</h4><ol><li>åˆ›å»ºè§‚å¯Ÿè€…</li><li>æŠŠè§‚å¯Ÿè€…æ·»åŠ åˆ°ä¸»çº¿ç¨‹çš„Runloopçš„commonæ¨¡å¼ä¸‹è§‚å¯Ÿï¼Œç„¶ååˆ›å»ºä¸€ä¸ªå¸¸é©»å­çº¿ç¨‹ä¸“é—¨ç”¨æ¥ç›‘æ§ä¸»çº¿ç¨‹çš„RunloopçŠ¶æ€</li><li>ä¸€æ—¦å‘ç°runloopè¿›å…¥ç¡çœ å‰çš„çŠ¶æ€æˆ–è€…å”¤é†’åçš„çŠ¶æ€åœ¨è®¾ç½®çš„æ—¶é—´é˜ˆå€¼å†…æ²¡æœ‰å˜åŒ–ï¼Œå³å¯åˆ¤å®šä¸ºå¡é¡¿ï¼Œç”¨ç¬¬ä¸‰æ–¹åº“PLCrashReporteræ¥è·å–å †æ ˆä¿¡æ¯ï¼Œä¸ŠæŠ¥æœåŠ¡å™¨ã€‚åç»­åˆ†æã€‚</li></ol><h2 id="AutoreleasePool"><a href="#AutoreleasePool" class="headerlink" title="AutoreleasePool"></a>AutoreleasePool</h2><p>é…åˆrunloopçš„ï¼Œæ¯æ¬¡runloopå¼€å¯æ—¶é‡å»ºè‡ªåŠ¨é‡Šæ”¾æ± ï¼Œä¼‘æ¯å‰é‡Šæ”¾æ‰æ± é‡Œçš„ä¸œè¥¿å¦‚Timer<br>ARCä¸‹è‡ªåŠ¨åˆ›å»ºçš„åœ¨å­çº¿ç¨‹ç»“æŸåé‡Šæ”¾ï¼Œæ‰‹åŠ¨åˆ›å»ºçš„åœ¨ä½œç”¨åŸŸå¤§æ‹¬å·ç»“æŸåé‡Šæ”¾<br>åº•å±‚å®ç° AutoReleasePoolPage æ˜¯ä¸€ä¸ªåŒå‘é“¾è¡¨ï¼Œæœ‰push release popæ“ä½œ</p><h2 id="iOSç³»ç»Ÿæ¶æ„"><a href="#iOSç³»ç»Ÿæ¶æ„" class="headerlink" title="iOSç³»ç»Ÿæ¶æ„"></a>iOSç³»ç»Ÿæ¶æ„</h2><p>å››ä¸ªå±‚</p><ul><li>ç¬¬ä¸€å±‚ï¼šç”¨æˆ·ä½“éªŒå±‚ï¼šSpringBoard</li><li>ç¬¬äºŒå±‚ï¼šåº”ç”¨æ¡†æ¶å±‚ï¼šCocoaTouch</li><li>ç¬¬ä¸‰å±‚ï¼šæ ¸å¿ƒæ¡†æ¶å±‚ï¼šMetalã€å›¾å½¢åª’ä½“æ ¸å¿ƒæ¡†æ¶</li><li>ç¬¬å››å±‚ï¼šDarwinå±‚ï¼šXNUã€å†…æ ¸ã€é©±åŠ¨</li></ul><p>iOSçš„å¯æ‰§è¡Œæ–‡ä»¶å’ŒåŠ¨æ€åº“éƒ½æ˜¯Mach-Oæ ¼å¼ï¼ŒåŠ è½½Appå®é™…å°±æ˜¯åŠ è½½Mach-Oæ–‡ä»¶ã€‚</p><h2 id="Appå¯åŠ¨è¿‡ç¨‹ä¸ä¼˜åŒ–"><a href="#Appå¯åŠ¨è¿‡ç¨‹ä¸ä¼˜åŒ–" class="headerlink" title="Appå¯åŠ¨è¿‡ç¨‹ä¸ä¼˜åŒ–"></a>Appå¯åŠ¨è¿‡ç¨‹ä¸ä¼˜åŒ–</h2><ol><li><p>main()æ‰§è¡Œå‰</p><ul><li>åŠ è½½å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆAppçš„.oæ–‡ä»¶çš„é›†åˆï¼‰</li><li>åŠ è½½åŠ¨æ€é“¾æ¥åº“ï¼Œè¿›è¡ŒrebaseæŒ‡é’ˆè°ƒæ•´å’Œbindç¬¦å·ç»‘å®š</li><li>Objc Runtime çš„åˆå§‹å¤„ç†ï¼ŒåŒ…æ‹¬ Objc ç›¸å…³ç±»çš„æ³¨å†Œã€Categoryæ³¨å†Œã€selector å”¯ä¸€æ€§æ£€æŸ¥</li><li>+load()åˆå§‹åŒ–<blockquote><p>è¿™ä¸ªé˜¶æ®µçš„ä¼˜åŒ–æœ‰ 1. å‡å°‘åŠ¨æ€åº“åŠ è½½ï¼ˆåˆå¹¶åŠ¨æ€åº“ï¼‰2. å‡å°‘åŠ è½½å¯åŠ¨åä¸ä¼šå»ç”¨çš„ç±»å’Œæ–¹æ³• 3. å°‘ç”¨+loadï¼Œæˆ–ç”¨ +initializeæ›¿æ¢ï¼Œå› ä¸ºruntime çš„ Method Swizzling æ“ä½œæ¯æ¬¡4ms</p></blockquote></li></ul></li><li><p>main()æ‰§è¡Œå</p><ul><li>æŒ‡ main() æ‰§è¡Œå¼€å§‹åˆ° didFinishLaunchingWithOptions æ–¹æ³•é‡Œé¦–å±æ¸²æŸ“ç›¸å…³æ–¹æ³•å®Œæˆ</li><li>é…ç½®åˆå§‹åŒ–æ–‡ä»¶çš„IOæ“ä½œ</li><li>é¦–å±åˆ—è¡¨å¤§æ•°æ®çš„è¯»å–</li><li>é¦–å±æ¸²æŸ“çš„å¤§é‡è®¡ç®—<blockquote><p>ä¼˜åŒ–æ–¹æ³•æœ‰æŠŠå„ç§ä¸é¦–å±æ¸²æŸ“ä¸ç›¸å¹²çš„åˆå§‹åŒ–æŒªèµ°æˆ–å­çº¿ç¨‹å¤„ç†</p></blockquote></li></ul></li><li><p>é¦–å±æ¸²æŸ“å®Œæˆå</p><ul><li>æŒ‡ didFinishLaunchingWithOptions ä½œç”¨åŸŸå†…æ‰§è¡Œé¦–å±æ¸²æŸ“ä¹‹åçš„æ‰€æœ‰æ–¹æ³•æ‰§è¡Œå®Œæˆ</li><li>éé¦–å±å…¶ä»–ä¸šåŠ¡æœåŠ¡æ¨¡å—çš„åˆå§‹åŒ–</li><li>ç›‘å¬çš„æ³¨å†Œ</li><li>é…ç½®æ–‡ä»¶çš„è¯»å†™<blockquote><p>æŠŠå¯èƒ½å¡ä½ä¸»çº¿ç¨‹çš„æ–¹æ³•æŒªèµ°æˆ–å­çº¿ç¨‹å¤„ç†</p></blockquote></li></ul></li></ol><h2 id="UIScrollView-çš„ä»£ç†æ–¹æ³•"><a href="#UIScrollView-çš„ä»£ç†æ–¹æ³•" class="headerlink" title="UIScrollView çš„ä»£ç†æ–¹æ³•"></a>UIScrollView çš„ä»£ç†æ–¹æ³•</h2><ol><li>æ»šåŠ¨å®Œ scrollViewDidScroll </li><li>ç¼©æ”¾å®Œ scrollViewDidZoom</li><li>å°†è¦å¼€å§‹æ‹–åŠ¨ scrollViewWillBeginDragging</li><li>å°†è¦ç»“æŸæ‹–åŠ¨ scrollViewWillEndDragging</li><li>æ»‘åŠ¨å°†è¦å‡é€Ÿã€ æ»‘åŠ¨å‡é€Ÿå®Œæˆ</li><li>æ»šåŠ¨åŠ¨ç”»å®Œæˆ</li><li>å°†è¦å¼€å§‹ç¼©æ”¾ã€å·²ç»ç»“æŸç¼©æ”¾</li></ol><h2 id="å“åº”é“¾å’Œäº‹ä»¶ä¼ é€’"><a href="#å“åº”é“¾å’Œäº‹ä»¶ä¼ é€’" class="headerlink" title="å“åº”é“¾å’Œäº‹ä»¶ä¼ é€’"></a>å“åº”é“¾å’Œäº‹ä»¶ä¼ é€’</h2><ol><li><p>hitTestæ–¹æ³•æ£€æµ‹çœ‹æ˜¯å¦è¿”å›</p></li><li><p>ç»§æ‰¿<code>UIResponder</code>çš„ç±»æ‰èƒ½å“åº”ï¼Œå¦‚<code>UIApplication</code>ã€<code>UIView</code>ã€<code>UIViewController</code>ã€‚è€Œ<code>CALayer</code>æ˜¯ç»§æ‰¿è‡ª<code>NSObject</code>çš„ï¼Œä¸èƒ½å“åº”</p></li><li><p>äº‹ä»¶é¦–å…ˆä¼ é€’ç»™<code>UIApplication</code>ï¼Œç„¶åå‘ä¸‹åˆ†å‘ç»™<code>UIWindow</code>ï¼Œç„¶ååˆ†å‘ç»™æœ€ä¸‹å±‚çš„<code>UIView</code>ï¼Œé€æ­¥è°ƒç”¨<code>hitTest</code>ä»å±å†…å‘å¤–æ‰¾ï¼Œå½“æŸä¸ª<code>UIView</code>è¿”å›YESæ—¶å°±é€’å½’å¯¹å…¶<code>SubView</code>æ‰§è¡Œ<code>hitTest</code>ï¼Œç›´åˆ°æ‰¾åˆ°æœ€åä¸€ä¸ª</p></li></ol><ul><li>æŸ<code>UIView</code>ä¸æ¥å—äº‹ä»¶çš„æƒ…å†µï¼š<ol><li>alpha &lt; 0.01</li><li>userInteractionEnabled = NO</li><li>hidden = YES</li></ol></li></ul><h2 id="UIView-å’Œ-CALayer-çš„åŒºåˆ«å’Œè”ç³»"><a href="#UIView-å’Œ-CALayer-çš„åŒºåˆ«å’Œè”ç³»" class="headerlink" title="UIView å’Œ CALayer çš„åŒºåˆ«å’Œè”ç³»"></a>UIView å’Œ CALayer çš„åŒºåˆ«å’Œè”ç³»</h2><ol><li>UIViewèƒ½å“åº”ï¼ŒCALayerä¸èƒ½</li><li>Viewçš„frame(å’Œbounds)æ˜¯ç®€å•è¿”å›layerçš„frame(bound), è€Œlayerçš„frameç”±å‡ ä¸ªå‚æ•°å†³å®š</li><li>UIView æ˜¯ CALayer çš„ä»£ç†</li><li>æ¯ä¸ªUIViewå†…éƒ½æœ‰ä¸€ä¸ªCALayerï¼ˆå³æœ‰ä¸ªå±æ€§ï¼‰</li></ol><h2 id="è½®æ’­å›¾æœ´ç´ å®ç°çš„é›†ä¸­æ–¹æ³•"><a href="#è½®æ’­å›¾æœ´ç´ å®ç°çš„é›†ä¸­æ–¹æ³•" class="headerlink" title="è½®æ’­å›¾æœ´ç´ å®ç°çš„é›†ä¸­æ–¹æ³•"></a>è½®æ’­å›¾æœ´ç´ å®ç°çš„é›†ä¸­æ–¹æ³•</h2><ol><li>UICollectionView, ç®€å•ç²—æš´æ”¾100ä¸ªCell</li><li>UIScrollView é¦–å°¾å„æ”¾ä¸€ä¸ªå±•ç¤º</li><li>UIScrollView ä¸‰ä¸ªImageViewå®ç°</li><li>UIImageView è‡ªå·±å®ç°layerè½¬åœºåŠ¨ç”»</li></ol><h2 id="TableView-å’Œ-CollectionView-å¿…é€‰çš„ä»£ç†æ–¹æ³•"><a href="#TableView-å’Œ-CollectionView-å¿…é€‰çš„ä»£ç†æ–¹æ³•" class="headerlink" title="TableView å’Œ CollectionView å¿…é€‰çš„ä»£ç†æ–¹æ³•"></a>TableView å’Œ CollectionView å¿…é€‰çš„ä»£ç†æ–¹æ³•</h2><ul><li>delegateéƒ½æ˜¯å¯é€‰</li><li>datasourceå„æœ‰ä¸¤ä¸ªå¿…é€‰</li><li>table: cellForRowAtIndexPathã€numberOfRowsInSection</li><li>collection: cellForItemAtIndexPathã€numberOfItemsInSection</li></ul><h2 id="UITableView-çš„ä¼˜åŒ–æ€è·¯"><a href="#UITableView-çš„ä¼˜åŒ–æ€è·¯" class="headerlink" title="UITableView çš„ä¼˜åŒ–æ€è·¯"></a>UITableView çš„ä¼˜åŒ–æ€è·¯</h2><h4 id="æµç¨‹"><a href="#æµç¨‹" class="headerlink" title="æµç¨‹"></a>æµç¨‹</h4><ol><li>è·å–æ•°æ®ï¼›</li><li>æŠŠæ•°æ®è½¬åŒ–æˆmodelã€å­˜è¿›æ•°ç»„ï¼›</li><li>tableviewè°ƒç”¨reloadDataåˆ·æ–°æ•°æ®ï¼›</li><li>åœ¨ä»£ç†æ–¹æ³•cellForRowAtIndexPathé‡Œï¼Œåˆ›å»ºè‡ªå®šä¹‰çš„cellï¼ŒæŠŠmodelèµ‹å€¼ç»™cellï¼›</li><li>cellåœ¨å¯¹åº”çš„modelçš„setæ–¹æ³•é‡Œï¼Œæ ¹æ®æ‹¿åˆ°çš„modelï¼Œè®¾ç½®å›¾ç‰‡çš„imageï¼Œè®¾ç½®labelçš„textç­‰(æ§ä»¶éƒ½ä»¥æ‡’åŠ è½½å½¢å¼åˆå§‹åŒ–)ï¼›</li><li>åœ¨ä»£ç†æ–¹æ³•heightForRowAtIndexPathé‡Œï¼Œæ ¹æ®modelï¼Œç®—å‡ºå½“å‰è¡Œåº”è¯¥æ˜¾ç¤ºå¤šå°‘çš„é«˜åº¦ï¼›</li><li>åœ¨cellçš„layoutSubviewsæ–¹æ³•é‡Œï¼Œå¸ƒå±€å­æ§ä»¶ã€‚</li></ol><h4 id="ä¼˜åŒ–æ€è·¯"><a href="#ä¼˜åŒ–æ€è·¯" class="headerlink" title="ä¼˜åŒ–æ€è·¯"></a>ä¼˜åŒ–æ€è·¯</h4><ol><li>é¿å…ä¸»çº¿ç¨‹é˜»å¡</li></ol><p>1/2æ­¥é‡Œçš„è·å–æ•°æ®ã€æ•°æ®å¤„ç†ç­‰è€—æ—¶æ“ä½œï¼Œåº”è¯¥æ”¾å…¥åå°çº¿ç¨‹å¼‚æ­¥å¤„ç†ï¼Œå¤„ç†å¥½åå†é€šçŸ¥ä¸»çº¿ç¨‹åˆ·æ–°ç•Œé¢ã€‚</p><ol start="2"><li>é¿å…é¢‘ç¹çš„å¯¹è±¡åˆ›å»º</li></ol><p>å¯¹è±¡çš„åˆ›å»ºä¼šå‘é€å†…å­˜åˆ†é…ã€å±æ€§è°ƒæ•´ç­‰ã€‚<br>æ‰€ä»¥ï¼Œé¦–å…ˆï¼Œå°½é‡ç”¨è½»é‡çš„å¯¹è±¡ä»£æ›¿é‡é‡çš„å¯¹è±¡ã€‚æ¯”å¦‚CALayerä»£æ›¿UIViewã€‚<br>æ¥ç€ï¼Œå¤šåˆ©ç”¨ç¼“å­˜æ€æƒ³ï¼Œå¯¹è±¡åˆ›å»ºåç¼“å­˜èµ·æ¥ï¼Œéœ€è¦çš„æ—¶å€™å†æ‹¿å‡ºæ¥ç”¨ã€‚åˆç†åˆ©ç”¨å†…å­˜å¼€é”€ï¼Œå‡å°‘CPUå¼€é”€ã€‚<br>æŠŠ Cell setModelé‡Œçš„ä¸€äº›æ“ä½œæ”¾åœ¨ç¬¬äºŒæ­¥æ•°æ®è½¬modelé‡Œ</p><ol start="3"><li>å‡å°‘å¯¹è±¡çš„å±æ€§èµ‹å€¼æ“ä½œ</li></ol><p>å°¤å…¶æ˜¯UIViewçš„frame/boundsç­‰å±æ€§çš„èµ‹å€¼æ“ä½œï¼Œä¼šäº§ç”Ÿæ¯”è¾ƒå¤§çš„CPUæ¶ˆè€—ã€‚<br>å°½é‡å°‘è®©Cellé‡Œç©ºé—´åŠ¨æ€å˜åŒ–ï¼Œæœ‰è§„å¾‹çš„è¯ç­›åˆ†æˆå¤šä¸ªå›ºå®šcell</p><ol start="4"><li>å¼‚æ­¥ç»˜åˆ¶</li></ol><p>æ–‡æœ¬æ¸²æŸ“ã€å›¾åƒç»˜åˆ¶éƒ½æ˜¯æ¯”è¾ƒæ¶ˆè€—æ€§èƒ½çš„æ“ä½œï¼Œè€ŒUILabelç­‰æ§ä»¶éƒ½æ˜¯åœ¨ä¸»çº¿ç¨‹è¿›è¡Œçš„æ–‡æœ¬ç»˜åˆ¶ã€‚è¿™ä¼šå¯¹æ€§èƒ½äº§ç”Ÿæ¯”è¾ƒå¤§çš„å½±å“ã€‚<br>UIKitå’ŒCoreAnimationç›¸å…³æ“ä½œå¿…é¡»åœ¨ä¸»çº¿ç¨‹ä¸­è¿›è¡Œï¼Œå…¶å®ƒçš„å¯ä»¥åœ¨åå°çº¿ç¨‹å¼‚æ­¥æ‰§è¡Œ</p><ol start="5"><li>ç®€åŒ–è§†å›¾ç»“æ„</li></ol><p>GPUåœ¨ç»˜åˆ¶å›¾åƒå‰ï¼Œä¼šæŠŠé‡å çš„è§†å›¾è¿›è¡Œæ··åˆï¼Œè§†å›¾ç»“æ„è¶Šå¤æ‚ï¼Œè¿™ä¸ªæ“ä½œå°±è¶Šè€—æ—¶ï¼Œå¦‚æœå­˜åœ¨é€æ˜è§†å›¾ï¼Œæ··åˆè¿‡ç¨‹ä¼šæ›´åŠ å¤æ‚ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥ï¼š</p><ul><li>å°½é‡é¿å…å¤æ‚çš„å›¾å±‚ç»“æ„</li><li>å°‘ä½¿ç”¨é€æ˜çš„è§†å›¾</li><li>ä¸é€æ˜çš„è§†å›¾ï¼Œè®¾ç½®opaque = YESâ€¨</li></ul><ol start="6"><li>å‡å°‘ç¦»å±æ¸²æŸ“</li></ol><p>è€ç”Ÿå¸¸è°ˆä¹‹åœ†è§’é—®é¢˜ï¼Œåœ†è§’æ˜¯å¼€å‘ä¸­ç»å¸¸ä½¿ç”¨åˆ°çš„ç¾åŒ–æ–¹å¼ï¼Œä½†ä¸€èˆ¬çš„è®¾ç½®cornerRadiusæ—¶ä¼šé…åˆmasksToBoundså±æ€§ï¼Œè¿™å°±ä¼šé€ æˆç¦»å±æ¸²æŸ“ã€‚å…³äºè¿™ç§é—®é¢˜çš„å¤„ç†ï¼Œå¤§è‡´æœ‰ä¸¤ä¸ªæ€è·¯ï¼š</p><ul><li>å¼‚æ­¥ç»˜åˆ¶ä¸€å¼ åœ†è§’çš„å›¾ç‰‡æ¥æ˜¾ç¤ºï¼›</li><li>ç”¨ä¸€ä¸ªåœ†è§’è€Œä¸­ç©ºçš„å›¾æ¥ç›–ä½ã€‚</li></ul><p>tableviewéœ€è¦åˆ·æ–°æ•°æ®æ—¶ï¼Œä½¿ç”¨<br>[tableview beginUpdates]ã€[tableview insertRowsAtIndexPaths:indexArray withRowAnimation:UITableViewRowAnimationNone]ã€<br>[tableview endUpdates];è€Œé<br>[tableview reloadData]ä»è€Œåˆ·æ–°æ›´å°‘çš„è¡Œå‡å°‘CPUå‹åŠ›</p><ol start="7"><li>å¯¹äºå›ºå®šè¡Œé«˜ï¼Œå‰ä¸€ä¸ªè®¾ç½®å±æ€§æ¯”åä¸€ä¸ªå®ç°ä»£ç†æ–¹æ³•æ•ˆç‡é«˜</li></ol><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cell.tableview.rowHeightÂ =Â <span class="number">50.0</span>;</span><br><span class="line"></span><br><span class="line">-Â (<span class="built_in">CGFloat</span>)tableView:(<span class="built_in">UITableView</span>Â *)tableViewÂ heightForRowAtIndexPath:(<span class="built_in">NSIndexPath</span>Â *)indexPath</span><br><span class="line">&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">return</span>Â <span class="number">50.0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="8"><li><p>NSDateFormatterè¿™ä¸ªå¯¹è±¡çš„ç›¸å…³æ“ä½œå¾ˆè´¹æ—¶ï¼Œéœ€è¦é¿å…é¢‘ç¹çš„åˆ›å»ºå’Œè®¡ç®—</p></li><li><p>åˆ©ç”¨RunLoopå»¶æ—¶åŠ è½½å›¾ç‰‡</p></li></ol><p>åˆ©ç”¨RunLoopï¼šæŠŠå›¾ç‰‡åŠ è½½çš„æ–¹æ³•æ”¾åœ¨<code>NSDefaultRunLoopMode</code>é‡Œï¼Œè¿™æ ·å½“æ»‘åŠ¨æ—¶å°±åˆ‡æ¢å‡ºäº†è¿™ä¸ªModeï¼Œæš‚åœåŠ è½½</p>]]></content>
      
      
      <categories>
          
          <category> Note </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
            <tag> Objective-C </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOSå¤„ç†å¤šçº¿ç¨‹å¼‚æ­¥Blockä¸­çš„UIæ“ä½œ</title>
      <link href="/2019-02-23-ios-block-and-mainqueue/"/>
      <url>/2019-02-23-ios-block-and-mainqueue/</url>
      
        <content type="html"><![CDATA[<p>å¤šçº¿ç¨‹æ–¹æ³•çš„<code>completionHandler</code>blockå¯èƒ½è¿è¡Œåœ¨éä¸»çº¿ç¨‹ä¸Šã€‚ä¸¤ç§å¤„ç†æ–¹æ³•ï¼š</p><a id="more"></a><ol><li>åœ¨blocké‡Œæ‰‹åŠ¨åŠ ä¸Š<code>dispatch_async(dispatch_get_main_queue(), ^{});</code></li></ol><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSURLSessionConfiguration</span> *configuration = [<span class="built_in">NSURLSessionConfiguration</span> defaultSessionConfiguration];</span><br><span class="line"></span><br><span class="line"><span class="built_in">NSURLSession</span> *session = [<span class="built_in">NSURLSession</span> sessionWithConfiguration:configuration];<span class="comment">//no delegateQueue</span></span><br><span class="line"><span class="built_in">NSURLRequest</span> *request = [<span class="built_in">NSURLRequest</span> requestWithURL:[<span class="built_in">NSURL</span> URLWithString:url] cachePolicy:<span class="built_in">NSURLRequestReturnCacheDataElseLoad</span> timeoutInterval:<span class="number">30.0</span>];</span><br><span class="line"></span><br><span class="line"><span class="built_in">NSURLSessionDownloadTask</span> *task = [session downloadTaskWithRequest:imgRequest completionHandler:^(<span class="built_in">NSURL</span> * _Nullable location, <span class="built_in">NSURLResponse</span> * _Nullable response, <span class="built_in">NSError</span> * _Nullable error) &#123;</span><br><span class="line">    <span class="built_in">dispatch_async</span>(dispatch_get_main_queue(), ^&#123;<span class="comment">/* do UI things */</span>&#125;);</span><br><span class="line">    <span class="comment">//or</span></span><br><span class="line">    [<span class="keyword">self</span> performSelectorOnMainThread:<span class="keyword">@selector</span>(doUIthings) withObject:<span class="literal">nil</span> waitUntilDone:<span class="literal">NO</span>];</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line">[task resume];</span><br></pre></td></tr></table></figure><ol start="2"><li>å¸¦æœ‰<code>delegateQueue</code>ç­‰å‚æ•°çš„æ–¹æ³•ï¼Œå¯ä¼ å…¥ä¸»çº¿ç¨‹é˜Ÿåˆ—ï¼Œç„¶åblock<code>completionHandler</code>ä¾¿è¿è¡Œåœ¨ä¸»çº¿ç¨‹äº†ã€‚</li></ol><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSURLSessionConfiguration</span> *configuration = [<span class="built_in">NSURLSessionConfiguration</span> defaultSessionConfiguration];</span><br><span class="line"></span><br><span class="line"><span class="built_in">NSURLSession</span> *session = [<span class="built_in">NSURLSession</span> sessionWithConfiguration:configuration delegate:<span class="keyword">self</span> delegateQueue:[<span class="built_in">NSOperationQueue</span> mainQueue]];<span class="comment">//get the mainQueue</span></span><br><span class="line"><span class="built_in">NSURLRequest</span> *request = [<span class="built_in">NSURLRequest</span> requestWithURL:[<span class="built_in">NSURL</span> URLWithString:url] cachePolicy:<span class="built_in">NSURLRequestReturnCacheDataElseLoad</span> timeoutInterval:<span class="number">30.0</span>];</span><br><span class="line"></span><br><span class="line"><span class="built_in">NSURLSessionDownloadTask</span> *task = [session downloadTaskWithRequest:imgRequest completionHandler:^(<span class="built_in">NSURL</span> * _Nullable location, <span class="built_in">NSURLResponse</span> * _Nullable response, <span class="built_in">NSError</span> * _Nullable error) &#123;</span><br><span class="line"><span class="comment">/* do UI things */</span></span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line">[task resume];</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Note </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
            <tag> Objective-C </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS åˆ¤æ–­NSStringå€¼æ˜¯å¦ä¸ºç©ºæˆ–nullå¹¶è½¬æ¢ä¸ºç©ºå­—ç¬¦ä¸²</title>
      <link href="/2019-02-12-transfer-null-to-nsstring/"/>
      <url>/2019-02-12-transfer-null-to-nsstring/</url>
      
        <content type="html"><![CDATA[<p>é‡åˆ°äº†ä¸€ä¸ªåå°jsonè¯¯å°†nullä½œä¸ºå­—ç¬¦ä¸²å€¼å¯¼è‡´iOSå®¢æˆ·ç«¯å´©æºƒé—ªé€€çš„é—®é¢˜ï¼Œè§£å†³æ–¹æ³•å¦‚ä¸‹ï¼šå¥—ä¸€å±‚åˆ¤æ–­ï¼Œå¦‚æœæ˜¯å„ç§æƒ…å†µçš„nullåˆ™è½¬æ¢ä¸º@â€â€ã€‚</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">+ (<span class="built_in">NSString</span> *) nullToString:(<span class="keyword">id</span>)string &#123;</span><br><span class="line">    <span class="keyword">if</span> ([string isEqual:<span class="string">@"NULL"</span>] || [string isKindOfClass:[<span class="built_in">NSNull</span> <span class="keyword">class</span>]] || [string isEqual:[<span class="built_in">NSNull</span> null]] || [string isEqual:<span class="literal">NULL</span>] || [[string <span class="keyword">class</span>] isSubclassOfClass:[<span class="built_in">NSNull</span> <span class="keyword">class</span>]] || string == <span class="literal">nil</span> || string == <span class="literal">NULL</span> || [string isKindOfClass:[<span class="built_in">NSNull</span> <span class="keyword">class</span>]] || [[string stringByTrimmingCharactersInSet:[<span class="built_in">NSCharacterSet</span> whitespaceAndNewlineCharacterSet]] length]==<span class="number">0</span> || [string isEqualToString:<span class="string">@"&lt;null&gt;"</span>] || [string isEqualToString:<span class="string">@"(null)"</span>]) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">@""</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">NSString</span> *)string;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr>]]></content>
      
      
      <categories>
          
          <category> Note </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
            <tag> Objective-C </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS MJExtensionä½¿ç”¨æ–¹æ³•æŒ‡å—(Objective-C)</title>
      <link href="/2019-02-03-mj-extension-guide/"/>
      <url>/2019-02-03-mj-extension-guide/</url>
      
        <content type="html"><![CDATA[<h2 id="MJExtensionèƒ½åšä»€ä¹ˆï¼Ÿ"><a href="#MJExtensionèƒ½åšä»€ä¹ˆï¼Ÿ" class="headerlink" title="MJExtensionèƒ½åšä»€ä¹ˆï¼Ÿ"></a>MJExtensionèƒ½åšä»€ä¹ˆï¼Ÿ</h2><h5 id="1-MJExtensionæ˜¯ä¸€å¥—å­—å…¸å’Œæ¨¡å‹ä¹‹é—´äº’ç›¸è½¬æ¢çš„è¶…è½»é‡çº§æ¡†æ¶"><a href="#1-MJExtensionæ˜¯ä¸€å¥—å­—å…¸å’Œæ¨¡å‹ä¹‹é—´äº’ç›¸è½¬æ¢çš„è¶…è½»é‡çº§æ¡†æ¶" class="headerlink" title="1. MJExtensionæ˜¯ä¸€å¥—å­—å…¸å’Œæ¨¡å‹ä¹‹é—´äº’ç›¸è½¬æ¢çš„è¶…è½»é‡çº§æ¡†æ¶"></a>1. MJExtensionæ˜¯ä¸€å¥—å­—å…¸å’Œæ¨¡å‹ä¹‹é—´äº’ç›¸è½¬æ¢çš„è¶…è½»é‡çº§æ¡†æ¶</h5><h5 id="2-MJExtensionèƒ½å®Œæˆçš„åŠŸèƒ½"><a href="#2-MJExtensionèƒ½å®Œæˆçš„åŠŸèƒ½" class="headerlink" title="2. MJExtensionèƒ½å®Œæˆçš„åŠŸèƒ½"></a>2. MJExtensionèƒ½å®Œæˆçš„åŠŸèƒ½</h5><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">å­—å…¸ï¼ˆJSONï¼‰ --&gt; æ¨¡å‹ï¼ˆModelï¼‰</span><br><span class="line">æ¨¡å‹ï¼ˆModelï¼‰ --&gt; å­—å…¸ï¼ˆJSONï¼‰</span><br><span class="line">å­—å…¸æ•°ç»„ï¼ˆJSON Arrayï¼‰ --&gt; æ¨¡å‹æ•°ç»„ï¼ˆModel Arrayï¼‰</span><br><span class="line">æ¨¡å‹æ•°ç»„ï¼ˆModel Arrayï¼‰ --&gt; å­—å…¸æ•°ç»„ï¼ˆJSON Arrayï¼‰</span><br></pre></td></tr></table></figure><p><code>è¯¦å°½ç”¨æ³•ä¸»è¦å‚è€ƒ main.mä¸­çš„å„ä¸ªå‡½æ•° ä»¥åŠ NSObject+MJKeyValue.h</code></p><h2 id="MJExtensionå’ŒJSONModelã€Mantleç­‰æ¡†æ¶çš„åŒºåˆ«"><a href="#MJExtensionå’ŒJSONModelã€Mantleç­‰æ¡†æ¶çš„åŒºåˆ«" class="headerlink" title="MJExtensionå’ŒJSONModelã€Mantleç­‰æ¡†æ¶çš„åŒºåˆ«"></a>MJExtensionå’ŒJSONModelã€Mantleç­‰æ¡†æ¶çš„åŒºåˆ«</h2><h5 id="1-è½¬æ¢é€Ÿç‡ï¼š"><a href="#1-è½¬æ¢é€Ÿç‡ï¼š" class="headerlink" title="1. è½¬æ¢é€Ÿç‡ï¼š"></a>1. è½¬æ¢é€Ÿç‡ï¼š</h5><p>æœ€è¿‘ä¸€æ¬¡æµ‹è¯•è¡¨æ˜ï¼š<code>MJExtension &gt; JSONModel &gt; Mantle</code> å„ä½å¼€å‘è€…ä¹Ÿå¯ä»¥è‡ªè¡Œæµ‹è¯•</p><h5 id="2-å…·ä½“ç”¨æ³•ï¼š"><a href="#2-å…·ä½“ç”¨æ³•ï¼š" class="headerlink" title="2. å…·ä½“ç”¨æ³•ï¼š"></a>2. å…·ä½“ç”¨æ³•ï¼š</h5><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">JSONModelï¼š</span><br><span class="line"></span><br><span class="line">è¦æ±‚æ‰€æœ‰æ¨¡å‹ç±»å¿…é¡»ç»§æ‰¿è‡ªJSONModelåŸºç±»</span><br><span class="line"></span><br><span class="line">Mantleï¼š</span><br><span class="line"></span><br><span class="line">è¦æ±‚æ‰€æœ‰æ¨¡å‹ç±»å¿…é¡»ç»§æ‰¿è‡ªMTModelåŸºç±»</span><br><span class="line"></span><br><span class="line">MJExtensionï¼š</span><br><span class="line"></span><br><span class="line">ä¸éœ€è¦ä½ çš„æ¨¡å‹ç±»ç»§æ‰¿ä»»ä½•ç‰¹æ®ŠåŸºç±»ï¼Œæ¯«æ— æ±¡æŸ“ï¼Œæ¯«æ— ä¾µå…¥æ€§</span><br></pre></td></tr></table></figure><h2 id="å¦‚ä½•å®‰è£…MJExtension"><a href="#å¦‚ä½•å®‰è£…MJExtension" class="headerlink" title="å¦‚ä½•å®‰è£…MJExtension"></a>å¦‚ä½•å®‰è£…MJExtension</h2><p>æ–¹æ³•ä¸€ï¼šcocoapodså¯¼å…¥ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod <span class="string">'MJExtension'</span></span><br></pre></td></tr></table></figure><p>æ–¹æ³•äºŒï¼šæ‰‹åŠ¨å¯¼å…¥ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">å°†MJExtensionExample/MJExtensionExample/MJExtensionæ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰æºä»£ç æ‹½å…¥é¡¹ç›®ä¸­</span><br><span class="line">å¯¼å…¥ä¸»å¤´æ–‡ä»¶ï¼š<span class="meta">#import <span class="meta-string">"MJExtension.h"</span></span></span><br><span class="line">MJExtension.h</span><br><span class="line">MJConst.h</span><br><span class="line">MJConst.m</span><br><span class="line">MJFoundation.h</span><br><span class="line">MJFoundation.m</span><br><span class="line">MJIvar.h</span><br><span class="line">MJIvar.m</span><br><span class="line">MJType.h</span><br><span class="line">MJType.m</span><br><span class="line"><span class="built_in">NSObject</span>+MJCoding.h</span><br><span class="line"><span class="built_in">NSObject</span>+MJCoding.m</span><br><span class="line"><span class="built_in">NSObject</span>+MJIvar.h</span><br><span class="line"><span class="built_in">NSObject</span>+MJIvar.m</span><br><span class="line"><span class="built_in">NSObject</span>+MJKeyValue.h</span><br><span class="line"><span class="built_in">NSObject</span>+MJKeyValue.m</span><br></pre></td></tr></table></figure><h2 id="å¦‚ä½•ä½¿ç”¨MJExtension"><a href="#å¦‚ä½•ä½¿ç”¨MJExtension" class="headerlink" title="å¦‚ä½•ä½¿ç”¨MJExtension"></a>å¦‚ä½•ä½¿ç”¨MJExtension</h2><h4 id="1-æœ€ç®€å•çš„å­—å…¸è½¬æ¨¡å‹"><a href="#1-æœ€ç®€å•çš„å­—å…¸è½¬æ¨¡å‹" class="headerlink" title="1. æœ€ç®€å•çš„å­—å…¸è½¬æ¨¡å‹"></a>1. æœ€ç®€å•çš„å­—å…¸è½¬æ¨¡å‹</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span> &#123;</span><br><span class="line">    SexMale,    </span><br><span class="line">    SexFemale&#125; Sex;</span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">User</span> : <span class="title">NSObject</span></span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">copy</span>, <span class="keyword">nonatomic</span>) <span class="built_in">NSString</span> *name;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">copy</span>, <span class="keyword">nonatomic</span>) <span class="built_in">NSString</span> *icon;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">assign</span>, <span class="keyword">nonatomic</span>) <span class="keyword">int</span> age;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">assign</span>, <span class="keyword">nonatomic</span>) <span class="keyword">double</span> height;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>, <span class="keyword">nonatomic</span>) <span class="built_in">NSNumber</span> *money;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">assign</span>, <span class="keyword">nonatomic</span>) Sex sex;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">NSDictionary</span> *dict = @&#123;</span><br><span class="line">                        <span class="string">@"name"</span> : <span class="string">@"Jack"</span>,                 </span><br><span class="line">                        <span class="string">@"icon"</span> : <span class="string">@"lufy.png"</span>,               </span><br><span class="line">                        <span class="string">@"age"</span> : @<span class="number">20</span>,               </span><br><span class="line">                        <span class="string">@"height"</span> : <span class="string">@"1.55"</span>,               </span><br><span class="line">                        <span class="string">@"money"</span> : @<span class="number">100.9</span>,               </span><br><span class="line">                        <span class="string">@"sex"</span> : @(SexFemale)            </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å°†å­—å…¸è½¬ä¸ºUseræ¨¡å‹</span></span><br><span class="line">User *user = [User objectWithKeyValues:dict];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"name=%@, icon=%@, age=%d, height=%@, money=%@, sex=%d"</span>, user.name, user.icon, user.age, user.height, user.money, user.sex);</span><br><span class="line"><span class="comment">// name=Jack, icon=lufy.png, age=20, height=1.550000, money=100.9, sex=1</span></span><br></pre></td></tr></table></figure><h5 id="æ ¸å¿ƒä»£ç 1ï¼š"><a href="#æ ¸å¿ƒä»£ç 1ï¼š" class="headerlink" title="æ ¸å¿ƒä»£ç 1ï¼š"></a>æ ¸å¿ƒä»£ç 1ï¼š</h5><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[User objectWithKeyValues:dict]</span><br></pre></td></tr></table></figure><h4 id="2-æ¨¡å‹ä¸­åµŒå¥—æ¨¡å‹"><a href="#2-æ¨¡å‹ä¸­åµŒå¥—æ¨¡å‹" class="headerlink" title="2. æ¨¡å‹ä¸­åµŒå¥—æ¨¡å‹"></a>2. æ¨¡å‹ä¸­åµŒå¥—æ¨¡å‹</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Status</span> : <span class="title">NSObject</span></span></span><br><span class="line"><span class="comment">/** å¾®åšæ–‡æœ¬å†…å®¹ */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">copy</span>, <span class="keyword">nonatomic</span>) <span class="built_in">NSString</span> *text;</span><br><span class="line"><span class="comment">/** å¾®åšä½œè€… */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>, <span class="keyword">nonatomic</span>) User *user;</span><br><span class="line"><span class="comment">/** è½¬å‘çš„å¾®åš */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>, <span class="keyword">nonatomic</span>) Status *retweetedStatus;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">NSDictionary</span> *dict = @&#123;               </span><br><span class="line"><span class="string">@"text"</span> : <span class="string">@"æ˜¯å•Šï¼Œä»Šå¤©å¤©æ°”ç¡®å®ä¸é”™ï¼"</span>, </span><br><span class="line"><span class="string">@"user"</span> : @&#123;                   </span><br><span class="line">             <span class="string">@"name"</span> : <span class="string">@"Jack"</span>,                   </span><br><span class="line">             <span class="string">@"icon"</span> : <span class="string">@"lufy.png"</span>                </span><br><span class="line">           &#125;,               </span><br><span class="line"><span class="string">@"retweetedStatus"</span> : @&#123;                   </span><br><span class="line">                        <span class="string">@"text"</span> : <span class="string">@"ä»Šå¤©å¤©æ°”çœŸä¸é”™ï¼"</span>,                   </span><br><span class="line">                        <span class="string">@"user"</span> : @&#123;                       </span><br><span class="line">                                    <span class="string">@"name"</span> : <span class="string">@"Rose"</span>,                       </span><br><span class="line">                                    <span class="string">@"icon"</span> : <span class="string">@"nami.png"</span>                    </span><br><span class="line">                                   &#125;                </span><br><span class="line">                       &#125;            </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å°†å­—å…¸è½¬ä¸ºStatusæ¨¡å‹</span></span><br><span class="line">Status *status = [Status objectWithKeyValues:dict];</span><br><span class="line"><span class="built_in">NSString</span> *text = status.text;</span><br><span class="line"><span class="built_in">NSString</span> *name = status.user.name;</span><br><span class="line"><span class="built_in">NSString</span> *icon = status.user.icon;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"text=%@, name=%@, icon=%@"</span>, text, name, icon);</span><br><span class="line"><span class="comment">// text=æ˜¯å•Šï¼Œä»Šå¤©å¤©æ°”ç¡®å®ä¸é”™ï¼, name=Jack, icon=lufy.png</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">NSString</span> *text2 = status.retweetedStatus.text;</span><br><span class="line"><span class="built_in">NSString</span> *name2 = status.retweetedStatus.user.name;</span><br><span class="line"><span class="built_in">NSString</span> *icon2 = status.retweetedStatus.user.icon;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"text2=%@, name2=%@, icon2=%@"</span>, text2, name2, icon2);</span><br><span class="line"><span class="comment">// text2=ä»Šå¤©å¤©æ°”çœŸä¸é”™ï¼, name2=Rose, icon2=nami.png</span></span><br></pre></td></tr></table></figure><h5 id="æ ¸å¿ƒä»£ç 2"><a href="#æ ¸å¿ƒä»£ç 2" class="headerlink" title="æ ¸å¿ƒä»£ç 2"></a>æ ¸å¿ƒä»£ç 2</h5><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[Status objectWithKeyValues:dict]`</span><br></pre></td></tr></table></figure><h4 id="3-æ¨¡å‹ä¸­æœ‰ä¸ªæ•°ç»„å±æ€§ï¼Œæ•°ç»„é‡Œé¢åˆè¦è£…ç€å…¶å®ƒæ¨¡å‹"><a href="#3-æ¨¡å‹ä¸­æœ‰ä¸ªæ•°ç»„å±æ€§ï¼Œæ•°ç»„é‡Œé¢åˆè¦è£…ç€å…¶å®ƒæ¨¡å‹" class="headerlink" title="3. æ¨¡å‹ä¸­æœ‰ä¸ªæ•°ç»„å±æ€§ï¼Œæ•°ç»„é‡Œé¢åˆè¦è£…ç€å…¶å®ƒæ¨¡å‹"></a>3. æ¨¡å‹ä¸­æœ‰ä¸ªæ•°ç»„å±æ€§ï¼Œæ•°ç»„é‡Œé¢åˆè¦è£…ç€å…¶å®ƒæ¨¡å‹</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Ad</span> : <span class="title">NSObject</span></span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">copy</span>, <span class="keyword">nonatomic</span>) <span class="built_in">NSString</span> *image;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">copy</span>, <span class="keyword">nonatomic</span>) <span class="built_in">NSString</span> *url;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">StatusResult</span> : <span class="title">NSObject</span></span></span><br><span class="line"><span class="comment">/** å­˜æ”¾ç€ä¸€å †çš„å¾®åšæ•°æ®ï¼ˆé‡Œé¢éƒ½æ˜¯Statusæ¨¡å‹ï¼‰ */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>, <span class="keyword">nonatomic</span>) <span class="built_in">NSMutableArray</span> *statuses;</span><br><span class="line"><span class="comment">/** å­˜æ”¾ç€ä¸€å †çš„å¹¿å‘Šæ•°æ®ï¼ˆé‡Œé¢éƒ½æ˜¯Adæ¨¡å‹ï¼‰ */</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>, <span class="keyword">nonatomic</span>) <span class="built_in">NSArray</span> *ads;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>, <span class="keyword">nonatomic</span>) <span class="built_in">NSNumber</span> *totalNumber;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">StatusResult</span></span></span><br><span class="line"><span class="comment">// å®ç°è¿™ä¸ªæ–¹æ³•çš„ç›®çš„ï¼šå‘Šè¯‰MJExtensionæ¡†æ¶statuseså’Œadsæ•°ç»„é‡Œé¢è£…çš„æ˜¯ä»€ä¹ˆæ¨¡å‹</span></span><br><span class="line"><span class="comment">/*    + (NSDictionary *)objectClassInArray&#123;    </span></span><br><span class="line"><span class="comment">return @&#123;         </span></span><br><span class="line"><span class="comment">@"statuses" : [Status class],         </span></span><br><span class="line"><span class="comment">@"ads" : [Ad class]    &#125;;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">+ (Class)objectClassInArray:(NSString *)propertyName&#123;    </span></span><br><span class="line"><span class="comment">if ([propertyName isEqualToString:@"statuses"]) &#123;        </span></span><br><span class="line"><span class="comment">return [Status class];    </span></span><br><span class="line"><span class="comment">&#125; else if ([propertyName isEqualToString:@"ads"]) &#123;        </span></span><br><span class="line"><span class="comment">return [Ad class];    &#125;    </span></span><br><span class="line"><span class="comment">return nil;&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿™ä¸ªæ–¹æ³•å¯¹æ¯”ä¸Šé¢çš„2ä¸ªæ–¹æ³•æ›´åŠ æ²¡æœ‰ä¾µå…¥æ€§å’Œæ±¡æŸ“ï¼Œå› ä¸ºä¸éœ€è¦å¯¼å…¥Statuså’ŒAdçš„å¤´æ–‡ä»¶</span></span><br><span class="line">+ (<span class="built_in">NSDictionary</span> *)objectClassInArray&#123;    </span><br><span class="line">    <span class="keyword">return</span> @&#123;         </span><br><span class="line">              <span class="string">@"statuses"</span> : <span class="string">@"Status"</span>,         </span><br><span class="line">              <span class="string">@"ads"</span> : <span class="string">@"Ad"</span>    </span><br><span class="line">            &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">NSDictionary</span> *dict = @&#123;                       </span><br><span class="line"><span class="string">@"statuses"</span> : @[                           </span><br><span class="line">                @&#123;                                   </span><br><span class="line">                   <span class="string">@"text"</span> : <span class="string">@"ä»Šå¤©å¤©æ°”çœŸä¸é”™ï¼"</span>,</span><br><span class="line">                   <span class="string">@"user"</span> : @&#123;                                   </span><br><span class="line">                                <span class="string">@"name"</span> : <span class="string">@"Rose"</span>,</span><br><span class="line">                                <span class="string">@"icon"</span> : <span class="string">@"nami.png"</span>                                                                                  </span><br><span class="line">                              &#125;                            </span><br><span class="line">                 &#125;, </span><br><span class="line"></span><br><span class="line">                 @&#123;                               </span><br><span class="line">                    <span class="string">@"text"</span> : <span class="string">@"æ˜å¤©å»æ—…æ¸¸äº†"</span>, </span><br><span class="line">                    <span class="string">@"user"</span> : @&#123;                                                                   </span><br><span class="line">                                 <span class="string">@"name"</span> : <span class="string">@"Jack"</span>,                                       </span><br><span class="line">                                 <span class="string">@"icon"</span> : <span class="string">@"lufy.png"</span>                               </span><br><span class="line">                               &#125;  </span><br><span class="line">                   &#125; </span><br><span class="line"></span><br><span class="line">                ],                       </span><br><span class="line"> <span class="string">@"ads"</span> :@[                           </span><br><span class="line">           @&#123;                               </span><br><span class="line">              <span class="string">@"image"</span> : <span class="string">@"ad01.png"</span>, </span><br><span class="line">              <span class="string">@"url"</span> : <span class="string">@"http://www.ad01.com"</span>                                                          </span><br><span class="line">            &#125;, </span><br><span class="line"></span><br><span class="line">           @&#123;                               </span><br><span class="line">              <span class="string">@"image"</span> : <span class="string">@"ad02.png"</span>,                                   </span><br><span class="line">              <span class="string">@"url"</span> : <span class="string">@"http://www.ad02.com"</span>                           </span><br><span class="line">            &#125;                       </span><br><span class="line">          ],                       </span><br><span class="line"> <span class="string">@"totalNumber"</span> : <span class="string">@"2014"</span>                    </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">         <span class="comment">// å°†å­—å…¸è½¬ä¸ºStatusResultæ¨¡å‹</span></span><br><span class="line">         StatusResult *result = [StatusResult objectWithKeyValues:dict];</span><br><span class="line">         <span class="built_in">NSLog</span>(<span class="string">@"totalNumber=%@"</span>, result.totalNumber);</span><br><span class="line">         <span class="comment">// totalNumber=2014</span></span><br><span class="line"></span><br><span class="line">         <span class="comment">// æ‰“å°statusesæ•°ç»„ä¸­çš„æ¨¡å‹å±æ€§</span></span><br><span class="line">         <span class="keyword">for</span> (Status *status <span class="keyword">in</span> result.statuses) &#123;    </span><br><span class="line">                <span class="built_in">NSString</span> *text = status.text;    </span><br><span class="line">                <span class="built_in">NSString</span> *name = status.user.name;    <span class="built_in">NSString</span> *icon = status.user.icon;    </span><br><span class="line">                <span class="built_in">NSLog</span>(<span class="string">@"text=%@, name=%@, icon=%@"</span>, text, name, icon);&#125;</span><br><span class="line">               <span class="comment">// text=ä»Šå¤©å¤©æ°”çœŸä¸é”™ï¼, name=Rose, icon=nami.png</span></span><br><span class="line">               <span class="comment">// text=æ˜å¤©å»æ—…æ¸¸äº†, name=Jack, icon=lufy.png</span></span><br><span class="line"></span><br><span class="line">         <span class="comment">// æ‰“å°adsæ•°ç»„ä¸­çš„æ¨¡å‹å±æ€§</span></span><br><span class="line">         <span class="keyword">for</span> (Ad *ad <span class="keyword">in</span> result.ads) &#123;    </span><br><span class="line">                 <span class="built_in">NSLog</span>(<span class="string">@"image=%@, url=%@"</span>, ad.image, ad.url);&#125;</span><br><span class="line">                 <span class="comment">// image=ad01.png, url=http://www.ad01.com</span></span><br><span class="line">                 <span class="comment">// image=ad02.png, url=http://www.ad02.com</span></span><br></pre></td></tr></table></figure><h5 id="æ ¸å¿ƒä»£ç 3ï¼š"><a href="#æ ¸å¿ƒä»£ç 3ï¼š" class="headerlink" title="æ ¸å¿ƒä»£ç 3ï¼š"></a>æ ¸å¿ƒä»£ç 3ï¼š</h5><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">åœ¨æ¨¡å‹å†…éƒ¨å®ç°+ (<span class="built_in">NSDictionary</span> *)objectClassInArrayæ–¹æ³•</span><br><span class="line"></span><br><span class="line">[StatusResult objectWithKeyValues:dict]</span><br></pre></td></tr></table></figure><h4 id="4-æ¨¡å‹ä¸­çš„å±æ€§åå’Œå­—å…¸ä¸­çš„keyä¸ç›¸åŒ-æˆ–è€…éœ€è¦å¤šçº§æ˜ å°„"><a href="#4-æ¨¡å‹ä¸­çš„å±æ€§åå’Œå­—å…¸ä¸­çš„keyä¸ç›¸åŒ-æˆ–è€…éœ€è¦å¤šçº§æ˜ å°„" class="headerlink" title="4. æ¨¡å‹ä¸­çš„å±æ€§åå’Œå­—å…¸ä¸­çš„keyä¸ç›¸åŒ(æˆ–è€…éœ€è¦å¤šçº§æ˜ å°„)"></a>4. æ¨¡å‹ä¸­çš„å±æ€§åå’Œå­—å…¸ä¸­çš„keyä¸ç›¸åŒ(æˆ–è€…éœ€è¦å¤šçº§æ˜ å°„)</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Bag</span> : <span class="title">NSObject</span></span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">copy</span>, <span class="keyword">nonatomic</span>) <span class="built_in">NSString</span> *name;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">assign</span>, <span class="keyword">nonatomic</span>) <span class="keyword">double</span> price;<span class="keyword">@end</span><span class="class"><span class="keyword">@interface</span> <span class="title">Student</span> : <span class="title">NSObject</span></span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">copy</span>, <span class="keyword">nonatomic</span>) <span class="built_in">NSString</span> *ID;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">copy</span>, <span class="keyword">nonatomic</span>) <span class="built_in">NSString</span> *desc;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">copy</span>, <span class="keyword">nonatomic</span>) <span class="built_in">NSString</span> *nowName;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">copy</span>, <span class="keyword">nonatomic</span>) <span class="built_in">NSString</span> *oldName;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">copy</span>, <span class="keyword">nonatomic</span>) <span class="built_in">NSString</span> *nameChangedTime;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>, <span class="keyword">nonatomic</span>) Bag *bag;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">Student</span></span></span><br><span class="line"><span class="comment">// å®ç°è¿™ä¸ªæ–¹æ³•çš„ç›®çš„ï¼šå‘Šè¯‰MJExtensionæ¡†æ¶æ¨¡å‹ä¸­çš„å±æ€§åå¯¹åº”ç€å­—å…¸çš„å“ªä¸ªkey</span></span><br><span class="line">+ (<span class="built_in">NSDictionary</span> *)replacedKeyFromPropertyName&#123;    </span><br><span class="line">     <span class="keyword">return</span> @&#123;                </span><br><span class="line">               <span class="string">@"ID"</span> : <span class="string">@"id"</span>,                </span><br><span class="line">               <span class="string">@"desc"</span> : <span class="string">@"desciption"</span>,                </span><br><span class="line">               <span class="string">@"oldName"</span> : <span class="string">@"name.oldName"</span>, </span><br><span class="line">               <span class="string">@"nowName"</span> : <span class="string">@"name.newName"</span>,  </span><br><span class="line">               <span class="string">@"nameChangedTime"</span> : <span class="string">@"name.info.nameChangedTime"</span>,                                       </span><br><span class="line">               <span class="string">@"bag"</span> : <span class="string">@"other.bag"</span>            </span><br><span class="line">              &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">NSDictionary</span> *dict = @&#123;                       </span><br><span class="line">                        <span class="string">@"id"</span> : <span class="string">@"20"</span>,                       </span><br><span class="line">                        <span class="string">@"desciption"</span> : <span class="string">@"å­©å­"</span>,</span><br><span class="line">                        <span class="string">@"name"</span> : @&#123;                                                         </span><br><span class="line">                                     <span class="string">@"newName"</span> : <span class="string">@"lufy"</span>, </span><br><span class="line">                                     <span class="string">@"oldName"</span> : <span class="string">@"kitty"</span>,  </span><br><span class="line">                                     <span class="string">@"info"</span> : @&#123;                                                                                                   </span><br><span class="line">                                                  <span class="string">@"nameChangedTime"</span> : <span class="string">@"2013-08"</span>                            </span><br><span class="line">                                                 &#125;                       </span><br><span class="line">                                    &#125;,                       </span><br><span class="line">                        <span class="string">@"other"</span> : @&#123;                            </span><br><span class="line">                                      <span class="string">@"bag"</span> : @&#123;                                </span><br><span class="line">                                                  <span class="string">@"name"</span> : <span class="string">@"å°ä¹¦åŒ…"</span>, </span><br><span class="line">                                                  <span class="string">@"price"</span> : @<span class="number">100.7</span>                                                              </span><br><span class="line">                                                 &#125;                       </span><br><span class="line">                                     &#125;                   </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å°†å­—å…¸è½¬ä¸ºStudentæ¨¡å‹</span></span><br><span class="line">Student *stu = [Student objectWithKeyValues:dict];</span><br><span class="line"><span class="comment">// æ‰“å°Studentæ¨¡å‹çš„å±æ€§</span></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"ID=%@, desc=%@, oldName=%@, nowName=%@, nameChangedTime=%@"</span>, stu.ID, stu.desc, stu.oldName, stu.nowName, stu.nameChangedTime);</span><br><span class="line"><span class="comment">// ID=20, desc=å­©å­, oldName=kitty, nowName=lufy, nameChangedTime=2013-08</span></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"bagName=%@, bagPrice=%f"</span>, stu.bag.name, stu.bag.price);</span><br><span class="line"><span class="comment">// bagName=å°ä¹¦åŒ…, bagPrice=100.700000</span></span><br></pre></td></tr></table></figure><h5 id="æ ¸å¿ƒä»£ç 4ï¼š"><a href="#æ ¸å¿ƒä»£ç 4ï¼š" class="headerlink" title="æ ¸å¿ƒä»£ç 4ï¼š"></a>æ ¸å¿ƒä»£ç 4ï¼š</h5><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">åœ¨æ¨¡å‹å†…éƒ¨å®ç°+ (<span class="built_in">NSDictionary</span> *)replacedKeyFromPropertyNameæ–¹æ³•</span><br><span class="line"></span><br><span class="line">[Student objectWithKeyValues:dict]</span><br></pre></td></tr></table></figure><h4 id="5-å°†ä¸€ä¸ªå­—å…¸æ•°ç»„è½¬æˆæ¨¡å‹æ•°ç»„"><a href="#5-å°†ä¸€ä¸ªå­—å…¸æ•°ç»„è½¬æˆæ¨¡å‹æ•°ç»„" class="headerlink" title="5. å°†ä¸€ä¸ªå­—å…¸æ•°ç»„è½¬æˆæ¨¡å‹æ•°ç»„"></a>5. å°†ä¸€ä¸ªå­—å…¸æ•°ç»„è½¬æˆæ¨¡å‹æ•°ç»„</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSArray</span> *dictArray = @[                       </span><br><span class="line">                        @&#123;                           </span><br><span class="line">                           <span class="string">@"name"</span> : <span class="string">@"Jack"</span>,                           </span><br><span class="line">                           <span class="string">@"icon"</span> : <span class="string">@"lufy.png"</span>,                        </span><br><span class="line">                         &#125;,                       </span><br><span class="line">                        @&#123;                           </span><br><span class="line">                           <span class="string">@"name"</span> : <span class="string">@"Rose"</span>,                           </span><br><span class="line">                           <span class="string">@"icon"</span> : <span class="string">@"nami.png"</span>,                        </span><br><span class="line">                         &#125;                    </span><br><span class="line">                       ];</span><br><span class="line"></span><br><span class="line"><span class="comment">// å°†å­—å…¸æ•°ç»„è½¬ä¸ºUseræ¨¡å‹æ•°ç»„</span></span><br><span class="line"><span class="built_in">NSArray</span> *userArray = [User objectArrayWithKeyValuesArray:dictArray];</span><br><span class="line"><span class="comment">// æ‰“å°userArrayæ•°ç»„ä¸­çš„Useræ¨¡å‹å±æ€§</span></span><br><span class="line"><span class="keyword">for</span> (User *user <span class="keyword">in</span> userArray) &#123;   </span><br><span class="line">      <span class="built_in">NSLog</span>(<span class="string">@"name=%@, icon=%@"</span>, user.name, user.icon);&#125;</span><br><span class="line">      <span class="comment">// name=Jack, icon=lufy.png</span></span><br><span class="line">      <span class="comment">// name=Rose, icon=nami.png</span></span><br></pre></td></tr></table></figure><h5 id="æ ¸å¿ƒä»£ç 5ï¼š"><a href="#æ ¸å¿ƒä»£ç 5ï¼š" class="headerlink" title="æ ¸å¿ƒä»£ç 5ï¼š"></a>æ ¸å¿ƒä»£ç 5ï¼š</h5><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[User objectArrayWithKeyValuesArray:dictArray]</span><br></pre></td></tr></table></figure><h4 id="6-å°†ä¸€ä¸ªæ¨¡å‹è½¬æˆå­—å…¸"><a href="#6-å°†ä¸€ä¸ªæ¨¡å‹è½¬æˆå­—å…¸" class="headerlink" title="6. å°†ä¸€ä¸ªæ¨¡å‹è½¬æˆå­—å…¸"></a>6. å°†ä¸€ä¸ªæ¨¡å‹è½¬æˆå­—å…¸</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ–°å»ºæ¨¡å‹</span></span><br><span class="line">  User *user = [[User alloc] init];</span><br><span class="line">user.name = <span class="string">@"Jack"</span>;</span><br><span class="line">user.icon = <span class="string">@"lufy.png"</span>;</span><br><span class="line"></span><br><span class="line">Status *status = [[Status alloc] init];</span><br><span class="line">status.user = user;</span><br><span class="line">status.text = <span class="string">@"ä»Šå¤©çš„å¿ƒæƒ…ä¸é”™ï¼"</span>;</span><br></pre></td></tr></table></figure><p>â€‹    </p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å°†æ¨¡å‹è½¬ä¸ºå­—å…¸</span></span><br><span class="line"><span class="built_in">NSDictionary</span> *statusDict = status.keyValues;</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, statusDict);</span><br><span class="line"><span class="comment">/*&#123; text = "ä»Šå¤©çš„å¿ƒæƒ…ä¸é”™ï¼";    </span></span><br><span class="line"><span class="comment">    user = &#123;        </span></span><br><span class="line"><span class="comment">             icon = "lufy.png";        </span></span><br><span class="line"><span class="comment">             name = Jack;    </span></span><br><span class="line"><span class="comment">           &#125;;</span></span><br><span class="line"><span class="comment">  &#125;*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¤šçº§æ˜ å°„çš„æ¨¡å‹</span></span><br><span class="line">Student *stu = [[Student alloc] init];</span><br><span class="line">stu.ID = <span class="string">@"123"</span>;</span><br><span class="line">stu.oldName = <span class="string">@"rose"</span>;</span><br><span class="line">stu.nowName = <span class="string">@"jack"</span>;</span><br><span class="line">stu.desc = <span class="string">@"handsome"</span>;</span><br><span class="line">stu.nameChangedTime = <span class="string">@"2018-09-08"</span>;</span><br><span class="line"></span><br><span class="line">Bag *bag = [[Bag alloc] init];</span><br><span class="line">bag.name = <span class="string">@"å°ä¹¦åŒ…"</span>;</span><br><span class="line">bag.price = <span class="number">205</span>;</span><br><span class="line">stu.bag = bag;</span><br><span class="line"><span class="built_in">NSDictionary</span> *stuDict = stu.keyValues;<span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, stuDict);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">&#123;    desciption = handsome;    </span></span><br><span class="line"><span class="comment">       id = 123;    </span></span><br><span class="line"><span class="comment">       name = &#123;        </span></span><br><span class="line"><span class="comment">                info =&#123;            </span></span><br><span class="line"><span class="comment">                nameChangedTime = "2018-09-08";        </span></span><br><span class="line"><span class="comment">                       &#125;;        </span></span><br><span class="line"><span class="comment">                newName = jack;        </span></span><br><span class="line"><span class="comment">                oldName = rose;    </span></span><br><span class="line"><span class="comment">               &#125;;    </span></span><br><span class="line"><span class="comment">                other = &#123;  </span></span><br><span class="line"><span class="comment">                          bag =&#123;            </span></span><br><span class="line"><span class="comment">                                 name = "å°ä¹¦åŒ…";            </span></span><br><span class="line"><span class="comment">                                 price = 205;        </span></span><br><span class="line"><span class="comment">                               &#125;;    </span></span><br><span class="line"><span class="comment">                        &#125;; </span></span><br><span class="line"><span class="comment">               &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure><h5 id="æ ¸å¿ƒä»£ç 6ï¼š"><a href="#æ ¸å¿ƒä»£ç 6ï¼š" class="headerlink" title="æ ¸å¿ƒä»£ç 6ï¼š"></a>æ ¸å¿ƒä»£ç 6ï¼š</h5><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">status.keyValuesã€stu.keyValues</span><br></pre></td></tr></table></figure><h4 id="7-å°†ä¸€ä¸ªæ¨¡å‹æ•°ç»„è½¬æˆå­—å…¸æ•°ç»„"><a href="#7-å°†ä¸€ä¸ªæ¨¡å‹æ•°ç»„è½¬æˆå­—å…¸æ•°ç»„" class="headerlink" title="7. å°†ä¸€ä¸ªæ¨¡å‹æ•°ç»„è½¬æˆå­—å…¸æ•°ç»„"></a>7. å°†ä¸€ä¸ªæ¨¡å‹æ•°ç»„è½¬æˆå­—å…¸æ•°ç»„</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ–°å»ºæ¨¡å‹æ•°ç»„</span></span><br><span class="line">  User *user1 = [[User alloc] init];</span><br><span class="line">user1.name = <span class="string">@"Jack"</span>;</span><br><span class="line">user1.icon = <span class="string">@"lufy.png"</span>;</span><br><span class="line"></span><br><span class="line">User *user2 = [[User alloc] init];</span><br><span class="line">user2.name = <span class="string">@"Rose"</span>;</span><br><span class="line">user2.icon = <span class="string">@"nami.png"</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">NSArray</span> *userArray = @[user1, user2];</span><br><span class="line"><span class="comment">// å°†æ¨¡å‹æ•°ç»„è½¬ä¸ºå­—å…¸æ•°ç»„</span></span><br><span class="line"><span class="built_in">NSArray</span> *dictArray = [User keyValuesArrayWithObjectArray:userArray];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, dictArray);</span><br><span class="line"><span class="comment">/*(    </span></span><br><span class="line"><span class="comment">&#123;        icon = "lufy.png";        name = Jack;    &#125;,    </span></span><br><span class="line"><span class="comment">&#123;        icon = "nami.png";        name = Rose;    &#125;  )*/</span></span><br></pre></td></tr></table></figure><h6 id="æ ¸å¿ƒä»£ç 7ï¼š"><a href="#æ ¸å¿ƒä»£ç 7ï¼š" class="headerlink" title="æ ¸å¿ƒä»£ç 7ï¼š"></a>æ ¸å¿ƒä»£ç 7ï¼š</h6><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[User keyValuesArrayWithObjectArray:userArray]</span><br></pre></td></tr></table></figure><h4 id="æ›´å¤šç”¨æ³•"><a href="#æ›´å¤šç”¨æ³•" class="headerlink" title="æ›´å¤šç”¨æ³•"></a>æ›´å¤šç”¨æ³•</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å‚è€ƒ<span class="built_in">NSObject</span>+MJKeyValue.h</span><br><span class="line">å‚è€ƒ<span class="built_in">NSObject</span>+MJCoding.h</span><br></pre></td></tr></table></figure><hr>]]></content>
      
      
      <categories>
          
          <category> Note </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
            <tag> Objective-C </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS UIScrollViewçš„ä»£ç†æ–¹æ³•æ±‡æ€»</title>
      <link href="/2019-02-02-ios-uiscrollview-delegate-methods/"/>
      <url>/2019-02-02-ios-uiscrollview-delegate-methods/</url>
      
        <content type="html"><![CDATA[<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@protocol</span> <span class="title">UIScrollViewDelegate</span>&lt;<span class="title">NSObject</span>&gt;</span></span><br><span class="line"><span class="keyword">@optional</span></span><br><span class="line">- (<span class="keyword">void</span>)scrollViewDidScroll:(<span class="built_in">UIScrollView</span> *)scrollView; </span><br><span class="line"><span class="comment">// any offset changes åªè¦scrollViewçš„content è¿™ä¸ªæ–¹æ³•åœ¨ä»»ä½•æ–¹å¼è§¦å‘ contentOffset </span></span><br><span class="line"><span class="comment">// å˜åŒ–çš„æ—¶å€™éƒ½ä¼šè¢«è°ƒç”¨ï¼ˆåŒ…æ‹¬ç”¨æˆ·æ‹–åŠ¨ï¼Œå‡é€Ÿè¿‡ç¨‹ï¼Œç›´æ¥é€šè¿‡ä»£ç è®¾ç½®ç­‰ï¼‰ï¼Œå¯ä»¥ç”¨äºç›‘æ§ contentOffset </span></span><br><span class="line"><span class="comment">// çš„å˜åŒ–ï¼Œå¹¶æ ¹æ®å½“å‰çš„ contentOffset å¯¹å…¶ä»– view åšå‡ºéšåŠ¨è°ƒæ•´ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// called on start of dragging (may require some time and or distance to move)</span></span><br><span class="line">- (<span class="keyword">void</span>)scrollViewWillBeginDragging:(<span class="built_in">UIScrollView</span> *)scrollView; </span><br><span class="line"><span class="comment">// ç”¨æˆ·å¼€å§‹æ‹–åŠ¨ scroll view çš„æ—¶å€™è¢«è°ƒç”¨ï¼Œå¯èƒ½éœ€è¦ä¸€äº›æ—¶é—´å’Œè·ç¦»ç§»åŠ¨ä¹‹åæ‰ä¼šè§¦å‘ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// called on finger up if the user dragged. velocity is in points/millisecond. </span></span><br><span class="line"><span class="comment">// targetContentOffset may be changed to adjust where the scroll view comes to rest</span></span><br><span class="line">- (<span class="keyword">void</span>)scrollViewWillEndDragging:(<span class="built_in">UIScrollView</span> *)scrollView withVelocity:(<span class="built_in">CGPoint</span>)velocity targetContentOffset:(<span class="keyword">inout</span> <span class="built_in">CGPoint</span> *)targetContentOffset <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">5</span>_0);</span><br><span class="line"><span class="comment">// åœ¨ didEndDragging å‰è¢«è°ƒç”¨ï¼Œå½“ willEndDragging æ–¹æ³•ä¸­ velocity ä¸º CGPointZero</span></span><br><span class="line"><span class="comment">//ï¼ˆç»“æŸæ‹–åŠ¨æ—¶ä¸¤ä¸ªæ–¹å‘éƒ½æ²¡æœ‰é€Ÿåº¦ï¼‰æ—¶ï¼ŒdidEndDragging ä¸­çš„ decelerate ä¸º NOï¼Œå³æ²¡æœ‰å‡é€Ÿè¿‡ç¨‹ï¼Œ</span></span><br><span class="line"><span class="comment">//willBeginDecelerating å’Œ didEndDecelerating ä¹Ÿå°±ä¸ä¼šè¢«è°ƒç”¨ã€‚åä¹‹ï¼Œ</span></span><br><span class="line"><span class="comment">// å½“ velocity ä¸ä¸º CGPointZero æ—¶ï¼Œscroll view ä¼šä»¥ velocity ä¸ºåˆé€Ÿåº¦ï¼Œ</span></span><br><span class="line"><span class="comment">// å‡é€Ÿç›´åˆ° targetContentOffsetã€‚</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)scrollViewDidEndDragging:(<span class="built_in">UIScrollView</span> *)scrollView willDecelerate:(<span class="built_in">BOOL</span>)decelerate;</span><br><span class="line"><span class="comment">// åœ¨ç”¨æˆ·ç»“æŸæ‹–åŠ¨åè¢«è°ƒç”¨ï¼Œdecelerate ä¸º YES æ—¶ï¼Œ</span></span><br><span class="line"><span class="comment">// ç»“æŸæ‹–åŠ¨åä¼šæœ‰å‡é€Ÿè¿‡ç¨‹ã€‚æ³¨ï¼Œåœ¨ didEndDragging ä¹‹åï¼Œå¦‚æœæœ‰å‡é€Ÿè¿‡ç¨‹ï¼Œ</span></span><br><span class="line"><span class="comment">// scroll view çš„ dragging å¹¶ä¸ä¼šç«‹å³ç½®ä¸º NOï¼Œè€Œæ˜¯è¦ç­‰åˆ°å‡é€Ÿç»“æŸä¹‹åï¼Œ</span></span><br><span class="line"><span class="comment">// æ‰€ä»¥è¿™ä¸ª dragging å±æ€§çš„å®é™…è¯­ä¹‰æ›´æ¥è¿‘ scrollingã€‚</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)scrollViewWillBeginDecelerating:(<span class="built_in">UIScrollView</span> *)scrollView;   <span class="comment">// å‡é€ŸåŠ¨ç”»å¼€å§‹å‰è¢«è°ƒç”¨ã€‚</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)scrollViewDidEndDecelerating:(<span class="built_in">UIScrollView</span> *)scrollView;      </span><br><span class="line"><span class="comment">// å‡é€ŸåŠ¨ç”»ç»“æŸæ—¶è¢«è°ƒç”¨ï¼Œè¿™é‡Œæœ‰ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼šå½“ä¸€æ¬¡å‡é€ŸåŠ¨ç”»å°šæœªç»“æŸçš„æ—¶å€™å†æ¬¡ drag scroll viewï¼Œ</span></span><br><span class="line"><span class="comment">// didEndDecelerating ä¸ä¼šè¢«è°ƒç”¨ï¼Œå¹¶ä¸”è¿™æ—¶ scroll view çš„ dragging å’Œ decelerating å±æ€§éƒ½æ˜¯ YESã€‚</span></span><br><span class="line"><span class="comment">// æ–°çš„ dragging å¦‚æœæœ‰åŠ é€Ÿåº¦ï¼Œé‚£ä¹ˆ willBeginDecelerating ä¼šå†ä¸€æ¬¡è¢«è°ƒç”¨ï¼Œç„¶åæ‰æ˜¯ didEndDeceleratingï¼›</span></span><br><span class="line"><span class="comment">// å¦‚æœæ²¡æœ‰åŠ é€Ÿåº¦ï¼Œè™½ç„¶ willBeginDecelerating ä¸ä¼šè¢«è°ƒç”¨ï¼Œä½†å‰ä¸€æ¬¡ç•™ä¸‹çš„ didEndDecelerating ä¼šè¢«è°ƒç”¨      </span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)scrollViewDidEndScrollingAnimation:(<span class="built_in">UIScrollView</span> *)scrollView; </span><br><span class="line"><span class="comment">// called when setContentOffset/scrollRectVisible:animated: finishes. not called if not animating</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)scrollViewDidZoom:(<span class="built_in">UIScrollView</span> *)scrollView <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">3</span>_2); </span><br><span class="line"><span class="comment">// any zoom scale changes viewç¼©æ”¾æ”¹å˜çš„æ—¶å€™è°ƒç”¨ã€‚</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">nullable</span> <span class="built_in">UIView</span> *)viewForZoomingInScrollView:(<span class="built_in">UIScrollView</span> *)scrollView;     </span><br><span class="line"><span class="comment">// return a view that will be scaled. if delegate returns nil, nothing happens</span></span><br><span class="line">å‘Šè¯‰ä»£ç†è¦ç¼©æ”¾é‚£ä¸ªæ§ä»¶ã€‚ </span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)scrollViewWillBeginZooming:(<span class="built_in">UIScrollView</span> *)scrollView withView:(<span class="keyword">nullable</span> <span class="built_in">UIView</span> *)view <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">3</span>_2); </span><br><span class="line"><span class="comment">// called before the scroll view begins zooming its contentç¼©æ”¾å¼€å§‹çš„æ—¶å€™è°ƒç”¨</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)scrollViewDidEndZooming:(<span class="built_in">UIScrollView</span> *)scrollView withView:(<span class="keyword">nullable</span> <span class="built_in">UIView</span> *)view atScale:(<span class="built_in">CGFloat</span>)scale; </span><br><span class="line"><span class="comment">// scale between minimum and maximum. called after any 'bounce' animationsç¼©æ”¾å®Œæ¯•çš„æ—¶å€™è°ƒç”¨ã€‚</span></span><br><span class="line"></span><br><span class="line">- (<span class="built_in">BOOL</span>)scrollViewShouldScrollToTop:(<span class="built_in">UIScrollView</span> *)scrollView;   <span class="comment">// return a yes if you want to scroll to the top. if not defined, assumes YES- (void)scrollViewDidScrollToTop:(UIScrollView *)scrollView;      </span></span><br><span class="line"><span class="comment">// called when scrolling animation finished. may be called immediately if already at topæ»šåŠ¨åŠ¨ç”»å®Œæˆæ—¶è°ƒç”¨ã€‚</span></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure><hr>]]></content>
      
      
      <categories>
          
          <category> Note </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
            <tag> Objective-C </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS UILabelçš„lineBreakModeçœç•¥æ¨¡å¼è®¾ç½®</title>
      <link href="/2019-02-01-ios-uilabel-linebreakmode-setting/"/>
      <url>/2019-02-01-ios-uilabel-linebreakmode-setting/</url>
      
        <content type="html"><![CDATA[<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">label.lineBreakMode = <span class="built_in">NSLineBreakByCharWrapping</span>; <span class="comment">//ä»¥å­—ç¬¦ä¸ºæ˜¾ç¤ºå•ä½æ˜¾ç¤ºï¼Œåé¢éƒ¨åˆ†çœç•¥ä¸æ˜¾ç¤ºã€‚</span></span><br><span class="line">label.lineBreakMode = <span class="built_in">NSLineBreakByClipping</span>; <span class="comment">//å‰ªåˆ‡ä¸æ–‡æœ¬å®½åº¦ç›¸åŒçš„å†…å®¹é•¿åº¦ï¼ŒååŠéƒ¨åˆ†è¢«åˆ é™¤ã€‚</span></span><br><span class="line">label.lineBreakMode = <span class="built_in">NSLineBreakByTruncatingHead</span>; <span class="comment">//å‰é¢éƒ¨åˆ†æ–‡å­—ä»¥â€¦â€¦æ–¹å¼çœç•¥ï¼Œæ˜¾ç¤ºå°¾éƒ¨æ–‡å­—å†…å®¹ã€‚</span></span><br><span class="line">label.lineBreakMode = <span class="built_in">NSLineBreakByTruncatingMiddle</span>; <span class="comment">//ä¸­é—´çš„å†…å®¹ä»¥â€¦â€¦æ–¹å¼çœç•¥ï¼Œæ˜¾ç¤ºå¤´å°¾çš„æ–‡å­—å†…å®¹ã€‚</span></span><br><span class="line">label.lineBreakMode = <span class="built_in">NSLineBreakByTruncatingTail</span>; <span class="comment">//ç»“å°¾éƒ¨åˆ†çš„å†…å®¹ä»¥â€¦â€¦æ–¹å¼çœç•¥ï¼Œæ˜¾ç¤ºå¤´çš„æ–‡å­—å†…å®¹ã€‚</span></span><br><span class="line">label.lineBreakMode = <span class="built_in">NSLineBreakByWordWrapping</span>; <span class="comment">//ä»¥å•è¯ä¸ºæ˜¾ç¤ºå•ä½æ˜¾ç¤ºï¼Œåé¢éƒ¨åˆ†çœç•¥ä¸æ˜¾ç¤ºã€‚</span></span><br></pre></td></tr></table></figure><hr>]]></content>
      
      
      <categories>
          
          <category> Note </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
            <tag> Objective-C </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOSä¿®æ”¹UIImageå›¾ç‰‡å°ºå¯¸å¤§å°é€»è¾‘åˆ†è¾¨ç‡</title>
      <link href="/2019-02-01-ios-uiimage-resize/"/>
      <url>/2019-02-01-ios-uiimage-resize/</url>
      
        <content type="html"><![CDATA[<p>ä¹‹å‰é‡åˆ°çš„é—®é¢˜ï¼Œç»™UITabbar itemè®¾ç½®å›¾ç‰‡ï¼Œç„¶è€Œç´ æçš„å›¾ç‰‡åˆ†è¾¨ç‡æ˜¯87*87ï¼Œå¡«æ»¡äº†æ•´ä¸ªtabbar itemçš„åŒºåŸŸï¼Œå¾ˆéš¾çœ‹ï¼Œåˆè¦è€ƒè™‘é€‚é…XS Maxçš„ä¸‰å€é—®é¢˜ã€‚ è§£å†³æ–¹æ³•å¦‚ä¸‹ï¼š é€šè¿‡è®¾ç½®scaleä½¿ç”Ÿæˆçš„å›¾ç‰‡å°ºå¯¸æ˜¯é€»è¾‘åˆ†è¾¨ç‡ptå•ä½ï¼Œä¸ç”¨æ“å¿ƒäºŒå€ä¸‰å€çš„é—®é¢˜ã€‚</p><a id="more"></a><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+ (<span class="built_in">UIImage</span> *)imageResize:(<span class="built_in">UIImage</span>*)img andResizeTo:(<span class="built_in">CGSize</span>)newSize &#123;</span><br><span class="line">    <span class="built_in">CGFloat</span> scale = [[<span class="built_in">UIScreen</span> mainScreen]scale];</span><br><span class="line">    <span class="comment">//UIGraphicsBeginImageContext(newSize);</span></span><br><span class="line">    <span class="built_in">UIGraphicsBeginImageContextWithOptions</span>(newSize, <span class="literal">NO</span>, scale);</span><br><span class="line">    [img drawInRect:<span class="built_in">CGRectMake</span>(<span class="number">0</span>,<span class="number">0</span>,newSize.width,newSize.height)];</span><br><span class="line">    <span class="built_in">UIImage</span>* newImage = <span class="built_in">UIGraphicsGetImageFromCurrentImageContext</span>();</span><br><span class="line">    <span class="built_in">UIGraphicsEndImageContext</span>();</span><br><span class="line">    <span class="keyword">return</span> newImage;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·ä¸€æ¥å°±èƒ½ä½¿tabbar itemçš„å›¾æ ‡å§‹ç»ˆæ˜¯25pt*25ptï¼Œæ°åˆ°å¥½å¤„ã€‚</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">childController.tabBarItem.selectedImage = [[SmallTools imageResize:[<span class="built_in">UIImage</span> imageNamed:selected] andResizeTo:<span class="built_in">CGSizeMake</span>(<span class="number">25</span>, <span class="number">25</span>)] imageWithRenderingMode:<span class="built_in">UIImageRenderingModeAlwaysOriginal</span>];</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/1549072293345_888x213.gif" alt></p><h3 id="å¦å¤–å…³äºä¸Šå›¾ä¸­é—´å›¾æ ‡çš„åŠ¨ç”»æ•ˆæœå®ç°å¯å‚è€ƒæ­¤æ–‡ç« "><a href="#å¦å¤–å…³äºä¸Šå›¾ä¸­é—´å›¾æ ‡çš„åŠ¨ç”»æ•ˆæœå®ç°å¯å‚è€ƒæ­¤æ–‡ç« " class="headerlink" title="å¦å¤–å…³äºä¸Šå›¾ä¸­é—´å›¾æ ‡çš„åŠ¨ç”»æ•ˆæœå®ç°å¯å‚è€ƒæ­¤æ–‡ç« "></a>å¦å¤–å…³äºä¸Šå›¾ä¸­é—´å›¾æ ‡çš„åŠ¨ç”»æ•ˆæœå®ç°å¯å‚è€ƒæ­¤æ–‡ç« </h3><p><a href="http://paaatrick.com/ios_uitabbar_touch_animation.html" title="iOS UITabbarå›¾æ ‡ç‚¹å‡»åŠ¨ç”»æ•ˆæœå®ç°">iOS UITabbarå›¾æ ‡ç‚¹å‡»åŠ¨ç”»æ•ˆæœå®ç°</a>      </p><hr>]]></content>
      
      
      <categories>
          
          <category> Tech </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
            <tag> Objective-C </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iOS UITabbarå›¾æ ‡ç‚¹å‡»åŠ¨ç”»æ•ˆæœå®ç°</title>
      <link href="/2019-02-01-ios-uitabbar-touch-animation/"/>
      <url>/2019-02-01-ios-uitabbar-touch-animation/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ç‚¹å‡»tabbaréƒ½åªæœ‰ä¸€ä¸ªå˜è‰²æ•ˆæœï¼Œä½†æœ‰æ—¶å€™ï¼Œå¦‚æœæˆ‘ä»¬æƒ³ç»™å®ƒæ·»åŠ ä¸€ä¸ªç‚¹å‡»åŠ¨ç”»ï¼Œè¯¥å¦‚ä½•åšå‘¢ï¼Ÿ ä»¥ä¸‹æ˜¯ä¸¤ç§æ–¹æ³•ï¼š </p><h3 id="æ–¹æ³•ä¸€"><a href="#æ–¹æ³•ä¸€" class="headerlink" title="æ–¹æ³•ä¸€"></a>æ–¹æ³•ä¸€</h3><p>é€šè¿‡<code>tabBar: didSelectItem:</code>ä»£ç†æ–¹æ³•æ¥æ”¶æ¯æ¬¡ç‚¹å‡»çš„itemï¼Œå¯¹æ¯ä¸ªiteméƒ½ç»‘å®šåŠ¨ç”»æ•ˆæœï¼Œå¼Šç«¯æ˜¯è·å–åˆ°çš„æ˜¯æ•´ä¸ªitemï¼Œå›¾æ ‡å’Œæ ‡é¢˜éƒ½ä¼šä¸€èµ·åŠ¨ã€‚ </p><h3 id="æ–¹æ³•äºŒ"><a href="#æ–¹æ³•äºŒ" class="headerlink" title="æ–¹æ³•äºŒ"></a>æ–¹æ³•äºŒ</h3><p>æ˜¯è‡ªå®šä¸€ä¸ªæ–¹æ³•å•ç‹¬è·å–tabbar itemçš„imageå’Œlabelï¼Œå¯è‡ªå®šåªå¯¹æŸä¸ªitemç»‘å®šåŠ¨ç”»ï¼Œå¹¶ä¸”å¯è®¾å®šå•ç‹¬imageçš„åŠ¨ç”»ã€‚ </p><h2 id="æ•ˆæœå›¾"><a href="#æ•ˆæœå›¾" class="headerlink" title="æ•ˆæœå›¾"></a>æ•ˆæœå›¾</h2><blockquote><p>ç¬¬äºŒç§æ–¹æ³•ï¼šåªå¯¹imageæ‰§è¡ŒåŠ¨ç”» </p></blockquote><p>1ã€å¸¦é‡åŠ›æ•ˆæœçš„å¼¹è·³</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/1549072293345_888x213.gif" alt></p><a id="more"></a><blockquote><p>å4ä¸ªæ˜¯ç¬¬ä¸€ç§æ–¹æ³•</p></blockquote><p>2ã€å…ˆæ”¾å¤§ï¼Œå†ç¼©å° </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/511196-20170116103844396-1872210226.gif" alt></p><p>3ã€Zè½´æ—‹è½¬ </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/511196-20170116103932614-876709799.gif" alt></p><p>4ã€Yè½´ä½ç§» </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/511196-20170116104000302-95725194.gif" alt></p><p>5ã€æ”¾å¤§å¹¶ä¿æŒ </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/511196-20170116104036224-920525159.gif" alt></p><h2 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h2><h3 id="è·å–è¦æ‰§è¡ŒåŠ¨ç”»çš„Item"><a href="#è·å–è¦æ‰§è¡ŒåŠ¨ç”»çš„Item" class="headerlink" title="è·å–è¦æ‰§è¡ŒåŠ¨ç”»çš„Item"></a>è·å–è¦æ‰§è¡ŒåŠ¨ç”»çš„Item</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">MainTabbarVC</span> ()&lt;<span class="title">UITabBarControllerDelegate</span>&gt;</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">assign</span>) <span class="built_in">NSInteger</span>  indexFlag;ã€€ã€€<span class="comment">//è®°å½•ä¸Šä¸€æ¬¡ç‚¹å‡»tabbarï¼Œä½¿ç”¨æ—¶ï¼Œè®°å¾—å…ˆåœ¨initæˆ–viewDidLoadé‡Œ åˆå§‹åŒ– = 0</span></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//ç¬¬ä¸€ç§æ–¹æ³•ï¼šé€šè¿‡æ¥æ”¶ç‚¹å‡»äº‹ä»¶å¯¹æ¯ä¸ªtabbar itemçš„ç‚¹å‡»éƒ½æ‰§è¡ŒåŠ¨ç”»</span></span><br><span class="line">-(<span class="keyword">void</span>)tabBar:(<span class="built_in">UITabBar</span> *)tabBar didSelectItem:(<span class="built_in">UITabBarItem</span> *)item&#123;</span><br><span class="line">    <span class="built_in">NSInteger</span> index = [<span class="keyword">self</span>.tabBar.items indexOfObject:item];</span><br><span class="line">    <span class="keyword">if</span> (index != <span class="keyword">self</span>.indexFlag) &#123;</span><br><span class="line">        <span class="comment">//æ‰§è¡ŒåŠ¨ç”»</span></span><br><span class="line">        <span class="built_in">NSMutableArray</span> *arry = [<span class="built_in">NSMutableArray</span> array];</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">UIView</span> *btn <span class="keyword">in</span> <span class="keyword">self</span>.tabBar.subviews) &#123;</span><br><span class="line">            <span class="keyword">if</span> ([btn isKindOfClass:<span class="built_in">NSClassFromString</span>(<span class="string">@"UITabBarButton"</span>)]) &#123;</span><br><span class="line">                 [arry addObject:btn];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//æ·»åŠ åŠ¨ç”»</span></span><br><span class="line">ã€€ã€€ã€€ã€€ <span class="comment">//---å°†ä¸‹é¢çš„åŠ¨ç”»ä»£ç å—æ‹·è´åˆ°æ­¤å¹¶ä¿®æ”¹æœ€åä¸€è¡ŒaddAnimationçš„layerå¯¹è±¡å³å¯---</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">self</span>.indexFlag = index;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç¬¬äºŒç§æ–¹æ³•ï¼šåªæƒ³å¯¹æŸä¸€ä¸ªitemçš„ç‚¹å‡»æ‰§è¡ŒåŠ¨ç”»ï¼Œä¸”åªæœ‰å›¾ç‰‡åŠ¨ï¼Œæ–‡å­—ä¸åŠ¨ã€‚å¹¶ä¸”å…¶ä½™å›¾æ ‡çš„ç‚¹å‡»ä¸å¸¦åŠ¨ç”»</span></span><br><span class="line">- (<span class="keyword">void</span>)tabBarImageAnimation &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">UIControl</span> *tabBarButton <span class="keyword">in</span> <span class="keyword">self</span>.tabBar.subviews) &#123;</span><br><span class="line">        <span class="keyword">if</span> ([tabBarButton isKindOfClass:<span class="built_in">NSClassFromString</span>(<span class="string">@"UITabBarButton"</span>)]) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="built_in">UIControl</span> *tabBarButtonLabel <span class="keyword">in</span> tabBarButton.subviews) &#123;</span><br><span class="line">                <span class="keyword">if</span> ([tabBarButtonLabel isKindOfClass:<span class="built_in">NSClassFromString</span>(<span class="string">@"UITabBarButtonLabel"</span>)]) &#123;</span><br><span class="line">                    <span class="built_in">UILabel</span> *label = (<span class="built_in">UILabel</span> *)tabBarButtonLabel;</span><br><span class="line">                    <span class="comment">//"tab1"åˆ°"tab4"åˆ†åˆ«æ˜¯ä¸æ‰“ç®—æ‰§è¡ŒåŠ¨ç”»çš„tabbar itemçš„æ ‡é¢˜åç§°</span></span><br><span class="line">                    <span class="keyword">if</span> (![label.text isEqualToString:<span class="string">@"tab1"</span>] &amp;&amp; ![label.text isEqualToString:<span class="string">@"tab2"</span>] &amp;&amp; ![label.text isEqualToString:<span class="string">@"tab3"</span>] &amp;&amp; ![label.text isEqualToString:<span class="string">@"tab4"</span>]) &#123;</span><br><span class="line">                        <span class="keyword">for</span> (<span class="built_in">UIView</span> *imageView <span class="keyword">in</span> tabBarButton.subviews) &#123;</span><br><span class="line">                            <span class="keyword">if</span> ([imageView isKindOfClass:<span class="built_in">NSClassFromString</span>(<span class="string">@"UITabBarSwappableImageView"</span>)]) &#123;</span><br><span class="line">                                <span class="comment">//æ·»åŠ åŠ¨ç”»</span></span><br><span class="line">                                <span class="comment">//---å°†ä¸‹é¢çš„åŠ¨ç”»ä»£ç å—æ‹·è´åˆ°æ­¤å¹¶ä¿®æ”¹æœ€åä¸€è¡ŒaddAnimationçš„layerå¯¹è±¡å³å¯---</span></span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ç¬¬äºŒç§æ–¹æ³•çš„ç”¨æ³•æ¯”è¾ƒçµæ´»ï¼Œæ¯”å¦‚å¯ä»¥åœ¨TabbarVCé‡Œè®¾ä¸Šé¢<code>tabBarImageAnimation</code>æ–¹æ³•çš„é€šçŸ¥Observerï¼Œåœ¨éœ€è¦æ‰§è¡ŒåŠ¨ç”»çš„åœ°æ–¹æ¯”å¦‚æ‰“å¼€æŸVCæ—¶åœ¨è¯¥VCçš„<code>viewDidAppear</code>é‡Œposté€šçŸ¥å³å¯ã€‚</p></blockquote><h3 id="åŠ¨ç”»ä»£ç "><a href="#åŠ¨ç”»ä»£ç " class="headerlink" title="åŠ¨ç”»ä»£ç "></a>åŠ¨ç”»ä»£ç </h3><p>1ã€å¸¦é‡åŠ›æ•ˆæœçš„å¼¹è·³</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">CAKeyframeAnimation</span> *animation = [<span class="built_in">CAKeyframeAnimation</span> animationWithKeyPath:<span class="string">@"transform.translation.y"</span>];</span><br><span class="line"><span class="comment">//é€šè¿‡åˆä¸­ç‰©ç†é‡åŠ›å…¬å¼è®¡ç®—å‡ºçš„ä½ç§»yå€¼æ•°ç»„</span></span><br><span class="line">animation.values = @[@<span class="number">0.0</span>, @<span class="number">-4.15</span>, @<span class="number">-7.26</span>, @<span class="number">-9.34</span>, @<span class="number">-10.37</span>, @<span class="number">-9.34</span>, @<span class="number">-7.26</span>, @<span class="number">-4.15</span>, @<span class="number">0.0</span>, @<span class="number">2.0</span>, @<span class="number">-2.9</span>, @<span class="number">-4.94</span>, @<span class="number">-6.11</span>, @<span class="number">-6.42</span>, @<span class="number">-5.86</span>, @<span class="number">-4.44</span>, @<span class="number">-2.16</span>, @<span class="number">0.0</span>];</span><br><span class="line">animation.duration = <span class="number">0.8</span>;</span><br><span class="line">animation.beginTime = <span class="built_in">CACurrentMediaTime</span>() + <span class="number">1</span>;</span><br><span class="line">[imageView.layer addAnimation:animation forKey:<span class="literal">nil</span>];</span><br></pre></td></tr></table></figure><p>2ã€å…ˆæ”¾å¤§ï¼Œå†ç¼©å°</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ”¾å¤§æ•ˆæœï¼Œå¹¶å›åˆ°åŸä½</span></span><br><span class="line"><span class="built_in">CABasicAnimation</span> *animation = [<span class="built_in">CABasicAnimation</span> animationWithKeyPath:<span class="string">@"transform.scale"</span>];</span><br><span class="line"><span class="comment">//é€Ÿåº¦æ§åˆ¶å‡½æ•°ï¼Œæ§åˆ¶åŠ¨ç”»è¿è¡Œçš„èŠ‚å¥</span></span><br><span class="line">animation.timingFunction = [<span class="built_in">CAMediaTimingFunction</span> functionWithName:kCAMediaTimingFunctionEaseInEaseOut];</span><br><span class="line">animation.duration = <span class="number">0.2</span>;       <span class="comment">//æ‰§è¡Œæ—¶é—´</span></span><br><span class="line">animation.repeatCount = <span class="number">1</span>;      <span class="comment">//æ‰§è¡Œæ¬¡æ•°</span></span><br><span class="line">animation.autoreverses = <span class="literal">YES</span>;    <span class="comment">//å®ŒæˆåŠ¨ç”»åä¼šå›åˆ°æ‰§è¡ŒåŠ¨ç”»ä¹‹å‰çš„çŠ¶æ€</span></span><br><span class="line">animation.fromValue = [<span class="built_in">NSNumber</span> numberWithFloat:<span class="number">0.7</span>];   <span class="comment">//åˆå§‹ä¼¸ç¼©å€æ•°</span></span><br><span class="line">animation.toValue = [<span class="built_in">NSNumber</span> numberWithFloat:<span class="number">1.3</span>];     <span class="comment">//ç»“æŸä¼¸ç¼©å€æ•°</span></span><br><span class="line">[[arry[index] layer] addAnimation:animation forKey:<span class="literal">nil</span>];</span><br></pre></td></tr></table></figure><p>3ã€Zè½´æ—‹è½¬</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//zè½´æ—‹è½¬180åº¦</span></span><br><span class="line"><span class="built_in">CABasicAnimation</span> *animation = [<span class="built_in">CABasicAnimation</span> animationWithKeyPath:<span class="string">@"transform.rotation.z"</span>];</span><br><span class="line"><span class="comment">//é€Ÿåº¦æ§åˆ¶å‡½æ•°ï¼Œæ§åˆ¶åŠ¨ç”»è¿è¡Œçš„èŠ‚å¥</span></span><br><span class="line">animation.timingFunction = [<span class="built_in">CAMediaTimingFunction</span> functionWithName:kCAMediaTimingFunctionEaseInEaseOut];</span><br><span class="line">animation.duration = <span class="number">0.2</span>;       <span class="comment">//æ‰§è¡Œæ—¶é—´</span></span><br><span class="line">animation.repeatCount = <span class="number">1</span>;      <span class="comment">//æ‰§è¡Œæ¬¡æ•°</span></span><br><span class="line">animation.removedOnCompletion = <span class="literal">YES</span>;</span><br><span class="line">animation.fromValue = [<span class="built_in">NSNumber</span> numberWithFloat:<span class="number">0</span>];   <span class="comment">//åˆå§‹ä¼¸ç¼©å€æ•°</span></span><br><span class="line">animation.toValue = [<span class="built_in">NSNumber</span> numberWithFloat:M_PI];     <span class="comment">//ç»“æŸä¼¸ç¼©å€æ•°</span></span><br><span class="line">[[arry[index] layer] addAnimation:animation forKey:<span class="literal">nil</span>];</span><br></pre></td></tr></table></figure><p>4ã€Yè½´ä½ç§»</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å‘ä¸Šç§»åŠ¨</span></span><br><span class="line"><span class="built_in">CABasicAnimation</span> *animation = [<span class="built_in">CABasicAnimation</span> animationWithKeyPath:<span class="string">@"transform.translation.y"</span>];</span><br><span class="line"><span class="comment">//é€Ÿåº¦æ§åˆ¶å‡½æ•°ï¼Œæ§åˆ¶åŠ¨ç”»è¿è¡Œçš„èŠ‚å¥</span></span><br><span class="line">animation.timingFunction = [<span class="built_in">CAMediaTimingFunction</span> functionWithName:kCAMediaTimingFunctionEaseInEaseOut];</span><br><span class="line">animation.duration = <span class="number">0.2</span>;       <span class="comment">//æ‰§è¡Œæ—¶é—´</span></span><br><span class="line">animation.repeatCount = <span class="number">1</span>;      <span class="comment">//æ‰§è¡Œæ¬¡æ•°</span></span><br><span class="line">animation.removedOnCompletion = <span class="literal">YES</span>;</span><br><span class="line">animation.fromValue = [<span class="built_in">NSNumber</span> numberWithFloat:<span class="number">0</span>];   <span class="comment">//åˆå§‹ä¼¸ç¼©å€æ•°</span></span><br><span class="line">animation.toValue = [<span class="built_in">NSNumber</span> numberWithFloat:<span class="number">-10</span>];     <span class="comment">//ç»“æŸä¼¸ç¼©å€æ•°</span></span><br><span class="line">[[arry[index] layer] addAnimation:animation forKey:<span class="literal">nil</span>];</span><br></pre></td></tr></table></figure><p>5ã€æ”¾å¤§å¹¶ä¿æŒ</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ”¾å¤§æ•ˆæœ</span></span><br><span class="line"><span class="built_in">CABasicAnimation</span> *animation = [<span class="built_in">CABasicAnimation</span> animationWithKeyPath:<span class="string">@"transform.scale"</span>];</span><br><span class="line"><span class="comment">//é€Ÿåº¦æ§åˆ¶å‡½æ•°ï¼Œæ§åˆ¶åŠ¨ç”»è¿è¡Œçš„èŠ‚å¥</span></span><br><span class="line">animation.timingFunction = [<span class="built_in">CAMediaTimingFunction</span> functionWithName:kCAMediaTimingFunctionEaseInEaseOut];</span><br><span class="line">animation.duration = <span class="number">0.2</span>;       <span class="comment">//æ‰§è¡Œæ—¶é—´</span></span><br><span class="line">animation.repeatCount = <span class="number">1</span>;      <span class="comment">//æ‰§è¡Œæ¬¡æ•°</span></span><br><span class="line">animation.removedOnCompletion = <span class="literal">NO</span>;</span><br><span class="line">animation.fillMode = kCAFillModeForwards;           <span class="comment">//ä¿è¯åŠ¨ç”»æ•ˆæœå»¶ç»­</span></span><br><span class="line">animation.fromValue = [<span class="built_in">NSNumber</span> numberWithFloat:<span class="number">1.0</span>];   <span class="comment">//åˆå§‹ä¼¸ç¼©å€æ•°</span></span><br><span class="line">animation.toValue = [<span class="built_in">NSNumber</span> numberWithFloat:<span class="number">1.15</span>];     <span class="comment">//ç»“æŸä¼¸ç¼©å€æ•°</span></span><br><span class="line">[[arry[index] layer] addAnimation:animation forKey:<span class="literal">nil</span>];</span><br><span class="line"><span class="comment">//ç§»é™¤å…¶ä»–tabbarçš„åŠ¨ç”»</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i&lt;arry.count; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (i != index) &#123;</span><br><span class="line">        [[arry[i] layer] removeAllAnimations];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤å¤–ï¼Œå¦‚æœæƒ³å®šåˆ¶å…¶ä»–åŠ¨ç”»æ•ˆæœï¼Œè¿˜å¯ä»¥ä»ä¸‹é¢å±æ€§é‡Œè‡ªå·±å®šåˆ¶åŠ¨ç”» </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/511196-20170116093610724-1578979553.png" alt></p><hr>]]></content>
      
      
      <categories>
          
          <category> Tech </category>
          
      </categories>
      
      
        <tags>
            
            <tag> iOS </tag>
            
            <tag> Objective-C </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¯”å’ªè’™æ›´å¯æ€•çš„ï¼Œæ˜¯æŒ–ç¥–åŸå¼ä¸¾æŠ¥æ¸…ç®—</title>
      <link href="/2019-02-01-raistlin2017/"/>
      <url>/2019-02-01-raistlin2017/</url>
      
        <content type="html"><![CDATA[<blockquote><p>åŸæ–‡å§‹å‘äºå¾®ä¿¡å…¬ä¼—å·ï¼ˆä¸ºä½ å†™ä¸€ä¸ªæ•…äº‹ï¼‰ï¼š<a href="http://mp.weixin.qq.com/s/Xb4bgA_2ylXRwQO4isgJqg" target="_blank" rel="noopener">æ¯”å’ªè’™æ›´å¯æ€•çš„ï¼Œæ˜¯æŒ–ç¥–åŸå¼ä¸¾æŠ¥æ¸…ç®—</a></p></blockquote><p>å› ä¸ºæ——ä¸‹è´¦å·â€œæ‰åæœ‰é™é’å¹´â€ä¸€ç¯‡è‡ªç§°â€œéè™šæ„â€œçš„æ–‡ç« ï¼Œå’ªè’™åˆè¢«æ¨ä¸Šé£å£æµªå°–ã€‚  </p><a id="more"></a><p>å°±äº‹è®ºäº‹çš„è¯´ï¼Œæ‰åæœ‰é™é’å¹´å…¶å®å’Œå’ªè’™å…³ç³»ä¸å¤§ï¼Œé‚£ç¡®å®æ˜¯ä¸ªç›¸å¯¹ç‹¬ç«‹çš„å›¢é˜Ÿï¼Œæˆ‘ä¹Ÿè¯»è¿‡ä»–ä»¬ä»¥å‰å¾ˆå¤šæ–‡ç« ï¼Œå¾ˆå¤šéƒ½æŒºå¥½çœ‹ï¼Œè¦è¯´æœ‰ä»€ä¹ˆé”™ï¼Œæœ€å¤šæ˜¯æœ‰ç‚¹ç…½åŠ¨æƒ…ç»ªã€‚  </p><p>ä½†æ˜¯åšåª’ä½“å˜›ï¼Œåˆæœ‰å‡ ä¸ªä¸ç…½åŠ¨æƒ…ç»ªå‘¢ï¼Œåªè¦ä¸é€ è°£ï¼Œä¸å¼•å¯¼é‚ªæ¶çš„ä»·å€¼è§‚ï¼Œå°±æ²¡å•¥é—®é¢˜ã€‚  </p><p>æ‰€ä»¥æˆ‘è§‰å¾—ä¸€ä¸ªå¥½çš„æ–¹å¼æ˜¯ï¼Œä½ ä¸åŒæ„å¥¹çš„ä¸€ç¯‡æ–‡ç« ï¼Œå°±è¯´è¿™ç¯‡æ–‡ç« å†™å¾—ä¸å¥½å†™å¾—ä¸å¯¹ï¼Œç”šè‡³å¯ä»¥è¯´è¿™ç¯‡æ–‡ç« å†™å¾—ç”¨å¿ƒé™©æ¶ã€‚  </p><p>ä½†ä½ å»æŒ–å¥¹çš„å‡ºèº«ï¼Œè¯´å¥¹ä»¥å‰æ˜¯å’ªè’™çš„å®ä¹ ç”Ÿï¼Œæ‰€ä»¥ä¸€å®šä¸æ˜¯ä»€ä¹ˆå¥½äººã€‚  </p><p>å°±æœ‰ç‚¹æ¶æ¯’äº†ã€‚  </p><p>æ¯”å¦‚æœ‰ä¸€ä½æˆ‘æŒºå–œæ¬¢çš„åª’ä½“äººï¼Œè¿™æ ·å†™ï¼Œæˆ‘å°±è§‰å¾—æ¶æ¯’äº†  </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/4-1548951367.png" alt="æ¯”å’ªè’™æ›´å¯æ€•çš„ï¼Œæ˜¯æŒ–ç¥–åŸå¼ä¸¾æŠ¥æ¸…ç®—"></p><p>ï¼ˆè€Œä¸”å¦‚æœçœŸçš„ç¿»äº†ç…§ç‰‡çš„è¯ï¼Œè¾ƒçœŸçš„è¯´è¿™å¥è¯æ˜¯é€ è°£ï¼‰  </p><p>è¿˜æœ‰æ˜¨å¤©æ•´ä¸ªæœ‹å‹åœˆè½°è½°çƒˆçƒˆçš„â€å«å’ªé‡â€œæµ‹è¯•ï¼Œå¾ˆå¤šäººå·ç§°æœ‹å‹åœˆåªè¦æœ‰äººå…³æ³¨å’ªè’™äº†ï¼Œå°±è¦å’ŒTAäº’åˆ ã€‚  </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/1-1548951367.jpeg" alt="æ¯”å’ªè’™æ›´å¯æ€•çš„ï¼Œæ˜¯æŒ–ç¥–åŸå¼ä¸¾æŠ¥æ¸…ç®—"></p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/9-1548951368.jpeg" alt="æ¯”å’ªè’™æ›´å¯æ€•çš„ï¼Œæ˜¯æŒ–ç¥–åŸå¼ä¸¾æŠ¥æ¸…ç®—"><br>è¿™æˆ‘ä¹Ÿè§‰å¾—å¤ªè¿‡ã€‚<br>æŒ‰ç…§ä»–ä»¬çš„æ„æ€ï¼Œä¹Ÿåˆ«ç®¡è¿™äººæ˜¯è°ï¼Œå’Œä»–ä»¬æ˜¯ä»€ä¹ˆå…³ç³»ï¼Œæ˜¯ä¸æ˜¯å¥½æœ‹å‹æˆ–è€…äº²æˆšï¼Œä¹Ÿä¸ç®¡è¿™ä¸ªäººå…³æ³¨å’ªè’™ç©¶ç«Ÿæ˜¯è®¤åŒå’ªè’™çš„ä»·å€¼è§‚è¿˜æ˜¯å°±æƒ³å›´è§‚ä¸€ä¸‹æˆ–è€…å­¦ä¹ æ’ç‰ˆï¼Œåªè¦å…³æ³¨å’ªè’™ï¼Œå°±è¦äº’åˆ ã€‚<br>è¿™æ”¾åœ¨å‡ åå¹´å‰ï¼Œæˆ‘ä»¬å«åšâ€åˆ’æ¸…ç•Œé™â€œï¼Œæµè¡Œè¿™ç§è¿åŠ¨çš„åå¹´ï¼Œæ˜¯æ–°ä¸­å›½æœ€æ··ä¹±çš„åå¹´ã€‚<br>å½“ç„¶æˆ‘è§‰å¾—æ›´è¿‡çš„ï¼Œè¿˜æ˜¯ä¸‹é¢è¿™å¼ æˆªå›¾ã€‚  </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/1-1548951370.jpeg" alt="æ¯”å’ªè’™æ›´å¯æ€•çš„ï¼Œæ˜¯æŒ–ç¥–åŸå¼ä¸¾æŠ¥æ¸…ç®—"></p><p>å’ªè’™ä¸€è¾¹è¯´è¿™è¯ï¼Œä¸€è¾¹â€æ°¸è¿œçˆ±å›½ï¼Œæ°¸è¿œçƒ­æ³ªç›ˆçœ¶â€œæ¶ä¸æ¶å¿ƒï¼Ÿ<br>æ¶å¿ƒã€‚  </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/1-1548951372.jpeg" alt="æ¯”å’ªè’™æ›´å¯æ€•çš„ï¼Œæ˜¯æŒ–ç¥–åŸå¼ä¸¾æŠ¥æ¸…ç®—"><br>å’ªè’™å¼æ¯’é¸¡æ±¤è®¨ä¸è®¨åŒï¼Ÿ  </p><p>æˆ‘ä¹Ÿè®¨åŒã€‚<br>ä½†è¿™æ ·æŒ–ç¥–åŸå¼æ¸…ç®—ä¸¾æŠ¥ï¼Œå°¤å…¶æ˜¯ä¸€ç›´ç¿»åˆ°2013å¹´çš„å¾®åšï¼Œç„¶åæŠŠç›¸å…³æœºæ„å…¨éƒ½@ä¸€éçš„è¡Œä¸ºï¼Œè®©æˆ‘æ„Ÿåˆ°å¾ˆä¸èˆ’æœã€‚<br>è¿™ç§ä¸èˆ’æœä¸æ˜¯åæ„Ÿï¼Œè€Œæ˜¯æ„Ÿåˆ°ææ€–ã€‚<br>è€Œä¸”è¿™æ ·çš„äº‹æƒ…ï¼Œè¿™äº›å¹´è¶Šæ¥è¶Šå¤šäº†ã€‚<br>è¿™æ ·çš„å¾…é‡ï¼Œé™ˆä¸€å‘é­é‡è¿‡ï¼š  </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/9-1548951373.jpeg" alt="æ¯”å’ªè’™æ›´å¯æ€•çš„ï¼Œæ˜¯æŒ–ç¥–åŸå¼ä¸¾æŠ¥æ¸…ç®—"></p><p>ç½—æ°¸æµ©é­é‡è¿‡ï¼š  </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/0-1548951373.jpeg" alt="æ¯”å’ªè’™æ›´å¯æ€•çš„ï¼Œæ˜¯æŒ–ç¥–åŸå¼ä¸¾æŠ¥æ¸…ç®—"></p><p>æ¯•ç¦å‰‘ä¹Ÿé­é‡è¿‡ï¼š  </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/4-1548951374.png" alt="æ¯”å’ªè’™æ›´å¯æ€•çš„ï¼Œæ˜¯æŒ–ç¥–åŸå¼ä¸¾æŠ¥æ¸…ç®—"></p><p>æ™®é€šç½‘å‹å½“ç„¶ä¹Ÿé­é‡è¿‡ï¼š  </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/8-1548951375.jpeg" alt="æ¯”å’ªè’™æ›´å¯æ€•çš„ï¼Œæ˜¯æŒ–ç¥–åŸå¼ä¸¾æŠ¥æ¸…ç®—"></p><p>åŠ¨ä¸åŠ¨å°±å‘¼åå°æ€ï¼Œè™æ‰‘å’Œå´äº¦å‡¡ç²‰ä¸æˆ˜æ–—æ—¶ï¼ŒåŒæ–¹éƒ½é­é‡è¿‡ã€‚</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/3-1548951377.jpeg" alt="æ¯”å’ªè’™æ›´å¯æ€•çš„ï¼Œæ˜¯æŒ–ç¥–åŸå¼ä¸¾æŠ¥æ¸…ç®—"></p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/4-1548951379.jpeg" alt="æ¯”å’ªè’™æ›´å¯æ€•çš„ï¼Œæ˜¯æŒ–ç¥–åŸå¼ä¸¾æŠ¥æ¸…ç®—"></p><p>æ¸¸æˆã€Šé˜´é˜³å¸ˆã€‹é­é‡è¿‡ï¼š</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/8-1548951380.jpg" alt="æ¯”å’ªè’™æ›´å¯æ€•çš„ï¼Œæ˜¯æŒ–ç¥–åŸå¼ä¸¾æŠ¥æ¸…ç®—"></p><p>æ˜æ˜Ÿéª‚æˆ˜çš„æ—¶å€™ä½¿ç”¨è¿‡è¿™ç§æ­¦å™¨ã€‚  </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/10-1548951381.jpeg" alt="æ¯”å’ªè’™æ›´å¯æ€•çš„ï¼Œæ˜¯æŒ–ç¥–åŸå¼ä¸¾æŠ¥æ¸…ç®—"></p><p>ç¤¾ä¼šçƒ­ç‚¹äº‹ä»¶å°±ä¸è¯´äº†ï¼Œæ€»æ˜¯æœ‰æˆåƒä¸Šä¸‡äººå‘å›¢å›¢ä¸¾æŠ¥ã€‚  </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/1-1548951383.jpg" alt="æ¯”å’ªè’™æ›´å¯æ€•çš„ï¼Œæ˜¯æŒ–ç¥–åŸå¼ä¸¾æŠ¥æ¸…ç®—"></p><p>ç°åœ¨ç”šè‡³ç‹è€…è£è€€ç©å¾—ä¸çˆ½äº†ï¼Œä¹Ÿè¦ä¸¾æŠ¥ã€‚  </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/3-1548951383.jpg" alt="æ¯”å’ªè’™æ›´å¯æ€•çš„ï¼Œæ˜¯æŒ–ç¥–åŸå¼ä¸¾æŠ¥æ¸…ç®—"></p><p>åœ¨è¿™äº›ä¸¾æŠ¥é‡Œï¼Œç½‘å‹ä»¬ç”¨ä¸çŸ¥é“ä»å“ªé‡Œå­¦åˆ°çš„è¯æ±‡ï¼Œç»™è‡ªå·±çœ‹ç€ä¸çˆ½çš„äººæ‰£ä¸Šä¸€ä¸ªåˆä¸€ä¸ªå¤§å¸½å­ï¼Œå¥—ä¸Šä¸€ä¸ªåˆä¸€ä¸ªç½ªåï¼Œå…¶æ‰‹æ³•ä¹‹çº¯ç†Ÿï¼Œè®©æˆ‘ä¸€åº¦ä»¥ä¸ºç”Ÿæ´»åœ¨å†¯éª¥æ‰çš„ã€Šä¸€ç™¾ä¸ªäººçš„åå¹´ã€‹é‡Œã€‚</p><p>å¯æƒœæ‹¿èµ·æ‰‹æœºç§ä¸€ç§ï¼Œå‘ç°å·²ç»æ˜¯2019å¹´äº†ã€‚</p><p>åœ¨æˆ‘çœ‹æ¥è¿™ç§è¡Œä¸ºå’Œçœ‹åˆ°è®©è‡ªå·±ä¸çˆ½çš„ç»¼è‰ºï¼Œæ­Œæ›²ï¼Œç”µå½±å°±å‘¼åå°æ€æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯åˆ†ä¸æ¸…å„ç§æƒåˆ©ç•Œé™çš„è¡¨ç°ã€‚å°±åƒå‡ ç™¾å¹´å‰ï¼Œè¢«äººæ¬ºè´Ÿäº†ï¼Œå°±å»è¡™é—¨ä¸€è·ªï¼Œé«˜å–Šâ€œå¤§äººï¼Œæˆ‘å†¤å•Šï¼â€ï¼Œç„¶åæœŸå¾…é’å¤©å¤§è€çˆ·ç»™è‡ªå·±åšä¸»çš„å¤ä»£ä¸­å›½äººä¸€æ ·ï¼Œå§‹ç»ˆæ²¡æœ‰é•¿å¤§ã€‚</p><p>ä»–ä»¬è‡ªå·±æ˜¯å·¨å©´ï¼Œå´ä»¥ä¸ºæˆ‘å›½å±…æ°‘å…¨éƒ½æ˜¯é•¿ä¸å¤§çš„å·¨å©´ï¼Œéœ€è¦å¦ˆå¦ˆæ— å¾®ä¸è‡³åœ°ç…§é¡¾æˆ‘ä»¬ï¼Œå¸®æˆ‘ä»¬æŒ‘å¥½å“ªäº›æ˜¯æˆ‘ä»¬è¯¥çœ‹çš„ï¼Œå“ªäº›æ˜¯æˆ‘ä»¬ä¸è¯¥çœ‹çš„ï¼Œç„¶ååªè¦ä»–ä»¬çœ‹åˆ°è‡ªå·±ä¸çˆ½çš„ï¼Œå°±ä¼šåƒå­©å­ä¸€æ ·å“­å–Šç€å«å¦ˆå¦ˆæ¥ï¼Œå¸Œæœ›å¦ˆå¦ˆæŠŠâ€œåä¸œè¥¿â€éƒ½æ‰“é£ï¼Œç„¶åæ‰ä¼šé‡æ–°å–œç¬‘é¢œå¼€ã€‚</p><p>å¯æƒœç°ä»£æ³•åˆ¶ç¤¾ä¼šæ²¡æœ‰ï¼Œä¹Ÿä¸åº”è¯¥æœ‰é’å¤©å¤§è€çˆ·â€”â€”å†å²æ—©å·²ç»è¯æ˜äº†ï¼Œé’å¤©å¤§è€çˆ·å¼çš„äººæ²»ï¼Œè¿œä¸å¦‚æ³•æ²»æ¥å¾—å…¬å¹³é«˜æ•ˆï¼Œé’å¤©å¤§è€çˆ·åå¹´ä¸€é‡ï¼Œä½†æ‰‹æ¡æƒåŠ›ï¼Œè‚†æ„æ»¥ç”¨çš„æ˜å®˜å´éåœ°éƒ½æ˜¯ã€‚  </p><p>è¿™å·²ç»å¾ˆé­”å¹»äº†ã€‚</p><p>ä½†æ›´é­”å¹»çš„æ˜¯ï¼Œè¿™äº›è¯‰æ±‚ï¼Œæœ‰æ—¶å€™è¿˜çœŸçš„ä¼šå¾—åˆ°å›åº”ã€‚</p><p>ä»¥å‰æˆ‘è§‰å¾—å­©å­é•¿ä¸å¤§ï¼Œç«™ä¸èµ·æ¥ï¼Œæ˜¯å› ä¸ºå­©å­è‡ªå·±ç¬¨ï¼Œä¸æƒ³é•¿å¤§ï¼Œåæ¥æ‰æ˜ç™½ï¼Œå­©å­é•¿ä¸å¤§ï¼Œå¤šåŠæ˜¯æœ‰ä¸€ä¸ªä»€ä¹ˆéƒ½æ›¿å­©å­åšä¸»ï¼Œä»€ä¹ˆéƒ½æ›¿å­©å­å†³å®šçš„å¦ˆâ€”â€”åœ¨è¿™äº›æŒ–åŸä¸¾æŠ¥çœŸçš„ä¼šå¾—åˆ°å›åº”çš„æƒ…å†µä¸‹ï¼Œè¿™æ ·çš„è¡Œä¸ºæ°¸è¿œä¸ä¼šåœæ­¢ï¼Œåªä¼šå˜æœ¬åŠ å‰ã€‚</p><p>å³ä½¿å¦‚æ­¤ï¼Œæˆ‘è¿˜æ˜¯å¸Œæœ›ä½ ä»¬èƒ½å°‘æŒ–åŸï¼Œå°‘å‘¼åå°æ€ã€‚</p><p>å› ä¸ºâ€œå°æ€â€è¿™ä¸ªè¯ä»£è¡¨çš„é‚£ä¸ªè¡Œä¸ºï¼Œæœ¬æ¥å°±ä¸åº”è¯¥å­˜åœ¨äºè¿™ä¸ªä¸–ç•Œä¸Šï¼Œå¹¶ä¸”å½“ä½ ä¹ æƒ¯â€å°æ€â€œä¹‹åï¼Œè¿Ÿæ—©æœ‰ä¸€å¤©ï¼Œä¼šé™ä¸´åˆ°ä½ å–œæ¬¢çš„é‚£ä¸ªè´¦å·ï¼Œé‚£ä¸ªä¸»æ’­æˆ–è€…é‚£ä¸ªæ˜æ˜Ÿèº«ä¸Šã€‚</p><p>è¿˜è®°å¾—ä¹‹å‰æ•´æ²»å…«å¦çš„æ—¶å€™å—ï¼Ÿ  </p><p>ä¸€å¼€å§‹å°çš„å¾ˆå¤šè´¦å·ï¼Œå¤§å®¶éƒ½è®¨åŒï¼Œæ‰€ä»¥ä¸€ç‰‡å«å¥½å£°ã€‚ç»“æœä¹‹åå‘å±•åˆ°åªè¦è´¦å·ä¸­å¸¦â€å…«å¦â€œä¸¤ä¸ªå­—çš„ï¼Œéƒ½è¢«å°å·äº†ï¼ŒåŒ…æ‹¬å¤§å®¶çˆ±çœ‹çš„â€æ¯’èˆŒç”µå½±â€œï¼Œâ€ä¸¥è‚ƒå…«å¦â€œï¼Œâ€é‡‘èå…«å¦å¥³â€œä¹Ÿå…¨éƒ¨éƒ½å‡‰äº†ã€‚</p><p>æœ€æç¬‘çš„æ˜¯ï¼Œæˆ‘æœ‰ä¸ªæœ‹å‹ï¼Œåšäº†ä¸ªè´¦å·å«â€è´¢ç»å…«å¦é˜µâ€œï¼Œé‚£æ®µæ—¶é—´åªèƒ½æ”¹æˆâ€è´¢ç»ä¹å¦é˜µâ€œï¼Œç»ˆäºèº²è¿‡ä¸€åŠ«ã€‚</p><p>è¿˜è®°å¾—ä¹‹å‰è®¨åŒPGONEçš„äººæ‹¼å‘½ä¸¾æŠ¥PGONEï¼Œ@äº†ä¸€å¤§å †å®˜æ–¹è´¦å·ï¼Œè¦æ±‚å¯¹PGONEè¿›è¡Œå°æ€å—ï¼Ÿ</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/4-1548951384.png" alt="æ¯”å’ªè’™æ›´å¯æ€•çš„ï¼Œæ˜¯æŒ–ç¥–åŸå¼ä¸¾æŠ¥æ¸…ç®—"></p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/3-1548951385.png" alt="æ¯”å’ªè’™æ›´å¯æ€•çš„ï¼Œæ˜¯æŒ–ç¥–åŸå¼ä¸¾æŠ¥æ¸…ç®—"></p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/0-1548951385.png" alt="æ¯”å’ªè’™æ›´å¯æ€•çš„ï¼Œæ˜¯æŒ–ç¥–åŸå¼ä¸¾æŠ¥æ¸…ç®—"></p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/1-1548951386.png" alt="æ¯”å’ªè’™æ›´å¯æ€•çš„ï¼Œæ˜¯æŒ–ç¥–åŸå¼ä¸¾æŠ¥æ¸…ç®—"></p><p>é‚£ä¼šå„¿æ°å¥½GAIæ±‚å©šæˆåŠŸï¼Œæ‰€ä»¥å½“æ—¶è¿™äº›äººä¸­ï¼Œæœ‰ä¸å°‘éƒ½äººæ˜¯é€šè¿‡æ§GAIæ¥è¸©PGONEçš„ã€‚</p><p>æˆ‘è‡ªå·±ä¹Ÿæ˜¯GAIçš„ç²‰ä¸ï¼Œåœ¨ä¸€ä¸ªGAIçš„ç²‰ä¸ç¾¤é‡Œï¼Œæœ‰å‡ ä¸ªå§ä»¬è¡¨ç¤ºå¤ªå¥½äº†ï¼Œè§£æ°”ã€‚ä½†éšå³æ›´å¤šäººè¡¨ç¤ºè¿™ä¸æ˜¯å¥½äº‹ï¼Œå› ä¸ºGAIä¹Ÿæœ‰é»‘å†å²ã€‚</p><p>æœç„¶è¿‡äº†æ²¡å¤šä¹…ï¼ŒGAIè¢«è¿«ä»ã€Šæ­Œæ‰‹ã€‹ä¸­é€€èµ›ï¼Œè‡³ä»Šä¹Ÿæ²¡åœ¨ç”µè§†ä¸Šå†çœ‹è¿‡ä»–ã€‚</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/0-1548951386.jpeg" alt="æ¯”å’ªè’™æ›´å¯æ€•çš„ï¼Œæ˜¯æŒ–ç¥–åŸå¼ä¸¾æŠ¥æ¸…ç®—"></p><p>åœ¨è¿™æ ·è½°è½°çƒˆçƒˆçš„æŒ–åŸå¼ä¸¾æŠ¥è¿åŠ¨ä¸­ï¼Œæš´èµ°æ¼«ç”»å‡‰äº†ï¼Œé™ˆä¸€å‘å‡‰äº†ï¼Œå¢æœ¬ä¼Ÿå‡‰äº†ï¼Œæ¯•ç¦å‰‘å‡‰äº†ï¼Œå¾ˆå¤šæ­Œæ‰‹æ˜æ˜Ÿéƒ½å‡‰äº†ã€‚</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/0-1548951387.jpg" alt="æ¯”å’ªè’™æ›´å¯æ€•çš„ï¼Œæ˜¯æŒ–ç¥–åŸå¼ä¸¾æŠ¥æ¸…ç®—"></p><p><strong>PGONEè¢«å°æ€ä½ ä»¬å«å¥½ï¼ŒGAIè¢«å°æ€ä½ ä»¬å–Šå†¤ï¼Œæ¯•ç¦å‰‘ä»å¤®è§†æ¶ˆå¤±ä½ ä»¬æƒ³å¿µä»–ã€‚ä½ ä»¬ä»¥ä¸ºè¿™å‡ ä»¶äº‹ä¸ä¸€æ ·åº”è¯¥åˆ†å¼€ï¼Œä½†ç»å†è¿‡è¿™ä¹ˆå¤šäº‹æƒ…ï¼Œä½ ä»¬åº”è¯¥æ˜ç™½ï¼Œè¿™ä¸¤ä»¶äº‹å…¶å®æ ¹æœ¬å°±æ˜¯ä¸€ä»¶äº‹ã€‚</strong>  </p><p>å°æ€çš„äººä¸ä¼šç®¡å“ªä¸ªå˜»å“ˆæ­Œæ‰‹æ˜¯æ­£èƒ½é‡çš„ï¼Œå“ªä¸ªæ˜¯å±¡æ•™ä¸æ”¹çš„â€”â€”æ—¢ç„¶å˜»å“ˆæœ‰é—®é¢˜ï¼Œé‚£å°±æœ‰é—®é¢˜çš„ä¸€èµ·ä¸‹ã€‚</p><p>å°±åƒç°åœ¨è¿™äº›ä¸ºå’ªè’™çš„å€’å°æ‹æ‰‹å«å¥½çš„è‡ªåª’ä½“äººï¼Œä½ åˆçŸ¥é“å°æ€çš„äººåˆ†å¾—æ¸…ä½ å’Œå’ªè’™çš„åŒºåˆ«å’¯ï¼Ÿ</p><p>å†µä¸”åœ¨æˆ‘çœ‹æ¥ï¼Œå¾ˆå¤šè´¦å·æ ¹æœ¬å°±å’Œå’ªè’™æ²¡åŒºåˆ«ã€‚</p><p>æ¯”å¦‚æŸä¸ªè‡ªåª’ä½“ï¼Œæ´‹æ´‹æ´’æ´’å†™äº†å‡ åƒå­—ï¼Œç»†æ•°å’ªè’™çš„â€ä¸ƒå®—ç½ªâ€œã€‚</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/8-1548951388.jpeg" alt="æ¯”å’ªè’™æ›´å¯æ€•çš„ï¼Œæ˜¯æŒ–ç¥–åŸå¼ä¸¾æŠ¥æ¸…ç®—"></p><p>æœ€åå¾—å‡ºçš„ç»“è®ºæ˜¯ï¼Œå’ªè’™æœ€å¤§çš„ç½ªå°±æ˜¯å¥¹åœ¨è¿åˆè¯»è€…ï¼Œå¹¶ä¸”æ ‡é¢˜ä½ä¿—ï¼Œå±å®³æå¤§ã€‚ä»–æŠŠæ–‡ç« å‘åˆ°500äººçš„æ–°åª’ä½“ç¾¤é‡Œï¼Œå¸Œæœ›å¤§å®¶ä¸ºä»–é¼“æŒå«å¥½ã€‚</p><p>ç»“æœç¿»å¼€ä»–è‡ªå·±çš„å…¬ä¼—å·ï¼Œæ ‡é¢˜å´æ˜¯è¿™ä¸ªç”»é£çš„ã€‚</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/1-1548951390.jpeg" alt="æ¯”å’ªè’™æ›´å¯æ€•çš„ï¼Œæ˜¯æŒ–ç¥–åŸå¼ä¸¾æŠ¥æ¸…ç®—"></p><p>å½“æœ‰äººåœ¨ç¾¤é‡Œè´¨é—®ä»–ï¼Œè¿™æ˜¯ä¸æ˜¯åœ¨è¿åˆè¯»è€…ï¼Œæ ‡é¢˜ä½ä¿—ï¼Œå±å®³æå¤§çš„æ—¶å€™ï¼Œä»–å¾ˆå¦è¯šçš„æ‰¿è®¤â€å¯æˆ‘çš„æ²¡äººçœ‹å•Šã€‚â€œ</p><p>è®©äººå¿ƒæ…Œã€‚</p><p>ä¸€ä¸ªäº‹å®æ˜¯ï¼Œæˆ‘ä»¬è¯´çš„æ³•åˆ¶è¯´çš„æ­£ä¹‰ï¼Œä»æ¥ä¸æ˜¯ç»™æˆ‘ä»¬å–œæ¬¢çš„ä¸œè¥¿å‡†å¤‡çš„ï¼Œæˆ‘ä»¬å–œæ¬¢çš„ä¸œè¥¿ï¼Œæ ¹æœ¬ä¸éœ€è¦å¿ƒä¸­çš„é‚£æ†ç§°æ¥ä¿æŠ¤ã€‚  </p><p>æˆ‘ä»¬è¯´çš„æ­£ä¹‰å’Œæ³•åˆ¶ï¼Œæ˜¯ä½ ä»¬è®¨åŒçš„äººï¼Œä¹Ÿæœ‰è¯´è¯çš„æƒåˆ©ï¼Œå¦‚æœä»–ä»¬æ²¡æœ‰è¿æ³•ï¼Œå°±ä¸åº”è¯¥ä¸è®©ä»–ä»¬è¯´è¯ã€‚</p><p>è¿˜æœ‰ä¸€ä¸ªäº‹å®æ˜¯ï¼Œå’ªè’™çš„ä»·å€¼è§‚ç¡®å®æœ‰é—®é¢˜ï¼Œä¹Ÿè®¸èƒ½ç…½åŠ¨å‡ åä¸‡äººçš„æƒ…ç»ªï¼Œæ˜¯ä¼šè®©äººç„¦è™‘ï¼Œä½†çœŸè¦è¯´å¥¹æ”¹å˜äº†å¤šå°‘äººä¸‰è§‚ï¼Œæˆ‘è§‰å¾—å„ä½æ˜¯é«˜çœ‹æ–‡å­—çš„åŠ›é‡äº†ã€‚</p><p>ä¸€æ–¹é¢å’ªè’™å¹¶ä¸äº§ç”Ÿä¸‰è§‚ï¼Œå¥¹ä¸€èˆ¬åªè¿åˆå¤§ä¼—æƒ…ç»ªï¼Œå¦ä¸€æ–¹é¢ä¸‰è§‚è¿™ä¸œè¥¿æ˜¯æ²¡é‚£ä¹ˆå®¹æ˜“æ”¹å˜çš„ï¼Œ2019å¹´äº†ï¼Œæ–‡å­—æ—©å°±æ²¡é‚£ä¹ˆå¤§åŠ›é‡äº†ï¼Œç°åœ¨å¦‚æœè¯´è°å› ä¸ºä¸€ç¯‡æ–‡ç« ä¸‰è§‚å°±å˜äº†ï¼Œé‚£è¯´æ˜TAæœ¬æ¥å°±æœ‰è¿™æ ·çš„æƒ³æ³•ï¼Œåªæ˜¯è¿™ç¯‡æ–‡ç« æ­£å¥½æ”¯æŒäº†TAè€Œå·²ã€‚</p><p>æ¯”èµ·å’ªè’™ï¼Œæˆ‘æ›´å®³æ€•é‚£æ ·å› ä¸ºè®¨åŒä¸€ä¸ªäººï¼Œå°±è‚†æ— å¿Œæƒ®åœ°çˆ†ç²—å£ï¼Œå°±æƒ³ç€è¦å¼„æ­»å¯¹æ–¹ï¼Œæ›´å®³æ€•é‚£æ ·æŒ–ç¥–åŸå¼çš„ä¸¾æŠ¥ã€‚</p><p>å› ä¸ºè¿™è®©æˆ‘è§‰å¾—è‡ªå·±æ¯æ—¶æ¯åˆ»éƒ½æ´»åœ¨ç›‘è§†ä¸­ï¼Œç»ˆæ—¥ä¸å¾—å®‰å®ã€‚</p><p>ç°åœ¨ä½ ä»¬è§‰å¾—åº”è¯¥è¿™æ ·å¯¹ä»˜å’ªè’™ï¼Œè°çŸ¥é“å“ªå¤©æˆ‘ä¼šä¸ä¼šå—åˆ°è¿™æ ·çš„å¾…é‡ã€‚</p><p>è€Œä¸”è¯´ä¸€åƒé“ä¸€ä¸‡ï¼Œå½“å¹´å’ªè’™å†™é‚£å‡ ç¯‡æ–‡ç« ï¼Œç–¯ç‹‚åœ¨æœ‹å‹åœˆè½¬å‘åˆ·å±ï¼ŒæŠŠå’ªè’™ä¸€åº¦æ§æˆå¾®ä¿¡ç¬¬ä¸€å¤§å·çš„ï¼Œè¿˜ä¸æ˜¯ç½‘å‹å—ï¼Ÿ</p><p>çœ‹åˆ°æŸä¸ªå»å¹´è¿˜æŠŠå’ªè’™è¯·ä¸ºåº§ä¸Šå®¾ï¼Œä¸€å£ä¸€ä¸ªå’ªè’™è€å¸ˆåšåˆ†äº«çš„æœºæ„ï¼Œæ˜¨å¤©ä»–ä»¬ä¸»ç¼–ä¹Ÿå¼€å§‹æµ‹å«å’ªç‡äº†ï¼Œå¯èƒ½ä¸‹ä¸€æ­¥å°±è¦è¡¨æ€â€äº’åˆ â€œäº†ã€‚</p><p>çœ‹åˆ°ä¹‹å‰åˆ†äº«è¿‡è‡´è´±äººå‡ ç¯‡çš„äººï¼Œå¼€å§‹åœ¨æœ‹å‹åœˆè¯´â€æƒ³ä¸é€šä¸ºä»€ä¹ˆè¿™ä¹ˆå¤šäººä¼šå…³æ³¨å’ªè’™â€œäº†ã€‚</p><p>æœ‰æ—¶å€™è§å¤šäº†è¿™ç§æ˜¨å¤©è¿˜ä¸‡äººè¿½æ§ï¼Œä»Šå¤©å°±è¿‡è¡—è€é¼ çš„æˆç ã€‚çœŸæ˜¯è®©äººå¯¹è¿™ä¸ªå¤æ‚ç¹å¤çš„ä¸–ç•Œï¼Œåˆå®³æ€•äº†å‡ åˆ†å‘¢ã€‚</p><p>-END-</p>]]></content>
      
      
      <categories>
          
          <category> Life </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>äº²æµ‹çœŸæ­£å¥½ç”¨çš„WordPressåª’ä½“åº“å›¾ç‰‡åˆ†ç±»æ’ä»¶</title>
      <link href="/2019-01-31-wp-real-media-library/"/>
      <url>/2019-01-31-wp-real-media-library/</url>
      
        <content type="html"><![CDATA[<p>WordPressæœ‰ä¸ªå¾ˆå¤§çš„é—®é¢˜å°±æ˜¯ç®¡ç†ä¸Šä¼ å›¾ç‰‡çš„åª’ä½“åº“å¾ˆèœï¼Œè¿æœ€åŸºæœ¬çš„æ–‡ä»¶å¤¹åˆ†ç±»åŠŸèƒ½éƒ½æ²¡æœ‰ã€‚ ç½‘ä¸Šæ‰¾äº†å¥½ä¸€ä¼šå„¿ï¼Œæœ€å¼€å§‹æ‰¾åˆ°ä¸€ä¸ª Attachment Taxonomies çœ‹ä»‹ç»å¥½åƒè¿˜å¯ä»¥</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/Screenshot-2019-01-31-18.12.21.png" alt></p><a id="more"></a><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/Screenshot-2019-01-31-18.12.51.png" alt></p><p>ç„¶è€Œå®é™…ä½¿ç”¨èµ·æ¥æä¸æ–¹ä¾¿ï¼Œä¸Šä¼ å›¾ç‰‡æ—¶ä¸èƒ½é€‰æ‹©ä¸Šä¼ åˆ°å“ªä¸ªåˆ†ç±»ï¼Œç°æœ‰çš„å›¾ç‰‡ä¹Ÿä¸èƒ½å¤šé€‰è®¾ç½®åˆ†ç±»ï¼Œéœ€è¦ç‚¹å¼€æ¯ä¸€å¼ å›¾ç‰‡å†å‹¾é€‰åˆ†ç±»ã€‚ ç„¶åæ‰¾åˆ°ä¸€ä¸ª WP Real Media Library åº¦å¨˜ç›˜æ‰¾åˆ°äº†èµ„æºï¼Œä¸‹è½½ååœ¨WordPressæ’ä»¶ç•Œé¢ä¸Šä¼ ä½¿ç”¨ã€‚ </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/Screenshot-2019-01-31-18.01.56.png" alt></p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/Screenshot-2019-01-31-18.13.26.png" alt></p><p>ä½¿ç”¨èµ·æ¥éå¸¸é¡ºæ‰‹ã€‚</p><h3 id="ä¸‹è½½é“¾æ¥"><a href="#ä¸‹è½½é“¾æ¥" class="headerlink" title="ä¸‹è½½é“¾æ¥"></a><a href="http://www.4mudi.com/themes/wp-real-media-library/#toggle-id-2" title="ä¸‹è½½é“¾æ¥" target="_blank" rel="noopener">ä¸‹è½½é“¾æ¥</a></h3><h3 id="V4-0-10-åº¦ç›˜é“¾æ¥"><a href="#V4-0-10-åº¦ç›˜é“¾æ¥" class="headerlink" title="V4.0.10 åº¦ç›˜é“¾æ¥"></a><a href="https://pan.baidu.com/s/1W5AYA0jVPFWZwZMmHMYd4w" title="V4.0.10 åº¦ç›˜é“¾æ¥" target="_blank" rel="noopener">V4.0.10 åº¦ç›˜é“¾æ¥</a></h3>]]></content>
      
      
      <categories>
          
          <category> Tech </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WordPress </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>äº‘æœåŠ¡å™¨ä½¿ç”¨WordPressæ­å»ºä¸ªäººåšå®¢å¹¶ç»‘å®šåŸŸåå…¨è®°å½•</title>
      <link href="/2019-01-29-build-wordpress-blog/"/>
      <url>/2019-01-29-build-wordpress-blog/</url>
      
        <content type="html"><![CDATA[<p>ä¸€ç›´åœ¨ç»­è´¹äº‘æœåŠ¡å™¨ï¼Œç´¢æ€§å……åˆ†åˆ©ç”¨èµ„æºï¼Œå¤å¤ä¸€ä¸‹ï¼Œé¼“æ£ä¸ªå°åšå®¢è®°å½•äº›ä¸œè¥¿ã€‚ ç°åœ¨å¤§è‡´å·²ç»æ­å¥½åšå®¢äº†ï¼Œé‚£å°±å…ˆæŠŠè¿™æŠ˜è…¾äº†ä¸€æ•´å¤©çš„å»ºç«™è¿‡ç¨‹ç»™è®°å½•ä¸‹ã€‚</p><h3 id="å…³äºæœåŠ¡å™¨"><a href="#å…³äºæœåŠ¡å™¨" class="headerlink" title="å…³äºæœåŠ¡å™¨"></a><strong>å…³äºæœåŠ¡å™¨</strong></h3><p>å‰å‡ å¹´è´­å…¥çš„Vultrçš„ECSï¼Œä¸œäº¬çš„ç›¸å¯¹æ€§ä»·æ¯”é«˜ä¸€äº›ï¼Œå»¶è¿Ÿå’Œç½‘é€Ÿéƒ½å¾ˆç¨³ï¼Œç°åœ¨ï¼ˆ2019.1ï¼‰è¿˜æœ‰3.5åˆ€ä¸€ä¸ªæœˆçš„ï¼Œéå¸¸å®æƒ ã€‚</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/Screenshot-2019-01-29-18.26.19.png" alt> </p><a id="more"></a><h4 id="å®‰è£…-Apache2ã€MySQLã€PHP"><a href="#å®‰è£…-Apache2ã€MySQLã€PHP" class="headerlink" title="å®‰è£… Apache2ã€MySQLã€PHP"></a><strong>å®‰è£… Apache2ã€MySQLã€PHP</strong></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install apache2</span><br><span class="line">sudo apt-get install mysql-server mysql-client</span><br></pre></td></tr></table></figure><p>æµ‹è¯•ä¸€ä¸‹Apache2æ˜¯å¦æˆåŠŸå®‰è£…ï¼šæµè§ˆå™¨è®¿é—®äº‘æœåŠ¡å™¨çš„IPï¼Œå®‰è£…æˆåŠŸçš„è¯ä¼šæ˜¾ç¤ºApache2çš„é»˜è®¤é¡µé¢ï¼ŒIt worksã€‚   å®‰è£…php7.0ï¼Œå¹¶å®‰è£…apacheçš„phpæ‰©å±•ï¼Œå†å®‰è£…æ•´åˆmysqlå’Œphpçš„å·¥å…·</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install php7.0</span><br><span class="line">sudo apt-get install libapache2-mod-php7.0</span><br><span class="line">sudo apt-get install php7.0-mysql</span><br></pre></td></tr></table></figure><p>é‡å¯ä¸€ä¸‹Apache2å’ŒMySQL</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo service apache2 restart</span><br><span class="line">sudo service mysql restart</span><br></pre></td></tr></table></figure><p>å®‰è£… phpmyadmin è¿™æ˜¯ä¸€ä¸ªä»¥PHPä¸ºåŸºç¡€ï¼Œä»¥Web-Baseæ–¹å¼æ¶æ„åœ¨ç½‘ç«™ä¸»æœºä¸Šçš„MySQLçš„æ•°æ®åº“ç®¡ç†å·¥å…·ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install phpmyadmin</span><br></pre></td></tr></table></figure><p>å¼€å¯ apache çš„ mod_rewriteï¼Œå†é‡å¯ä¸€æ¬¡apache</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo a2enmod rewrite</span><br><span class="line">sudo service apache2 restart</span><br></pre></td></tr></table></figure><p>å…ˆç™»å½•mysql <code>mysql -u root -p</code> ï¼Œè¾“å…¥å¯†ç  é¦–å…ˆåˆ›å»ºåä¸ºâ€œwordpressdbâ€æ•°æ®åº“ï¼Œç„¶åæŸ¥çœ‹åˆ›å»ºçš„æ•°æ®åº“æ˜¯å¦æˆåŠŸã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">create database wordpressdb;</span><br><span class="line">show databases;</span><br></pre></td></tr></table></figure><p>çœ‹åˆ°å›¾ä¸­å‡ºç°è‡ªå·±åˆ›å»ºçš„æ•°æ®åº“ã€‚</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20180318165221370.png" alt>  </p><p>ç»™ç”¨æˆ·æœåŠ¡æƒé™ï¼Œä¸‹é¢çš„wordpressuseræ”¹ä¸ºå®‰è£…mysqlæ—¶è‡ªå·±è¾“å…¥çš„ç”¨æˆ·åã€‚</p><p>GRANT ALL PRIVILEGES ON wordpressdb.* TO wordpressuser@localhost;<br>FLUSH PRIVILEGES;</p><p>  è¾“å…¥ <code>exit;</code>é€€å‡ºmysqlï¼Œå¹¶å†æ¬¡é‡å¯æœåŠ¡ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo service apache2 restart</span><br><span class="line">sudo service mysql restart</span><br></pre></td></tr></table></figure><h4 id="ä¸‹è½½å¹¶é…ç½®WordPress"><a href="#ä¸‹è½½å¹¶é…ç½®WordPress" class="headerlink" title="ä¸‹è½½å¹¶é…ç½®WordPress"></a><strong>ä¸‹è½½å¹¶é…ç½®WordPress</strong></h4><p>ç”¨wgetä»WordPresså®˜æ–¹ç½‘ç«™ä¸‹è½½å®‰è£…åŒ…ï¼Œæ”¾åœ¨ /var/www/html/ ç›®å½•ï¼Œç„¶åè§£å‹ã€‚ ï¼ˆæœ€æ–°ç‰ˆä¸‹è½½é“¾æ¥åœ¨ <a href="https://cn.wordpress.org/download/" target="_blank" rel="noopener">https://cn.wordpress.org/download/</a> é‡Œé¢æœ‰ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /var/www/html/</span><br><span class="line">sudo wget https://cn.wordpress.org/wordpress-5.0.3-zh_CN.zip</span><br><span class="line">sudo tar zxf wordpress-4.9.4.tar.gz</span><br></pre></td></tr></table></figure><p>  åœ¨ /var/www/html/wordpress/wp-content/ ä¸‹åˆ›å»ºuploadsã€‚ ç„¶åæ›´æ”¹ä¸Šä¼ ç›®å½•æƒé™ï¼Œä¸ç„¶ä¹‹ååšå®¢ä¸Šä¼ ä¸äº†å›¾ç‰‡ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo mkdir uploads</span><br><span class="line">sudo chown -R www-data /var/www/html/wordpress</span><br><span class="line">sudo chmod -R 755 /var/www/html/wordpress</span><br><span class="line">sudo chown -R :www-data /var/www/html/wordpress/wp-content/uploads</span><br></pre></td></tr></table></figure><p>  é…ç½®wp-config-sample.php ï¼Œè¯¥æ–‡ä»¶åœ¨/var/www/html/wordpress/ä¸‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vi wp-config-sample.php</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹æ–¹æ³•å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20180318182134757.png" alt></p><p>æµè§ˆå™¨è®¿é—®  http://æœåŠ¡å™¨IPåœ°å€/wordpress ï¼Œå¦‚æœå®‰è£…æ­£å¸¸åˆ™è¿›å…¥wordpressçš„å®‰è£…ç•Œé¢ã€‚ å®‰è£…å¥½åçš„æ•ˆæœå¦‚å›¾ï¼š </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20180318182550961.png" alt></p><p>åˆ°æ­¤å»ºç«™å®Œæˆã€‚æ¥ä¸‹æ¥ç”³è¯·åŸŸåå¹¶ç»‘å®šæœåŠ¡å™¨ã€‚</p><h3 id="ç”³è¯·åŸŸåå¹¶é…ç½®DNS"><a href="#ç”³è¯·åŸŸåå¹¶é…ç½®DNS" class="headerlink" title="ç”³è¯·åŸŸåå¹¶é…ç½®DNS"></a><strong>ç”³è¯·åŸŸåå¹¶é…ç½®DNS</strong></h3><p>é€šè¿‡æ¯”ä»·ç½‘ç«™å¯ä»¥å…ˆå¤§è‡´çœ‹ä¸€ä¸‹æƒ³è¦çš„åŸŸåä»·æ ¼ <a href="https://www.domcomp.com/" target="_blank" rel="noopener">https://www.domcomp.com/</a></p><p>çœ‹äº†ä¸€ä¸‹çŸ¥ä¹ï¼Œå¤§å®¶æ¨èçš„åŸŸåä¾›åº”å•†æœ‰ NameSilo ã€Namecheapã€Porkbunã€GoDaddyç­‰ï¼Œäº²æµ‹äº†ä¸€éï¼Œå‘ç° NameSilo ç”¨æˆ·ç•Œé¢å¤ªä¸‘ï¼›Namecheap å®é™…å¹¶ä¸ cheapï¼›æœ€å¤šäººè¯´çš„ GoDaddy ä¹Ÿåè´µä½†æ˜¯æ”¯æŒæ”¯ä»˜å®ï¼ŒPorkbun æ€§ä»·æ¯”é«˜è€Œä¸”ç•Œé¢å‹å¥½ã€‚ å› ä¸ºæœ‰å¢ƒå¤–æ”¯ä»˜çš„ä¿¡ç”¨å¡å°±ä¸è€ƒè™‘ GoDaddy äº†ï¼Œç›´æ¥åœ¨ Porkbun ä¸Šä¸‹å•äº†ä¸€ä¸ª .com åŸŸåï¼Œé¦–å¹´ä¸åˆ° 7åˆ€ï¼Œç»­è´¹ 8.7åˆ€ã€‚ </p><p>å€¼å¾—ä¸€æçš„æ˜¯æ”¯ä»˜æ—¶å¥½å‡ å¼ å¡æ”¯ä»˜å¤±è´¥ï¼Œå»ºè¡Œã€å†œè¡Œéƒ½ä¸è¡Œï¼Œæ¢äº†å¹¿å‘çš„ä¸‡äº‹è¾¾æ‰æ”¯ä»˜æˆåŠŸï¼Œæœ‰ç‚¹è¿·ã€‚ ä»˜æ¬¾åä¸»é¡µå¯ä»¥çœ‹åˆ°è‡ªå·±åŸŸåçš„å„ç§è¯¦æƒ…ï¼Œç„¶åè¦è®¾ç½®çš„æ˜¯ DNS RECORDS </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/Screenshot-2019-01-29-17.48.31.png" alt></p><p>ç‚¹å‡»Editï¼Œæ·»åŠ ä¸¤ä¸ªAè®°å½•ï¼Œåˆ†åˆ«æ˜¯å¸¦wwwå’Œä¸å¸¦çš„åŸŸåï¼ŒANSWERå¡«è‡ªå·±çš„ä¸»æœºåœ°å€ã€‚ </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/Screenshot-2019-01-29-17.50.38.png" alt></p><p>ä¸¤ä¸ªNSå¡«DNSæä¾›å•†çš„ï¼Œè¿™é‡Œå› ä¸ºVultrè‡ªå¸¦äº†å…è´¹çš„DNSæœåŠ¡ï¼Œç›´æ¥å¡«ä¸Šå»å³å¯ï¼Œå…·ä½“çš„DNSåœ°å€å¯åœ¨Vultrçš„è®¾ç½®é¡µé‡Œæ‰¾ã€‚ ä¸‹å›¾å°±æ˜¯è®¾ç½®é¡µï¼Œå¯ä»¥çœ‹åˆ°åº•ä¸‹æœ‰ä¸¤æ¡DNSåœ°å€ï¼Œå¡«åˆ° Porkbun é‡Œï¼Œç„¶åè¿˜è¦åœ¨ Vultr é‡Œ Add Domainï¼Œç»‘å®šæœåŠ¡å™¨åˆ°åŸŸåã€‚ </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/Screenshot-2019-01-29-17.52.20.png" alt></p><p>ä¸¤è¾¹éƒ½æ“ä½œå®Œæˆåï¼Œé™å€™å‡ åˆ†é’Ÿï¼Œç„¶åè®¿é—®ä¸€ä¸‹è‡ªå·±çš„åŸŸåï¼Œåº”è¯¥å°±å‡ºæ¥äº†ã€‚</p><h3 id="å¸¸è§é—®é¢˜"><a href="#å¸¸è§é—®é¢˜" class="headerlink" title="å¸¸è§é—®é¢˜"></a><strong>å¸¸è§é—®é¢˜</strong></h3><h4 id="åœ¨ä»ªè¡¨ç›˜çš„è®¾ç½®ä¸­ä¸å°å¿ƒæ›´æ”¹äº†wordpressåœ°å€åå›ä¸åˆ°åå°"><a href="#åœ¨ä»ªè¡¨ç›˜çš„è®¾ç½®ä¸­ä¸å°å¿ƒæ›´æ”¹äº†wordpressåœ°å€åå›ä¸åˆ°åå°" class="headerlink" title="åœ¨ä»ªè¡¨ç›˜çš„è®¾ç½®ä¸­ä¸å°å¿ƒæ›´æ”¹äº†wordpressåœ°å€åå›ä¸åˆ°åå°"></a><strong>åœ¨ä»ªè¡¨ç›˜çš„è®¾ç½®ä¸­ä¸å°å¿ƒæ›´æ”¹äº†wordpressåœ°å€åå›ä¸åˆ°åå°</strong></h4><p>åœ¨å»ºç«™è¿‡ç¨‹ä¸­ï¼Œå¦‚æœæ”¹åŠ¨äº† wordpressåœ°å€æˆ–ç«™ç‚¹åœ°å€ï¼Œå°±å›ä¸åˆ°åå°äº†ã€‚ </p><p>è§£å†³æ–¹æ³•ï¼šç½‘ç«™é¦–é¡µåœ¨wordpressç›®å½•ä¸‹çš„index.phpä¸­çš„requireè¿™è¡Œçš„å†…å®¹ã€‚ </p><p>ä¸‹å›¾æ˜¯wordpressä¸‹index.phpçš„requireæ‰€åœ¨è¡Œçš„å†…å®¹ã€‚ </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20180319090603947.png" alt></p><p>æœ€å¼€å§‹wordpress urlæ˜¯ï¼š ä¸»æœºip/wordpressã€‚ å®ƒä¼šè‡ªåŠ¨å»æ‰¾index.phpï¼Œç„¶åå°±é€šè¿‡index.phpé‡Œé¢çš„å†…å®¹åŠ è½½wordpressç¯å¢ƒï¼Œæ›´æ”¹äº†urlåï¼Œå°±ä¸èƒ½è‡ªåŠ¨å»æ‰¾index.phpäº†ã€‚æ­¤æ—¶åå°ä¹Ÿæ— æ³•ç™»å½•ã€‚è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œç›´æ¥è¿›æ•°æ®åº“ä¿®æ”¹ç›¸å…³æ•°æ®å³å¯ã€‚æ“ä½œå¦‚ä¸‹ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p //ç„¶åè¾“å…¥å¯†ç </span><br><span class="line">show databases; //æ˜¾ç¤ºæ‰€æœ‰æ•°æ®åº“</span><br><span class="line">use wordpressdb; //é€‰ä¸­ä½ è‡ªå·±ç½‘ç«™å¯¹åº”çš„æ•°æ®åº“ã€‚</span><br><span class="line">show tables; //æ˜¾ç¤ºè¯¥æ•°æ®åº“æ‰€æœ‰è¡¨æ ¼ã€‚</span><br><span class="line">select * from wp_options where 1=1 limit 10; //æŸ¥çœ‹æ•°æ®åº“å‰10æ¡è®°å½•</span><br><span class="line">update wp\_options set option\_value=&apos;http://æœåŠ¡å™¨ipï¼ˆæˆ–åŸŸåï¼‰/wordpress&apos; where option_name=&apos;siteurl&apos;;//ï¼ˆå¦‚æœhomeä¹Ÿæ”¹äº†å°±ä¹Ÿæ”¹å›æ¥ï¼‰</span><br><span class="line">update wp\_options set option\_value=&apos;http://æœåŠ¡å™¨ipï¼ˆæˆ–åŸŸåï¼‰/wordpress&apos; where option_name=&apos;home&apos;;</span><br></pre></td></tr></table></figure><p>å…¶å®å°±æ˜¯æ”¹å˜äº†wordpress url ï¼Œåˆ™wp_optionsè¡¨ä¸­çš„siteurlçš„å€¼å˜åŒ–äº†ï¼Œåªè¦æŠŠå®ƒåœ¨ä¿®æ”¹è¿‡æ¥å°±è¡Œã€‚</p><h4 id="ä½¿ç”¨æœåŠ¡å™¨IPï¼ˆæˆ–åŸŸåï¼‰æ ¹åœ°å€ç›´æ¥è®¿é—®ç½‘ç«™é¦–é¡µ"><a href="#ä½¿ç”¨æœåŠ¡å™¨IPï¼ˆæˆ–åŸŸåï¼‰æ ¹åœ°å€ç›´æ¥è®¿é—®ç½‘ç«™é¦–é¡µ" class="headerlink" title="ä½¿ç”¨æœåŠ¡å™¨IPï¼ˆæˆ–åŸŸåï¼‰æ ¹åœ°å€ç›´æ¥è®¿é—®ç½‘ç«™é¦–é¡µ"></a><strong>ä½¿ç”¨æœåŠ¡å™¨IPï¼ˆæˆ–åŸŸåï¼‰æ ¹åœ°å€ç›´æ¥è®¿é—®ç½‘ç«™é¦–é¡µ</strong></h4><p>æ­¤æ–‡ç« çš„å»ºç«™æ–¹æ³•æ˜¯æŠŠæ‰€æœ‰ä¸œè¥¿éƒ½æ”¾åœ¨wordpressç›®å½•ä¸‹ï¼Œå› æ­¤å»ºå®Œåï¼Œè®¿é—®ç½‘ç«™çš„ç½‘å€ä¸ºï¼šä¸»æœºIP/wordpresssã€‚</p><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šä¹°ä¸€ä¸ªåŸŸåä¸äº‘ä¸»æœºIPç»‘å®šï¼Œè¾“å…¥IPåœ°å€åªèƒ½è®¿é—®æ ¹ç›®å½•ã€‚ å³/var/www/htmlï¼Œä½†æ˜¯æ— æ³•è®¿é—®å…¶ä¸‹é¢çš„å­ç›®å½•ã€‚</p><p>ä»¥ä¸‹å°†ç»™å‡ºè§£å†³æ–¹æ¡ˆã€‚å¦‚æœä½¿ä¸»æœºIPç›´æ¥å®šä½åˆ°ç½‘ç«™é¦–é¡µã€‚</p><p>ç¬¬ä¸€ç§è§£å†³æ–¹å¼æ˜¯æŠŠwordpressçš„å†…å®¹ç›´æ¥éƒ½å¼„åˆ°æ ¹ç›®å½•ä¸­ï¼Œè¿™æ˜¯ä¸æå€¡çš„ï¼Œä¼šä½¿æ ¹ç›®å½•å˜å¾—æ‚ä¹±ã€‚é€šå¸¸æ¨èç¬¬äºŒç§æ–¹æ¡ˆã€‚   </p><p>ç¬¬äºŒç§æ–¹æ¡ˆæ“ä½œå¦‚ä¸‹ï¼š ç™»å½•åå°ï¼Œæ‰“å¼€ è®¾ç½®â†’å¸¸è§„ï¼Œä¿®æ”¹ç«™ç‚¹åœ°å€ã€‚ </p><p>WordPressåœ°å€æ˜¯æœ¬ä½“å­˜æ”¾çš„åœ°å€ï¼ŒæŒ‰æœ¬æ–‡å®‰è£…çš„è¯å°±ä¸ç”¨æ”¹åŠ¨äº†ã€‚ ç«™ç‚¹åœ°å€æ˜¯æµè§ˆå™¨è®¿é—®çš„åœ°å€ï¼Œæ”¹ä¸º â€œhttp://æœåŠ¡å™¨IPï¼ˆæˆ–åŸŸåï¼‰â€ çš„å½¢å¼ï¼Œå¦‚ä¸‹å›¾å³å¯ã€‚ </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/Screenshot-2019-01-31-15.26.26.png" alt></p><p>åŒæ—¶ï¼Œæ‰“å¼€ è®¾ç½®â†’å›ºå®šé“¾æ¥ï¼ŒæŠŠå›ºå®šé“¾æ¥ä¿®æ”¹æˆå¦‚ä¸‹å½¢å¼ï¼šï¼ˆå»æ‰ä¸­é—´çš„/wordpress/ï¼‰ </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/Screenshot-2019-01-29-17.14.42.png" alt></p><p>è‡³äºæ–‡ç« åç¼€åï¼Œç½‘ä¸Šæœ‰å…³WordPressæ°¸ä¹…é“¾æ¥è®¾ç½®çš„ä»‹ç»ä¼—å¤šï¼Œæ™®éè®¤ä¸º <code>/%postname%.html</code> æ˜¯æœ€ä½³çš„è‡ªå®šä¹‰æ°¸ä¹…é“¾æ¥å½¢å¼ã€‚</p><p>è¿™ç§å½¢å¼å°†æ˜¾ç¤ºä¸º:http://ä½ çš„åŸŸå/æ—¥å¿—æ ‡é¢˜.htmlï¼Œç®€å•æ˜äº†ï¼Œæœ‰åˆ©äºSEOã€‚ä½†å½“ä½ çš„æ—¥å¿—æ ‡é¢˜æ˜¯ä¸­æ–‡æ—¶ï¼Œæ–‡ç« æ ‡é¢˜ä»¥ä¸­æ–‡å½¢å¼å‡ºç°ï¼Œçœ‹ä¸Šå»å¾ˆä¸ç¬¦åˆæ ‡å‡†ï¼Œæˆ–è€…å¯èƒ½ä¼šå‡ºç°å¦‚:%64%b3%e8%ae%ar%e6%ba%a7%e5%9.html ç±»ä¼¼ä¹±ç çš„æ˜¾ç¤ºã€‚å› æ­¤éœ€è¦åœ¨ç¼–è¾‘æ–‡ç« æ—¶ï¼Œæ ‡é¢˜ä¸‹é¢å›ºå®šé“¾æ¥é¡¹ï¼Œç‚¹å‡»ç¼–è¾‘ï¼Œç”¨æ‹¼éŸ³æˆ–è‹±æ–‡è¾“å…¥æ–‡ç« æ ‡é¢˜ã€‚ </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/Screenshot-2019-01-29-17.19.42.png" alt>  </p><p>ç„¶åæŠŠwordpressç›®å½•ä¸‹çš„index.php å’Œ .htaccessæ–‡ä»¶å¤åˆ¶ä¸€ä»½åˆ°æ ¹ç›®å½•ä¸‹ï¼Œ.htaccess æ˜¯éšè—æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ls -allã€‚å°†å…¶æ˜¾ç¤ºå‡ºæ¥ã€‚æ³¨æ„æ˜¯å¤åˆ¶æ–‡ä»¶ï¼ŒåŸæ¥ç›®å½•ä¸‹è¿˜å­˜åœ¨ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /var/www/html/wordpress/</span><br><span class="line">cp index.php /var/www/html/</span><br><span class="line">cp .htaccess /var/www/html/</span><br></pre></td></tr></table></figure><p>ç„¶åä½¿ç”¨vimä¿®æ”¹.htaccessæ–‡ä»¶çš„å†…å®¹ä¸ºä¸‹å›¾æ‰€ç¤ºã€‚ï¼ˆé»˜è®¤æ–‡ä»¶å¦‚æœå°±æ˜¯å¦‚æ­¤åˆ™è·³è¿‡è¯¥æ­¥éª¤ï¼‰ </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20180319093058967.png" alt></p><p>ä¿®æ”¹index.phpæ–‡ä»¶ï¼Œå› ä¸ºindex.phpæ–‡ä»¶æ˜¯wordpressä¸‹index.phpçš„å¤åˆ¶å“ï¼Œå› æ­¤æ–‡ä»¶å†…éƒ¨çš„requireé‚£ä¸€è¡Œçš„å€¼å½“å¯¹äºå½“å‰ç›®å½•ï¼Œæ˜¯ä¸æ­£ç¡®çš„ã€‚åŒæ ·ä½¿ç”¨vimç¼–è¾‘è¯¥æ–‡ä»¶ï¼ŒæŠŠrequireé‚£ä¸€è¡Œè·¯å¾„ï¼Œä¿®æ”¹æˆä¸‹å›¾é‚£æ ·ã€‚ </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20180319093423845.png" alt></p><p>æ­¤æ—¶å†è¾“å…¥IPï¼Œçœ‹åˆ°è¿˜æ˜¯It worksç•Œé¢ï¼Œé‚£æ˜¯å› ä¸ºå®‰è£…apacheæ—¶ï¼Œæˆ‘ä»¬çœ‹åˆ°çš„It worksç•Œé¢å…¶å®æ˜¯æ ¹ç›®å½•ä¸‹çš„index.htmlã€‚å½“index.html å’Œ index.phpåŒæ—¶å­˜åœ¨æ—¶ï¼Œé»˜è®¤è¿˜æ˜¯æ‰“å¼€index.htmlï¼Œæ‰€ä»¥åº”è¯¥æŠŠindex.htmlç§»å‡ºè¯¥ç›®å½•ã€‚æˆ‘ä»¬æŠŠå®ƒç§»å‡ºåˆ°å…¶ä»–ç›®å½•å°±è¡Œã€‚  </p><h4 id="ç„¶åå¯èƒ½ä¼šäº§ç”Ÿä¸‹ä¸€ä¸ªé—®é¢˜ï¼Œè®¾ç½®å›ºå®šé“¾æ¥åï¼Œæ–‡ç« é¡µä¼š404"><a href="#ç„¶åå¯èƒ½ä¼šäº§ç”Ÿä¸‹ä¸€ä¸ªé—®é¢˜ï¼Œè®¾ç½®å›ºå®šé“¾æ¥åï¼Œæ–‡ç« é¡µä¼š404" class="headerlink" title="ç„¶åå¯èƒ½ä¼šäº§ç”Ÿä¸‹ä¸€ä¸ªé—®é¢˜ï¼Œè®¾ç½®å›ºå®šé“¾æ¥åï¼Œæ–‡ç« é¡µä¼š404"></a><strong>ç„¶åå¯èƒ½ä¼šäº§ç”Ÿä¸‹ä¸€ä¸ªé—®é¢˜ï¼Œè®¾ç½®å›ºå®šé“¾æ¥åï¼Œæ–‡ç« é¡µä¼š404</strong></h4><p>è§£å†³æ–¹æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vi /etc/apache2/apache2.conf</span><br></pre></td></tr></table></figure><p>æŠŠ AllowOverride None æ”¹ä¸º AllowOverride ALL</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20170922122312719.png" alt></p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20170922122320129.png" alt></p><p>æ³¨æ„æœ‰ä¸¤å¤„è¦æ”¹ï¼Œç„¶åæ“ä½œä¸€ä¸‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo a2enmod rewrite</span><br><span class="line">sudo /etc/init.d/apache2 restar</span><br></pre></td></tr></table></figure><p>åˆ·æ–°ä¸€ä¸‹åº”è¯¥å°±èƒ½æ­£å¸¸æ‰“å¼€æ–‡ç« äº†ã€‚</p><h3 id="ä¸»é¡µæ ·å¼ä¿®æ”¹"><a href="#ä¸»é¡µæ ·å¼ä¿®æ”¹" class="headerlink" title="ä¸»é¡µæ ·å¼ä¿®æ”¹"></a><strong>ä¸»é¡µæ ·å¼ä¿®æ”¹</strong></h3><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20170413090347184.jpeg" alt></p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/20170413090322305.png" alt></p><p>é¡µå°¾å’ŒåŠŸèƒ½æ¨¡å—é‡Œçš„é“¾æ¥å¦‚æœè§‰å¾—ç¢çœ¼ï¼Œå¯ä»¥å»é™¤ã€‚  </p><h4 id="åˆ é™¤é¡µå°¾â€œè‡ªè±ªåœ°ä½¿ç”¨WordPressâ€å­—æ ·"><a href="#åˆ é™¤é¡µå°¾â€œè‡ªè±ªåœ°ä½¿ç”¨WordPressâ€å­—æ ·" class="headerlink" title="åˆ é™¤é¡µå°¾â€œè‡ªè±ªåœ°ä½¿ç”¨WordPressâ€å­—æ ·"></a><strong>åˆ é™¤é¡µå°¾â€œè‡ªè±ªåœ°ä½¿ç”¨WordPressâ€å­—æ ·</strong></h4><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/Screenshot-2019-01-29-18.12.11.png" alt></p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/Screenshot-2019-01-29-18.15.07.png" alt>  </p><p>å¦‚æœæ˜¯é€šè¿‡å‡½æ•°ç”Ÿæˆé¡µå°¾çš„ä¸»é¢˜ï¼Œä¸€èˆ¬åœ¨æ¨¡æ¿å‡½æ•°é‚£é‡Œä¿®æ”¹ï¼ŒæŸ¥æ‰¾ â€œProudly powered byâ€ çš„å­—æ ·åˆ æ‰å°±okã€‚</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=â€œ&lt;?php echo esc\_url( \_\_( â€˜http://wordpress.org/â€™, â€˜twentyelevenâ€™ )); ?&gt;â€ title=â€œ&lt;?php esc\_attr\_e(â€˜SemanticPersonalPublishing Platformâ€™, â€˜twentyelevenâ€™ ); ?&gt;â€ rel=â€œgeneratorâ€&gt;&lt;?php printf( __( â€˜Proudly powered by%sâ€™,â€˜twentyelevenâ€™ ), â€˜WordPressâ€™ ); ?&gt;&lt;/a&gt;</span><br></pre></td></tr></table></figure><h4 id="åˆ é™¤åŠŸèƒ½å°å·¥å…·é‡Œçš„â€œæ–‡ç« RSSâ€ã€â€œè¯„è®ºRSSâ€ã€â€œWordPress-orgâ€"><a href="#åˆ é™¤åŠŸèƒ½å°å·¥å…·é‡Œçš„â€œæ–‡ç« RSSâ€ã€â€œè¯„è®ºRSSâ€ã€â€œWordPress-orgâ€" class="headerlink" title="åˆ é™¤åŠŸèƒ½å°å·¥å…·é‡Œçš„â€œæ–‡ç« RSSâ€ã€â€œè¯„è®ºRSSâ€ã€â€œWordPress.orgâ€"></a><strong>åˆ é™¤åŠŸèƒ½å°å·¥å…·é‡Œçš„â€œæ–‡ç« RSSâ€ã€â€œè¯„è®ºRSSâ€ã€â€œWordPress.orgâ€</strong></h4><p>æ‰“å¼€ç»„ä»¶æ–‡ä»¶å¤¹ï¼šwp-include/widgets/class-wp-widget-meta.php æ‰¾åˆ°ä»£ç æ®µåˆ é™¤å³å¯ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">!\-\-</span> å±è”½ <span class="attr">RSS</span> åŠŸèƒ½</span></span><br><span class="line">&lt;li&gt;&lt;a href="&lt;?php echo esc\_url( get\_bloginfo( 'rss2\_url' )); ?&gt;"&gt;&lt;?php \_e('Entries &lt;abbr title="Really Simple Syndication"&gt;RSS&lt;/abbr&gt;'); ?&gt;&lt;/a&gt;&lt;/li&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&lt;?php echo esc\_url( get\_bloginfo( 'comments\_rss2\_url' )); ?&gt;"</span>&gt;</span>&lt;?php _e('Comments &lt;abbr title="Really Simple Syndication"&gt;RSS&lt;/abbr&gt;'); ?&gt;<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Tech </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WordPress </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—</title>
      <link href="/2017-05-17-doubletree-longhua/"/>
      <url>/2017-05-17-doubletree-longhua/</url>
      
        <content type="html"><![CDATA[<p>é¾™åå¹´åˆæ–°å¼€äº†é—´ DoubleTreeï¼Œä»æ­¤æ·±åœ³ä¹Ÿæœ‰CAT2çš„å¸Œå°”é¡¿äº†ã€‚å¯æƒœçš„æ˜¯ç§¯åˆ†æˆ¿å¸¸å¹´ä¸æ”¾10000åˆ†çš„åŸºç¡€æˆ¿å‹ï¼Œè¿˜å¥½è¿ç»­ä¸¤æ—¥åŠä»¥ä¸Šè¿˜èƒ½è®¢åˆ°åŸºç¡€æˆ¿ï¼Œé…åˆ Hilton Q1 ä¿ƒé”€æ¯æ™šé€2000åˆ†æ´»åŠ¨ï¼Œéå¸¸é€‚åˆä¿çº§åˆ·æˆ¿ã€‚   </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress1-1548760825.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—"></p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress5-1548760828.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—">  </p><p>é…’åº—åœ¨ç²¤å•†ä¸­å¿ƒå¤§å¦1-15å±‚ï¼Œåè½äºé¾™åæ–‡åŒ–å¹¿åœºæ—ï¼Œéš”å£æ˜¯é¾™åæ˜Ÿæ²³ICOï¼Œè·ç¦»åœ°é“æ¸…æ¹–ç«™è¾ƒè¿‘ï¼Œå‘¨å›´è¿˜ç®—ç¹åï¼Œæ®è¯´æ˜¯é¾™åæ–°åŒºé¦–å®¶äº”æ˜Ÿçº§å›½é™…é…’åº—ã€‚ç²¤å•†ä¸­å¿ƒè¿™æ ‹æ¥¼å…¨ç»ç’ƒè¦†ç›–æ˜¾å¾—æ¯”è¾ƒå•†åŠ¡ï¼Œç¬¦åˆ DoubleTree å“ç‰Œçš„å®šä½ã€‚   </p><a id="more"></a><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress6-1548760829.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—"></p><p>ä¸€è¿›å¤§å ‚å°±æ˜¯å…¸å‹çš„ DoubleTree æ€§å†·æ·¡é£æ ¼ï¼Œç±³ç™½è‰²å¤§ç†çŸ³ä¸ºä¸»çš„è£…ä¿®é£æ ¼ä½¿åŸæœ¬è¾ƒå°çš„å¤§å ‚æ˜¾å¾—å¤§æ°”ï¼Œå‰å°äººæ‰‹ä¸å¤Ÿï¼Œå®¢äººå¤šæ—¶è¦æ’é˜Ÿ CI/COï¼Œä¸Šé…’å»Š Check-in å°±æ›´æ˜¯è¦ç­‰å¾ˆä¹…äº†ã€‚   </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress5-1548760829.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—"></p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress2-1548760830.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—"></p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress10-1548760831.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—"></p><p>é…’åº—è¢«è®¾è®¡åœ¨è¿™æ ‹æ¥¼åº•éƒ¨åå‡ å±‚ï¼Œä¸ŠåŠéƒ¨åˆ†æ˜¯å†™å­—æ¥¼ï¼Œä¼¼ä¹ä¸šä¸»ä¸å¤ªé‡è§†é…’åº—ã€‚   </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress9-1548760832.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—">  </p><p>è¿™æ¬¡å…¥ä½æ—¶æˆ¿æ€ç´§å¼ ï¼Œåªç»™å‡ä¸€çº§åˆ°12æ¥¼çš„å›­æ™¯æˆ¿ï¼Œè™½ç„¶æ²¡å‡çº§åˆ°è¡Œæ”¿æˆ¿ä¸è¿‡ä¹Ÿç»™äº†è¡Œæ”¿å¾…é‡ã€‚   </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress0-1548760833.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—"></p><p>DoubleTree æ ‡å¿—æ€§çš„çƒ­æ›²å¥‡é¥¼ï¼Œæ¯ä½é¡¾å®¢å…¥ä½æ—¶éƒ½ç»™ä¸¤ä»½ï¼Œå¾ˆå¥½åƒï¼Œè·¯è¿‡å‰å°æ—¶å¯ä»¥å†è¦å‡ å—ã€‚   </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress3-1548760835.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—"></p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress2-1548760837.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—"></p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress3-1548760837.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—"></p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress9-1548760839.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—"></p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress8-1548760840.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—"></p><p>å› ä¸ºæ˜¯æ–°å¼€ä¸šçš„é…’åº—ï¼Œç¡¬ä»¶æ°´å‡†åœ¨åŒå“ç‰Œä¸­æ•°ä¸€æ•°äºŒï¼Œå®¢æˆ¿é¢ç§¯48å¹³æ–¹èµ·æ­¥ä¹Ÿæ²¡ä»€ä¹ˆé—®é¢˜ï¼Œå¥—æˆ¿æ¥¼å±‚æ®è¯´è¢«æŸå‰§ç»„åŒ…äº†å‡ ä¸ªæœˆï¼Œå› æ­¤æ²¡èƒ½å‡çº§å¥—æˆ¿æŒºå¯æƒœçš„ã€‚   </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress9-1548760842.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—"></p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress6-1548760843.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—"></p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress2-1548760845.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—"></p><p>é€¸æ—æ ‡é…å•äººæµ´ç¼¸ï¼Œå«ç”Ÿé—´å¹²æ¹¿åˆ†ç¦»ï¼Œç‘°ç€ç¿ ï¼ˆCrabtree &amp; Evelynï¼‰çš„å¤‡å“å‘³é“ä¸€èˆ¬ï¼Œè¿˜æ˜¯æ›´å–œæ¬¢å½¼å¾—ç½—å¤«ï¼ˆPeter Thomas Rothï¼‰çš„çƒ­æƒ…æœå‘³ã€‚   </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress10-1548760846.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—"></p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress10-1548760847.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—"></p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress6-1548760848.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—"></p><p>çª—å¤–æ­£å¯¹é¾™åæ–‡åŒ–å¹¿åœºï¼Œä¹Ÿæ˜¯æ–°å»ºçš„ï¼Œæ™šä¸Šæœ‰å¤§æ‰¹å¹¿åœºèˆå¤§å¦ˆï¼Œå¹¸å¥½ç»ç’ƒéš”éŸ³æ€§èƒ½ä¸é”™ï¼Œé—®é¢˜æ˜¯æ™šä¸Šæœ‰æ²»å®‰çš„å•è½¦æŒç»­é—ªçƒçº¢è“ç¯å…‰ï¼Œç©¿é€åŠ›æå¼ºï¼Œä¸æ‹‰ä¸Šé®å…‰çª—å¸˜è¦è¢«é—ªççœ¼ã€‚   </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress0-1548760850.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—"></p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress0-1548760852.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—"></p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress5-1548760853.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—"></p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress6-1548760855.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—"></p><p>åºŠå¤´éŸ³å“æ”¯æŒç›´æ¥æ’ iPhone æ’­æ”¾ï¼Œæ’åº§è‡ªå¸¦USBä¹Ÿæ˜¯è¿™å‡ å¹´æ–°å¼€é…’åº—çš„æ ‡é…äº†ã€‚æ¬¢è¿æ°´æœç•¥æ˜¾å°æ°”ï¼Œè¿›é—¨çš„æŸœå­å¦æœ‰ç„æœºï¼Œæ°´å£¶èŒ¶æ¯å’Œå°å†°ç®±éƒ½è—åœ¨é‡Œé¢ã€‚   </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress2-1548760855.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—"></p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress2-1548760856.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—"></p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress1-1548760857.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—"></p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress8-1548760859.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—"></p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress7-1548760862.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—"></p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress2-1548760863.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—"></p><p>è¡Œæ”¿é…’å»Šçš„ Happy Hour ä»17ç‚¹åˆ°19ç‚¹ï¼Œèœå“ååˆ†ä¸°å¯Œï¼Œçƒ­èœã€ç”œå“å¾ˆå¤šï¼Œå½“ä½œæ™šé¤å®Œå…¨æ²¡æœ‰é—®é¢˜ã€‚   </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress10-1548760865.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—"></p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress6-1548760865.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—"></p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress3-1548760866.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—"></p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress5-1548760867.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—"></p><p>é…’åº—å¥èº«æˆ¿è¿˜æ²¡è£…ä¿®å¥½ï¼ŒæŠŠé…’å»Šå¯¹é¢çš„ä¸€é—´å¥—æˆ¿æ”¹é€ æˆäº†ä¸€ä¸ªä¸´æ—¶å¥èº«æˆ¿ï¼Œæ‰€ä»¥é¢ç§¯å¾ˆå°ï¼Œè®¾å¤‡ä¹Ÿä¸å¤Ÿå¤šï¼Œæ¥å‡ ä¸ªè€å¤–å°±å æ»¡äº†ã€‚å®¤å¤–æ³³æ± ä¹Ÿè¦åˆ°17å¹´5æœˆåº•æ‰å¼€æ”¾ã€‚   </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress1-1548760868.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—"></p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress9-1548760870.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—"></p><p>å›åˆ°æˆ¿é—´å‘ç°å·²ç»å¼€å¥½äº†å¤œåºŠï¼Œå¯èƒ½æ˜¯çœ‹åˆ°ä¸€ä¸‹å­æŠŠä¸¤ç“¶æ°´å–å®Œäº†ï¼Œäºæ˜¯åˆè¡¥å……äº†å…­ç“¶ğŸ˜‚è€Œä¸”å¾ˆè´´å¿ƒåœ°åœ¨åºŠä¸Šæ”¾äº†å¼ æ˜æ—¥å¤©æ°”é¢„æŠ¥ã€‚   </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress7-1548760872.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—"></p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress1-1548760874.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—"></p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress8-1548760875.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—"></p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress8-1548760876.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—"></p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress4-1548760878.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—"></p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress0-1548760880.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—"></p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress0-1548760882.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—"></p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress3-1548760884.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—"></p><p>é…’åº—çš„ä¸»é¤å…åä¸º ã€OPEN | â€œé–‹â€å…¨æ—¥é¤å…ã€ï¼Œç„¶è€Œæ™šä¸Šåªè¥ä¸šåˆ°22ç‚¹ï¼Œå¹¶æ²¡æœ‰é€šå®µå¼€æ”¾ğŸ˜‘ æ—©é¤çœ‹ä¼¼ä¸°å¯Œï¼Œå®é™…å‡ºå“ä¸€èˆ¬ï¼Œè›‹å·å’Œé¸¡è‚‰è‚ è¿˜æ²¡æœ‰å¸Œå°”é¡¿èŠ±å›­çš„å¥½åƒã€‚ä¸è¿‡é¤å…ç¯å¢ƒç¡®å®ä¸é”™ï¼Œé€‚åˆå¹³æ—¶æ™šä¸Šæ¥åƒè‡ªåŠ©é¤ã€‚   </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress8-1548760885.jpeg" alt="æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—"></p><p>è¿™é—´ DoubleTree æœ€è¿‘å‡ ä¸ªæœˆéƒ½ä¸æ”¾åŸºç¡€æˆ¿äº†ï¼Œå¯èƒ½ç¡®å®æ˜¯å•†åŠ¡å®¢æ¯”è¾ƒå¤šå§ï¼Œ 10000åˆ†å…¥ä½è™½ç„¶æ²¡æœ‰åä¸œä¸€å †5000åˆ† DoubleTree é‚£ä¹ˆç™½èœä»·ï¼Œä½†æ¯•ç«Ÿåœ°å¤„æ·±åœ³é¾™åè…¹åœ°ï¼Œæ€§ä»·æ¯”éå¸¸é«˜ï¼Œå®å±å¸Œå°”é¡¿ä¿çº§ä¼˜é€‰ã€‚      </p><blockquote><p>åŸæ–‡å§‹å‘äºå¾®ä¿¡å…¬ä¼—å·ï¼ˆæ´¾å¤§æ˜Ÿæ˜Ÿæ˜Ÿæ˜Ÿï¼‰ï¼š<a href="http://mp.weixin.qq.com/s/3AVq0D4fRAt10VIMWOGvmw" target="_blank" rel="noopener">æ€§å†·æ·¡å•†åŠ¡é£ï¼šæ·±åœ³é¾™åå¸Œå°”é¡¿é€¸æ—é…’åº—</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Life </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hotel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å®œå®¶ | ä¸€ä¸ªé¡ºä¾¿å–å–å®¶å…·çš„é¥­å ‚</title>
      <link href="/2015-12-17-ikea-canteen/"/>
      <url>/2015-12-17-ikea-canteen/</url>
      
        <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress0-1548761309.jpeg" alt="å®œå®¶ | ä¸€ä¸ªé¡ºä¾¿å–å–å®¶å…·çš„é¥­å ‚"></p><p>ç›¸ä¿¡å¾ˆå¤šäººå°è±¡ä¸­çš„å®œå®¶åªæ˜¯ä¸ªå–å®¶å…·çš„åœ°æ–¹</p><p>è·Ÿè‡ªå·±å…³ç³»ä¸å¤§</p><p>å»é‚£é‡Œå¹²å˜›</p><a id="more"></a><p>ç„¶è€Œäº‹å®ä¸Šå¹¶ä¸æ˜¯è¿™æ ·çš„  </p><p>å®œå®¶ä¸åªæ˜¯å–å®¶å…·</p><p>ä¹Ÿå–éå¸¸å¤šé›¶ç¢ç©æ„</p><p>å¾ˆé€‚åˆä¹°æ¥å……å®å®¿èˆ</p><p>ä½†æ›´é‡è¦çš„æ˜¯å®ƒçš„é¤å…</p><!-- more --><p>ä¸€ä¸ªå®¤å‹è¯´</p><p>â€œå®œå®¶å°±æ˜¯ä¸ªé¡ºä¾¿å–å®¶å…·çš„é£Ÿå ‚â€</p><p>è¿™è¯ä¸å‡</p><p>è¿™ä¸ªé¤å…ä¸åªæ˜¯å‘¨æœ«äººæ»¡ä¸ºæ‚£</p><p>å³ä¾¿æ˜¯å·¥ä½œæ—¥ä¹Ÿè¦æ‰¾åº§ä½æ‰¾å¾ˆä¹…</p><p>è¿™è¿˜æ˜¯å®œå®¶åè½åœ¨æ²¡æœ‰åœ°é“ç»è¿‡çš„éƒŠåŒºçš„å‰æä¸‹</p><p>æ˜¾å¾—æ›´ä¸ºéš¾å¾—</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress10-1548761310.jpeg" alt="å®œå®¶ | ä¸€ä¸ªé¡ºä¾¿å–å–å®¶å…·çš„é¥­å ‚"></p><p>â–²é¤å…é—¨å£èœå•</p><p>é¤å…ä¸ç®—å¤ªå¤§</p><p>èœå•ä¹Ÿå¾ˆç®€å•</p><p>ä¸»èœä¹Ÿå°±ç‘å…¸è‚‰åœ† è”¬èœä¸¸ è‚‰é…±é¢ ä¸‰æ–‡é±¼ è¥¿å†·ç‰›æ‰’ ç‰›è‚‰é¥­ç­‰</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress5-1548761312.jpeg" alt="å®œå®¶ | ä¸€ä¸ªé¡ºä¾¿å–å–å®¶å…·çš„é¥­å ‚"></p><p>æœ€èµçš„å°±æ˜¯ç‘å…¸è‚‰åœ†äº†</p><p>ä¸åŒäºæ±•å¤´ç‰›è‚‰ä¸¸çˆ½å£ å¼¹æ€§ æœ‰åš¼åŠ²</p><p>å®œå®¶çš„ç‘å…¸è‚‰åœ†å£æ„Ÿç»†è…» ç”¨æ–™ä¸°å¯Œ</p><p>ä»¥çŒªè‚‰å’Œç‰›è‚‰æ··åˆæ…ç¢</p><p>åŠ å…¥ç‰›å¥¶ é¢åŒ…ç³  åˆ‡ç¢çš„æ´‹è‘± é©¬é“ƒè–¯ç²‰æˆ–ç‡•éº¦ç‰‡</p><p>ç„¶åå†åŠ ä¸Šç™½èƒ¡æ¤’ ç› äº”é¦™ç²‰æˆ–è‚‰æ¡‚ç­‰é¦™æ–™è°ƒå‘³</p><p>æ“åŒ€åææˆçƒå½¢  </p><p>é£Ÿç”¨æ—¶é…ä»¥è‚‰é…± åœŸè±†æ³¥ æœé…±ä»¥åŠä¸€æšç‘å…¸å›½æ——  </p><p>ä»¤äººé£ŸæŒ‡å¤§åŠ¨</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress0-1548761313.jpeg" alt="å®œå®¶ | ä¸€ä¸ªé¡ºä¾¿å–å–å®¶å…·çš„é¥­å ‚"></p><p>è¥¿å†·ç‰›æ‰’å‡ºå“è¿˜ç®—å¯ä»¥</p><p>è™½ç„¶è·Ÿä¸“é—¨åšç‰›æ‰’çš„é¤å…ç›¸æ¯”å·®è·ä¸å°</p><p>ä½†è€ƒè™‘åˆ°ä¸‰åå¤šçš„å”®ä»·ä¹Ÿèƒ½ç†è§£ è¿˜æ˜¯å€¼è¿™ä¸ªä»·çš„</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress9-1548761314.jpeg" alt="å®œå®¶ | ä¸€ä¸ªé¡ºä¾¿å–å–å®¶å…·çš„é¥­å ‚"></p><p>çƒ¤ä¸‰æ–‡é±¼é…é€šå¿ƒç²‰</p><p>ä»½é‡åè¶³</p><p>ä¸åˆ°ä¸‰åå—</p><p>ä»·æ ¼æ„Ÿäºº</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress7-1548761316.jpeg" alt="å®œå®¶ | ä¸€ä¸ªé¡ºä¾¿å–å–å®¶å…·çš„é¥­å ‚"></p><p>å¥¥å°”è‰¯é¸¡è…¿</p><p>è¡¨çš®çƒ¤çš„ç„¦ç„¦çš„</p><p>è‚‰è´¨å¤šæ±å«©æ»‘</p><p>è·Ÿè‚‰ä¸¸ä¸€æ ·ä¹Ÿæ˜¯å¿…ç‚¹</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress3-1548761318.jpeg" alt="å®œå®¶ | ä¸€ä¸ªé¡ºä¾¿å–å–å®¶å…·çš„é¥­å ‚"></p><p>å†·ç›˜èœ</p><p>é¦™è‰ä¸‰æ–‡é±¼</p><p>é…¸é»„ç“œé…±ä¸ä¼šæ©ç›–ä¸‰æ–‡é±¼çš„é²œç¾</p><p>åè€Œç›¸å¾—ç›Šå½°ç¾å‘³å¯å£</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress2-1548761319.jpeg" alt="å®œå®¶ | ä¸€ä¸ªé¡ºä¾¿å–å–å®¶å…·çš„é¥­å ‚"></p><p>å®œå®¶ç‰©ä»·è®©äººæœ‰ç§å›åˆ°åå¹´å‰çš„æ„Ÿè§‰</p><p>åœ¨æ·±åœ³ç‰©ä»·é£æ¶¨éƒ½å¿«èµ¶ä¸Šé¦™æ¸¯çš„å¹´ä»£</p><p>è¿˜æœ‰è¿™ä¹ˆä¸ªå‡ºå“ä¼˜è‰¯åˆä¾¿å®œçš„é¤å…å®å±ä¸æ˜“</p><p>å¦‚æœä¸æ˜¯å› ä¸ºè·¯é€”é¥è¿œäº¤é€šä¸ä¾¿åˆ©çœŸçš„å°±æˆé¥­å ‚äº†</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress10-1548761320.jpeg" alt="å®œå®¶ | ä¸€ä¸ªé¡ºä¾¿å–å–å®¶å…·çš„é¥­å ‚"></p><p>â–²å–èœçª—å£è¶…åƒé¥­å ‚</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress3-1548761323.jpeg" alt="å®œå®¶ | ä¸€ä¸ªé¡ºä¾¿å–å–å®¶å…·çš„é¥­å ‚"></p><p>è¯´æ˜¯é¥­å ‚çš„å¦ä¸€ä¸ªåŸå› </p><p>é¡¾å®¢åƒå®Œåéœ€è¦è‡ªå·±æŠŠé¤ç›˜æ”¾è¿›å›æ”¶è½¦é‡Œ</p><p>å¤§å¤§å‡å°‘æ¸…æ´é˜¿å§¨å·¥ä½œé‡</p><hr><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress3-1548761325.jpeg" alt="å®œå®¶ | ä¸€ä¸ªé¡ºä¾¿å–å–å®¶å…·çš„é¥­å ‚"></p><p>â–²ä¼šå‘˜å¡é¢œå€¼é¢‡é«˜</p><p>è®°å¾—åŠä¸€å¼ å®œå®¶çš„ä¼šå‘˜å¡</p><p>åœ¨å…¥å£å’Œæ”¶é“¶å°å‰éƒ½æœ‰å…è´¹ç”³è¯·çš„ç”µè„‘</p><p>å¡«å®Œèµ„æ–™ç›´æ¥å°±åå¡å‡ºæ¥äº†</p><p>å·¥ä½œæ—¥å‡­ä¼šå‘˜å¡å¯ä»¥åœ¨é¤å…å…è´¹å–å’–å•¡</p><p>æ— é™ç»­æ¯çš„å–”</p><p>è€Œä¸”å¾ˆå¤šå•å“éƒ½æœ‰ä¼šå‘˜ä¼˜æƒ </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress2-1548761327.jpeg" alt="å®œå®¶ | ä¸€ä¸ªé¡ºä¾¿å–å–å®¶å…·çš„é¥­å ‚"></p><p>æ¯”å¦‚è¿™ä¸ªä¸¤å—ä¹çš„æ¯å­  </p><p>æ–°ä¼šå‘˜å¯ä»¥ä¸€å—é’±è´­ä¹°</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress9-1548761329.jpeg" alt="å®œå®¶ | ä¸€ä¸ªé¡ºä¾¿å–å–å®¶å…·çš„é¥­å ‚"></p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress10-1548761330.jpeg" alt="å®œå®¶ | ä¸€ä¸ªé¡ºä¾¿å–å–å®¶å…·çš„é¥­å ‚"></p><p>å€¼å¾—ä¸€æçš„æ˜¯æ¯›å·¾å’Œé—¨å«  </p><p>æ¯›å·¾è´¨é‡å¾ˆå¥½ ä¸ä¼šæ‰æ¯›</p><p>é—¨å«ä»·æ ¼æ„Ÿäºº</p><p>å¯ä»¥å±¯å¤šå‡ å¼ åœ¨å®¿èˆ</p><p>è„äº†ç›´æ¥æ¢ä¸€ä¸ª</p><hr><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress3-1548761331.jpeg" alt="å®œå®¶ | ä¸€ä¸ªé¡ºä¾¿å–å–å®¶å…·çš„é¥­å ‚"></p><p>åœ¨æ”¶é“¶å°å‡ºæ¥çš„åœ°æ–¹è¿˜æœ‰ä¸€ä¸ªå°é£Ÿæ¡£</p><p>äº”å—é’±çš„çƒ­ç‹—å¥—é¤å¯ä»¥æ— é™ç»­æ¯</p><p>æœ€è¿‘é¥®æ–™éƒ½æ¢æˆäº†ç›¸æ¯”å¯ä¹å«ç³–é‡å‡åŠçš„åŒ—æ¬§é£å‘³æœå‘³é¥®æ–™</p><p>ä¸è¿‡æ„Ÿè§‰è¿˜æ˜¯ä»¥å‰çš„è”“è¶Šè“æœæ±å¥½å–</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress9-1548761333.jpeg" alt="å®œå®¶ | ä¸€ä¸ªé¡ºä¾¿å–å–å®¶å…·çš„é¥­å ‚"></p><p>è¿˜æœ‰å°±æ˜¯åå—ä¸‰ä¸²çš„å¢¨é±¼ä¸¸</p><p>çœŸå¿ƒèµèµèµèµèµ</p><p>å¤–ç„¦é‡Œå«©å¼¹ç‰™å¯å£</p><p>å¢¨é±¼å‘³åè¶³</p><p>ä¹°ä¹°ä¹°ååƒä¸Šä¸€ä»½å¢¨é±¼ä¸¸çœŸæ˜¯é…¸çˆ½</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress5-1548761334.jpeg" alt="å®œå®¶ | ä¸€ä¸ªé¡ºä¾¿å–å–å®¶å…·çš„é¥­å ‚"></p><p>è¿˜æœ‰åŒæ ·åå—ä¸‰ä¸²çš„çƒ¤è‚   </p><p>å‘³é“è·Ÿä¹å‡¯æ’’çš„çƒ¤è‚ å·®ä¸å¤š</p><p>å› ä¸ºé‡ä¸å¤š</p><p>æ™šä¸Šä¸ƒå…«ç‚¹åå¯èƒ½å°±å–å®Œäº†</p><p>åŒæ ·å¼ºåŠ›æ¨è</p><p>è§åˆ°äº†èµ¶ç´§ä¹°ä¸‰ä¸²</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress10-1548761335.jpeg" alt="å®œå®¶ | ä¸€ä¸ªé¡ºä¾¿å–å–å®¶å…·çš„é¥­å ‚"></p><p>å°é£Ÿæ¡£æ—è¾¹è¿˜æœ‰ä¸“é—¨å–ç‘å…¸ç‰¹äº§çš„è¶…å¸‚</p><p>å¦‚æœè‚‰ä¸¸æˆ–è€…ä¸‰æ–‡é±¼åƒçš„ä¸è¿‡ç˜¾è¿˜èƒ½ä¹°å†·å†»çš„å›å»è‡ªå·±ç…®</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress10-1548761336.jpeg" alt="å®œå®¶ | ä¸€ä¸ªé¡ºä¾¿å–å–å®¶å…·çš„é¥­å ‚"></p><p>é˜»æŒ¡å®œå®¶æˆä¸ºé¥­å ‚çš„æœ€å¤§å› ç´ è¿˜æ˜¯åœ°ç†ä½ç½®ä¸å¥½</p><p>å…¬äº¤éå¸¸ä¸ä¾¿åˆ©</p><p>åªèƒ½è‡ªé©¾æˆ–è€…æ‰“è½¦å‰å¾€</p><p>ä¸è¿‡ä¸å¡è½¦çš„è¯ä»æ¡‚åº™è¿‡å»ååˆ†é’Ÿå°±èƒ½åˆ°</p><p>æ‰€ä»¥é—²æš‡ä¹‹ä½™è¿˜æ˜¯å¯ä»¥å»åƒé¤é¥­çš„</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress5-1548761337.jpeg" alt="å®œå®¶ | ä¸€ä¸ªé¡ºä¾¿å–å–å®¶å…·çš„é¥­å ‚"></p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress3-1548761337.jpeg" alt="å®œå®¶ | ä¸€ä¸ªé¡ºä¾¿å–å–å®¶å…·çš„é¥­å ‚"></p><blockquote><p>åŸæ–‡å§‹å‘äºå¾®ä¿¡å…¬ä¼—å·ï¼ˆæ´¾å¤§æ˜Ÿæ˜Ÿæ˜Ÿæ˜Ÿï¼‰ï¼š<a href="http://mp.weixin.qq.com/s/fml6LiuDyC8qeY6rLNhtpw" target="_blank" rel="noopener">å®œå®¶ | ä¸€ä¸ªé¡ºä¾¿å–å–å®¶å…·çš„é¥­å ‚</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Life </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Food </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸€è˜­æ‹‰é¢</title>
      <link href="/2015-11-18-ichiran-ramen/"/>
      <url>/2015-11-18-ichiran-ramen/</url>
      
        <content type="html"><![CDATA[<p>ä¸€è˜­æ‹‰é¢</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress0-1548759254.jpeg" alt="ä¸€è˜­æ‹‰é¢"><br>â–²é“œé”£æ¹¾åº—é—¨å£ </p><p>ä¸€è˜­æ‹‰é¢çš„ç‰¹ç‚¹åœ¨äºåº§ä½æ˜¯éš”é—´å¹¶ä¸”24å°æ—¶è¿è¥ï¼Œå¾ˆé€‚åˆæ·±å¤œä¸‹ç­åä¸€ä¸ªäººæ¥åƒï¼Œä¸ä¼šå°´å°¬ã€‚ </p><a id="more"></a><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress7-1548759255.jpeg" alt="ä¸€è˜­æ‹‰é¢"><br>â–²åº§ä½éƒ½æ˜¯ä¸€ä¸ªä¸ªéš”é—´ </p><p>å¹´åˆçš„æ—¶å€™ï¼Œä¸€å…°é™¤äº†æ—¥æœ¬æœ¬åœŸå¤–å°±åªæœ‰é“œé”£æ¹¾ä¸€å®¶åˆ†åº—ï¼Œæ¸¯å²›çº¿é“œé”£æ¹¾ç«™Cå‡ºå£èµ°5åˆ†é’Ÿè°¢æ–é“440å·é—¨é¢ä¾¿æ˜¯ã€‚åº—é“ºä¸ç®—å¤§ï¼Œç›®æµ‹åªèƒ½å®¹çº³50äººï¼Œå¤©é»‘äº†ä¹‹åä¸€ç›´åˆ°å‡Œæ™¨ä¸‰å››ç‚¹éƒ½è¦æ’é˜Ÿï¼Œ22ç‚¹å·¦å³é«˜å³°æœŸç”šè‡³è¦æ’ä¸€ä¸ªé’Ÿçš„é˜Ÿï¼Œä¸è¿‡ä¸ºäº†åƒä¸Šä¸€ç¢—ä¸€å…°æ‹‰é¢ï¼Œæ’é˜Ÿä¹…ä¸€ç‚¹ä¹Ÿå€¼å¾—ã€‚ </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress9-1548759257.jpeg" alt="ä¸€è˜­æ‹‰é¢"><br>â–²é“œé”£æ¹¾åº—æ’é˜Ÿæ’å‡ºäº†åº—é¢   </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress9-1548759259.jpeg" alt="ä¸€è˜­æ‹‰é¢"><br>â–²ç©ºä½™åº§ä½å±•ç¤ºï¼Œæ¯ä¸ªç»¿è‰²æ ¼å­ä»£è¡¨ä¸€ä¸ªåº§ä½ </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress3-1548759262.jpeg" alt="ä¸€è˜­æ‹‰é¢"><br>â–²åªæœ‰ä¸€æ¬¾é¢çš„èœå• </p><p>æ’é˜Ÿå¿«åˆ°çš„æ—¶å€™åº—å‘˜ä¼šç»™å•ä½ è®©ä½ åœˆå‡ºåå¥½ï¼Œæˆ‘é™¤äº†ç¡¬åº¦å–œæ¬¢åç¡¬ä¸€äº›å¤–å…¶ä»–éƒ½æ˜¯æ™®é€šã€‚åç¡¬æ˜¯å› ä¸ºå’¬èµ·æ¥æœ‰å£æ„Ÿã€‚ä¸€ç¢—89å—æ¸¯å¸çš„æ‹‰é¢ï¼Œç²¾ååœ¨äºæ±¤åº•ï¼Œæµ“é¦™è€Œä¸è…»ï¼Œå®æ‰“å®ç”¨è±šéª¨ç†¬åˆ¶ï¼Œä¸åŠ å‘³ç²¾ã€‚åƒå®Œé¢åå¦‚æœä¸å–æ±¤å°±å¤ªæµªè´¹äº†ã€‚ </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress4-1548759263.jpeg" alt="ä¸€è˜­æ‹‰é¢"><br>â–²1/2å€è¾£ </p><p>å› ä¸ºè¿˜æ˜¯å­¦ç”Ÿï¼Œé’±ä¸å¤šï¼Œæ‰€ä»¥å¾ˆå°‘è¿½åŠ é¢åº•ã€æ¸©æ³‰è›‹ã€å‰çƒ§æˆ–è€…æ³¢å­æ±½æ°´ã€‚ä¸è¿‡æ¸©æ³‰è›‹æ˜¯çœŸå¿ƒå¥½åƒï¼Œå»ºè®®å°¾å·´ä»¬å»çš„è¯ä¸€å®šè¦ç‚¹ä¸€ä»½ã€‚ ç§˜åˆ¶é…±æ±ç¡®å®æŒºè¾£çš„ï¼Œæœ‰ä¸€æ¬¡è¢«æ€‚æ¿å†™äº†5å€è¾£ï¼Œåƒå®Œæ•´ä¸ªäººéƒ½ä¸å¥½äº†ï¼Œå½“æ™šç¡è§‰éƒ½ç¡ä¸å¥½ã€‚å½“ç„¶ä¸»è¦æ˜¯å› ä¸ºæˆ‘ä¸å¤ªèƒ½åƒè¾£ï¼Œæ— è¾£ä¸æ¬¢çš„å°¾å·´å¯ä»¥è¯•è¯•20å€è¾£ï¼Œå¾ˆé…¸çˆ½[doge] </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress10-1548759264.jpeg" alt="ä¸€è˜­æ‹‰é¢"><br>â–²5å€è¾£ </p><p>åº—é¢æ˜¯å•äººéš”é—´ï¼Œæ¯ä¸ªä½ç½®éƒ½æœ‰å†·æ°´æ°´é¾™å¤´ï¼Œå°±ç®—å†å†·çš„å¤©ä¹Ÿæ˜¯å†·æ°´ã€‚ç½‘ä¸Šçš„è§£é‡Šæ˜¯  </p><blockquote><p>å†°æ°´çš„ä½œç”¨åœ¨æ–¼åƒæ‹‰é¢æ—¶ç¼“å’Œæµ“åšçš„å‘³é“ï¼ŒåŒæ—¶æœ‰åŠ©å£è…”é™æ¸©åŠ å¿«åƒé¢é€Ÿåº¦ï¼Œå› ä¸ºé¢å¤ªçƒ­è€Œåƒå¾—æ…¢ï¼Œé¢æµ¸æ±¤ç³Šçƒ‚çš„æƒ…å†µåªä¼šè¶Šæ¥è¶Šä¸¥é‡ã€‚ å†°æ°´æ˜¯å¤šå¹´æ¥æ—¥å¼æ‹‰é¢çš„ä¼ ç»Ÿï¼Œæ˜¥å¤ç§‹å†¬ä¹Ÿä¸æ”¹ã€‚åšä¸»æ›¾åœ¨ä¸‹é›ªæ—¥å­åœ¨æ‹‰é¢åº—å¤–æ’é˜Ÿï¼Œåº—å‘˜ä¼šä¸ºç­‰å¾…çš„äººé€ä¸Šçƒ­èŒ¶ï¼Œä½†å»åˆ°åº—å†…è¿˜æ˜¯å†°æ°´ã€‚ å¸Œæœ›å¤§å®¶ä¸è¦å› ç‚ºæ°”æ¸©10åº¦æ—¶æ‹‰é¢åº—å†…é€ä¸Šå†°æ°´å°±ç ´å£å¤§éª‚æˆ–ä¸Šç½‘åŠ£è¯„ï¼Œäººå®¶æ—¥æœ¬äººä¸‹é›ªæ—¶éƒ½æœªæŠ•è¯‰ã€‚ç†è§£è¿™åŸå› åä»æƒ³è¦çƒ­æ°´çš„è¯ï¼Œå‘åº—å‘˜ç¤¼è²Œåœ°è¦æ±‚å°±æ˜¯äº†ã€‚</p></blockquote><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress3-1548759265.jpeg" alt="ä¸€è˜­æ‹‰é¢"><br>â–²æ¯ä¸ªåº§ä½ä¸Šéƒ½æœ‰é¦–æ¬¡æ¥åº—é¡¾å®¢æŒ‡å—ï¼Œä¸­è‹±æ—¥å„ä¸€ä»½ </p><p>ä»Šå¹´å¹´ä¸­çš„æ—¶å€™ï¼Œä¸€å…°åœ¨å°–æ²™å’€æ£‰ç™»å¾„8å·è´Ÿä¸€æ¥¼å¼€äº†ç¬¬äºŒå®¶åˆ†åº—ã€‚ä¸çŸ¥é“ä»€ä¹ˆåŸå› ï¼Œå¾ˆå¤šåœ°å›¾ä¸Šéƒ½è¿˜æ²¡æœ‰æ ‡è®°å‡ºæ¥ï¼Œå°–æ²™å’€N4å‡ºå£å‡ºæ¥å°±æ˜¯äº†ã€‚ </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress9-1548759265.jpg" alt="ä¸€è˜­æ‹‰é¢"><br>â–²é«˜å¾·åœ°å›¾ </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress4-1548759267.jpeg" alt="ä¸€è˜­æ‹‰é¢"><br>â–²å°–æ²™å’€åº—å…¥å£ï¼Œåº—é“ºåœ¨è´Ÿä¸€æ¥¼ </p><p>å¯èƒ½æ˜¯å› ä¸ºåœ¨é“œé”£æ¹¾çš„ç¬¬ä¸€å®¶æµ·å¤–åˆ†åº—å°åˆ°äº†ç”œå¤´ï¼Œè¿™å®¶æ–°åˆ†åº—é¢ç§¯å¾ˆå¤§ï¼Œè€Œä¸”å‡ºç°äº†ä¸€å…°å±‹å°ï¼Œå°±æ˜¯æ™®é€šé¤å…çš„åº§æ¤…åŒºï¼Œä½†æˆ‘è¿˜æ˜¯å–œæ¬¢éš”é—´å¤šä¸€ç‚¹ï¼Œæ¯•ç«Ÿéš”é—´æ˜¯ä¸€å…°çš„ç‰¹è‰²ï¼Œåå±‹å°çš„è¯æ²¡æœ‰æ„Ÿè§‰ã€‚ </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress5-1548759269.jpeg" alt="ä¸€è˜­æ‹‰é¢"><br>â–²å°–æ²™å’€åº—ä¸€å…°å±‹å° </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress0-1548759271.jpeg" alt="ä¸€è˜­æ‹‰é¢"><br>â–²ä¸€å…°æ–¹ä¾¿é¢ </p><p>ä¸€å…°æ–¹ä¾¿é¢ï¼Œå››äº”æœˆä»½åˆšæ¨å‡ºçš„æ—¶å€™æœ‰ä¹°å•æ»¡200HKDé€ä¸€ä¸ªçš„æ´»åŠ¨ï¼Œå›æ¥å®¿èˆæ³¡äº†ä¸€ä¸‹å‘ç°æŒºä¸€èˆ¬çš„ï¼Œè·Ÿåº—é‡Œåƒçš„å·®è·å¤ªå¤§ï¼Œä¸çŸ¥é“æ˜¯æ–¹ä¾¿é¢çš„é—®é¢˜è¿˜æ˜¯æˆ‘æ³¡é¢æ–¹æ³•ä¸å½“[æ‘Šæ‰‹]åŸä»·æ˜¯198HKDäº”åŒ…ï¼Œæ®è¯´ä¹°ä¸€å¥—çš„è¯é‡Œé¢ä¼šæœ‰ç‰¹æ®Šé…æ–™ </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress4-1548759272.jpeg" alt="ä¸€è˜­æ‹‰é¢"><br>â–²æ³¡å‡ºæ¥çš„æ•ˆæœï¼Œå‡­è‰¯å¿ƒè®²ç¡®å®æ¯”åˆå‘³é“ä¹‹ç±»çš„å¥½åƒä¸€äº›ï¼Œä½†è¿˜ä¸è‡³äºå¤ªå¥½åƒï¼Œä¸å€¼é‚£ä¸ªä»·ã€‚ </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress6-1548759275.jpeg" alt="ä¸€è˜­æ‹‰é¢"><br>â–²æ–¹ä¾¿é¢æµ·æŠ¥ </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress4-1548759279.jpeg" alt="ä¸€è˜­æ‹‰é¢"><br>â–²æ”¶é“¶å° </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress0-1548759280.jpeg" alt="ä¸€è˜­æ‹‰é¢"><br>â–²æ”¶é“¶å°åé¢çš„å±•æŸœ </p><p>æœˆåˆå»åƒçš„æ—¶å€™å‘ç°è´¦å•å¤šäº†ä¸€é¡¹é¢å¤–10%çš„æœåŠ¡è´¹ï¼Œä»¥å‰éƒ½æ²¡è§è¿‡ï¼Œä¸çŸ¥é“æ˜¯æœ€è¿‘æ‰å¼€å§‹æ”¶çš„è¿˜æ˜¯å› ä¸ºå°–æ²™å’€åº—æ¯”è¾ƒå¤§è¦é¢å¤–æ”¶è´¹ã€‚ä»˜æ¬¾æ”¯æŒç°é‡‘ã€å…«è¾¾é€šå’Œé“¶è”å¡ï¼Œæˆ‘é¢„è®¡ä¸ç”¨å¤ªä¹…ï¼Œæ”¯ä»˜å®å°±ä¼šæ¥æ’ä¸€è„šï¼Œè¿›ä¸€æ­¥æ–¹ä¾¿å¤§é™†æ¸¸å®¢åœ¨é¦™æ¸¯æ¸¸ç©ã€‚ </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress9-1548759281.jpeg" alt="ä¸€è˜­æ‹‰é¢"><br>â–²å°–æ²™å’€åº—å†…æµ·æŠ¥ </p><p>è¿˜æ²¡è¯»å¤§å­¦çš„æ—¶å€™åœ¨å¹¿å·ä½ï¼Œæ¯æ¬¡å»æ­£ä½³å’Œä¸­ååŸºæœ¬ä¸Šéƒ½æ˜¯åƒåšå¤šä¸€å¹¸èˆã€‚åšå¤šåˆšè¿›é©»å¹¿å·ç¬¬ä¸€æ¬¡åƒçš„æ—¶å€™éœ‡æƒŠäº†ï¼Œæ€ä¹ˆä¼šæœ‰è¿™ä¹ˆå¥½åƒçš„é¢ï¼Œä»æ­¤å†ä¹Ÿæ²¡åƒè¿‡å‘³åƒå…¬ä»”é¢ã€‚ ç„¶è€Œä¸Šå¤§å­¦åï¼ŒæŸæ¬¡å®‰åˆ©åˆ«äººåšå¤šæ—¶è¢«åå®‰åˆ©äº†ä¸€å…°ï¼Œè¿™æ‰å‘è§‰å±±å¤–æœ‰å±±ã€‚ </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress2-1548759282.jpeg" alt="ä¸€è˜­æ‹‰é¢"><br>â–²é“œé”£æ¹¾åº—é—¨é¢ </p><p>ä¸€å…°æ²¡æœ‰åšå¤šä¸€å¹¸èˆçš„å–§é—¹ç¯å¢ƒï¼Œåº—å‘˜ä»¬ä¸ä¼šçƒ­è¡€åœ°é½å£°ç”¨æ—¥è¯­å–Šæ¬¢è¿å…‰ä¸´ï¼Œåªä¼šåœ¨éš”é—´åé¢ç«¯é¢ä¸Šæ¥æ—¶è¯´ä¸€å£°æ…¢ç”¨ï¼ˆä¸ä¼šæ—¥è¯­ï¼ŒçŒœçš„ï¼‰ç„¶åè½ä¸‹å¸˜å­ã€‚åº—é‡Œå¦‚æœæ²¡æœ‰å°å­©çš„è¯ä¸€èˆ¬éƒ½æŒºå®‰é™ã€‚ å¦å¤–ä¸åŒäºåšå¤šä¸°å¯Œçš„èœå•ï¼Œä¸€å…°åªæœ‰ä¸€æ¬¾é¢ï¼ˆå¥½åƒæœ€è¿‘æ–°æ¨å‡ºäº†ä¸€æ¬¾æ²¾é¢ï¼Œä¸å¤ªè®°å¾—äº†ï¼‰ã€‚ </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress6-1548759283.jpeg" alt="ä¸€è˜­æ‹‰é¢"><br>â–²åŸºå‹åƒå¾—æ­£æ¬¢ </p><p>åœ¨æˆ‘æœ‰é™çš„ç»å†ä¸­ï¼Œä¸€å…°æ‹‰é¢åœ¨æˆ‘åƒè¿‡çš„æ—¥æœ¬æ‹‰é¢ä¸­ç®—æ˜¯æœ€å¥½åƒçš„äº†ï¼Œä¸€å…°ä»¥å…¶ç‹¬ç‰¹çš„éš”é—´è®¾è®¡ï¼Œåªåšä¸€æ¬¾é¢çš„åšæŒï¼Œæè‡´æµ“é¦™çš„æ±¤åº•ï¼Œå£æ„Ÿç»†è…»çš„é¢åº•èµ¢å¾—äº†å¤§ä¼—çš„å–œçˆ±ã€‚æœ‰æ—¶å€™æˆ‘å˜´é¦‹äº†ä¹Ÿä¸æ€•åŠ³ç´¯ï¼Œä¸“é—¨ä»æ·±åœ³æ¹¾è¿‡å…³æ­å·´å£«åˆ°å¤©æ°´å›´è½¬æ¸¯é“åˆ°å°–æ²™å’€æ¥åƒä¸ªé¢ï¼Œä¹Ÿç®—æ˜¯ä¸€å…°çœŸç²‰äº†ã€‚ å¤§å®¶å¦‚æœå»ä¸€å…°ï¼Œä¸€å®šè¦é¢„ç•™å¤šä¸€äº›æ—¶é—´ç”¨æ¥æ’é˜Ÿï¼Œä»¥å…è€½è¯¯è¡Œç¨‹ã€‚[doge] </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/beepress0-1548759283.jpeg" alt="ä¸€è˜­æ‹‰é¢"></p><blockquote><p>åŸæ–‡å§‹å‘äºå¾®ä¿¡å…¬ä¼—å·ï¼ˆæ´¾å¤§æ˜Ÿæ˜Ÿæ˜Ÿæ˜Ÿï¼‰ï¼š<a href="http://mp.weixin.qq.com/s/85y8zF4qNyA2NR8sBmuNLQ" target="_blank" rel="noopener">ä¸€è˜­æ‹‰é¢</a></p></blockquote><h3 id="2019-01æ›´æ–°-â€”-æ—¥æœ¬çš„ä¸€è˜­æ‹‰é¢"><a href="#2019-01æ›´æ–°-â€”-æ—¥æœ¬çš„ä¸€è˜­æ‹‰é¢" class="headerlink" title="2019.01æ›´æ–° â€” æ—¥æœ¬çš„ä¸€è˜­æ‹‰é¢"></a>2019.01æ›´æ–° â€” æ—¥æœ¬çš„ä¸€è˜­æ‹‰é¢</h3><p>  2018å¹´å¤å¤©å»å¤§é˜ªå’Œä¸œäº¬æ™ƒæ‚ äº†ä¸€åœˆï¼Œè·¯è¿‡ä¸å°‘ä¸€å…°ã€‚  </p><h3 id="å¤§é˜ª"><a href="#å¤§é˜ª" class="headerlink" title="å¤§é˜ª"></a>å¤§é˜ª</h3><h4 id><a href="#" class="headerlink" title=" "></a> </h4><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/IMG_2417.jpg" alt><br>â–²å¤§é˜ªä¹Ÿè¶…å¤šäºº</p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/IMG_7512.jpg" alt><br>â–²è‡ªåŠ©æœºå™¨å…ˆä»˜åé£Ÿï¼Œè¿™ç§æœºå™¨æ˜¯çœŸçš„ğŸ‚ğŸº   </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/IMG_4485.jpg" alt><br>â–²è‡ªåŠ©æœºå‡ºçš„ç¥¨   </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/IMG_4487.jpg" alt><br>â–²å‡ºå“ç¨³å®šï¼Œè·Ÿé¦™æ¸¯çš„å‡ ä¹æ²¡åŒºåˆ«      </p><h3 id="ä¸œäº¬"><a href="#ä¸œäº¬" class="headerlink" title="ä¸œäº¬"></a>ä¸œäº¬</h3><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/IMG_7086.jpg" alt><br>â–²è¿˜æ˜¯è‡ªåŠ©æœºï¼Œä¾ç„¶äººå¤šå¾—ä¸€æ‰¹   </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/IMG_5225.jpg" alt><br>â–²è¿˜æ˜¯ä¸€æ ·çš„å‘³é“   </p><p><img src="https://raw.githubusercontent.com/Fongim/personal_blog_image/master/image/IMG_5497.jpg" alt><br>â–²ä¸€æ ·çš„æŠ¹èŒ¶è±†è…</p>]]></content>
      
      
      <categories>
          
          <category> Life </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Food </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
